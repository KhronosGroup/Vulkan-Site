<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Command Buffers :: Vulkan Documentation Project</title>
    <meta name="generator" content="Antora 3.1.10">
    <script>
      !function (theme) {
        if (theme === 'dark') document.documentElement.classList.add('dark')
        else document.documentElement.classList.add('light')
      }(localStorage && localStorage.getItem('theme') || (matchMedia('(prefers-color-scheme: dark)')?.matches && 'dark'))
    </script>
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="apple-touch-icon" sizes="180x180" href="../../../_/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../_/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../_/img/favicon-16x16.png">
    <link rel="manifest" href="../../../_/static/site.webmanifest">
    <link rel="mask-icon" href="../../../_/img/safari-pinned-tab.svg" color="#a41e22">
    <meta name="msapplication-TileColor" content="#ffc40d">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../.."><img class="navbar-item" alt="Vulkan White Label" src="../../../_/Vulkan_Docs.svg" /></a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field has-filter">
          <label for="search-input"></label>
          <input id="search-input" type="text" placeholder="Search the docs">
          <label class="filter checkbox">
            <input type="checkbox" data-facet-filter="component:spec" checked> In this component
          </label>
        </div>
      </div>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <!-- <a class="navbar-item" href="#">Home</a> -->
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Specs</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../spec/latest/chapters/introduction.html">Vulkan API</a>
            <a class="navbar-item" href="../../../glsl/latest/index.html">GLSL</a>
            <a class="navbar-item" href="../../../guide/latest/hlsl.html">HLSL</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Education</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../features/latest/features/index.html">Vulkan Feature Descriptions</a>
            <a class="navbar-item" href="../../../guide/latest/index.html">Vulkan Guide</a>
            <a class="navbar-item" href="../../../samples/latest/README.html">Vulkan Samples</a>
            <a class="navbar-item" href="../../../tutorial/latest/index.html">Vulkan Tutorial</a>
            <a class="navbar-item" href="https://www.youtube.com/c/vulkan">YouTube</a>
            <a class="navbar-item" href="https://vulkan.org">More Info at Vulkan.org</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Feedback</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="https://github.com/KhronosGroup/Vulkan-Site/issues/new/choose" target="_blank">Report a Problem</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Community</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="https://discord.gg/vulkan">Vulkan Discord</a>
            <a class="navbar-item" href="https://reddit.com/r/vulkan">Reddit</a>
            <a class="navbar-item" href="https://stackoverflow.com/questions/tagged/vulkan">Stack Overflow</a>
            <a class="navbar-item" href="https://fosstodon.org/@vulkan">Mastodon</a>
          </div>
        </div>
      </div>
    </div>
    <label class="theme-toggler">
      <input type="checkbox" id="switch-theme-checkbox" name="switch-theme-checkbox"/>
      <span class="icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="moon" class="svg-inline--fa fa-moon moon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M223.5 32C100 32 0 132.3 0 256S100 480 223.5 480c60.6 0 115.5-24.2 155.8-63.4c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6c-96.9 0-175.5-78.8-175.5-176c0-65.8 36-123.1 89.3-153.3c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"></path>
        </svg>
        <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="sun" class="svg-inline--fa fa-sun sun" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M361.5 1.2c5 2.1 8.6 6.6 9.6 11.9L391 121l107.9 19.8c5.3 1 9.8 4.6 11.9 9.6s1.5 10.7-1.6 15.2L446.9 256l62.3 90.3c3.1 4.5 3.7 10.2 1.6 15.2s-6.6 8.6-11.9 9.6L391 391 371.1 498.9c-1 5.3-4.6 9.8-9.6 11.9s-10.7 1.5-15.2-1.6L256 446.9l-90.3 62.3c-4.5 3.1-10.2 3.7-15.2 1.6s-8.6-6.6-9.6-11.9L121 391 13.1 371.1c-5.3-1-9.8-4.6-11.9-9.6s-1.5-10.7 1.6-15.2L65.1 256 2.8 165.7c-3.1-4.5-3.7-10.2-1.6-15.2s6.6-8.6 11.9-9.6L121 121 140.9 13.1c1-5.3 4.6-9.8 9.6-11.9s10.7-1.5 15.2 1.6L256 65.1 346.3 2.8c4.5-3.1 10.2-3.7 15.2-1.6zM160 256a96 96 0 1 1 192 0 96 96 0 1 1 -192 0zm224 0a128 128 0 1 0 -256 0 128 128 0 1 0 256 0z"></path>
        </svg></span>
    </label>
  </nav>
</header>
<script>
  window.onload = function() {
    let e = document.getElementById("switch-theme-checkbox")
    e.checked = document.documentElement.classList.contains("dark");
    e.checked ? e.parentElement.classList.add("active") : e.parentElement.classList.remove("active")
  }
  !function() {
    let e = document.getElementById("switch-theme-checkbox")
    e.checked = document.documentElement.classList.contains("dark")
    e.addEventListener("change", function() {
      if (document.documentElement.classList.contains("light")) {
        document.documentElement.classList.remove("light")
        document.documentElement.classList.add("dark")
      } else if (document.documentElement.classList.contains("dark")) {
        document.documentElement.classList.remove("dark")
        document.documentElement.classList.add("light")
      } else {
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          document.documentElement.classList.add("dark")
        } else {
          document.documentElement.classList.add("light")
        }
      }
      document.documentElement.setAttribute("data-theme", this.checked ? "dark" : "light"),
        function(e) {
          window.localStorage && window.localStorage.setItem("theme", e)
        }(this.checked ? "dark" : "light"), this.checked ? this.parentElement.classList.add("active") : this.parentElement.classList.remove("active")
    }.bind(e))
  }();
</script>
<div class="body">
<div class="nav-container" data-component="spec" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">Vulkan Specification</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fundamentals.html">Fundamentals</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="initialization.html">Initialization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="devsandqueues.html">Devices and Queues</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="cmdbuffers.html">Command Buffers</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="synchronization.html">Synchronization and Cache Control</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="renderpass.html">Render Pass</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="shaders.html">Shaders</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="pipelines.html">Pipelines</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="memory.html">Memory Allocation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="resources.html">Resource Creation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="samplers.html">Samplers</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="descriptorsets.html">Resource Descriptors</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="interfaces.html">Shader Interfaces</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="textures.html">Image Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fragmentdensitymapops.html">Fragment Density Map Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="queries.html">Queries</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="clears.html">Clear Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="copies.html">Copy Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="drawing.html">Drawing Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fxvertex.html">Fixed-Function Vertex Processing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="tessellation.html">Tessellation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="geometry.html">Geometry Shading</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_mesh_shader/mesh.html">Mesh Shading</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_HUAWEI_cluster_culling_shader/clusterculling.html">Cluster Culling Shading</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="vertexpostproc.html">Fixed-Function Vertex Post-Processing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="primsrast.html">Rasterization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fragops.html">Fragment Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="framebuffer.html">The Framebuffer</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dispatch.html">Dispatching Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="device_generated_commands/generatedcommands.html">Device-Generated Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="sparsemem.html">Sparse Resources</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_KHR_surface/wsi.html">Window System Integration (WSI)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_KHR_deferred_host_operations/deferred_host_operations.html">Deferred Host Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_EXT_private_data.html">Private Data</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="accelstructures.html">Acceleration Structures</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_EXT_opacity_micromap/micromaps.html">Micromap</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="raytraversal.html">Ray Traversal</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="raytracing.html">Ray Tracing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_memory_decompression.html">Memory Decompression</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="videocoding.html">Video Coding</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_optical_flow/optical_flow.html">Optical Flow</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="executiongraphs.html">Execution Graphs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="extensions.html">Extending Vulkan</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="features.html">Features</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="limits.html">Limits</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="formats.html">Formats</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="capabilities.html">Additional Capabilities</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="debugging.html">Debugging</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/spirvenv.html">Vulkan Environment for SPIR-V</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/memorymodel.html">Memory Model</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/compressedtex.html">Compressed Image Formats</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/versions.html">Core Revisions (Informative)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/extensions.html">Layers &amp; Extensions (Informative)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/roadmap.html">Vulkan Roadmap Milestones</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/boilerplate.html">API Boilerplate</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/invariance.html">Invariance</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/glossary.html">Lexicon</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/credits.html">Credits (Informative)</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Vulkan Specification</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../../../tutorial/latest/00_Introduction.html">Khronos Vulkan Tutorial</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../tutorial/latest/00_Introduction.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../glsl/latest/index.html">OpenGL Shading Language Specification</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../glsl/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../features/latest/features/index.html">Vulkan Feature Descriptions</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../features/latest/features/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../guide/latest/index.html">Vulkan Guide</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../guide/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../samples/latest/README.html">Vulkan Samples</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../samples/latest/README.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <div class="title"><a href="../index.html">Vulkan Specification</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Vulkan Specification</a></li>
    <li><a href="cmdbuffers.html">Command Buffers</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Command Buffers</h1>
<div id="preamble">
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Command buffers are objects used to record commands which <strong>can</strong> be
subsequently submitted to a device queue for execution.
There are two levels of command buffers - <em>primary command buffers</em>, which
<strong>can</strong> execute secondary command buffers, and which are submitted to queues,
and <em>secondary command buffers</em>, which <strong>can</strong> be executed by primary command
buffers, and which are not directly submitted to queues.</p>
</div>
<div class="paragraph">
<p>Command buffers are represented by <code>VkCommandBuffer</code> handles:</p>
</div>
<div id="VkCommandBuffer" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VK_DEFINE_HANDLE(VkCommandBuffer)</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Recorded commands include commands to bind pipelines and descriptor sets to
the command buffer, commands to modify dynamic state, commands to draw (for
graphics rendering), commands to dispatch (for compute), commands to execute
secondary command buffers (for primary command buffers only), commands to
copy buffers and images, and other commands.</p>
</div>
<div id="commandbuffers-statereset" class="paragraph">
<p>Each command buffer manages state independently of other command buffers.
There is no inheritance of state across primary and secondary command
buffers, or between secondary command buffers.
When a command buffer begins recording, all state in that command buffer is
<strong>undefined</strong>.
When secondary command buffer(s) are recorded to execute on a primary
command buffer, the secondary command buffer inherits no state from the
primary command buffer, and all state of the primary command buffer is
<strong>undefined</strong> after an execute secondary command buffer command is recorded.
There is one exception to this rule - if the primary command buffer is
inside a render pass instance, then the render pass and subpass state is not
disturbed by executing secondary command buffers.
For state dependent commands (such as draws and dispatches), any state
consumed by those commands <strong>must</strong> not be <strong>undefined</strong>.</p>
</div>
<div class="paragraph">
<p><a href="#VkCommandBufferInheritanceViewportScissorInfoNV">VkCommandBufferInheritanceViewportScissorInfoNV</a> defines an exception
allowing limited inheritance of dynamic viewport and scissor state.</p>
</div>
<div class="paragraph">
<p>Unless otherwise specified, and without explicit synchronization, the
various commands submitted to a queue via command buffers <strong>may</strong> execute in
arbitrary order relative to each other, and/or concurrently.
Also, the memory side effects of those commands <strong>may</strong> not be directly visible
to other commands without explicit memory dependencies.
This is true within a command buffer, and across command buffers submitted
to a given queue.
See <a href="synchronization.html#synchronization" class="xref page">the synchronization chapter</a> for information on
<a href="synchronization.html#synchronization-implicit" class="xref page">implicit</a> and explicit synchronization between
commands.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="commandbuffers-lifecycle"><a class="anchor" href="#commandbuffers-lifecycle"></a>Command Buffer Lifecycle</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Each command buffer is always in one of the following states:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Initial</dt>
<dd>
<p>When a command buffer is <a href="#vkAllocateCommandBuffers">allocated</a>, it is
in the <em>initial state</em>.
Some commands are able to <em>reset</em> a command buffer (or a set of command
buffers) back to this state from any of the executable, recording or
invalid state.
Command buffers in the initial state <strong>can</strong> only be moved to the recording
state, or freed.</p>
</dd>
<dt class="hdlist1">Recording</dt>
<dd>
<p><a href="#vkBeginCommandBuffer">vkBeginCommandBuffer</a> changes the state of a command buffer from
the initial state to the <em>recording state</em>.
Once a command buffer is in the recording state, <code>vkCmd*</code> commands
<strong>can</strong> be used to record to the command buffer.</p>
</dd>
<dt class="hdlist1">Executable</dt>
<dd>
<p><a href="#vkEndCommandBuffer">vkEndCommandBuffer</a> ends the recording of a command buffer, and
moves it from the recording state to the <em>executable state</em>.
Executable command buffers <strong>can</strong> be <a href="#commandbuffers-submission">    submitted</a>, reset, or <a href="#commandbuffers-secondary">recorded to another    command buffer</a>.</p>
</dd>
<dt class="hdlist1">Pending</dt>
<dd>
<p><a href="#commandbuffers-submission">Queue submission</a> of a command buffer
changes the state of a command buffer from the executable state to the
<em>pending state</em>.
Whilst in the pending state, applications <strong>must</strong> not attempt to modify
the command buffer in any way - as the device <strong>may</strong> be processing the
commands recorded to it.
Once execution of a command buffer completes, the command buffer either
reverts back to the <em>executable state</em>, or if it was recorded with
<code>VK_COMMAND_BUFFER_USAGE_ONE_TIME_SUBMIT_BIT</code>, it moves to the
<em>invalid state</em>.
A <a href="synchronization.html#synchronization" class="xref page">synchronization</a> command <strong>should</strong> be used to detect
when this occurs.</p>
</dd>
<dt class="hdlist1">Invalid</dt>
<dd>
<p>Some operations, such as <a href="fundamentals.html#fundamentals-objectmodel-lifetime-cmdbuffers" class="xref page">    modifying or deleting a resource</a> that was used in a command recorded
to a command buffer, will transition the state of that command buffer
into the <em>invalid state</em>.
Command buffers in the invalid state <strong>can</strong> only be reset or freed.</p>
</dd>
</dl>
</div>
<div id="commandbuffer-lifecycle-diagram" class="imageblock text-center">
<div class="content">
<img src="../_images/commandbuffer_lifecycle.svg" alt="commandbuffer lifecycle">
</div>
<div class="title">Figure 1. Lifecycle of a command buffer</div>
</div>
<div class="paragraph">
<p>Any given command that operates on a command buffer has its own requirements
on what state a command buffer <strong>must</strong> be in, which are detailed in the valid
usage constraints for that command.</p>
</div>
<div class="paragraph">
<p>Resetting a command buffer is an operation that discards any previously
recorded commands and puts a command buffer in the <em>initial state</em>.
Resetting occurs as a result of <a href="#vkResetCommandBuffer">vkResetCommandBuffer</a> or
<a href="#vkResetCommandPool">vkResetCommandPool</a>, or as part of <a href="#vkBeginCommandBuffer">vkBeginCommandBuffer</a> (which
additionally puts the command buffer in the <em>recording state</em>).</p>
</div>
<div class="paragraph">
<p><a href="#commandbuffers-secondary">Secondary command buffers</a> <strong>can</strong> be recorded to
a primary command buffer via <a href="#vkCmdExecuteCommands">vkCmdExecuteCommands</a>.
This partially ties the lifecycle of the two command buffers together - if
the primary is submitted to a queue, both the primary and any secondaries
recorded to it move to the <em>pending state</em>.
Once execution of the primary completes, so it does for any secondary
recorded within it.
After all executions of each command buffer complete, they each move to
their appropriate completion state (either to the <em>executable state</em> or the
<em>invalid state</em>, as specified above).</p>
</div>
<div class="paragraph">
<p>If a secondary moves to the <em>invalid state</em> or the <em>initial state</em>, then all
primary buffers it is recorded in move to the <em>invalid state</em>.
A primary moving to any other state does not affect the state of a secondary
recorded in it.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Resetting or freeing a primary command buffer removes the lifecycle linkage
to all secondary command buffers that were recorded into it.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="commandbuffers-pools"><a class="anchor" href="#commandbuffers-pools"></a>Command Pools</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Command pools are opaque objects that command buffer memory is allocated
from, and which allow the implementation to amortize the cost of resource
creation across multiple command buffers.
Command pools are externally synchronized, meaning that a command pool <strong>must</strong>
not be used concurrently in multiple threads.
That includes use via recording commands on any command buffers allocated
from the pool, as well as operations that allocate, free, and reset command
buffers or the pool itself.</p>
</div>
<div class="paragraph">
<p>Command pools are represented by <code>VkCommandPool</code> handles:</p>
</div>
<div id="VkCommandPool" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkCommandPool)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a command pool, call:</p>
</div>
<div id="vkCreateCommandPool" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VkResult vkCreateCommandPool(
    VkDevice                                    device,
    const VkCommandPoolCreateInfo*              pCreateInfo,
    const VkAllocationCallbacks*                pAllocator,
    VkCommandPool*                              pCommandPool);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the command pool.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to a <a href="#VkCommandPoolCreateInfo">VkCommandPoolCreateInfo</a>
structure specifying the state of the command pool object.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="memory.html#memory-allocation" class="xref page">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pCommandPool</code> is a pointer to a <a href="#VkCommandPool">VkCommandPool</a> handle in which
the created pool is returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateCommandPool-queueFamilyIndex-01937" href="#VUID-vkCreateCommandPool-queueFamilyIndex-01937"></a> <span class="vuid">VUID-vkCreateCommandPool-queueFamilyIndex-01937</span><br>

<code>pCreateInfo-&gt;queueFamilyIndex</code> <strong>must</strong> be the index of a queue family
available in the logical device <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateCommandPool-device-parameter" href="#VUID-vkCreateCommandPool-device-parameter"></a> <span class="vuid">VUID-vkCreateCommandPool-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateCommandPool-pCreateInfo-parameter" href="#VUID-vkCreateCommandPool-pCreateInfo-parameter"></a> <span class="vuid">VUID-vkCreateCommandPool-pCreateInfo-parameter</span><br>
 <code>pCreateInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkCommandPoolCreateInfo">VkCommandPoolCreateInfo</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateCommandPool-pAllocator-parameter" href="#VUID-vkCreateCommandPool-pAllocator-parameter"></a> <span class="vuid">VUID-vkCreateCommandPool-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong>must</strong> be a valid pointer to a valid <a href="memory.html#VkAllocationCallbacks" class="xref page">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateCommandPool-pCommandPool-parameter" href="#VUID-vkCreateCommandPool-pCommandPool-parameter"></a> <span class="vuid">VUID-vkCreateCommandPool-pCommandPool-parameter</span><br>
 <code>pCommandPool</code> <strong>must</strong> be a valid pointer to a <a href="#VkCommandPool">VkCommandPool</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkCommandPoolCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkCommandPoolCreateInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef struct VkCommandPoolCreateInfo {
    VkStructureType             sType;
    const void*                 pNext;
    VkCommandPoolCreateFlags    flags;
    uint32_t                    queueFamilyIndex;
} VkCommandPoolCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkCommandPoolCreateFlagBits">VkCommandPoolCreateFlagBits</a> indicating
usage behavior for the pool and command buffers allocated from it.</p>
</li>
<li>
<p><code>queueFamilyIndex</code> designates a queue family as described in section
<a href="devsandqueues.html#devsandqueues-queueprops" class="xref page">Queue Family Properties</a>.
All command buffers allocated from this command pool <strong>must</strong> be submitted
on queues from the same queue family.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandPoolCreateInfo-flags-02860" href="#VUID-VkCommandPoolCreateInfo-flags-02860"></a> <span class="vuid">VUID-VkCommandPoolCreateInfo-flags-02860</span><br>

If the <a href="features.html#features-protectedMemory" class="xref page"><code>protectedMemory</code></a> feature is
not enabled, the <code>VK_COMMAND_POOL_CREATE_PROTECTED_BIT</code> bit of
<code>flags</code> <strong>must</strong> not be set</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandPoolCreateInfo-sType-sType" href="#VUID-VkCommandPoolCreateInfo-sType-sType"></a> <span class="vuid">VUID-VkCommandPoolCreateInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_COMMAND_POOL_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkCommandPoolCreateInfo-pNext-pNext" href="#VUID-VkCommandPoolCreateInfo-pNext-pNext"></a> <span class="vuid">VUID-VkCommandPoolCreateInfo-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkCommandPoolCreateInfo-flags-parameter" href="#VUID-VkCommandPoolCreateInfo-flags-parameter"></a> <span class="vuid">VUID-VkCommandPoolCreateInfo-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkCommandPoolCreateFlagBits">VkCommandPoolCreateFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in <a href="#VkCommandPoolCreateInfo">VkCommandPoolCreateInfo</a>::<code>flags</code>,
specifying usage behavior for a command pool, are:</p>
</div>
<div id="VkCommandPoolCreateFlagBits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef enum VkCommandPoolCreateFlagBits {
    VK_COMMAND_POOL_CREATE_TRANSIENT_BIT = 0x00000001,
    VK_COMMAND_POOL_CREATE_RESET_COMMAND_BUFFER_BIT = 0x00000002,
  // Provided by VK_VERSION_1_1
    VK_COMMAND_POOL_CREATE_PROTECTED_BIT = 0x00000004,
} VkCommandPoolCreateFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_COMMAND_POOL_CREATE_TRANSIENT_BIT</code> specifies that command
buffers allocated from the pool will be short-lived, meaning that they
will be reset or freed in a relatively short timeframe.
This flag <strong>may</strong> be used by the implementation to control memory
allocation behavior within the pool.</p>
</li>
<li>
<p><code>VK_COMMAND_POOL_CREATE_RESET_COMMAND_BUFFER_BIT</code> allows any command
buffer allocated from a pool to be individually reset to the
<a href="#commandbuffers-lifecycle">initial state</a>; either by calling
<a href="#vkResetCommandBuffer">vkResetCommandBuffer</a>, or via the implicit reset when calling
<a href="#vkBeginCommandBuffer">vkBeginCommandBuffer</a>.
If this flag is not set on a pool, then <code>vkResetCommandBuffer</code> <strong>must</strong>
not be called for any command buffer allocated from that pool.</p>
</li>
<li>
<p><code>VK_COMMAND_POOL_CREATE_PROTECTED_BIT</code> specifies that command
buffers allocated from the pool are protected command buffers.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkCommandPoolCreateFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef VkFlags VkCommandPoolCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkCommandPoolCreateFlags</code> is a bitmask type for setting a mask of zero
or more <a href="#VkCommandPoolCreateFlagBits">VkCommandPoolCreateFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To trim a command pool, call:</p>
</div>
<div id="vkTrimCommandPool" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_1
void vkTrimCommandPool(
    VkDevice                                    device,
    VkCommandPool                               commandPool,
    VkCommandPoolTrimFlags                      flags);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent command</p>
</div>
<div id="vkTrimCommandPoolKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_maintenance1
void vkTrimCommandPoolKHR(
    VkDevice                                    device,
    VkCommandPool                               commandPool,
    VkCommandPoolTrimFlags                      flags);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the command pool.</p>
</li>
<li>
<p><code>commandPool</code> is the command pool to trim.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Trimming a command pool recycles unused memory from the command pool back to
the system.
Command buffers allocated from the pool are not affected by the command.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This command provides applications with some control over the internal
memory allocations used by command pools.</p>
</div>
<div class="paragraph">
<p>Unused memory normally arises from command buffers that have been recorded
and later reset, such that they are no longer using the memory.
On reset, a command buffer can return memory to its command pool, but the
only way to release memory from a command pool to the system requires
calling <a href="#vkResetCommandPool">vkResetCommandPool</a>, which cannot be executed while any command
buffers from that pool are still in use.
Subsequent recording operations into command buffers will reuse this memory
but since total memory requirements fluctuate over time, unused memory can
accumulate.</p>
</div>
<div class="paragraph">
<p>In this situation, trimming a command pool <strong>may</strong> be useful to return unused
memory back to the system, returning the total outstanding memory allocated
by the pool back to a more &#8220;average&#8221; value.</p>
</div>
<div class="paragraph">
<p>Implementations utilize many internal allocation strategies that make it
impossible to guarantee that all unused memory is released back to the
system.
For instance, an implementation of a command pool <strong>may</strong> involve allocating
memory in bulk from the system and sub-allocating from that memory.
In such an implementation any live command buffer that holds a reference to
a bulk allocation would prevent that allocation from being freed, even if
only a small proportion of the bulk allocation is in use.</p>
</div>
<div class="paragraph">
<p>In most cases trimming will result in a reduction in allocated but unused
memory, but it does not guarantee the &#8220;ideal&#8221; behavior.</p>
</div>
<div class="paragraph">
<p>Trimming <strong>may</strong> be an expensive operation, and <strong>should</strong> not be called
frequently.
Trimming <strong>should</strong> be treated as a way to relieve memory pressure after
application-known points when there exists enough unused memory that the
cost of trimming is &#8220;worth&#8221; it.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkTrimCommandPool-device-parameter" href="#VUID-vkTrimCommandPool-device-parameter"></a> <span class="vuid">VUID-vkTrimCommandPool-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkTrimCommandPool-commandPool-parameter" href="#VUID-vkTrimCommandPool-commandPool-parameter"></a> <span class="vuid">VUID-vkTrimCommandPool-commandPool-parameter</span><br>
 <code>commandPool</code> <strong>must</strong> be a valid <a href="#VkCommandPool">VkCommandPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkTrimCommandPool-flags-zerobitmask" href="#VUID-vkTrimCommandPool-flags-zerobitmask"></a> <span class="vuid">VUID-vkTrimCommandPool-flags-zerobitmask</span><br>
 <code>flags</code> <strong>must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkTrimCommandPool-commandPool-parent" href="#VUID-vkTrimCommandPool-commandPool-parent"></a> <span class="vuid">VUID-vkTrimCommandPool-commandPool-parent</span><br>
 <code>commandPool</code> <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandPool</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkCommandPoolTrimFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_1
typedef VkFlags VkCommandPoolTrimFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkCommandPoolTrimFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_maintenance1
typedef VkCommandPoolTrimFlags VkCommandPoolTrimFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkCommandPoolTrimFlags</code> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To reset a command pool, call:</p>
</div>
<div id="vkResetCommandPool" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VkResult vkResetCommandPool(
    VkDevice                                    device,
    VkCommandPool                               commandPool,
    VkCommandPoolResetFlags                     flags);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the command pool.</p>
</li>
<li>
<p><code>commandPool</code> is the command pool to reset.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkCommandPoolResetFlagBits">VkCommandPoolResetFlagBits</a> controlling
the reset operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Resetting a command pool recycles all of the resources from all of the
command buffers allocated from the command pool back to the command pool.
All command buffers that have been allocated from the command pool are put
in the <a href="#commandbuffers-lifecycle">initial state</a>.</p>
</div>
<div class="paragraph">
<p>Any primary command buffer allocated from another <a href="#VkCommandPool">VkCommandPool</a> that
is in the <a href="#commandbuffers-lifecycle">recording or executable state</a> and
has a secondary command buffer allocated from <code>commandPool</code> recorded
into it, becomes <a href="#commandbuffers-lifecycle">invalid</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetCommandPool-commandPool-00040" href="#VUID-vkResetCommandPool-commandPool-00040"></a> <span class="vuid">VUID-vkResetCommandPool-commandPool-00040</span><br>

All <code>VkCommandBuffer</code> objects allocated from <code>commandPool</code> <strong>must</strong>
not be in the <a href="#commandbuffers-lifecycle">pending state</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetCommandPool-device-parameter" href="#VUID-vkResetCommandPool-device-parameter"></a> <span class="vuid">VUID-vkResetCommandPool-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkResetCommandPool-commandPool-parameter" href="#VUID-vkResetCommandPool-commandPool-parameter"></a> <span class="vuid">VUID-vkResetCommandPool-commandPool-parameter</span><br>
 <code>commandPool</code> <strong>must</strong> be a valid <a href="#VkCommandPool">VkCommandPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkResetCommandPool-flags-parameter" href="#VUID-vkResetCommandPool-flags-parameter"></a> <span class="vuid">VUID-vkResetCommandPool-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkCommandPoolResetFlagBits">VkCommandPoolResetFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkResetCommandPool-commandPool-parent" href="#VUID-vkResetCommandPool-commandPool-parent"></a> <span class="vuid">VUID-vkResetCommandPool-commandPool-parent</span><br>
 <code>commandPool</code> <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandPool</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in <a href="#vkResetCommandPool">vkResetCommandPool</a>::<code>flags</code>, controlling
the reset operation, are:</p>
</div>
<div id="VkCommandPoolResetFlagBits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef enum VkCommandPoolResetFlagBits {
    VK_COMMAND_POOL_RESET_RELEASE_RESOURCES_BIT = 0x00000001,
} VkCommandPoolResetFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_COMMAND_POOL_RESET_RELEASE_RESOURCES_BIT</code>
specifies that resetting a command pool recycles all of the resources
from the command pool back to the system.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkCommandPoolResetFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef VkFlags VkCommandPoolResetFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkCommandPoolResetFlags</code> is a bitmask type for setting a mask of zero
or more <a href="#VkCommandPoolResetFlagBits">VkCommandPoolResetFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a command pool, call:</p>
</div>
<div id="vkDestroyCommandPool" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkDestroyCommandPool(
    VkDevice                                    device,
    VkCommandPool                               commandPool,
    const VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the command pool.</p>
</li>
<li>
<p><code>commandPool</code> is the handle of the command pool to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="memory.html#memory-allocation" class="xref page">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When a pool is destroyed, all command buffers allocated from the pool are
<a href="#vkFreeCommandBuffers">freed</a>.</p>
</div>
<div class="paragraph">
<p>Any primary command buffer allocated from another <a href="#VkCommandPool">VkCommandPool</a> that
is in the <a href="#commandbuffers-lifecycle">recording or executable state</a> and
has a secondary command buffer allocated from <code>commandPool</code> recorded
into it, becomes <a href="#commandbuffers-lifecycle">invalid</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyCommandPool-commandPool-00041" href="#VUID-vkDestroyCommandPool-commandPool-00041"></a> <span class="vuid">VUID-vkDestroyCommandPool-commandPool-00041</span><br>

All <code>VkCommandBuffer</code> objects allocated from <code>commandPool</code> <strong>must</strong>
not be in the <a href="#commandbuffers-lifecycle">pending state</a></p>
</li>
<li>
<p><a id="VUID-vkDestroyCommandPool-commandPool-00042" href="#VUID-vkDestroyCommandPool-commandPool-00042"></a> <span class="vuid">VUID-vkDestroyCommandPool-commandPool-00042</span><br>

If <code>VkAllocationCallbacks</code> were provided when <code>commandPool</code> was
created, a compatible set of callbacks <strong>must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyCommandPool-commandPool-00043" href="#VUID-vkDestroyCommandPool-commandPool-00043"></a> <span class="vuid">VUID-vkDestroyCommandPool-commandPool-00043</span><br>

If no <code>VkAllocationCallbacks</code> were provided when <code>commandPool</code>
was created, <code>pAllocator</code> <strong>must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyCommandPool-device-parameter" href="#VUID-vkDestroyCommandPool-device-parameter"></a> <span class="vuid">VUID-vkDestroyCommandPool-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyCommandPool-commandPool-parameter" href="#VUID-vkDestroyCommandPool-commandPool-parameter"></a> <span class="vuid">VUID-vkDestroyCommandPool-commandPool-parameter</span><br>
 If <code>commandPool</code> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, <code>commandPool</code> <strong>must</strong> be a valid <a href="#VkCommandPool">VkCommandPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyCommandPool-pAllocator-parameter" href="#VUID-vkDestroyCommandPool-pAllocator-parameter"></a> <span class="vuid">VUID-vkDestroyCommandPool-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong>must</strong> be a valid pointer to a valid <a href="memory.html#VkAllocationCallbacks" class="xref page">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyCommandPool-commandPool-parent" href="#VUID-vkDestroyCommandPool-commandPool-parent"></a> <span class="vuid">VUID-vkDestroyCommandPool-commandPool-parent</span><br>
 If <code>commandPool</code> is a valid handle, it <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandPool</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="commandbuffer-allocation"><a class="anchor" href="#commandbuffer-allocation"></a>Command Buffer Allocation and Management</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To allocate command buffers, call:</p>
</div>
<div id="vkAllocateCommandBuffers" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VkResult vkAllocateCommandBuffers(
    VkDevice                                    device,
    const VkCommandBufferAllocateInfo*          pAllocateInfo,
    VkCommandBuffer*                            pCommandBuffers);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the command pool.</p>
</li>
<li>
<p><code>pAllocateInfo</code> is a pointer to a <a href="#VkCommandBufferAllocateInfo">VkCommandBufferAllocateInfo</a>
structure describing parameters of the allocation.</p>
</li>
<li>
<p><code>pCommandBuffers</code> is a pointer to an array of <a href="#VkCommandBuffer">VkCommandBuffer</a>
handles in which the resulting command buffer objects are returned.
The array <strong>must</strong> be at least the length specified by the
<code>commandBufferCount</code> member of <code>pAllocateInfo</code>.
Each allocated command buffer begins in the initial state.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkAllocateCommandBuffers</code> <strong>can</strong> be used to allocate multiple command
buffers.
If the allocation of any of those command buffers fails, the implementation
<strong>must</strong> free all successfully allocated command buffer objects from this
command, set all entries of the <code>pCommandBuffers</code> array to <code>NULL</code> and
return the error.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Filling <code>pCommandBuffers</code> with <code>NULL</code> values on failure is an exception
to the default error behavior that output parameters will have <strong>undefined</strong>
contents.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When command buffers are first allocated, they are in the
<a href="#commandbuffers-lifecycle">initial state</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkAllocateCommandBuffers-device-parameter" href="#VUID-vkAllocateCommandBuffers-device-parameter"></a> <span class="vuid">VUID-vkAllocateCommandBuffers-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkAllocateCommandBuffers-pAllocateInfo-parameter" href="#VUID-vkAllocateCommandBuffers-pAllocateInfo-parameter"></a> <span class="vuid">VUID-vkAllocateCommandBuffers-pAllocateInfo-parameter</span><br>
 <code>pAllocateInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkCommandBufferAllocateInfo">VkCommandBufferAllocateInfo</a> structure</p>
</li>
<li>
<p><a id="VUID-vkAllocateCommandBuffers-pCommandBuffers-parameter" href="#VUID-vkAllocateCommandBuffers-pCommandBuffers-parameter"></a> <span class="vuid">VUID-vkAllocateCommandBuffers-pCommandBuffers-parameter</span><br>
 <code>pCommandBuffers</code> <strong>must</strong> be a valid pointer to an array of <code>pAllocateInfo-&gt;commandBufferCount</code> <a href="#VkCommandBuffer">VkCommandBuffer</a> handles</p>
</li>
<li>
<p><a id="VUID-vkAllocateCommandBuffers-pAllocateInfo::commandBufferCount-arraylength" href="#VUID-vkAllocateCommandBuffers-pAllocateInfo::commandBufferCount-arraylength"></a> <span class="vuid">VUID-vkAllocateCommandBuffers-pAllocateInfo::commandBufferCount-arraylength</span><br>
 <code>pAllocateInfo-&gt;commandBufferCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>pAllocateInfo-&gt;commandPool</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkCommandBufferAllocateInfo</code> structure is defined as:</p>
</div>
<div id="VkCommandBufferAllocateInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef struct VkCommandBufferAllocateInfo {
    VkStructureType         sType;
    const void*             pNext;
    VkCommandPool           commandPool;
    VkCommandBufferLevel    level;
    uint32_t                commandBufferCount;
} VkCommandBufferAllocateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>commandPool</code> is the command pool from which the command buffers are
allocated.</p>
</li>
<li>
<p><code>level</code> is a <a href="#VkCommandBufferLevel">VkCommandBufferLevel</a> value specifying the command
buffer level.</p>
</li>
<li>
<p><code>commandBufferCount</code> is the number of command buffers to allocate
from the pool.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferAllocateInfo-sType-sType" href="#VUID-VkCommandBufferAllocateInfo-sType-sType"></a> <span class="vuid">VUID-VkCommandBufferAllocateInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_COMMAND_BUFFER_ALLOCATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferAllocateInfo-pNext-pNext" href="#VUID-VkCommandBufferAllocateInfo-pNext-pNext"></a> <span class="vuid">VUID-VkCommandBufferAllocateInfo-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferAllocateInfo-commandPool-parameter" href="#VUID-VkCommandBufferAllocateInfo-commandPool-parameter"></a> <span class="vuid">VUID-VkCommandBufferAllocateInfo-commandPool-parameter</span><br>
 <code>commandPool</code> <strong>must</strong> be a valid <a href="#VkCommandPool">VkCommandPool</a> handle</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferAllocateInfo-level-parameter" href="#VUID-VkCommandBufferAllocateInfo-level-parameter"></a> <span class="vuid">VUID-VkCommandBufferAllocateInfo-level-parameter</span><br>
 <code>level</code> <strong>must</strong> be a valid <a href="#VkCommandBufferLevel">VkCommandBufferLevel</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <a href="#VkCommandBufferAllocateInfo">VkCommandBufferAllocateInfo</a>::<code>level</code>,
specifying the command buffer level, are:</p>
</div>
<div id="VkCommandBufferLevel" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef enum VkCommandBufferLevel {
    VK_COMMAND_BUFFER_LEVEL_PRIMARY = 0,
    VK_COMMAND_BUFFER_LEVEL_SECONDARY = 1,
} VkCommandBufferLevel;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_COMMAND_BUFFER_LEVEL_PRIMARY</code> specifies a primary command
buffer.</p>
</li>
<li>
<p><code>VK_COMMAND_BUFFER_LEVEL_SECONDARY</code> specifies a secondary command
buffer.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To reset a command buffer, call:</p>
</div>
<div id="vkResetCommandBuffer" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VkResult vkResetCommandBuffer(
    VkCommandBuffer                             commandBuffer,
    VkCommandBufferResetFlags                   flags);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer to reset.
The command buffer <strong>can</strong> be in any state other than
<a href="#commandbuffers-lifecycle">pending</a>, and is moved into the
<a href="#commandbuffers-lifecycle">initial state</a>.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkCommandBufferResetFlagBits">VkCommandBufferResetFlagBits</a>
controlling the reset operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any primary command buffer that is in the <a href="#commandbuffers-lifecycle">recording or executable state</a> and has <code>commandBuffer</code> recorded into
it, becomes <a href="#commandbuffers-lifecycle">invalid</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetCommandBuffer-commandBuffer-00045" href="#VUID-vkResetCommandBuffer-commandBuffer-00045"></a> <span class="vuid">VUID-vkResetCommandBuffer-commandBuffer-00045</span><br>

<code>commandBuffer</code> <strong>must</strong> not be in the <a href="#commandbuffers-lifecycle">    pending state</a></p>
</li>
<li>
<p><a id="VUID-vkResetCommandBuffer-commandBuffer-00046" href="#VUID-vkResetCommandBuffer-commandBuffer-00046"></a> <span class="vuid">VUID-vkResetCommandBuffer-commandBuffer-00046</span><br>

<code>commandBuffer</code> <strong>must</strong> have been allocated from a pool that was
created with the <code>VK_COMMAND_POOL_CREATE_RESET_COMMAND_BUFFER_BIT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetCommandBuffer-commandBuffer-parameter" href="#VUID-vkResetCommandBuffer-commandBuffer-parameter"></a> <span class="vuid">VUID-vkResetCommandBuffer-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkResetCommandBuffer-flags-parameter" href="#VUID-vkResetCommandBuffer-flags-parameter"></a> <span class="vuid">VUID-vkResetCommandBuffer-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkCommandBufferResetFlagBits">VkCommandBufferResetFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in <a href="#vkResetCommandBuffer">vkResetCommandBuffer</a>::<code>flags</code>,
controlling the reset operation, are:</p>
</div>
<div id="VkCommandBufferResetFlagBits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef enum VkCommandBufferResetFlagBits {
    VK_COMMAND_BUFFER_RESET_RELEASE_RESOURCES_BIT = 0x00000001,
} VkCommandBufferResetFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_COMMAND_BUFFER_RESET_RELEASE_RESOURCES_BIT</code> specifies that most
or all memory resources currently owned by the command buffer <strong>should</strong> be
returned to the parent command pool.
If this flag is not set, then the command buffer <strong>may</strong> hold onto memory
resources and reuse them when recording commands.
<code>commandBuffer</code> is moved to the <a href="#commandbuffers-lifecycle">initial    state</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkCommandBufferResetFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef VkFlags VkCommandBufferResetFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkCommandBufferResetFlags</code> is a bitmask type for setting a mask of zero
or more <a href="#VkCommandBufferResetFlagBits">VkCommandBufferResetFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To free command buffers, call:</p>
</div>
<div id="vkFreeCommandBuffers" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkFreeCommandBuffers(
    VkDevice                                    device,
    VkCommandPool                               commandPool,
    uint32_t                                    commandBufferCount,
    const VkCommandBuffer*                      pCommandBuffers);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the command pool.</p>
</li>
<li>
<p><code>commandPool</code> is the command pool from which the command buffers
were allocated.</p>
</li>
<li>
<p><code>commandBufferCount</code> is the length of the <code>pCommandBuffers</code>
array.</p>
</li>
<li>
<p><code>pCommandBuffers</code> is a pointer to an array of handles of command
buffers to free.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any primary command buffer that is in the <a href="#commandbuffers-lifecycle">recording or executable state</a> and has any element of <code>pCommandBuffers</code>
recorded into it, becomes <a href="#commandbuffers-lifecycle">invalid</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkFreeCommandBuffers-pCommandBuffers-00047" href="#VUID-vkFreeCommandBuffers-pCommandBuffers-00047"></a> <span class="vuid">VUID-vkFreeCommandBuffers-pCommandBuffers-00047</span><br>

All elements of <code>pCommandBuffers</code> <strong>must</strong> not be in the
<a href="#commandbuffers-lifecycle">pending state</a></p>
</li>
<li>
<p><a id="VUID-vkFreeCommandBuffers-pCommandBuffers-00048" href="#VUID-vkFreeCommandBuffers-pCommandBuffers-00048"></a> <span class="vuid">VUID-vkFreeCommandBuffers-pCommandBuffers-00048</span><br>

<code>pCommandBuffers</code> <strong>must</strong> be a valid pointer to an array of
<code>commandBufferCount</code> <code>VkCommandBuffer</code> handles, each element of
which <strong>must</strong> either be a valid handle or <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkFreeCommandBuffers-device-parameter" href="#VUID-vkFreeCommandBuffers-device-parameter"></a> <span class="vuid">VUID-vkFreeCommandBuffers-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkFreeCommandBuffers-commandPool-parameter" href="#VUID-vkFreeCommandBuffers-commandPool-parameter"></a> <span class="vuid">VUID-vkFreeCommandBuffers-commandPool-parameter</span><br>
 <code>commandPool</code> <strong>must</strong> be a valid <a href="#VkCommandPool">VkCommandPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkFreeCommandBuffers-commandBufferCount-arraylength" href="#VUID-vkFreeCommandBuffers-commandBufferCount-arraylength"></a> <span class="vuid">VUID-vkFreeCommandBuffers-commandBufferCount-arraylength</span><br>
 <code>commandBufferCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkFreeCommandBuffers-commandPool-parent" href="#VUID-vkFreeCommandBuffers-commandPool-parent"></a> <span class="vuid">VUID-vkFreeCommandBuffers-commandPool-parent</span><br>
 <code>commandPool</code> <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
<li>
<p><a id="VUID-vkFreeCommandBuffers-pCommandBuffers-parent" href="#VUID-vkFreeCommandBuffers-pCommandBuffers-parent"></a> <span class="vuid">VUID-vkFreeCommandBuffers-pCommandBuffers-parent</span><br>
 Each element of <code>pCommandBuffers</code> that is a valid handle <strong>must</strong> have been created, allocated, or retrieved from <code>commandPool</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandPool</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to each member of <code>pCommandBuffers</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="commandbuffers-recording"><a class="anchor" href="#commandbuffers-recording"></a>Command Buffer Recording</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To begin recording a command buffer, call:</p>
</div>
<div id="vkBeginCommandBuffer" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VkResult vkBeginCommandBuffer(
    VkCommandBuffer                             commandBuffer,
    const VkCommandBufferBeginInfo*             pBeginInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the handle of the command buffer which is to be
put in the recording state.</p>
</li>
<li>
<p><code>pBeginInfo</code> is a pointer to a <a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a>
structure defining additional information about how the command buffer
begins recording.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBeginCommandBuffer-commandBuffer-00049" href="#VUID-vkBeginCommandBuffer-commandBuffer-00049"></a> <span class="vuid">VUID-vkBeginCommandBuffer-commandBuffer-00049</span><br>

<code>commandBuffer</code> <strong>must</strong> not be in the <a href="#commandbuffers-lifecycle">    recording or pending state</a></p>
</li>
<li>
<p><a id="VUID-vkBeginCommandBuffer-commandBuffer-00050" href="#VUID-vkBeginCommandBuffer-commandBuffer-00050"></a> <span class="vuid">VUID-vkBeginCommandBuffer-commandBuffer-00050</span><br>

If <code>commandBuffer</code> was allocated from a <a href="#VkCommandPool">VkCommandPool</a> which
did not have the <code>VK_COMMAND_POOL_CREATE_RESET_COMMAND_BUFFER_BIT</code>
flag set, <code>commandBuffer</code> <strong>must</strong> be in the
<a href="#commandbuffers-lifecycle">initial state</a></p>
</li>
<li>
<p><a id="VUID-vkBeginCommandBuffer-commandBuffer-00051" href="#VUID-vkBeginCommandBuffer-commandBuffer-00051"></a> <span class="vuid">VUID-vkBeginCommandBuffer-commandBuffer-00051</span><br>

If <code>commandBuffer</code> is a secondary command buffer, the
<code>pInheritanceInfo</code> member of <code>pBeginInfo</code> <strong>must</strong> be a valid
<code>VkCommandBufferInheritanceInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkBeginCommandBuffer-commandBuffer-00052" href="#VUID-vkBeginCommandBuffer-commandBuffer-00052"></a> <span class="vuid">VUID-vkBeginCommandBuffer-commandBuffer-00052</span><br>

If <code>commandBuffer</code> is a secondary command buffer and either the
<code>occlusionQueryEnable</code> member of the <code>pInheritanceInfo</code> member
of <code>pBeginInfo</code> is <code>VK_FALSE</code>, or the
<a href="features.html#features-occlusionQueryPrecise" class="xref page"><code>occlusionQueryPrecise</code></a> feature
is not enabled, then <code>pBeginInfo-&gt;pInheritanceInfo&#8594;queryFlags</code>
<strong>must</strong> not contain <code>VK_QUERY_CONTROL_PRECISE_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkBeginCommandBuffer-commandBuffer-02840" href="#VUID-vkBeginCommandBuffer-commandBuffer-02840"></a> <span class="vuid">VUID-vkBeginCommandBuffer-commandBuffer-02840</span><br>

If <code>commandBuffer</code> is a primary command buffer, then
<code>pBeginInfo-&gt;flags</code> <strong>must</strong> not set both the
<code>VK_COMMAND_BUFFER_USAGE_ONE_TIME_SUBMIT_BIT</code> and the
<code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code> flags</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBeginCommandBuffer-commandBuffer-parameter" href="#VUID-vkBeginCommandBuffer-commandBuffer-parameter"></a> <span class="vuid">VUID-vkBeginCommandBuffer-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkBeginCommandBuffer-pBeginInfo-parameter" href="#VUID-vkBeginCommandBuffer-pBeginInfo-parameter"></a> <span class="vuid">VUID-vkBeginCommandBuffer-pBeginInfo-parameter</span><br>
 <code>pBeginInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkCommandBufferBeginInfo</code> structure is defined as:</p>
</div>
<div id="VkCommandBufferBeginInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef struct VkCommandBufferBeginInfo {
    VkStructureType                          sType;
    const void*                              pNext;
    VkCommandBufferUsageFlags                flags;
    const VkCommandBufferInheritanceInfo*    pInheritanceInfo;
} VkCommandBufferBeginInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkCommandBufferUsageFlagBits">VkCommandBufferUsageFlagBits</a>
specifying usage behavior for the command buffer.</p>
</li>
<li>
<p><code>pInheritanceInfo</code> is a pointer to a
<a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a> structure, used if
<code>commandBuffer</code> is a secondary command buffer.
If this is a primary command buffer, then this value is ignored.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferBeginInfo-flags-09123" href="#VUID-VkCommandBufferBeginInfo-flags-09123"></a> <span class="vuid">VUID-VkCommandBufferBeginInfo-flags-09123</span><br>

If <code>flags</code> contains
<code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code>, the
<a href="#VkCommandPool">VkCommandPool</a> that <code>commandBuffer</code> was allocated from <strong>must</strong>
support graphics operations</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferBeginInfo-flags-00055" href="#VUID-VkCommandBufferBeginInfo-flags-00055"></a> <span class="vuid">VUID-VkCommandBufferBeginInfo-flags-00055</span><br>

If <code>flags</code> contains
<code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code>, the
<code>framebuffer</code> member of <code>pInheritanceInfo</code> <strong>must</strong> be either
<a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, or a valid <code>VkFramebuffer</code> that is compatible
with the <code>renderPass</code> member of <code>pInheritanceInfo</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferBeginInfo-flags-09240" href="#VUID-VkCommandBufferBeginInfo-flags-09240"></a> <span class="vuid">VUID-VkCommandBufferBeginInfo-flags-09240</span><br>

If <code>flags</code> contains
<code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code> and the
<a href="features.html#features-dynamicRendering" class="xref page"><code>dynamicRendering</code></a> feature is not
enabled, the <code>renderPass</code> member of <code>pInheritanceInfo</code> <strong>must</strong> not
be <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferBeginInfo-flags-06002" href="#VUID-VkCommandBufferBeginInfo-flags-06002"></a> <span class="vuid">VUID-VkCommandBufferBeginInfo-flags-06002</span><br>

If <code>flags</code> contains
<code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code> and the
<code>renderPass</code> member of <code>pInheritanceInfo</code> is
<a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, the <code>pNext</code> chain of <code>pInheritanceInfo</code>
<strong>must</strong> include a <a href="#VkCommandBufferInheritanceRenderingInfo">VkCommandBufferInheritanceRenderingInfo</a> structure</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferBeginInfo-flags-06003" href="#VUID-VkCommandBufferBeginInfo-flags-06003"></a> <span class="vuid">VUID-VkCommandBufferBeginInfo-flags-06003</span><br>

If <code>flags</code> contains
<code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code>, the
<code>renderPass</code> member of <code>pInheritanceInfo</code> is
<a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, and the <code>pNext</code> chain of
<code>pInheritanceInfo</code> includes a <a href="#VkAttachmentSampleCountInfoAMD">VkAttachmentSampleCountInfoAMD</a>
or <a href="#VkAttachmentSampleCountInfoNV">VkAttachmentSampleCountInfoNV</a> structure, the
<code>colorAttachmentCount</code> member of that structure <strong>must</strong> be equal to
the value of
<a href="#VkCommandBufferInheritanceRenderingInfo">VkCommandBufferInheritanceRenderingInfo</a>::<code>colorAttachmentCount</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferBeginInfo-flags-06000" href="#VUID-VkCommandBufferBeginInfo-flags-06000"></a> <span class="vuid">VUID-VkCommandBufferBeginInfo-flags-06000</span><br>

If <code>flags</code> contains
<code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code>
and the <code>renderPass</code> member of <code>pInheritanceInfo</code> is not
<a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>,
the <code>renderPass</code> member of <code>pInheritanceInfo</code> <strong>must</strong> be a valid
<code>VkRenderPass</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferBeginInfo-flags-06001" href="#VUID-VkCommandBufferBeginInfo-flags-06001"></a> <span class="vuid">VUID-VkCommandBufferBeginInfo-flags-06001</span><br>

If <code>flags</code> contains
<code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code>
and the <code>renderPass</code> member of <code>pInheritanceInfo</code> is not
<a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>,
the <code>subpass</code> member of <code>pInheritanceInfo</code> <strong>must</strong> be a valid
subpass index within the <code>renderPass</code> member of
<code>pInheritanceInfo</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferBeginInfo-sType-sType" href="#VUID-VkCommandBufferBeginInfo-sType-sType"></a> <span class="vuid">VUID-VkCommandBufferBeginInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_COMMAND_BUFFER_BEGIN_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferBeginInfo-pNext-pNext" href="#VUID-VkCommandBufferBeginInfo-pNext-pNext"></a> <span class="vuid">VUID-VkCommandBufferBeginInfo-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code> or a pointer to a valid instance of <a href="#VkDeviceGroupCommandBufferBeginInfo">VkDeviceGroupCommandBufferBeginInfo</a></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferBeginInfo-sType-unique" href="#VUID-VkCommandBufferBeginInfo-sType-unique"></a> <span class="vuid">VUID-VkCommandBufferBeginInfo-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferBeginInfo-flags-parameter" href="#VUID-VkCommandBufferBeginInfo-flags-parameter"></a> <span class="vuid">VUID-VkCommandBufferBeginInfo-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkCommandBufferUsageFlagBits">VkCommandBufferUsageFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in <a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a>::<code>flags</code>,
specifying usage behavior for a command buffer, are:</p>
</div>
<div id="VkCommandBufferUsageFlagBits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef enum VkCommandBufferUsageFlagBits {
    VK_COMMAND_BUFFER_USAGE_ONE_TIME_SUBMIT_BIT = 0x00000001,
    VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT = 0x00000002,
    VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT = 0x00000004,
} VkCommandBufferUsageFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_COMMAND_BUFFER_USAGE_ONE_TIME_SUBMIT_BIT</code> specifies that each
recording of the command buffer will only be submitted once, and the
command buffer will be reset and recorded again between each submission.</p>
</li>
<li>
<p><code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code> specifies that a
secondary command buffer is considered to be entirely inside a render
pass.
If this is a primary command buffer, then this bit is ignored.</p>
</li>
<li>
<p><code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code> specifies that a
command buffer <strong>can</strong> be resubmitted to any queue of the same queue family
while it is in the <em>pending state</em>, and recorded into multiple primary
command buffers.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkCommandBufferUsageFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef VkFlags VkCommandBufferUsageFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkCommandBufferUsageFlags</code> is a bitmask type for setting a mask of zero
or more <a href="#VkCommandBufferUsageFlagBits">VkCommandBufferUsageFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the command buffer is a secondary command buffer, then the
<code>VkCommandBufferInheritanceInfo</code> structure defines any state that will
be inherited from the primary command buffer:</p>
</div>
<div id="VkCommandBufferInheritanceInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef struct VkCommandBufferInheritanceInfo {
    VkStructureType                  sType;
    const void*                      pNext;
    VkRenderPass                     renderPass;
    uint32_t                         subpass;
    VkFramebuffer                    framebuffer;
    VkBool32                         occlusionQueryEnable;
    VkQueryControlFlags              queryFlags;
    VkQueryPipelineStatisticFlags    pipelineStatistics;
} VkCommandBufferInheritanceInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>renderPass</code> is a <a href="renderpass.html#VkRenderPass" class="xref page">VkRenderPass</a> object defining which render
passes the <code>VkCommandBuffer</code> will be <a href="renderpass.html#renderpass-compatibility" class="xref page">    compatible</a> with and <strong>can</strong> be executed within.</p>
</li>
<li>
<p><code>subpass</code> is the index of the subpass within the render pass
instance that the <code>VkCommandBuffer</code> will be executed within.</p>
</li>
<li>
<p><code>framebuffer</code> <strong>can</strong> refer to the <a href="renderpass.html#VkFramebuffer" class="xref page">VkFramebuffer</a> object that the
<code>VkCommandBuffer</code> will be rendering to if it is executed within a
render pass instance.
It <strong>can</strong> be <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a> if the framebuffer is not known.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Specifying the exact framebuffer that the secondary command buffer will be
executed with <strong>may</strong> result in better performance at command buffer execution
time.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p><code>occlusionQueryEnable</code> specifies whether the command buffer <strong>can</strong> be
executed while an occlusion query is active in the primary command
buffer.
If this is <code>VK_TRUE</code>, then this command buffer <strong>can</strong> be executed
whether the primary command buffer has an occlusion query active or not.
If this is <code>VK_FALSE</code>, then the primary command buffer <strong>must</strong> not
have an occlusion query active.</p>
</li>
<li>
<p><code>queryFlags</code> specifies the query flags that <strong>can</strong> be used by an
active occlusion query in the primary command buffer when this secondary
command buffer is executed.
If this value includes the <code>VK_QUERY_CONTROL_PRECISE_BIT</code> bit, then
the active query <strong>can</strong> return boolean results or actual sample counts.
If this bit is not set, then the active query <strong>must</strong> not use the
<code>VK_QUERY_CONTROL_PRECISE_BIT</code> bit.</p>
</li>
<li>
<p><code>pipelineStatistics</code> is a bitmask of
<a href="queries.html#VkQueryPipelineStatisticFlagBits" class="xref page">VkQueryPipelineStatisticFlagBits</a> specifying the set of pipeline
statistics that <strong>can</strong> be counted by an active query in the primary
command buffer when this secondary command buffer is executed.
If this value includes a given bit, then this command buffer <strong>can</strong> be
executed whether the primary command buffer has a pipeline statistics
query active that includes this bit or not.
If this value excludes a given bit, then the active pipeline statistics
query <strong>must</strong> not be from a query pool that counts that statistic.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <a href="#VkCommandBuffer">VkCommandBuffer</a> will not be executed within a render pass
instance,
or if the render pass instance was begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a>,
<code>renderPass</code>, <code>subpass</code>, and <code>framebuffer</code> are ignored.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferInheritanceInfo-occlusionQueryEnable-00056" href="#VUID-VkCommandBufferInheritanceInfo-occlusionQueryEnable-00056"></a> <span class="vuid">VUID-VkCommandBufferInheritanceInfo-occlusionQueryEnable-00056</span><br>

If the <a href="features.html#features-inheritedQueries" class="xref page"><code>inheritedQueries</code></a> feature is
not enabled, <code>occlusionQueryEnable</code> <strong>must</strong> be <code>VK_FALSE</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceInfo-queryFlags-00057" href="#VUID-VkCommandBufferInheritanceInfo-queryFlags-00057"></a> <span class="vuid">VUID-VkCommandBufferInheritanceInfo-queryFlags-00057</span><br>

If the <a href="features.html#features-inheritedQueries" class="xref page"><code>inheritedQueries</code></a> feature is
enabled, <code>queryFlags</code> <strong>must</strong> be a valid combination of
<a href="queries.html#VkQueryControlFlagBits" class="xref page">VkQueryControlFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceInfo-queryFlags-02788" href="#VUID-VkCommandBufferInheritanceInfo-queryFlags-02788"></a> <span class="vuid">VUID-VkCommandBufferInheritanceInfo-queryFlags-02788</span><br>

If the <a href="features.html#features-inheritedQueries" class="xref page"><code>inheritedQueries</code></a> feature is
not enabled, <code>queryFlags</code> <strong>must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceInfo-pipelineStatistics-02789" href="#VUID-VkCommandBufferInheritanceInfo-pipelineStatistics-02789"></a> <span class="vuid">VUID-VkCommandBufferInheritanceInfo-pipelineStatistics-02789</span><br>

If the <a href="features.html#features-pipelineStatisticsQuery" class="xref page">    <code>pipelineStatisticsQuery</code></a> feature is enabled,
<code>pipelineStatistics</code> <strong>must</strong> be a valid combination of
<a href="queries.html#VkQueryPipelineStatisticFlagBits" class="xref page">VkQueryPipelineStatisticFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceInfo-pipelineStatistics-00058" href="#VUID-VkCommandBufferInheritanceInfo-pipelineStatistics-00058"></a> <span class="vuid">VUID-VkCommandBufferInheritanceInfo-pipelineStatistics-00058</span><br>

If the <a href="features.html#features-pipelineStatisticsQuery" class="xref page">    <code>pipelineStatisticsQuery</code></a> feature is not enabled,
<code>pipelineStatistics</code> <strong>must</strong> be <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferInheritanceInfo-sType-sType" href="#VUID-VkCommandBufferInheritanceInfo-sType-sType"></a> <span class="vuid">VUID-VkCommandBufferInheritanceInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_COMMAND_BUFFER_INHERITANCE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceInfo-pNext-pNext" href="#VUID-VkCommandBufferInheritanceInfo-pNext-pNext"></a> <span class="vuid">VUID-VkCommandBufferInheritanceInfo-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="#VkAttachmentSampleCountInfoAMD">VkAttachmentSampleCountInfoAMD</a>, <a href="#VkCommandBufferInheritanceConditionalRenderingInfoEXT">VkCommandBufferInheritanceConditionalRenderingInfoEXT</a>, <a href="#VkCommandBufferInheritanceRenderPassTransformInfoQCOM">VkCommandBufferInheritanceRenderPassTransformInfoQCOM</a>, <a href="#VkCommandBufferInheritanceRenderingInfo">VkCommandBufferInheritanceRenderingInfo</a>, <a href="#VkCommandBufferInheritanceViewportScissorInfoNV">VkCommandBufferInheritanceViewportScissorInfoNV</a>, <a href="resources.html#VkExternalFormatANDROID" class="xref page">VkExternalFormatANDROID</a>, <a href="renderpass.html#VkMultiviewPerViewAttributesInfoNVX" class="xref page">VkMultiviewPerViewAttributesInfoNVX</a>, <a href="interfaces.html#VkRenderingAttachmentLocationInfo" class="xref page">VkRenderingAttachmentLocationInfo</a>, or <a href="interfaces.html#VkRenderingInputAttachmentIndexInfo" class="xref page">VkRenderingInputAttachmentIndexInfo</a></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceInfo-sType-unique" href="#VUID-VkCommandBufferInheritanceInfo-sType-unique"></a> <span class="vuid">VUID-VkCommandBufferInheritanceInfo-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceInfo-commonparent" href="#VUID-VkCommandBufferInheritanceInfo-commonparent"></a> <span class="vuid">VUID-VkCommandBufferInheritanceInfo-commonparent</span><br>
 Both of <code>framebuffer</code>, and <code>renderPass</code> that are valid handles of non-ignored parameters <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>On some implementations, not using the
<code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code> bit enables command
buffers to be patched in-place if needed, rather than creating a copy of the
command buffer.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If a command buffer is in the <a href="#commandbuffers-lifecycle">invalid, or executable state</a>, and the command buffer was allocated from a command pool
with the <code>VK_COMMAND_POOL_CREATE_RESET_COMMAND_BUFFER_BIT</code> flag set,
then <code>vkBeginCommandBuffer</code> implicitly resets the command buffer,
behaving as if <code>vkResetCommandBuffer</code> had been called with
<code>VK_COMMAND_BUFFER_RESET_RELEASE_RESOURCES_BIT</code> not set.
After the implicit reset, <code>commandBuffer</code> is moved to the
<a href="#commandbuffers-lifecycle">recording state</a>.</p>
</div>
<div class="paragraph">
<p>If the <a href="features.html#features-commandBufferInheritance" class="xref page"><code>commandBufferInheritance</code></a>
feature is enabled, all graphics and compute state including bound pipeline
state, bound shader objects, bound vertex and index buffers, bound
descriptor sets and push constants, and all previously set dynamic state is
inherited by the secondary command buffer from the primary or secondary
command buffer that executes it.
Furthermore, all of the state set by this secondary command buffer is
inherited back to the primary or secondard command buffer that executes it.
If the <a href="features.html#features-commandBufferInheritance" class="xref page"><code>commandBufferInheritance</code></a>
feature is not enabled there is a limited amount of inheritance of state
into the secondary command buffer as specified below.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the <code>pNext</code> chain of <a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a> includes a
<code>VkCommandBufferInheritanceConditionalRenderingInfoEXT</code> structure, then
that structure controls whether a command buffer <strong>can</strong> be executed while
conditional rendering is <a href="drawing.html#active-conditional-rendering" class="xref page">active</a> in the
primary command buffer.</p>
</div>
<div class="paragraph">
<p>The <code>VkCommandBufferInheritanceConditionalRenderingInfoEXT</code> structure is
defined as:</p>
</div>
<div id="VkCommandBufferInheritanceConditionalRenderingInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_conditional_rendering
typedef struct VkCommandBufferInheritanceConditionalRenderingInfoEXT {
    VkStructureType    sType;
    const void*        pNext;
    VkBool32           conditionalRenderingEnable;
} VkCommandBufferInheritanceConditionalRenderingInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>conditionalRenderingEnable</code> specifies whether the command buffer
<strong>can</strong> be executed while conditional rendering is active in the primary
command buffer.
If this is <code>VK_TRUE</code>, then this command buffer <strong>can</strong> be executed
whether the primary command buffer has active conditional rendering or
not.
If this is <code>VK_FALSE</code>, then the primary command buffer <strong>must</strong> not
have conditional rendering active.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If this structure is not present, the behavior is as if
<code>conditionalRenderingEnable</code> is <code>VK_FALSE</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferInheritanceConditionalRenderingInfoEXT-conditionalRenderingEnable-01977" href="#VUID-VkCommandBufferInheritanceConditionalRenderingInfoEXT-conditionalRenderingEnable-01977"></a> <span class="vuid">VUID-VkCommandBufferInheritanceConditionalRenderingInfoEXT-conditionalRenderingEnable-01977</span><br>

If the <a href="features.html#features-inheritedConditionalRendering" class="xref page">    <code>inheritedConditionalRendering</code></a> feature is not enabled,
<code>conditionalRenderingEnable</code> <strong>must</strong> be <code>VK_FALSE</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferInheritanceConditionalRenderingInfoEXT-sType-sType" href="#VUID-VkCommandBufferInheritanceConditionalRenderingInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkCommandBufferInheritanceConditionalRenderingInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_COMMAND_BUFFER_INHERITANCE_CONDITIONAL_RENDERING_INFO_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To begin recording a secondary command buffer compatible with execution
inside a render pass using <a href="vertexpostproc.html#vertexpostproc-renderpass-transform" class="xref page">render pass transform</a>, add the
<a href="#VkCommandBufferInheritanceRenderPassTransformInfoQCOM">VkCommandBufferInheritanceRenderPassTransformInfoQCOM</a> to the
<code>pNext</code> chain of <a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a> structure passed
to the <a href="#vkBeginCommandBuffer">vkBeginCommandBuffer</a> command specifying the parameters for
transformed rasterization.</p>
</div>
<div class="paragraph">
<p>The <code>VkCommandBufferInheritanceRenderPassTransformInfoQCOM</code> structure is
defined as:</p>
</div>
<div id="VkCommandBufferInheritanceRenderPassTransformInfoQCOM" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_QCOM_render_pass_transform
typedef struct VkCommandBufferInheritanceRenderPassTransformInfoQCOM {
    VkStructureType                  sType;
    void*                            pNext;
    VkSurfaceTransformFlagBitsKHR    transform;
    VkRect2D                         renderArea;
} VkCommandBufferInheritanceRenderPassTransformInfoQCOM;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>transform</code> is a <a href="VK_KHR_surface/wsi.html#VkSurfaceTransformFlagBitsKHR" class="xref page">VkSurfaceTransformFlagBitsKHR</a> value
describing the transform to be applied to the render pass.</p>
</li>
<li>
<p><code>renderArea</code> is the render area that is affected by the command
buffer.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the secondary is recorded to execute within a render pass instance
using <a href="#vkCmdExecuteCommands">vkCmdExecuteCommands</a>, the render pass transform parameters of
the secondary command buffer <strong>must</strong> be consistent with the render pass
transform parameters specified for the render pass instance.
In particular, the <code>transform</code> and <code>renderArea</code> for command buffer
<strong>must</strong> be identical to the <code>transform</code> and <code>renderArea</code> of the render
pass instance.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferInheritanceRenderPassTransformInfoQCOM-transform-02864" href="#VUID-VkCommandBufferInheritanceRenderPassTransformInfoQCOM-transform-02864"></a> <span class="vuid">VUID-VkCommandBufferInheritanceRenderPassTransformInfoQCOM-transform-02864</span><br>

<code>transform</code> <strong>must</strong> be <code>VK_SURFACE_TRANSFORM_IDENTITY_BIT_KHR</code>,
<code>VK_SURFACE_TRANSFORM_ROTATE_90_BIT_KHR</code>,
<code>VK_SURFACE_TRANSFORM_ROTATE_180_BIT_KHR</code>, or
<code>VK_SURFACE_TRANSFORM_ROTATE_270_BIT_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferInheritanceRenderPassTransformInfoQCOM-sType-sType" href="#VUID-VkCommandBufferInheritanceRenderPassTransformInfoQCOM-sType-sType"></a> <span class="vuid">VUID-VkCommandBufferInheritanceRenderPassTransformInfoQCOM-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_COMMAND_BUFFER_INHERITANCE_RENDER_PASS_TRANSFORM_INFO_QCOM</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkCommandBufferInheritanceViewportScissorInfoNV</code> structure is
defined as:</p>
</div>
<div id="VkCommandBufferInheritanceViewportScissorInfoNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_NV_inherited_viewport_scissor
typedef struct VkCommandBufferInheritanceViewportScissorInfoNV {
    VkStructureType      sType;
    const void*          pNext;
    VkBool32             viewportScissor2D;
    uint32_t             viewportDepthCount;
    const VkViewport*    pViewportDepths;
} VkCommandBufferInheritanceViewportScissorInfoNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>viewportScissor2D</code> specifies whether the listed dynamic state is
inherited.</p>
</li>
<li>
<p><code>viewportDepthCount</code> specifies the maximum number of viewports to
inherit.
When <code>viewportScissor2D</code> is <code>VK_FALSE</code>, the behavior is as if
this value is zero.</p>
</li>
<li>
<p><code>pViewportDepths</code> is a pointer to a <a href="vertexpostproc.html#VkViewport" class="xref page">VkViewport</a> structure
specifying the expected depth range for each inherited viewport.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <code>pNext</code> chain of <a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a> includes a
<code>VkCommandBufferInheritanceViewportScissorInfoNV</code> structure, then that
structure controls whether a command buffer <strong>can</strong> inherit the following state
from other command buffers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_DYNAMIC_STATE_SCISSOR</code></p>
</li>
<li>
<p><code>VK_DYNAMIC_STATE_SCISSOR_WITH_COUNT</code></p>
</li>
<li>
<p><code>VK_DYNAMIC_STATE_DISCARD_RECTANGLE_EXT</code></p>
</li>
<li>
<p><code>VK_DYNAMIC_STATE_DISCARD_RECTANGLE_ENABLE_EXT</code></p>
</li>
<li>
<p><code>VK_DYNAMIC_STATE_DISCARD_RECTANGLE_MODE_EXT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>as well as the following state, with restrictions on inherited depth values
and viewport count:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_DYNAMIC_STATE_VIEWPORT</code></p>
</li>
<li>
<p><code>VK_DYNAMIC_STATE_VIEWPORT_WITH_COUNT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>viewportScissor2D</code> is <code>VK_FALSE</code>, then the command buffer does
not inherit the listed dynamic state, and <strong>should</strong> set this state itself.
If this structure is not present, the behavior is as if
<code>viewportScissor2D</code> is <code>VK_FALSE</code>.</p>
</div>
<div class="paragraph">
<p>If <code>viewportScissor2D</code> is <code>VK_TRUE</code>, then the listed dynamic state
is inherited, and the command buffer <strong>must</strong> not set this
state, except that the viewport and scissor count <strong>may</strong> be set by binding a
graphics pipeline that does not specify this state as dynamic.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Due to this restriction, applications <strong>should</strong> ensure either all or none of
the graphics pipelines bound in this secondary command buffer use dynamic
viewport/scissor counts.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When the command buffer is executed as part of a the execution of a
<a href="#vkCmdExecuteCommands">vkCmdExecuteCommands</a> command, the inherited state (if enabled) is
determined by the following procedure, performed separately for each dynamic
state, and separately for each value for dynamic state that consists of
multiple values (e.g. multiple viewports).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>With <span class="eq">i</span> being the index of the executed command buffer in the
<code>pCommandBuffers</code> array of <a href="#vkCmdExecuteCommands">vkCmdExecuteCommands</a>, if <span class="eq">i &gt;
0</span> and any secondary command buffer from index <span class="eq">0</span> to <span class="eq">i-1</span>
modifies the state, the inherited state is provisionally set to the
final value set by the last such secondary command buffer.
Binding a graphics pipeline defining the state statically is equivalent
to setting the state to an <strong>undefined</strong> value.</p>
</li>
<li>
<p>Otherwise, the tentatative inherited state is that of the primary
command buffer at the point the <a href="#vkCmdExecuteCommands">vkCmdExecuteCommands</a> command was
recorded; if the state is <strong>undefined</strong>, then so is the provisional
inherited state.</p>
</li>
<li>
<p>If the provisional inherited state is an <strong>undefined</strong> value, then the
state is not inherited.</p>
</li>
<li>
<p>If the provisional inherited state is a viewport, with <span class="eq">n</span> being its
viewport index, then if <span class="eq">n ≥ <code>viewportDepthCount</code></span>, or if
either <a href="vertexpostproc.html#VkViewport" class="xref page">VkViewport</a>::<code>minDepth</code> or
<a href="vertexpostproc.html#VkViewport" class="xref page">VkViewport</a>::<code>maxDepth</code> are not equal to the respective values
of the <span class="eq">n<sup>th</sup></span> element of <code>pViewportDepths</code>, then the state is
not inherited.</p>
</li>
<li>
<p>If the provisional inherited state passes both checks, then it becomes
the actual inherited state.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>There is no support for inheriting dynamic state from a secondary command
buffer executed as part of a different <code>vkCmdExecuteCommands</code> command.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferInheritanceViewportScissorInfoNV-viewportScissor2D-04782" href="#VUID-VkCommandBufferInheritanceViewportScissorInfoNV-viewportScissor2D-04782"></a> <span class="vuid">VUID-VkCommandBufferInheritanceViewportScissorInfoNV-viewportScissor2D-04782</span><br>

If the <a href="features.html#features-inheritedViewportScissor2D" class="xref page">    <code>inheritedViewportScissor2D</code></a> feature is not enabled,
<code>viewportScissor2D</code> <strong>must</strong> be <code>VK_FALSE</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceViewportScissorInfoNV-viewportScissor2D-04783" href="#VUID-VkCommandBufferInheritanceViewportScissorInfoNV-viewportScissor2D-04783"></a> <span class="vuid">VUID-VkCommandBufferInheritanceViewportScissorInfoNV-viewportScissor2D-04783</span><br>

If the <a href="features.html#features-multiViewport" class="xref page"><code>multiViewport</code></a> feature is not
enabled and <code>viewportScissor2D</code> is <code>VK_TRUE</code>, then
<code>viewportDepthCount</code> <strong>must</strong> be <code>1</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceViewportScissorInfoNV-viewportScissor2D-04784" href="#VUID-VkCommandBufferInheritanceViewportScissorInfoNV-viewportScissor2D-04784"></a> <span class="vuid">VUID-VkCommandBufferInheritanceViewportScissorInfoNV-viewportScissor2D-04784</span><br>

If <code>viewportScissor2D</code> is <code>VK_TRUE</code>, then
<code>viewportDepthCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceViewportScissorInfoNV-viewportScissor2D-04785" href="#VUID-VkCommandBufferInheritanceViewportScissorInfoNV-viewportScissor2D-04785"></a> <span class="vuid">VUID-VkCommandBufferInheritanceViewportScissorInfoNV-viewportScissor2D-04785</span><br>

If <code>viewportScissor2D</code> is <code>VK_TRUE</code>, then <code>pViewportDepths</code>
<strong>must</strong> be a valid pointer to an array of <code>viewportDepthCount</code> valid
<code>VkViewport</code> structures, except any requirements on <code>x</code>, <code>y</code>,
<code>width</code>, and <code>height</code> do not apply</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceViewportScissorInfoNV-viewportScissor2D-04786" href="#VUID-VkCommandBufferInheritanceViewportScissorInfoNV-viewportScissor2D-04786"></a> <span class="vuid">VUID-VkCommandBufferInheritanceViewportScissorInfoNV-viewportScissor2D-04786</span><br>

If <code>viewportScissor2D</code> is <code>VK_TRUE</code>, then the command buffer
<strong>must</strong> be recorded with the
<code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferInheritanceViewportScissorInfoNV-sType-sType" href="#VUID-VkCommandBufferInheritanceViewportScissorInfoNV-sType-sType"></a> <span class="vuid">VUID-VkCommandBufferInheritanceViewportScissorInfoNV-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_COMMAND_BUFFER_INHERITANCE_VIEWPORT_SCISSOR_INFO_NV</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkCommandBufferInheritanceRenderingInfo</code> structure is defined as:</p>
</div>
<div id="VkCommandBufferInheritanceRenderingInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
typedef struct VkCommandBufferInheritanceRenderingInfo {
    VkStructureType          sType;
    const void*              pNext;
    VkRenderingFlags         flags;
    uint32_t                 viewMask;
    uint32_t                 colorAttachmentCount;
    const VkFormat*          pColorAttachmentFormats;
    VkFormat                 depthAttachmentFormat;
    VkFormat                 stencilAttachmentFormat;
    VkSampleCountFlagBits    rasterizationSamples;
} VkCommandBufferInheritanceRenderingInfo;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkCommandBufferInheritanceRenderingInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_dynamic_rendering
typedef VkCommandBufferInheritanceRenderingInfo VkCommandBufferInheritanceRenderingInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="renderpass.html#VkRenderingFlagBits" class="xref page">VkRenderingFlagBits</a> used by the render
pass instance.</p>
</li>
<li>
<p><code>viewMask</code> is the view mask used for rendering.</p>
</li>
<li>
<p><code>colorAttachmentCount</code> is the number of color attachments specified
in the render pass instance.</p>
</li>
<li>
<p><code>pColorAttachmentFormats</code> is a pointer to an array of <a href="formats.html#VkFormat" class="xref page">VkFormat</a>
values defining the format of color attachments.</p>
</li>
<li>
<p><code>depthAttachmentFormat</code> is a <a href="formats.html#VkFormat" class="xref page">VkFormat</a> value defining the
format of the depth attachment.</p>
</li>
<li>
<p><code>stencilAttachmentFormat</code> is a <a href="formats.html#VkFormat" class="xref page">VkFormat</a> value defining the
format of the stencil attachment.</p>
</li>
<li>
<p><code>rasterizationSamples</code> is a <a href="limits.html#VkSampleCountFlagBits" class="xref page">VkSampleCountFlagBits</a> specifying
the number of samples used in rasterization.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <code>pNext</code> chain of <a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a> includes a
<code>VkCommandBufferInheritanceRenderingInfo</code> structure, then that structure
controls parameters of dynamic render pass instances that the
<a href="#VkCommandBuffer">VkCommandBuffer</a> <strong>can</strong> be executed within.
If <a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a>::<code>renderPass</code> is not
<a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, or
<code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code> is not specified in
<a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a>::<code>flags</code>, parameters of this structure
are ignored.</p>
</div>
<div class="paragraph">
<p>If <code>colorAttachmentCount</code> is <code>0</code> and the
<a href="features.html#features-variableMultisampleRate" class="xref page"><code>variableMultisampleRate</code></a> feature
is enabled, <code>rasterizationSamples</code> is ignored.</p>
</div>
<div class="paragraph">
<p>If <code>depthAttachmentFormat</code>, <code>stencilAttachmentFormat</code>, or any
element of <code>pColorAttachmentFormats</code> is <code>VK_FORMAT_UNDEFINED</code>, it
indicates that the corresponding attachment is unused within the render pass
and writes to those attachments are discarded.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferInheritanceRenderingInfo-colorAttachmentCount-06004" href="#VUID-VkCommandBufferInheritanceRenderingInfo-colorAttachmentCount-06004"></a> <span class="vuid">VUID-VkCommandBufferInheritanceRenderingInfo-colorAttachmentCount-06004</span><br>

If <code>colorAttachmentCount</code> is not <code>0</code>, <code>rasterizationSamples</code>
<strong>must</strong> be a valid <a href="limits.html#VkSampleCountFlagBits" class="xref page">VkSampleCountFlagBits</a> value</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceRenderingInfo-variableMultisampleRate-06005" href="#VUID-VkCommandBufferInheritanceRenderingInfo-variableMultisampleRate-06005"></a> <span class="vuid">VUID-VkCommandBufferInheritanceRenderingInfo-variableMultisampleRate-06005</span><br>

If the <a href="features.html#features-variableMultisampleRate" class="xref page">    <code>variableMultisampleRate</code></a> feature is not enabled,
<code>rasterizationSamples</code> <strong>must</strong> be a valid <a href="limits.html#VkSampleCountFlagBits" class="xref page">VkSampleCountFlagBits</a>
value</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceRenderingInfo-depthAttachmentFormat-06540" href="#VUID-VkCommandBufferInheritanceRenderingInfo-depthAttachmentFormat-06540"></a> <span class="vuid">VUID-VkCommandBufferInheritanceRenderingInfo-depthAttachmentFormat-06540</span><br>

If <code>depthAttachmentFormat</code> is not <code>VK_FORMAT_UNDEFINED</code>, it
<strong>must</strong> be a format that includes a depth component</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceRenderingInfo-depthAttachmentFormat-06007" href="#VUID-VkCommandBufferInheritanceRenderingInfo-depthAttachmentFormat-06007"></a> <span class="vuid">VUID-VkCommandBufferInheritanceRenderingInfo-depthAttachmentFormat-06007</span><br>

If <code>depthAttachmentFormat</code> is not <code>VK_FORMAT_UNDEFINED</code>, it
<strong>must</strong> be a format with <a href="formats.html#potential-format-features" class="xref page">potential format    features</a> that include
<code>VK_FORMAT_FEATURE_DEPTH_STENCIL_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceRenderingInfo-pColorAttachmentFormats-06492" href="#VUID-VkCommandBufferInheritanceRenderingInfo-pColorAttachmentFormats-06492"></a> <span class="vuid">VUID-VkCommandBufferInheritanceRenderingInfo-pColorAttachmentFormats-06492</span><br>

If any element of <code>pColorAttachmentFormats</code> is not
<code>VK_FORMAT_UNDEFINED</code>, it <strong>must</strong> be a format with
<a href="formats.html#potential-format-features" class="xref page">potential format features</a> that include
<code>VK_FORMAT_FEATURE_COLOR_ATTACHMENT_BIT</code>
, or <code>VK_FORMAT_FEATURE_2_LINEAR_COLOR_ATTACHMENT_BIT_NV</code> if the
<a href="features.html#features-linearColorAttachment" class="xref page"><code>linearColorAttachment</code></a> feature
is enabled</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceRenderingInfo-stencilAttachmentFormat-06541" href="#VUID-VkCommandBufferInheritanceRenderingInfo-stencilAttachmentFormat-06541"></a> <span class="vuid">VUID-VkCommandBufferInheritanceRenderingInfo-stencilAttachmentFormat-06541</span><br>

If <code>stencilAttachmentFormat</code> is not <code>VK_FORMAT_UNDEFINED</code>, it
<strong>must</strong> be a format that includes a stencil aspect</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceRenderingInfo-stencilAttachmentFormat-06199" href="#VUID-VkCommandBufferInheritanceRenderingInfo-stencilAttachmentFormat-06199"></a> <span class="vuid">VUID-VkCommandBufferInheritanceRenderingInfo-stencilAttachmentFormat-06199</span><br>

If <code>stencilAttachmentFormat</code> is not <code>VK_FORMAT_UNDEFINED</code>, it
<strong>must</strong> be a format with <a href="formats.html#potential-format-features" class="xref page">potential format    features</a> that include
<code>VK_FORMAT_FEATURE_DEPTH_STENCIL_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceRenderingInfo-depthAttachmentFormat-06200" href="#VUID-VkCommandBufferInheritanceRenderingInfo-depthAttachmentFormat-06200"></a> <span class="vuid">VUID-VkCommandBufferInheritanceRenderingInfo-depthAttachmentFormat-06200</span><br>

If <code>depthAttachmentFormat</code> is not <code>VK_FORMAT_UNDEFINED</code> and
<code>stencilAttachmentFormat</code> is not <code>VK_FORMAT_UNDEFINED</code>,
<code>depthAttachmentFormat</code> <strong>must</strong> equal <code>stencilAttachmentFormat</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceRenderingInfo-multiview-06008" href="#VUID-VkCommandBufferInheritanceRenderingInfo-multiview-06008"></a> <span class="vuid">VUID-VkCommandBufferInheritanceRenderingInfo-multiview-06008</span><br>

If the <a href="features.html#features-multiview" class="xref page"><code>multiview</code></a> feature is not enabled,
<code>viewMask</code> <strong>must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceRenderingInfo-viewMask-06009" href="#VUID-VkCommandBufferInheritanceRenderingInfo-viewMask-06009"></a> <span class="vuid">VUID-VkCommandBufferInheritanceRenderingInfo-viewMask-06009</span><br>

The index of the most significant bit in <code>viewMask</code> <strong>must</strong> be less
than <a href="devsandqueues.html#limits-maxMultiviewViewCount" class="xref page"><code>maxMultiviewViewCount</code></a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferInheritanceRenderingInfo-sType-sType" href="#VUID-VkCommandBufferInheritanceRenderingInfo-sType-sType"></a> <span class="vuid">VUID-VkCommandBufferInheritanceRenderingInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_COMMAND_BUFFER_INHERITANCE_RENDERING_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceRenderingInfo-flags-parameter" href="#VUID-VkCommandBufferInheritanceRenderingInfo-flags-parameter"></a> <span class="vuid">VUID-VkCommandBufferInheritanceRenderingInfo-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="renderpass.html#VkRenderingFlagBits" class="xref page">VkRenderingFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceRenderingInfo-pColorAttachmentFormats-parameter" href="#VUID-VkCommandBufferInheritanceRenderingInfo-pColorAttachmentFormats-parameter"></a> <span class="vuid">VUID-VkCommandBufferInheritanceRenderingInfo-pColorAttachmentFormats-parameter</span><br>
 If <code>colorAttachmentCount</code> is not <code>0</code>, <code>pColorAttachmentFormats</code> <strong>must</strong> be a valid pointer to an array of <code>colorAttachmentCount</code> valid <a href="formats.html#VkFormat" class="xref page">VkFormat</a> values</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceRenderingInfo-depthAttachmentFormat-parameter" href="#VUID-VkCommandBufferInheritanceRenderingInfo-depthAttachmentFormat-parameter"></a> <span class="vuid">VUID-VkCommandBufferInheritanceRenderingInfo-depthAttachmentFormat-parameter</span><br>
 <code>depthAttachmentFormat</code> <strong>must</strong> be a valid <a href="formats.html#VkFormat" class="xref page">VkFormat</a> value</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceRenderingInfo-stencilAttachmentFormat-parameter" href="#VUID-VkCommandBufferInheritanceRenderingInfo-stencilAttachmentFormat-parameter"></a> <span class="vuid">VUID-VkCommandBufferInheritanceRenderingInfo-stencilAttachmentFormat-parameter</span><br>
 <code>stencilAttachmentFormat</code> <strong>must</strong> be a valid <a href="formats.html#VkFormat" class="xref page">VkFormat</a> value</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceRenderingInfo-rasterizationSamples-parameter" href="#VUID-VkCommandBufferInheritanceRenderingInfo-rasterizationSamples-parameter"></a> <span class="vuid">VUID-VkCommandBufferInheritanceRenderingInfo-rasterizationSamples-parameter</span><br>
 If <code>rasterizationSamples</code> is not <code>0</code>, <code>rasterizationSamples</code> <strong>must</strong> be a valid <a href="limits.html#VkSampleCountFlagBits" class="xref page">VkSampleCountFlagBits</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The
<code>VkAttachmentSampleCountInfoAMD</code>
or
<code>VkAttachmentSampleCountInfoNV</code>
structure is defined as:</p>
</div>
<div id="VkAttachmentSampleCountInfoAMD" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_AMD_mixed_attachment_samples with VK_VERSION_1_3 or VK_KHR_dynamic_rendering
typedef struct VkAttachmentSampleCountInfoAMD {
    VkStructureType                 sType;
    const void*                     pNext;
    uint32_t                        colorAttachmentCount;
    const VkSampleCountFlagBits*    pColorAttachmentSamples;
    VkSampleCountFlagBits           depthStencilAttachmentSamples;
} VkAttachmentSampleCountInfoAMD;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkAttachmentSampleCountInfoNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_NV_framebuffer_mixed_samples with VK_VERSION_1_3 or VK_KHR_dynamic_rendering
typedef VkAttachmentSampleCountInfoAMD VkAttachmentSampleCountInfoNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure</p>
</li>
<li>
<p><code>colorAttachmentCount</code> is the number of color attachments specified
in a render pass instance.</p>
</li>
<li>
<p><code>pColorAttachmentSamples</code> is a pointer to an array of
<a href="limits.html#VkSampleCountFlagBits" class="xref page">VkSampleCountFlagBits</a> values defining the sample count of color
attachments.</p>
</li>
<li>
<p><code>depthStencilAttachmentSamples</code> is a <a href="limits.html#VkSampleCountFlagBits" class="xref page">VkSampleCountFlagBits</a>
value defining the sample count of a depth/stencil attachment.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a>::<code>renderPass</code> is
<a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, <code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code>
is specified in <a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a>::<code>flags</code>, and the
<code>pNext</code> chain of <a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a> includes
<code>VkAttachmentSampleCountInfoAMD</code>, then this structure defines the sample
counts of each attachment within the render pass instance.
If <code>VkAttachmentSampleCountInfoAMD</code> is not included, the value of
<a href="#VkCommandBufferInheritanceRenderingInfo">VkCommandBufferInheritanceRenderingInfo</a>::<code>rasterizationSamples</code> is
used as the sample count for each attachment.
If <a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a>::<code>renderPass</code> is not
<a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, or
<code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code> is not specified in
<a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a>::<code>flags</code>, parameters of this structure
are ignored.</p>
</div>
<div class="paragraph">
<p><code>VkAttachmentSampleCountInfoAMD</code> <strong>can</strong> also be included in the
<code>pNext</code> chain of <a href="pipelines.html#VkGraphicsPipelineCreateInfo" class="xref page">VkGraphicsPipelineCreateInfo</a>.
When a graphics pipeline is created without a <a href="renderpass.html#VkRenderPass" class="xref page">VkRenderPass</a>, if this
structure is included in the <code>pNext</code> chain of
<a href="pipelines.html#VkGraphicsPipelineCreateInfo" class="xref page">VkGraphicsPipelineCreateInfo</a>, it specifies the sample count of
attachments used for rendering.
If this structure is not specified, and the pipeline does not include a
<a href="renderpass.html#VkRenderPass" class="xref page">VkRenderPass</a>, the value of
<a href="primsrast.html#VkPipelineMultisampleStateCreateInfo" class="xref page">VkPipelineMultisampleStateCreateInfo</a>::<code>rasterizationSamples</code> is
used as the sample count for each attachment.
If a graphics pipeline is created with a valid <a href="renderpass.html#VkRenderPass" class="xref page">VkRenderPass</a>,
parameters of this structure are ignored.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAttachmentSampleCountInfoAMD-sType-sType" href="#VUID-VkAttachmentSampleCountInfoAMD-sType-sType"></a> <span class="vuid">VUID-VkAttachmentSampleCountInfoAMD-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_ATTACHMENT_SAMPLE_COUNT_INFO_AMD</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Once recording starts, an application records a sequence of commands
(<code>vkCmd*</code>) to set state in the command buffer, draw, dispatch, and other
commands.</p>
</div>
<div class="paragraph">
<p>Several commands can also be recorded indirectly from <code>VkBuffer</code>
content, see <a href="device_generated_commands/generatedcommands.html#device-generated-commands" class="xref page">Device-Generated Commands</a>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To complete recording of a command buffer, call:</p>
</div>
<div id="vkEndCommandBuffer" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VkResult vkEndCommandBuffer(
    VkCommandBuffer                             commandBuffer);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer to complete recording.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The command buffer <strong>must</strong> have been in the <a href="#commandbuffers-lifecycle">recording state</a>, and, if successful, is moved to the
<a href="#commandbuffers-lifecycle">executable state</a>.</p>
</div>
<div class="paragraph">
<p>If there was an error during recording, the application will be notified by
an unsuccessful return code returned by <code>vkEndCommandBuffer</code>, and the
command buffer will be moved to the <a href="#commandbuffers-lifecycle">invalid state</a>.</p>
</div>
<div class="paragraph">
<p>In case the application recorded one or more <a href="videocoding.html#video-encode-operations" class="xref page">video encode operations</a> into the command buffer, implementations <strong>may</strong> return the
<code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code> error if any of the
specified Video Std parameters do not adhere to the syntactic or semantic
requirements of the used video compression standard, or if values derived
from parameters according to the rules defined by the used video compression
standard do not adhere to the capabilities of the video compression standard
or the implementation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Applications <strong>should</strong> not rely on the
<code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code> error being returned by any
command as a means to verify Video Std parameters, as implementations are
not required to report the error in any specific set of cases.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkEndCommandBuffer-commandBuffer-00059" href="#VUID-vkEndCommandBuffer-commandBuffer-00059"></a> <span class="vuid">VUID-vkEndCommandBuffer-commandBuffer-00059</span><br>

<code>commandBuffer</code> <strong>must</strong> be in the <a href="#commandbuffers-lifecycle">    recording state</a></p>
</li>
<li>
<p><a id="VUID-vkEndCommandBuffer-commandBuffer-00060" href="#VUID-vkEndCommandBuffer-commandBuffer-00060"></a> <span class="vuid">VUID-vkEndCommandBuffer-commandBuffer-00060</span><br>

If <code>commandBuffer</code> is a primary command buffer, there <strong>must</strong> not be
an active render pass instance</p>
</li>
<li>
<p><a id="VUID-vkEndCommandBuffer-commandBuffer-00061" href="#VUID-vkEndCommandBuffer-commandBuffer-00061"></a> <span class="vuid">VUID-vkEndCommandBuffer-commandBuffer-00061</span><br>

All queries made <a href="queries.html#queries-operation-active" class="xref page">active</a> during the
recording of <code>commandBuffer</code> <strong>must</strong> have been made inactive</p>
</li>
<li>
<p><a id="VUID-vkEndCommandBuffer-None-01978" href="#VUID-vkEndCommandBuffer-None-01978"></a> <span class="vuid">VUID-vkEndCommandBuffer-None-01978</span><br>

Conditional rendering <strong>must</strong> not be
<a href="drawing.html#active-conditional-rendering" class="xref page">active</a></p>
</li>
<li>
<p><a id="VUID-vkEndCommandBuffer-None-06991" href="#VUID-vkEndCommandBuffer-None-06991"></a> <span class="vuid">VUID-vkEndCommandBuffer-None-06991</span><br>

There <strong>must</strong> be no video session object bound</p>
</li>
<li>
<p><a id="VUID-vkEndCommandBuffer-commandBuffer-01815" href="#VUID-vkEndCommandBuffer-commandBuffer-01815"></a> <span class="vuid">VUID-vkEndCommandBuffer-commandBuffer-01815</span><br>

If <code>commandBuffer</code> is a secondary command buffer, there <strong>must</strong> not be
an outstanding <a href="debugging.html#vkCmdBeginDebugUtilsLabelEXT" class="xref page">vkCmdBeginDebugUtilsLabelEXT</a> command recorded to
<code>commandBuffer</code> that has not previously been ended by a call to
<a href="debugging.html#vkCmdEndDebugUtilsLabelEXT" class="xref page">vkCmdEndDebugUtilsLabelEXT</a></p>
</li>
<li>
<p><a id="VUID-vkEndCommandBuffer-commandBuffer-00062" href="#VUID-vkEndCommandBuffer-commandBuffer-00062"></a> <span class="vuid">VUID-vkEndCommandBuffer-commandBuffer-00062</span><br>

If <code>commandBuffer</code> is a secondary command buffer, there <strong>must</strong> not be
an outstanding <a href="debugging.html#vkCmdDebugMarkerBeginEXT" class="xref page">vkCmdDebugMarkerBeginEXT</a> command recorded to
<code>commandBuffer</code> that has not previously been ended by a call to
<a href="debugging.html#vkCmdDebugMarkerEndEXT" class="xref page">vkCmdDebugMarkerEndEXT</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkEndCommandBuffer-commandBuffer-parameter" href="#VUID-vkEndCommandBuffer-commandBuffer-parameter"></a> <span class="vuid">VUID-vkEndCommandBuffer-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When a command buffer is in the executable state, it <strong>can</strong> be submitted to a
queue for execution.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="commandbuffers-submission"><a class="anchor" href="#commandbuffers-submission"></a>Command Buffer Submission</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Submission can be a high overhead operation, and applications <strong>should</strong>
attempt to batch work together into as few calls to <code>vkQueueSubmit</code>
or <code>vkQueueSubmit2</code>
as possible.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To submit command buffers to a queue, call:</p>
</div>
<div id="vkQueueSubmit2" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
VkResult vkQueueSubmit2(
    VkQueue                                     queue,
    uint32_t                                    submitCount,
    const VkSubmitInfo2*                        pSubmits,
    VkFence                                     fence);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent command</p>
</div>
<div id="vkQueueSubmit2KHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_synchronization2
VkResult vkQueueSubmit2KHR(
    VkQueue                                     queue,
    uint32_t                                    submitCount,
    const VkSubmitInfo2*                        pSubmits,
    VkFence                                     fence);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>queue</code> is the queue that the command buffers will be submitted to.</p>
</li>
<li>
<p><code>submitCount</code> is the number of elements in the <code>pSubmits</code> array.</p>
</li>
<li>
<p><code>pSubmits</code> is a pointer to an array of <a href="#VkSubmitInfo2">VkSubmitInfo2</a>
structures, each specifying a command buffer submission batch.</p>
</li>
<li>
<p><code>fence</code> is an <strong>optional</strong> handle to a fence to be signaled once all
submitted command buffers have completed execution.
If <code>fence</code> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, it defines a
<a href="synchronization.html#synchronization-fences-signaling" class="xref page">fence signal operation</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkQueueSubmit2</code> is a <a href="devsandqueues.html#devsandqueues-submission" class="xref page">queue submission command</a>, with each batch defined by an element of <code>pSubmits</code>.</p>
</div>
<div class="paragraph">
<p>Semaphore operations submitted with <a href="#vkQueueSubmit2">vkQueueSubmit2</a> have additional
ordering constraints compared to other submission commands, with
dependencies involving previous and subsequent queue operations.
Information about these additional constraints can be found in the
<a href="synchronization.html#synchronization-semaphores" class="xref page">semaphore</a> section of <a href="synchronization.html#synchronization" class="xref page">the synchronization chapter</a>.</p>
</div>
<div class="paragraph">
<p>If any command buffer submitted to this queue is in the
<a href="#commandbuffers-lifecycle">executable state</a>, it is moved to the
<a href="#commandbuffers-lifecycle">pending state</a>.
Once execution of all submissions of a command buffer complete, it moves
from the <a href="#commandbuffers-lifecycle">pending state</a>, back to the
<a href="#commandbuffers-lifecycle">executable state</a>.
If a command buffer was recorded with the
<code>VK_COMMAND_BUFFER_USAGE_ONE_TIME_SUBMIT_BIT</code> flag, it instead moves
back to the <a href="#commandbuffers-lifecycle">invalid state</a>.</p>
</div>
<div class="paragraph">
<p>If <code>vkQueueSubmit2</code> fails, it <strong>may</strong> return
<code>VK_ERROR_OUT_OF_HOST_MEMORY</code> or <code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code>.
If it does, the implementation <strong>must</strong> ensure that the state and contents of
any resources or synchronization primitives referenced by the submitted
command buffers and any semaphores referenced by <code>pSubmits</code> is
unaffected by the call or its failure.
If <code>vkQueueSubmit2</code> fails in such a way that the implementation is
unable to make that guarantee, the implementation <strong>must</strong> return
<code>VK_ERROR_DEVICE_LOST</code>.
See <a href="devsandqueues.html#devsandqueues-lost-device" class="xref page">Lost Device</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkQueueSubmit2-fence-04894" href="#VUID-vkQueueSubmit2-fence-04894"></a> <span class="vuid">VUID-vkQueueSubmit2-fence-04894</span><br>

If <code>fence</code> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, <code>fence</code> <strong>must</strong> be
unsignaled</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit2-fence-04895" href="#VUID-vkQueueSubmit2-fence-04895"></a> <span class="vuid">VUID-vkQueueSubmit2-fence-04895</span><br>

If <code>fence</code> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, <code>fence</code> <strong>must</strong> not be
associated with any other queue command that has not yet completed
execution on that queue</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit2-synchronization2-03866" href="#VUID-vkQueueSubmit2-synchronization2-03866"></a> <span class="vuid">VUID-vkQueueSubmit2-synchronization2-03866</span><br>

The <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature <strong>must</strong>
be enabled</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit2-commandBuffer-03867" href="#VUID-vkQueueSubmit2-commandBuffer-03867"></a> <span class="vuid">VUID-vkQueueSubmit2-commandBuffer-03867</span><br>

If a command recorded into the <code>commandBuffer</code> member of any element
of the <code>pCommandBufferInfos</code> member of any element of <code>pSubmits</code>
referenced a <a href="synchronization.html#VkEvent" class="xref page">VkEvent</a>, that event <strong>must</strong> not be referenced by a
command that has been submitted to another queue and is still in the
<em>pending state</em></p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit2-semaphore-03868" href="#VUID-vkQueueSubmit2-semaphore-03868"></a> <span class="vuid">VUID-vkQueueSubmit2-semaphore-03868</span><br>

The <code>semaphore</code> member of any binary semaphore element of the
<code>pSignalSemaphoreInfos</code> member of any element of <code>pSubmits</code>
<strong>must</strong> be unsignaled when the semaphore signal operation it defines is
executed on the device</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit2-stageMask-03869" href="#VUID-vkQueueSubmit2-stageMask-03869"></a> <span class="vuid">VUID-vkQueueSubmit2-stageMask-03869</span><br>

The <code>stageMask</code> member of any element of the
<code>pSignalSemaphoreInfos</code> member of any element of <code>pSubmits</code>
<strong>must</strong> only include pipeline stages that are supported by the queue
family which <code>queue</code> belongs to</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit2-stageMask-03870" href="#VUID-vkQueueSubmit2-stageMask-03870"></a> <span class="vuid">VUID-vkQueueSubmit2-stageMask-03870</span><br>

The <code>stageMask</code> member of any element of the
<code>pWaitSemaphoreInfos</code> member of any element of <code>pSubmits</code> <strong>must</strong>
only include pipeline stages that are supported by the queue family
which <code>queue</code> belongs to</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit2-semaphore-03871" href="#VUID-vkQueueSubmit2-semaphore-03871"></a> <span class="vuid">VUID-vkQueueSubmit2-semaphore-03871</span><br>

When a semaphore wait operation for a binary semaphore is executed, as
defined by the <code>semaphore</code> member of any element of the
<code>pWaitSemaphoreInfos</code> member of any element of <code>pSubmits</code>, there
<strong>must</strong> be no other queues waiting on the same semaphore</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit2-semaphore-03873" href="#VUID-vkQueueSubmit2-semaphore-03873"></a> <span class="vuid">VUID-vkQueueSubmit2-semaphore-03873</span><br>

The <code>semaphore</code> member of any element of the
<code>pWaitSemaphoreInfos</code> member of any element of <code>pSubmits</code>
that was created with a <a href="synchronization.html#VkSemaphoreType" class="xref page">VkSemaphoreType</a> of
<code>VK_SEMAPHORE_TYPE_BINARY</code>
<strong>must</strong> reference a semaphore signal operation that has been submitted for
execution and any <a href="synchronization.html#synchronization-semaphores-signaling" class="xref page">semaphore    signal operations</a> on which it depends <strong>must</strong> have also been submitted
for execution</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit2-commandBuffer-03874" href="#VUID-vkQueueSubmit2-commandBuffer-03874"></a> <span class="vuid">VUID-vkQueueSubmit2-commandBuffer-03874</span><br>

The <code>commandBuffer</code> member of any element of the
<code>pCommandBufferInfos</code> member of any element of <code>pSubmits</code> <strong>must</strong>
be in the <a href="#commandbuffers-lifecycle">pending or executable state</a></p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit2-commandBuffer-03875" href="#VUID-vkQueueSubmit2-commandBuffer-03875"></a> <span class="vuid">VUID-vkQueueSubmit2-commandBuffer-03875</span><br>

If a command recorded into the <code>commandBuffer</code> member of any element
of the <code>pCommandBufferInfos</code> member of any element of <code>pSubmits</code>
was not recorded with the
<code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code>, it <strong>must</strong> not be in
the <a href="#commandbuffers-lifecycle">pending state</a></p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit2-commandBuffer-03876" href="#VUID-vkQueueSubmit2-commandBuffer-03876"></a> <span class="vuid">VUID-vkQueueSubmit2-commandBuffer-03876</span><br>

Any <a href="#commandbuffers-secondary">secondary command buffers recorded</a>
into the <code>commandBuffer</code> member of any element of the
<code>pCommandBufferInfos</code> member of any element of <code>pSubmits</code> <strong>must</strong>
be in the <a href="#commandbuffers-lifecycle">pending or executable state</a></p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit2-commandBuffer-03877" href="#VUID-vkQueueSubmit2-commandBuffer-03877"></a> <span class="vuid">VUID-vkQueueSubmit2-commandBuffer-03877</span><br>

If any <a href="#commandbuffers-secondary">secondary command buffers recorded</a>
into the <code>commandBuffer</code> member of any element of the
<code>pCommandBufferInfos</code> member of any element of <code>pSubmits</code> was
not recorded with the
<code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code>, it <strong>must</strong> not be in
the <a href="#commandbuffers-lifecycle">pending state</a></p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit2-commandBuffer-03878" href="#VUID-vkQueueSubmit2-commandBuffer-03878"></a> <span class="vuid">VUID-vkQueueSubmit2-commandBuffer-03878</span><br>

The <code>commandBuffer</code> member of any element of the
<code>pCommandBufferInfos</code> member of any element of <code>pSubmits</code> <strong>must</strong>
have been allocated from a <code>VkCommandPool</code> that was created for the
same queue family <code>queue</code> belongs to</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit2-commandBuffer-03879" href="#VUID-vkQueueSubmit2-commandBuffer-03879"></a> <span class="vuid">VUID-vkQueueSubmit2-commandBuffer-03879</span><br>

If a command recorded into the <code>commandBuffer</code> member of any element
of the <code>pCommandBufferInfos</code> member of any element of <code>pSubmits</code>
includes a <a href="synchronization.html#synchronization-queue-transfers-acquire" class="xref page">Queue Family    Ownership Transfer Acquire Operation</a>, there <strong>must</strong> exist a previously
submitted <a href="synchronization.html#synchronization-queue-transfers-release" class="xref page">Queue Family    Ownership Transfer Release Operation</a> on a queue in the queue family
identified by the acquire operation, with parameters matching the
acquire operation as defined in the definition of such
<a href="synchronization.html#synchronization-queue-transfers-acquire" class="xref page">acquire operations</a>, and
which happens before the acquire operation</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit2-commandBuffer-03880" href="#VUID-vkQueueSubmit2-commandBuffer-03880"></a> <span class="vuid">VUID-vkQueueSubmit2-commandBuffer-03880</span><br>

If a command recorded into the <code>commandBuffer</code> member of any element
of the <code>pCommandBufferInfos</code> member of any element of <code>pSubmits</code>
was a <a href="queries.html#vkCmdBeginQuery" class="xref page">vkCmdBeginQuery</a> whose <code>queryPool</code> was created with a
<code>queryType</code> of <code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, the
<a href="queries.html#profiling-lock" class="xref page">profiling lock</a> <strong>must</strong> have been held continuously on
the <code>VkDevice</code> that <code>queue</code> was retrieved from, throughout
recording of those command buffers</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit2-queue-06447" href="#VUID-vkQueueSubmit2-queue-06447"></a> <span class="vuid">VUID-vkQueueSubmit2-queue-06447</span><br>

If <code>queue</code> was not created with
<code>VK_DEVICE_QUEUE_CREATE_PROTECTED_BIT</code>, the <code>flags</code> member of
any element of <code>pSubmits</code> <strong>must</strong> not include
<code>VK_SUBMIT_PROTECTED_BIT_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkQueueSubmit2-queue-parameter" href="#VUID-vkQueueSubmit2-queue-parameter"></a> <span class="vuid">VUID-vkQueueSubmit2-queue-parameter</span><br>
 <code>queue</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkQueue" class="xref page">VkQueue</a> handle</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit2-pSubmits-parameter" href="#VUID-vkQueueSubmit2-pSubmits-parameter"></a> <span class="vuid">VUID-vkQueueSubmit2-pSubmits-parameter</span><br>
 If <code>submitCount</code> is not <code>0</code>, <code>pSubmits</code> <strong>must</strong> be a valid pointer to an array of <code>submitCount</code> valid <a href="#VkSubmitInfo2">VkSubmitInfo2</a> structures</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit2-fence-parameter" href="#VUID-vkQueueSubmit2-fence-parameter"></a> <span class="vuid">VUID-vkQueueSubmit2-fence-parameter</span><br>
 If <code>fence</code> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, <code>fence</code> <strong>must</strong> be a valid <a href="synchronization.html#VkFence" class="xref page">VkFence</a> handle</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit2-commonparent" href="#VUID-vkQueueSubmit2-commonparent"></a> <span class="vuid">VUID-vkQueueSubmit2-commonparent</span><br>
 Both of <code>fence</code>, and <code>queue</code> that are valid handles of non-ignored parameters <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>queue</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to <code>fence</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="videocoding.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkSubmitInfo2</code> structure is defined as:</p>
</div>
<div id="VkSubmitInfo2" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
typedef struct VkSubmitInfo2 {
    VkStructureType                     sType;
    const void*                         pNext;
    VkSubmitFlags                       flags;
    uint32_t                            waitSemaphoreInfoCount;
    const VkSemaphoreSubmitInfo*        pWaitSemaphoreInfos;
    uint32_t                            commandBufferInfoCount;
    const VkCommandBufferSubmitInfo*    pCommandBufferInfos;
    uint32_t                            signalSemaphoreInfoCount;
    const VkSemaphoreSubmitInfo*        pSignalSemaphoreInfos;
} VkSubmitInfo2;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkSubmitInfo2KHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_synchronization2
typedef VkSubmitInfo2 VkSubmitInfo2KHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkSubmitFlagBits">VkSubmitFlagBits</a>.</p>
</li>
<li>
<p><code>waitSemaphoreInfoCount</code> is the number of elements in
<code>pWaitSemaphoreInfos</code>.</p>
</li>
<li>
<p><code>pWaitSemaphoreInfos</code> is a pointer to an array of
<a href="#VkSemaphoreSubmitInfo">VkSemaphoreSubmitInfo</a> structures defining
<a href="synchronization.html#synchronization-semaphores-waiting" class="xref page">semaphore wait operations</a>.</p>
</li>
<li>
<p><code>commandBufferInfoCount</code> is the number of elements in
<code>pCommandBufferInfos</code> and the number of command buffers to execute
in the batch.</p>
</li>
<li>
<p><code>pCommandBufferInfos</code> is a pointer to an array of
<a href="#VkCommandBufferSubmitInfo">VkCommandBufferSubmitInfo</a> structures describing command buffers to
execute in the batch.</p>
</li>
<li>
<p><code>signalSemaphoreInfoCount</code> is the number of elements in
<code>pSignalSemaphoreInfos</code>.</p>
</li>
<li>
<p><code>pSignalSemaphoreInfos</code> is a pointer to an array of
<a href="#VkSemaphoreSubmitInfo">VkSemaphoreSubmitInfo</a> describing
<a href="synchronization.html#synchronization-semaphores-signaling" class="xref page">semaphore signal operations</a>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSubmitInfo2-semaphore-03881" href="#VUID-VkSubmitInfo2-semaphore-03881"></a> <span class="vuid">VUID-VkSubmitInfo2-semaphore-03881</span><br>

If the same semaphore is used as the <code>semaphore</code> member of both an
element of <code>pSignalSemaphoreInfos</code> and <code>pWaitSemaphoreInfos</code>,
and that semaphore is a timeline semaphore, the <code>value</code> member of
the <code>pSignalSemaphoreInfos</code> element <strong>must</strong> be greater than the
<code>value</code> member of the <code>pWaitSemaphoreInfos</code> element</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo2-semaphore-03882" href="#VUID-VkSubmitInfo2-semaphore-03882"></a> <span class="vuid">VUID-VkSubmitInfo2-semaphore-03882</span><br>

If the <code>semaphore</code> member of any element of
<code>pSignalSemaphoreInfos</code> is a timeline semaphore, the <code>value</code>
member of that element <strong>must</strong> have a value greater than the current value
of the semaphore when the <a href="synchronization.html#synchronization-semaphores-signaling" class="xref page">    semaphore signal operation</a> is executed</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo2-semaphore-03883" href="#VUID-VkSubmitInfo2-semaphore-03883"></a> <span class="vuid">VUID-VkSubmitInfo2-semaphore-03883</span><br>

If the <code>semaphore</code> member of any element of
<code>pSignalSemaphoreInfos</code> is a timeline semaphore, the <code>value</code>
member of that element <strong>must</strong> have a value which does not differ from the
current value of the semaphore or the value of any outstanding semaphore
wait or signal operation on that semaphore by more than
<a href="devsandqueues.html#limits-maxTimelineSemaphoreValueDifference" class="xref page">    <code>maxTimelineSemaphoreValueDifference</code></a></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo2-semaphore-03884" href="#VUID-VkSubmitInfo2-semaphore-03884"></a> <span class="vuid">VUID-VkSubmitInfo2-semaphore-03884</span><br>

If the <code>semaphore</code> member of any element of
<code>pWaitSemaphoreInfos</code> is a timeline semaphore, the <code>value</code>
member of that element <strong>must</strong> have a value which does not differ from the
current value of the semaphore or the value of any outstanding semaphore
wait or signal operation on that semaphore by more than
<a href="devsandqueues.html#limits-maxTimelineSemaphoreValueDifference" class="xref page">    <code>maxTimelineSemaphoreValueDifference</code></a></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo2-flags-03886" href="#VUID-VkSubmitInfo2-flags-03886"></a> <span class="vuid">VUID-VkSubmitInfo2-flags-03886</span><br>

If <code>flags</code> includes <code>VK_SUBMIT_PROTECTED_BIT</code>, all elements of
<code>pCommandBuffers</code> <strong>must</strong> be protected command buffers</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo2-flags-03887" href="#VUID-VkSubmitInfo2-flags-03887"></a> <span class="vuid">VUID-VkSubmitInfo2-flags-03887</span><br>

If <code>flags</code> does not include <code>VK_SUBMIT_PROTECTED_BIT</code>, each
element of <code>pCommandBuffers</code> <strong>must</strong> not be a protected command buffer</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo2-commandBuffer-06192" href="#VUID-VkSubmitInfo2-commandBuffer-06192"></a> <span class="vuid">VUID-VkSubmitInfo2-commandBuffer-06192</span><br>

If any <code>commandBuffer</code> member of an element of
<code>pCommandBufferInfos</code> contains any <a href="renderpass.html#renderpass-suspension" class="xref page">resumed    render pass instances</a>, they <strong>must</strong> be suspended by a render pass
instance earlier in submission order within <code>pCommandBufferInfos</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo2-commandBuffer-06010" href="#VUID-VkSubmitInfo2-commandBuffer-06010"></a> <span class="vuid">VUID-VkSubmitInfo2-commandBuffer-06010</span><br>

If any <code>commandBuffer</code> member of an element of
<code>pCommandBufferInfos</code> contains any <a href="renderpass.html#renderpass-suspension" class="xref page">suspended    render pass instances</a>, they <strong>must</strong> be resumed by a render pass instance
later in submission order within <code>pCommandBufferInfos</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo2-commandBuffer-06011" href="#VUID-VkSubmitInfo2-commandBuffer-06011"></a> <span class="vuid">VUID-VkSubmitInfo2-commandBuffer-06011</span><br>

If any <code>commandBuffer</code> member of an element of
<code>pCommandBufferInfos</code> contains any <a href="renderpass.html#renderpass-suspension" class="xref page">suspended    render pass instances</a>, there <strong>must</strong> be no action or synchronization
commands between that render pass instance and the render pass instance
that resumes it</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo2-commandBuffer-06012" href="#VUID-VkSubmitInfo2-commandBuffer-06012"></a> <span class="vuid">VUID-VkSubmitInfo2-commandBuffer-06012</span><br>

If any <code>commandBuffer</code> member of an element of
<code>pCommandBufferInfos</code> contains any <a href="renderpass.html#renderpass-suspension" class="xref page">suspended    render pass instances</a>, there <strong>must</strong> be no render pass instances between
that render pass instance and the render pass instance that resumes it</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo2-variableSampleLocations-06013" href="#VUID-VkSubmitInfo2-variableSampleLocations-06013"></a> <span class="vuid">VUID-VkSubmitInfo2-variableSampleLocations-06013</span><br>

If the <a href="limits.html#limits-variableSampleLocations" class="xref page"><code>variableSampleLocations</code></a>
limit is not supported, and any <code>commandBuffer</code> member of an element
of <code>pCommandBufferInfos</code> contains any <a href="renderpass.html#renderpass-suspension" class="xref page">    suspended render pass instances</a>, where a graphics pipeline has been
bound, any pipelines bound in the render pass instance that resumes it,
or any subsequent render pass instances that resume from that one and so
on, <strong>must</strong> use the same sample locations</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSubmitInfo2-sType-sType" href="#VUID-VkSubmitInfo2-sType-sType"></a> <span class="vuid">VUID-VkSubmitInfo2-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_SUBMIT_INFO_2</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo2-pNext-pNext" href="#VUID-VkSubmitInfo2-pNext-pNext"></a> <span class="vuid">VUID-VkSubmitInfo2-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="debugging.html#VkFrameBoundaryEXT" class="xref page">VkFrameBoundaryEXT</a>, <a href="VK_KHR_surface/wsi.html#VkLatencySubmissionPresentIdNV" class="xref page">VkLatencySubmissionPresentIdNV</a>, <a href="#VkPerformanceQuerySubmitInfoKHR">VkPerformanceQuerySubmitInfoKHR</a>, <a href="#VkWin32KeyedMutexAcquireReleaseInfoKHR">VkWin32KeyedMutexAcquireReleaseInfoKHR</a>, or <a href="#VkWin32KeyedMutexAcquireReleaseInfoNV">VkWin32KeyedMutexAcquireReleaseInfoNV</a></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo2-sType-unique" href="#VUID-VkSubmitInfo2-sType-unique"></a> <span class="vuid">VUID-VkSubmitInfo2-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo2-flags-parameter" href="#VUID-VkSubmitInfo2-flags-parameter"></a> <span class="vuid">VUID-VkSubmitInfo2-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkSubmitFlagBits">VkSubmitFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo2-pWaitSemaphoreInfos-parameter" href="#VUID-VkSubmitInfo2-pWaitSemaphoreInfos-parameter"></a> <span class="vuid">VUID-VkSubmitInfo2-pWaitSemaphoreInfos-parameter</span><br>
 If <code>waitSemaphoreInfoCount</code> is not <code>0</code>, <code>pWaitSemaphoreInfos</code> <strong>must</strong> be a valid pointer to an array of <code>waitSemaphoreInfoCount</code> valid <a href="#VkSemaphoreSubmitInfo">VkSemaphoreSubmitInfo</a> structures</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo2-pCommandBufferInfos-parameter" href="#VUID-VkSubmitInfo2-pCommandBufferInfos-parameter"></a> <span class="vuid">VUID-VkSubmitInfo2-pCommandBufferInfos-parameter</span><br>
 If <code>commandBufferInfoCount</code> is not <code>0</code>, <code>pCommandBufferInfos</code> <strong>must</strong> be a valid pointer to an array of <code>commandBufferInfoCount</code> valid <a href="#VkCommandBufferSubmitInfo">VkCommandBufferSubmitInfo</a> structures</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo2-pSignalSemaphoreInfos-parameter" href="#VUID-VkSubmitInfo2-pSignalSemaphoreInfos-parameter"></a> <span class="vuid">VUID-VkSubmitInfo2-pSignalSemaphoreInfos-parameter</span><br>
 If <code>signalSemaphoreInfoCount</code> is not <code>0</code>, <code>pSignalSemaphoreInfos</code> <strong>must</strong> be a valid pointer to an array of <code>signalSemaphoreInfoCount</code> valid <a href="#VkSemaphoreSubmitInfo">VkSemaphoreSubmitInfo</a> structures</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in <a href="#VkSubmitInfo2">VkSubmitInfo2</a>::<code>flags</code>, specifying
submission behavior, are:</p>
</div>
<div id="VkSubmitFlagBits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
typedef enum VkSubmitFlagBits {
    VK_SUBMIT_PROTECTED_BIT = 0x00000001,
  // Provided by VK_KHR_synchronization2
    VK_SUBMIT_PROTECTED_BIT_KHR = VK_SUBMIT_PROTECTED_BIT,
} VkSubmitFlagBits;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkSubmitFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_synchronization2
typedef VkSubmitFlagBits VkSubmitFlagBitsKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUBMIT_PROTECTED_BIT</code> specifies that this batch is a protected
submission.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkSubmitFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
typedef VkFlags VkSubmitFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkSubmitFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_synchronization2
typedef VkSubmitFlags VkSubmitFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkSubmitFlags</code> is a bitmask type for setting a mask of zero or more
<a href="#VkSubmitFlagBits">VkSubmitFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkSemaphoreSubmitInfo</code> structure is defined as:</p>
</div>
<div id="VkSemaphoreSubmitInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
typedef struct VkSemaphoreSubmitInfo {
    VkStructureType          sType;
    const void*              pNext;
    VkSemaphore              semaphore;
    uint64_t                 value;
    VkPipelineStageFlags2    stageMask;
    uint32_t                 deviceIndex;
} VkSemaphoreSubmitInfo;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkSemaphoreSubmitInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_synchronization2
typedef VkSemaphoreSubmitInfo VkSemaphoreSubmitInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>semaphore</code> is a <a href="synchronization.html#VkSemaphore" class="xref page">VkSemaphore</a> affected by this operation.</p>
</li>
<li>
<p><code>value</code> is
either the value used to signal <code>semaphore</code> or the value waited on
by <code>semaphore</code>, if <code>semaphore</code> is a timeline semaphore.
Otherwise it is
ignored.</p>
</li>
<li>
<p><code>stageMask</code> is a <a href="synchronization.html#VkPipelineStageFlags2" class="xref page">VkPipelineStageFlags2</a> mask of pipeline stages
which limit the first synchronization scope of a semaphore signal
operation, or second synchronization scope of a semaphore wait operation
as described in the <a href="synchronization.html#synchronization-semaphores-waiting" class="xref page">semaphore wait    operation</a> and <a href="synchronization.html#synchronization-semaphores-signaling" class="xref page">semaphore signal    operation</a> sections of <a href="synchronization.html#synchronization" class="xref page">the synchronization    chapter</a>.</p>
</li>
<li>
<p><code>deviceIndex</code> is the index of the device within a device group that
executes the semaphore wait or signal operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Whether this structure defines a semaphore wait or signal operation is
defined by how it is used.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSemaphoreSubmitInfo-stageMask-03929" href="#VUID-VkSemaphoreSubmitInfo-stageMask-03929"></a> <span class="vuid">VUID-VkSemaphoreSubmitInfo-stageMask-03929</span><br>

If the <a href="features.html#features-geometryShader" class="xref page"><code>geometryShader</code></a> feature is not
enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreSubmitInfo-stageMask-03930" href="#VUID-VkSemaphoreSubmitInfo-stageMask-03930"></a> <span class="vuid">VUID-VkSemaphoreSubmitInfo-stageMask-03930</span><br>

If the <a href="features.html#features-tessellationShader" class="xref page"><code>tessellationShader</code></a> feature
is not enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreSubmitInfo-stageMask-03931" href="#VUID-VkSemaphoreSubmitInfo-stageMask-03931"></a> <span class="vuid">VUID-VkSemaphoreSubmitInfo-stageMask-03931</span><br>

If the <a href="features.html#features-conditionalRendering" class="xref page"><code>conditionalRendering</code></a>
feature is not enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreSubmitInfo-stageMask-03932" href="#VUID-VkSemaphoreSubmitInfo-stageMask-03932"></a> <span class="vuid">VUID-VkSemaphoreSubmitInfo-stageMask-03932</span><br>

If the <a href="features.html#features-fragmentDensityMap" class="xref page"><code>fragmentDensityMap</code></a> feature
is not enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreSubmitInfo-stageMask-03933" href="#VUID-VkSemaphoreSubmitInfo-stageMask-03933"></a> <span class="vuid">VUID-VkSemaphoreSubmitInfo-stageMask-03933</span><br>

If the <a href="features.html#features-transformFeedback" class="xref page"><code>transformFeedback</code></a> feature
is not enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreSubmitInfo-stageMask-03934" href="#VUID-VkSemaphoreSubmitInfo-stageMask-03934"></a> <span class="vuid">VUID-VkSemaphoreSubmitInfo-stageMask-03934</span><br>

If the <a href="features.html#features-meshShader" class="xref page"><code>meshShader</code></a> feature is not enabled,
<code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreSubmitInfo-stageMask-03935" href="#VUID-VkSemaphoreSubmitInfo-stageMask-03935"></a> <span class="vuid">VUID-VkSemaphoreSubmitInfo-stageMask-03935</span><br>

If the <a href="features.html#features-taskShader" class="xref page"><code>taskShader</code></a> feature is not enabled,
<code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreSubmitInfo-stageMask-07316" href="#VUID-VkSemaphoreSubmitInfo-stageMask-07316"></a> <span class="vuid">VUID-VkSemaphoreSubmitInfo-stageMask-07316</span><br>

If neither of the <a href="features.html#features-shadingRateImage" class="xref page"><code>shadingRateImage</code></a>
or the <a href="features.html#features-attachmentFragmentShadingRate" class="xref page">    <code>attachmentFragmentShadingRate</code></a> features are enabled,
<code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreSubmitInfo-stageMask-04957" href="#VUID-VkSemaphoreSubmitInfo-stageMask-04957"></a> <span class="vuid">VUID-VkSemaphoreSubmitInfo-stageMask-04957</span><br>

If the <a href="features.html#features-subpassShading" class="xref page"><code>subpassShading</code></a> feature is not
enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreSubmitInfo-stageMask-04995" href="#VUID-VkSemaphoreSubmitInfo-stageMask-04995"></a> <span class="vuid">VUID-VkSemaphoreSubmitInfo-stageMask-04995</span><br>

If the <a href="features.html#features-invocationMask" class="xref page"><code>invocationMask</code></a> feature is not
enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreSubmitInfo-stageMask-07946" href="#VUID-VkSemaphoreSubmitInfo-stageMask-07946"></a> <span class="vuid">VUID-VkSemaphoreSubmitInfo-stageMask-07946</span><br>

If neither the <a href="../appendices/extensions.html#VK_NV_ray_tracing" class="xref page">VK_NV_ray_tracing</a> extension or the
<a href="features.html#features-rayTracingPipeline" class="xref page"><code>rayTracingPipeline</code></a> feature are
enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreSubmitInfo-device-03888" href="#VUID-VkSemaphoreSubmitInfo-device-03888"></a> <span class="vuid">VUID-VkSemaphoreSubmitInfo-device-03888</span><br>

If the <code>device</code> that <code>semaphore</code> was created on is not a device
group, <code>deviceIndex</code> <strong>must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreSubmitInfo-device-03889" href="#VUID-VkSemaphoreSubmitInfo-device-03889"></a> <span class="vuid">VUID-VkSemaphoreSubmitInfo-device-03889</span><br>

If the <code>device</code> that <code>semaphore</code> was created on is a device
group, <code>deviceIndex</code> <strong>must</strong> be a valid device index</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSemaphoreSubmitInfo-sType-sType" href="#VUID-VkSemaphoreSubmitInfo-sType-sType"></a> <span class="vuid">VUID-VkSemaphoreSubmitInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_SEMAPHORE_SUBMIT_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreSubmitInfo-pNext-pNext" href="#VUID-VkSemaphoreSubmitInfo-pNext-pNext"></a> <span class="vuid">VUID-VkSemaphoreSubmitInfo-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreSubmitInfo-semaphore-parameter" href="#VUID-VkSemaphoreSubmitInfo-semaphore-parameter"></a> <span class="vuid">VUID-VkSemaphoreSubmitInfo-semaphore-parameter</span><br>
 <code>semaphore</code> <strong>must</strong> be a valid <a href="synchronization.html#VkSemaphore" class="xref page">VkSemaphore</a> handle</p>
</li>
<li>
<p><a id="VUID-VkSemaphoreSubmitInfo-stageMask-parameter" href="#VUID-VkSemaphoreSubmitInfo-stageMask-parameter"></a> <span class="vuid">VUID-VkSemaphoreSubmitInfo-stageMask-parameter</span><br>
 <code>stageMask</code> <strong>must</strong> be a valid combination of <a href="synchronization.html#VkPipelineStageFlagBits2" class="xref page">VkPipelineStageFlagBits2</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkCommandBufferSubmitInfo</code> structure is defined as:</p>
</div>
<div id="VkCommandBufferSubmitInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
typedef struct VkCommandBufferSubmitInfo {
    VkStructureType    sType;
    const void*        pNext;
    VkCommandBuffer    commandBuffer;
    uint32_t           deviceMask;
} VkCommandBufferSubmitInfo;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkCommandBufferSubmitInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_synchronization2
typedef VkCommandBufferSubmitInfo VkCommandBufferSubmitInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>commandBuffer</code> is a <a href="#VkCommandBuffer">VkCommandBuffer</a> to be submitted for
execution.</p>
</li>
<li>
<p><code>deviceMask</code> is a bitmask indicating which devices in a device group
execute the command buffer.
A <code>deviceMask</code> of <code>0</code> is equivalent to setting all bits
corresponding to valid devices in the group to <code>1</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferSubmitInfo-commandBuffer-03890" href="#VUID-VkCommandBufferSubmitInfo-commandBuffer-03890"></a> <span class="vuid">VUID-VkCommandBufferSubmitInfo-commandBuffer-03890</span><br>

<code>commandBuffer</code> <strong>must</strong> not have been allocated with
<code>VK_COMMAND_BUFFER_LEVEL_SECONDARY</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferSubmitInfo-deviceMask-03891" href="#VUID-VkCommandBufferSubmitInfo-deviceMask-03891"></a> <span class="vuid">VUID-VkCommandBufferSubmitInfo-deviceMask-03891</span><br>

If <code>deviceMask</code> is not <code>0</code>, it <strong>must</strong> be a valid device mask</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferSubmitInfo-commandBuffer-09445" href="#VUID-VkCommandBufferSubmitInfo-commandBuffer-09445"></a> <span class="vuid">VUID-VkCommandBufferSubmitInfo-commandBuffer-09445</span><br>

If any render pass instance in <code>commandBuffer</code> was recorded with a
<a href="renderpass.html#VkRenderPassStripeBeginInfoARM" class="xref page">VkRenderPassStripeBeginInfoARM</a> structure in its pNext chain and
did not specify the <code>VK_RENDERING_RESUMING_BIT</code> flag, a
<a href="#VkRenderPassStripeSubmitInfoARM">VkRenderPassStripeSubmitInfoARM</a> <strong>must</strong> be included in the
<code>pNext</code> chain</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferSubmitInfo-pNext-09446" href="#VUID-VkCommandBufferSubmitInfo-pNext-09446"></a> <span class="vuid">VUID-VkCommandBufferSubmitInfo-pNext-09446</span><br>

If a <a href="#VkRenderPassStripeSubmitInfoARM">VkRenderPassStripeSubmitInfoARM</a> is included in the
<code>pNext</code> chain, the value of
<a href="#VkRenderPassStripeSubmitInfoARM">VkRenderPassStripeSubmitInfoARM</a>::<code>stripeSemaphoreInfoCount</code>
<strong>must</strong> be equal to the sum of the
<a href="renderpass.html#VkRenderPassStripeBeginInfoARM" class="xref page">VkRenderPassStripeBeginInfoARM</a>::<code>stripeInfoCount</code> parameters
provided to render pass instances recorded in <code>commandBuffer</code> that
did not specify the <code>VK_RENDERING_RESUMING_BIT</code> flag</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferSubmitInfo-sType-sType" href="#VUID-VkCommandBufferSubmitInfo-sType-sType"></a> <span class="vuid">VUID-VkCommandBufferSubmitInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_COMMAND_BUFFER_SUBMIT_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferSubmitInfo-pNext-pNext" href="#VUID-VkCommandBufferSubmitInfo-pNext-pNext"></a> <span class="vuid">VUID-VkCommandBufferSubmitInfo-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code> or a pointer to a valid instance of <a href="#VkRenderPassStripeSubmitInfoARM">VkRenderPassStripeSubmitInfoARM</a></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferSubmitInfo-sType-unique" href="#VUID-VkCommandBufferSubmitInfo-sType-unique"></a> <span class="vuid">VUID-VkCommandBufferSubmitInfo-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferSubmitInfo-commandBuffer-parameter" href="#VUID-VkCommandBufferSubmitInfo-commandBuffer-parameter"></a> <span class="vuid">VUID-VkCommandBufferSubmitInfo-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkRenderPassStripeSubmitInfoARM</code> structure is defined as:</p>
</div>
<div id="VkRenderPassStripeSubmitInfoARM" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_ARM_render_pass_striped
typedef struct VkRenderPassStripeSubmitInfoARM {
    VkStructureType                 sType;
    const void*                     pNext;
    uint32_t                        stripeSemaphoreInfoCount;
    const VkSemaphoreSubmitInfo*    pStripeSemaphoreInfos;
} VkRenderPassStripeSubmitInfoARM;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>stripeSemaphoreInfoCount</code> is the number of semaphores used to
signal stripe completion in the render pass instances in the submitted
command buffer.</p>
</li>
<li>
<p><code>pStripeSemaphoreInfos</code> is a pointer to an array of
<code>stripeSemaphoreInfoCount</code> <a href="#VkSemaphoreSubmitInfo">VkSemaphoreSubmitInfo</a> structures
describing the semaphores used to signal stripe completion.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure can be included in the <code>pNext</code> chain of
<a href="#VkCommandBufferSubmitInfo">VkCommandBufferSubmitInfo</a> to provide a set of semaphores to be
signaled for each striped render pass instance.</p>
</div>
<div class="paragraph">
<p>The elements of <code>pStripeSemaphoreInfos</code> are mapped to render pass
instances in <a href="#VkCommandBufferSubmitInfo">VkCommandBufferSubmitInfo</a>::<code>commandBuffer</code> in
submission order and in stripe order within each render pass instance.
Each semaphore in <code>pStripeSemaphoreInfos</code> is signaled when the
implementation has completed execution of the associated stripe.
In a render pass instance that has multiview enabled, the stripe includes
all views in the view mask.
In a render pass instance with <code>layerCount</code> greater than 1, the stripe
includes all layers.</p>
</div>
<div class="paragraph">
<p>Render pass instances that specify the <code>VK_RENDERING_RESUMING_BIT</code> will
not have any elements of <code>pStripeSemaphoreInfos</code> mapped to them.
Instead, for suspending and resuming render pass instances, this mapping is
done for the first suspending render pass instance, and the per-stripe
semaphores are only signaled for the last resuming render pass instance.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkRenderPassStripeSubmitInfoARM-semaphore-09447" href="#VUID-VkRenderPassStripeSubmitInfoARM-semaphore-09447"></a> <span class="vuid">VUID-VkRenderPassStripeSubmitInfoARM-semaphore-09447</span><br>

The <code>semaphore</code> member of each element of
<code>pStripeSemaphoreInfos</code> <strong>must</strong> have been created with a
<a href="synchronization.html#VkSemaphoreType" class="xref page">VkSemaphoreType</a> of <code>VK_SEMAPHORE_TYPE_BINARY</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkRenderPassStripeSubmitInfoARM-sType-sType" href="#VUID-VkRenderPassStripeSubmitInfoARM-sType-sType"></a> <span class="vuid">VUID-VkRenderPassStripeSubmitInfoARM-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_RENDER_PASS_STRIPE_SUBMIT_INFO_ARM</code></p>
</li>
<li>
<p><a id="VUID-VkRenderPassStripeSubmitInfoARM-pStripeSemaphoreInfos-parameter" href="#VUID-VkRenderPassStripeSubmitInfoARM-pStripeSemaphoreInfos-parameter"></a> <span class="vuid">VUID-VkRenderPassStripeSubmitInfoARM-pStripeSemaphoreInfos-parameter</span><br>
 <code>pStripeSemaphoreInfos</code> <strong>must</strong> be a valid pointer to an array of <code>stripeSemaphoreInfoCount</code> valid <a href="#VkSemaphoreSubmitInfo">VkSemaphoreSubmitInfo</a> structures</p>
</li>
<li>
<p><a id="VUID-VkRenderPassStripeSubmitInfoARM-stripeSemaphoreInfoCount-arraylength" href="#VUID-VkRenderPassStripeSubmitInfoARM-stripeSemaphoreInfoCount-arraylength"></a> <span class="vuid">VUID-VkRenderPassStripeSubmitInfoARM-stripeSemaphoreInfoCount-arraylength</span><br>
 <code>stripeSemaphoreInfoCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To submit command buffers to a queue, call:</p>
</div>
<div id="vkQueueSubmit" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VkResult vkQueueSubmit(
    VkQueue                                     queue,
    uint32_t                                    submitCount,
    const VkSubmitInfo*                         pSubmits,
    VkFence                                     fence);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>queue</code> is the queue that the command buffers will be submitted to.</p>
</li>
<li>
<p><code>submitCount</code> is the number of elements in the <code>pSubmits</code> array.</p>
</li>
<li>
<p><code>pSubmits</code> is a pointer to an array of <a href="#VkSubmitInfo">VkSubmitInfo</a>
structures, each specifying a command buffer submission batch.</p>
</li>
<li>
<p><code>fence</code> is an <strong>optional</strong> handle to a fence to be signaled once all
submitted command buffers have completed execution.
If <code>fence</code> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, it defines a
<a href="synchronization.html#synchronization-fences-signaling" class="xref page">fence signal operation</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkQueueSubmit</code> is a <a href="devsandqueues.html#devsandqueues-submission" class="xref page">queue submission command</a>, with each batch defined by an element of <code>pSubmits</code>.
Batches begin execution in the order they appear in <code>pSubmits</code>, but <strong>may</strong>
complete out of order.</p>
</div>
<div class="paragraph">
<p>Fence and semaphore operations submitted with <a href="#vkQueueSubmit">vkQueueSubmit</a> have
additional ordering constraints compared to other submission commands, with
dependencies involving previous and subsequent queue operations.
Information about these additional constraints can be found in the
<a href="synchronization.html#synchronization-semaphores" class="xref page">semaphore</a> and <a href="synchronization.html#synchronization-fences" class="xref page">fence</a> sections of <a href="synchronization.html#synchronization" class="xref page">the synchronization chapter</a>.</p>
</div>
<div class="paragraph">
<p>Details on the interaction of <code>pWaitDstStageMask</code> with synchronization
are described in the <a href="synchronization.html#synchronization-semaphores-waiting" class="xref page">semaphore wait operation</a> section of <a href="synchronization.html#synchronization" class="xref page">the synchronization chapter</a>.</p>
</div>
<div class="paragraph">
<p>The order that batches appear in <code>pSubmits</code> is used to determine
<a href="synchronization.html#synchronization-submission-order" class="xref page">submission order</a>, and thus all the
<a href="synchronization.html#synchronization-implicit" class="xref page">implicit ordering guarantees</a> that respect it.
Other than these implicit ordering guarantees and any <a href="synchronization.html#synchronization" class="xref page">explicit synchronization primitives</a>, these batches <strong>may</strong> overlap or
otherwise execute out of order.</p>
</div>
<div class="paragraph">
<p>If any command buffer submitted to this queue is in the
<a href="#commandbuffers-lifecycle">executable state</a>, it is moved to the
<a href="#commandbuffers-lifecycle">pending state</a>.
Once execution of all submissions of a command buffer complete, it moves
from the <a href="#commandbuffers-lifecycle">pending state</a>, back to the
<a href="#commandbuffers-lifecycle">executable state</a>.
If a command buffer was recorded with the
<code>VK_COMMAND_BUFFER_USAGE_ONE_TIME_SUBMIT_BIT</code> flag, it instead moves to
the <a href="#commandbuffers-lifecycle">invalid state</a>.</p>
</div>
<div class="paragraph">
<p>If <code>vkQueueSubmit</code> fails, it <strong>may</strong> return
<code>VK_ERROR_OUT_OF_HOST_MEMORY</code> or <code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code>.
If it does, the implementation <strong>must</strong> ensure that the state and contents of
any resources or synchronization primitives referenced by the submitted
command buffers and any semaphores referenced by <code>pSubmits</code> is
unaffected by the call or its failure.
If <code>vkQueueSubmit</code> fails in such a way that the implementation is unable
to make that guarantee, the implementation <strong>must</strong> return
<code>VK_ERROR_DEVICE_LOST</code>.
See <a href="devsandqueues.html#devsandqueues-lost-device" class="xref page">Lost Device</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkQueueSubmit-fence-00063" href="#VUID-vkQueueSubmit-fence-00063"></a> <span class="vuid">VUID-vkQueueSubmit-fence-00063</span><br>

If <code>fence</code> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, <code>fence</code> <strong>must</strong> be
unsignaled</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-fence-00064" href="#VUID-vkQueueSubmit-fence-00064"></a> <span class="vuid">VUID-vkQueueSubmit-fence-00064</span><br>

If <code>fence</code> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, <code>fence</code> <strong>must</strong> not be
associated with any other queue command that has not yet completed
execution on that queue</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pCommandBuffers-00065" href="#VUID-vkQueueSubmit-pCommandBuffers-00065"></a> <span class="vuid">VUID-vkQueueSubmit-pCommandBuffers-00065</span><br>

Any calls to <a href="synchronization.html#vkCmdSetEvent" class="xref page">vkCmdSetEvent</a>, <a href="synchronization.html#vkCmdResetEvent" class="xref page">vkCmdResetEvent</a> or
<a href="synchronization.html#vkCmdWaitEvents" class="xref page">vkCmdWaitEvents</a> that have been recorded into any of the command
buffer elements of the <code>pCommandBuffers</code> member of any element of
<code>pSubmits</code>, <strong>must</strong> not reference any <a href="synchronization.html#VkEvent" class="xref page">VkEvent</a> that is referenced
by any of those commands in a command buffer that has been submitted to
another queue and is still in the <em>pending state</em></p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pWaitDstStageMask-00066" href="#VUID-vkQueueSubmit-pWaitDstStageMask-00066"></a> <span class="vuid">VUID-vkQueueSubmit-pWaitDstStageMask-00066</span><br>

Any stage flag included in any element of the <code>pWaitDstStageMask</code>
member of any element of <code>pSubmits</code> <strong>must</strong> be a pipeline stage
supported by one of the capabilities of <code>queue</code>, as specified in the
<a href="synchronization.html#synchronization-pipeline-stages-supported" class="xref page">table of supported pipeline    stages</a></p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pSignalSemaphores-00067" href="#VUID-vkQueueSubmit-pSignalSemaphores-00067"></a> <span class="vuid">VUID-vkQueueSubmit-pSignalSemaphores-00067</span><br>

Each binary semaphore element of the <code>pSignalSemaphores</code> member of
any element of <code>pSubmits</code> <strong>must</strong> be unsignaled when the semaphore
signal operation it defines is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pWaitSemaphores-00068" href="#VUID-vkQueueSubmit-pWaitSemaphores-00068"></a> <span class="vuid">VUID-vkQueueSubmit-pWaitSemaphores-00068</span><br>

When a semaphore wait operation referring to a binary semaphore defined
by any element of the <code>pWaitSemaphores</code> member of any element of
<code>pSubmits</code> executes on <code>queue</code>, there <strong>must</strong> be no other queues
waiting on the same semaphore</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pWaitSemaphores-03238" href="#VUID-vkQueueSubmit-pWaitSemaphores-03238"></a> <span class="vuid">VUID-vkQueueSubmit-pWaitSemaphores-03238</span><br>

All elements of the <code>pWaitSemaphores</code> member of all elements of
<code>pSubmits</code>
created with a <a href="synchronization.html#VkSemaphoreType" class="xref page">VkSemaphoreType</a> of <code>VK_SEMAPHORE_TYPE_BINARY</code>
<strong>must</strong> reference a semaphore signal operation that has been submitted for
execution and any <a href="synchronization.html#synchronization-semaphores-signaling" class="xref page">semaphore    signal operations</a> on which it depends <strong>must</strong> have also been submitted
for execution</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pCommandBuffers-00070" href="#VUID-vkQueueSubmit-pCommandBuffers-00070"></a> <span class="vuid">VUID-vkQueueSubmit-pCommandBuffers-00070</span><br>

Each element of the <code>pCommandBuffers</code> member of each element of
<code>pSubmits</code> <strong>must</strong> be in the <a href="#commandbuffers-lifecycle">pending or    executable state</a></p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pCommandBuffers-00071" href="#VUID-vkQueueSubmit-pCommandBuffers-00071"></a> <span class="vuid">VUID-vkQueueSubmit-pCommandBuffers-00071</span><br>

If any element of the <code>pCommandBuffers</code> member of any element of
<code>pSubmits</code> was not recorded with the
<code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code>, it <strong>must</strong> not be in
the <a href="#commandbuffers-lifecycle">pending state</a></p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pCommandBuffers-00072" href="#VUID-vkQueueSubmit-pCommandBuffers-00072"></a> <span class="vuid">VUID-vkQueueSubmit-pCommandBuffers-00072</span><br>

Any <a href="#commandbuffers-secondary">secondary command buffers recorded</a>
into any element of the <code>pCommandBuffers</code> member of any element of
<code>pSubmits</code> <strong>must</strong> be in the <a href="#commandbuffers-lifecycle">pending or    executable state</a></p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pCommandBuffers-00073" href="#VUID-vkQueueSubmit-pCommandBuffers-00073"></a> <span class="vuid">VUID-vkQueueSubmit-pCommandBuffers-00073</span><br>

If any <a href="#commandbuffers-secondary">secondary command buffers recorded</a>
into any element of the <code>pCommandBuffers</code> member of any element of
<code>pSubmits</code> was not recorded with the
<code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code>, it <strong>must</strong> not be in
the <a href="#commandbuffers-lifecycle">pending state</a></p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pCommandBuffers-00074" href="#VUID-vkQueueSubmit-pCommandBuffers-00074"></a> <span class="vuid">VUID-vkQueueSubmit-pCommandBuffers-00074</span><br>

Each element of the <code>pCommandBuffers</code> member of each element of
<code>pSubmits</code> <strong>must</strong> have been allocated from a <code>VkCommandPool</code> that
was created for the same queue family <code>queue</code> belongs to</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pSubmits-02207" href="#VUID-vkQueueSubmit-pSubmits-02207"></a> <span class="vuid">VUID-vkQueueSubmit-pSubmits-02207</span><br>

If any element of <code>pSubmits-&gt;pCommandBuffers</code> includes a
<a href="synchronization.html#synchronization-queue-transfers-acquire" class="xref page">Queue Family Ownership    Transfer Acquire Operation</a>, there <strong>must</strong> exist a previously submitted
<a href="synchronization.html#synchronization-queue-transfers-release" class="xref page">Queue Family Ownership    Transfer Release Operation</a> on a queue in the queue family identified
by the acquire operation, with parameters matching the acquire operation
as defined in the definition of such
<a href="synchronization.html#synchronization-queue-transfers-acquire" class="xref page">acquire operations</a>, and
which happens-before the acquire operation</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pCommandBuffers-03220" href="#VUID-vkQueueSubmit-pCommandBuffers-03220"></a> <span class="vuid">VUID-vkQueueSubmit-pCommandBuffers-03220</span><br>

If a command recorded into any element of <code>pCommandBuffers</code> was a
<a href="queries.html#vkCmdBeginQuery" class="xref page">vkCmdBeginQuery</a> whose <code>queryPool</code> was created with a
<code>queryType</code> of <code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, the
<a href="queries.html#profiling-lock" class="xref page">profiling lock</a> <strong>must</strong> have been held continuously on
the <code>VkDevice</code> that <code>queue</code> was retrieved from, throughout
recording of those command buffers</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pSubmits-02808" href="#VUID-vkQueueSubmit-pSubmits-02808"></a> <span class="vuid">VUID-vkQueueSubmit-pSubmits-02808</span><br>

Any resource created with <code>VK_SHARING_MODE_EXCLUSIVE</code> that is read
by an operation specified by <code>pSubmits</code> <strong>must</strong> not be owned by any
queue family other than the one which <code>queue</code> belongs to, at the
time it is executed</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pSubmits-04626" href="#VUID-vkQueueSubmit-pSubmits-04626"></a> <span class="vuid">VUID-vkQueueSubmit-pSubmits-04626</span><br>

Any resource created with <code>VK_SHARING_MODE_CONCURRENT</code> that is
accessed by an operation specified by <code>pSubmits</code> <strong>must</strong> have included
the queue family of <code>queue</code> at resource creation time</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-queue-06448" href="#VUID-vkQueueSubmit-queue-06448"></a> <span class="vuid">VUID-vkQueueSubmit-queue-06448</span><br>

If <code>queue</code> was not created with
<code>VK_DEVICE_QUEUE_CREATE_PROTECTED_BIT</code>, there <strong>must</strong> be no element of
<code>pSubmits</code> that includes a <a href="#VkProtectedSubmitInfo">VkProtectedSubmitInfo</a> structure in
its <code>pNext</code> chain with <code>protectedSubmit</code> equal to <code>VK_TRUE</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkQueueSubmit-queue-parameter" href="#VUID-vkQueueSubmit-queue-parameter"></a> <span class="vuid">VUID-vkQueueSubmit-queue-parameter</span><br>
 <code>queue</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkQueue" class="xref page">VkQueue</a> handle</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pSubmits-parameter" href="#VUID-vkQueueSubmit-pSubmits-parameter"></a> <span class="vuid">VUID-vkQueueSubmit-pSubmits-parameter</span><br>
 If <code>submitCount</code> is not <code>0</code>, <code>pSubmits</code> <strong>must</strong> be a valid pointer to an array of <code>submitCount</code> valid <a href="#VkSubmitInfo">VkSubmitInfo</a> structures</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-fence-parameter" href="#VUID-vkQueueSubmit-fence-parameter"></a> <span class="vuid">VUID-vkQueueSubmit-fence-parameter</span><br>
 If <code>fence</code> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, <code>fence</code> <strong>must</strong> be a valid <a href="synchronization.html#VkFence" class="xref page">VkFence</a> handle</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-commonparent" href="#VUID-vkQueueSubmit-commonparent"></a> <span class="vuid">VUID-vkQueueSubmit-commonparent</span><br>
 Both of <code>fence</code>, and <code>queue</code> that are valid handles of non-ignored parameters <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>queue</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to <code>fence</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="videocoding.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkSubmitInfo</code> structure is defined as:</p>
</div>
<div id="VkSubmitInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef struct VkSubmitInfo {
    VkStructureType                sType;
    const void*                    pNext;
    uint32_t                       waitSemaphoreCount;
    const VkSemaphore*             pWaitSemaphores;
    const VkPipelineStageFlags*    pWaitDstStageMask;
    uint32_t                       commandBufferCount;
    const VkCommandBuffer*         pCommandBuffers;
    uint32_t                       signalSemaphoreCount;
    const VkSemaphore*             pSignalSemaphores;
} VkSubmitInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>waitSemaphoreCount</code> is the number of semaphores upon which to wait
before executing the command buffers for the batch.</p>
</li>
<li>
<p><code>pWaitSemaphores</code> is a pointer to an array of <a href="synchronization.html#VkSemaphore" class="xref page">VkSemaphore</a>
handles upon which to wait before the command buffers for this batch
begin execution.
If semaphores to wait on are provided, they define a
<a href="synchronization.html#synchronization-semaphores-waiting" class="xref page">semaphore wait operation</a>.</p>
</li>
<li>
<p><code>pWaitDstStageMask</code> is a pointer to an array of pipeline stages at
which each corresponding semaphore wait will occur.</p>
</li>
<li>
<p><code>commandBufferCount</code> is the number of command buffers to execute in
the batch.</p>
</li>
<li>
<p><code>pCommandBuffers</code> is a pointer to an array of <a href="#VkCommandBuffer">VkCommandBuffer</a>
handles to execute in the batch.</p>
</li>
<li>
<p><code>signalSemaphoreCount</code> is the number of semaphores to be signaled
once the commands specified in <code>pCommandBuffers</code> have completed
execution.</p>
</li>
<li>
<p><code>pSignalSemaphores</code> is a pointer to an array of <a href="synchronization.html#VkSemaphore" class="xref page">VkSemaphore</a>
handles which will be signaled when the command buffers for this batch
have completed execution.
If semaphores to be signaled are provided, they define a
<a href="synchronization.html#synchronization-semaphores-signaling" class="xref page">semaphore signal operation</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The order that command buffers appear in <code>pCommandBuffers</code> is used to
determine <a href="synchronization.html#synchronization-submission-order" class="xref page">submission order</a>, and thus
all the <a href="synchronization.html#synchronization-implicit" class="xref page">implicit ordering guarantees</a> that
respect it.
Other than these implicit ordering guarantees and any <a href="synchronization.html#synchronization" class="xref page">explicit synchronization primitives</a>, these command buffers <strong>may</strong> overlap or
otherwise execute out of order.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitDstStageMask-04090" href="#VUID-VkSubmitInfo-pWaitDstStageMask-04090"></a> <span class="vuid">VUID-VkSubmitInfo-pWaitDstStageMask-04090</span><br>

If the <a href="features.html#features-geometryShader" class="xref page"><code>geometryShader</code></a> feature is not
enabled, <code>pWaitDstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitDstStageMask-04091" href="#VUID-VkSubmitInfo-pWaitDstStageMask-04091"></a> <span class="vuid">VUID-VkSubmitInfo-pWaitDstStageMask-04091</span><br>

If the <a href="features.html#features-tessellationShader" class="xref page"><code>tessellationShader</code></a> feature
is not enabled, <code>pWaitDstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitDstStageMask-04092" href="#VUID-VkSubmitInfo-pWaitDstStageMask-04092"></a> <span class="vuid">VUID-VkSubmitInfo-pWaitDstStageMask-04092</span><br>

If the <a href="features.html#features-conditionalRendering" class="xref page"><code>conditionalRendering</code></a>
feature is not enabled, <code>pWaitDstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_CONDITIONAL_RENDERING_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitDstStageMask-04093" href="#VUID-VkSubmitInfo-pWaitDstStageMask-04093"></a> <span class="vuid">VUID-VkSubmitInfo-pWaitDstStageMask-04093</span><br>

If the <a href="features.html#features-fragmentDensityMap" class="xref page"><code>fragmentDensityMap</code></a> feature
is not enabled, <code>pWaitDstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitDstStageMask-04094" href="#VUID-VkSubmitInfo-pWaitDstStageMask-04094"></a> <span class="vuid">VUID-VkSubmitInfo-pWaitDstStageMask-04094</span><br>

If the <a href="features.html#features-transformFeedback" class="xref page"><code>transformFeedback</code></a> feature
is not enabled, <code>pWaitDstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TRANSFORM_FEEDBACK_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitDstStageMask-04095" href="#VUID-VkSubmitInfo-pWaitDstStageMask-04095"></a> <span class="vuid">VUID-VkSubmitInfo-pWaitDstStageMask-04095</span><br>

If the <a href="features.html#features-meshShader" class="xref page"><code>meshShader</code></a> feature is not enabled,
<code>pWaitDstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitDstStageMask-04096" href="#VUID-VkSubmitInfo-pWaitDstStageMask-04096"></a> <span class="vuid">VUID-VkSubmitInfo-pWaitDstStageMask-04096</span><br>

If the <a href="features.html#features-taskShader" class="xref page"><code>taskShader</code></a> feature is not enabled,
<code>pWaitDstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitDstStageMask-07318" href="#VUID-VkSubmitInfo-pWaitDstStageMask-07318"></a> <span class="vuid">VUID-VkSubmitInfo-pWaitDstStageMask-07318</span><br>

If neither of the <a href="features.html#features-shadingRateImage" class="xref page"><code>shadingRateImage</code></a>
or the <a href="features.html#features-attachmentFragmentShadingRate" class="xref page">    <code>attachmentFragmentShadingRate</code></a> features are enabled,
<code>pWaitDstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitDstStageMask-03937" href="#VUID-VkSubmitInfo-pWaitDstStageMask-03937"></a> <span class="vuid">VUID-VkSubmitInfo-pWaitDstStageMask-03937</span><br>

If the <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature is
not enabled, <code>pWaitDstStageMask</code> <strong>must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitDstStageMask-07949" href="#VUID-VkSubmitInfo-pWaitDstStageMask-07949"></a> <span class="vuid">VUID-VkSubmitInfo-pWaitDstStageMask-07949</span><br>

If neither the <a href="../appendices/extensions.html#VK_NV_ray_tracing" class="xref page">VK_NV_ray_tracing</a> extension or the
<a href="features.html#features-rayTracingPipeline" class="xref page"><code>rayTracingPipeline</code></a> feature are
enabled, <code>pWaitDstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pCommandBuffers-00075" href="#VUID-VkSubmitInfo-pCommandBuffers-00075"></a> <span class="vuid">VUID-VkSubmitInfo-pCommandBuffers-00075</span><br>

Each element of <code>pCommandBuffers</code> <strong>must</strong> not have been allocated with
<code>VK_COMMAND_BUFFER_LEVEL_SECONDARY</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitDstStageMask-00078" href="#VUID-VkSubmitInfo-pWaitDstStageMask-00078"></a> <span class="vuid">VUID-VkSubmitInfo-pWaitDstStageMask-00078</span><br>

Each element of <code>pWaitDstStageMask</code> <strong>must</strong> not include
<code>VK_PIPELINE_STAGE_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitSemaphores-03239" href="#VUID-VkSubmitInfo-pWaitSemaphores-03239"></a> <span class="vuid">VUID-VkSubmitInfo-pWaitSemaphores-03239</span><br>

If any element of <code>pWaitSemaphores</code> or <code>pSignalSemaphores</code> was
created with a <a href="synchronization.html#VkSemaphoreType" class="xref page">VkSemaphoreType</a> of
<code>VK_SEMAPHORE_TYPE_TIMELINE</code>, then the <code>pNext</code> chain <strong>must</strong>
include a <a href="#VkTimelineSemaphoreSubmitInfo">VkTimelineSemaphoreSubmitInfo</a> structure</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pNext-03240" href="#VUID-VkSubmitInfo-pNext-03240"></a> <span class="vuid">VUID-VkSubmitInfo-pNext-03240</span><br>

If the <code>pNext</code> chain of this structure includes a
<a href="#VkTimelineSemaphoreSubmitInfo">VkTimelineSemaphoreSubmitInfo</a> structure and any element of
<code>pWaitSemaphores</code> was created with a <a href="synchronization.html#VkSemaphoreType" class="xref page">VkSemaphoreType</a> of
<code>VK_SEMAPHORE_TYPE_TIMELINE</code>, then its <code>waitSemaphoreValueCount</code>
member <strong>must</strong> equal <code>waitSemaphoreCount</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pNext-03241" href="#VUID-VkSubmitInfo-pNext-03241"></a> <span class="vuid">VUID-VkSubmitInfo-pNext-03241</span><br>

If the <code>pNext</code> chain of this structure includes a
<a href="#VkTimelineSemaphoreSubmitInfo">VkTimelineSemaphoreSubmitInfo</a> structure and any element of
<code>pSignalSemaphores</code> was created with a <a href="synchronization.html#VkSemaphoreType" class="xref page">VkSemaphoreType</a> of
<code>VK_SEMAPHORE_TYPE_TIMELINE</code>, then its
<code>signalSemaphoreValueCount</code> member <strong>must</strong> equal
<code>signalSemaphoreCount</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pSignalSemaphores-03242" href="#VUID-VkSubmitInfo-pSignalSemaphores-03242"></a> <span class="vuid">VUID-VkSubmitInfo-pSignalSemaphores-03242</span><br>

For each element of <code>pSignalSemaphores</code> created with a
<a href="synchronization.html#VkSemaphoreType" class="xref page">VkSemaphoreType</a> of <code>VK_SEMAPHORE_TYPE_TIMELINE</code> the
corresponding element of
<a href="#VkTimelineSemaphoreSubmitInfo">VkTimelineSemaphoreSubmitInfo</a>::<code>pSignalSemaphoreValues</code> <strong>must</strong>
have a value greater than the current value of the semaphore when the
<a href="synchronization.html#synchronization-semaphores-signaling" class="xref page">semaphore signal operation</a> is
executed</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitSemaphores-03243" href="#VUID-VkSubmitInfo-pWaitSemaphores-03243"></a> <span class="vuid">VUID-VkSubmitInfo-pWaitSemaphores-03243</span><br>

For each element of <code>pWaitSemaphores</code> created with a
<a href="synchronization.html#VkSemaphoreType" class="xref page">VkSemaphoreType</a> of <code>VK_SEMAPHORE_TYPE_TIMELINE</code> the
corresponding element of
<a href="#VkTimelineSemaphoreSubmitInfo">VkTimelineSemaphoreSubmitInfo</a>::<code>pWaitSemaphoreValues</code> <strong>must</strong>
have a value which does not differ from the current value of the
semaphore or the value of any outstanding semaphore wait or signal
operation on that semaphore by more than
<a href="devsandqueues.html#limits-maxTimelineSemaphoreValueDifference" class="xref page">    <code>maxTimelineSemaphoreValueDifference</code></a></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pSignalSemaphores-03244" href="#VUID-VkSubmitInfo-pSignalSemaphores-03244"></a> <span class="vuid">VUID-VkSubmitInfo-pSignalSemaphores-03244</span><br>

For each element of <code>pSignalSemaphores</code> created with a
<a href="synchronization.html#VkSemaphoreType" class="xref page">VkSemaphoreType</a> of <code>VK_SEMAPHORE_TYPE_TIMELINE</code> the
corresponding element of
<a href="#VkTimelineSemaphoreSubmitInfo">VkTimelineSemaphoreSubmitInfo</a>::<code>pSignalSemaphoreValues</code> <strong>must</strong>
have a value which does not differ from the current value of the
semaphore or the value of any outstanding semaphore wait or signal
operation on that semaphore by more than
<a href="devsandqueues.html#limits-maxTimelineSemaphoreValueDifference" class="xref page">    <code>maxTimelineSemaphoreValueDifference</code></a></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pNext-04120" href="#VUID-VkSubmitInfo-pNext-04120"></a> <span class="vuid">VUID-VkSubmitInfo-pNext-04120</span><br>

If the <code>pNext</code> chain of this structure does not include a
<code>VkProtectedSubmitInfo</code> structure with <code>protectedSubmit</code> set to
<code>VK_TRUE</code>, then each element of the <code>pCommandBuffers</code> array
<strong>must</strong> be an unprotected command buffer</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pNext-04148" href="#VUID-VkSubmitInfo-pNext-04148"></a> <span class="vuid">VUID-VkSubmitInfo-pNext-04148</span><br>

If the <code>pNext</code> chain of this structure includes a
<code>VkProtectedSubmitInfo</code> structure with <code>protectedSubmit</code> set to
<code>VK_TRUE</code>, then each element of the <code>pCommandBuffers</code> array
<strong>must</strong> be a protected command buffer</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pCommandBuffers-06193" href="#VUID-VkSubmitInfo-pCommandBuffers-06193"></a> <span class="vuid">VUID-VkSubmitInfo-pCommandBuffers-06193</span><br>

If <code>pCommandBuffers</code> contains any <a href="renderpass.html#renderpass-suspension" class="xref page">resumed    render pass instances</a>, they <strong>must</strong> be suspended by a render pass
instance earlier in submission order within <code>pCommandBuffers</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pCommandBuffers-06014" href="#VUID-VkSubmitInfo-pCommandBuffers-06014"></a> <span class="vuid">VUID-VkSubmitInfo-pCommandBuffers-06014</span><br>

If <code>pCommandBuffers</code> contains any <a href="renderpass.html#renderpass-suspension" class="xref page">suspended    render pass instances</a>, they <strong>must</strong> be resumed by a render pass instance
later in submission order within <code>pCommandBuffers</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pCommandBuffers-06015" href="#VUID-VkSubmitInfo-pCommandBuffers-06015"></a> <span class="vuid">VUID-VkSubmitInfo-pCommandBuffers-06015</span><br>

If <code>pCommandBuffers</code> contains any <a href="renderpass.html#renderpass-suspension" class="xref page">suspended    render pass instances</a>, there <strong>must</strong> be no action or synchronization
commands executed in a primary or <a href="#commandbuffers-secondary">    secondary</a> command buffer between that render pass instance and the
render pass instance that resumes it</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pCommandBuffers-06016" href="#VUID-VkSubmitInfo-pCommandBuffers-06016"></a> <span class="vuid">VUID-VkSubmitInfo-pCommandBuffers-06016</span><br>

If <code>pCommandBuffers</code> contains any <a href="renderpass.html#renderpass-suspension" class="xref page">suspended    render pass instances</a>, there <strong>must</strong> be no render pass instances between
that render pass instance and the render pass instance that resumes it</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-variableSampleLocations-06017" href="#VUID-VkSubmitInfo-variableSampleLocations-06017"></a> <span class="vuid">VUID-VkSubmitInfo-variableSampleLocations-06017</span><br>

If the <a href="limits.html#limits-variableSampleLocations" class="xref page"><code>variableSampleLocations</code></a>
limit is not supported, and any element of <code>pCommandBuffers</code>
contains any <a href="renderpass.html#renderpass-suspension" class="xref page">suspended render pass instances</a>,
where a graphics pipeline has been bound, any pipelines bound in the
render pass instance that resumes it, or any subsequent render pass
instances that resume from that one and so on, <strong>must</strong> use the same sample
locations</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSubmitInfo-sType-sType" href="#VUID-VkSubmitInfo-sType-sType"></a> <span class="vuid">VUID-VkSubmitInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_SUBMIT_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pNext-pNext" href="#VUID-VkSubmitInfo-pNext-pNext"></a> <span class="vuid">VUID-VkSubmitInfo-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="../appendices/extensions.html#VkAmigoProfilingSubmitInfoSEC" class="xref page">VkAmigoProfilingSubmitInfoSEC</a>, <a href="#VkD3D12FenceSubmitInfoKHR">VkD3D12FenceSubmitInfoKHR</a>, <a href="#VkDeviceGroupSubmitInfo">VkDeviceGroupSubmitInfo</a>, <a href="debugging.html#VkFrameBoundaryEXT" class="xref page">VkFrameBoundaryEXT</a>, <a href="VK_KHR_surface/wsi.html#VkLatencySubmissionPresentIdNV" class="xref page">VkLatencySubmissionPresentIdNV</a>, <a href="#VkPerformanceQuerySubmitInfoKHR">VkPerformanceQuerySubmitInfoKHR</a>, <a href="#VkProtectedSubmitInfo">VkProtectedSubmitInfo</a>, <a href="#VkTimelineSemaphoreSubmitInfo">VkTimelineSemaphoreSubmitInfo</a>, <a href="#VkWin32KeyedMutexAcquireReleaseInfoKHR">VkWin32KeyedMutexAcquireReleaseInfoKHR</a>, or <a href="#VkWin32KeyedMutexAcquireReleaseInfoNV">VkWin32KeyedMutexAcquireReleaseInfoNV</a></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-sType-unique" href="#VUID-VkSubmitInfo-sType-unique"></a> <span class="vuid">VUID-VkSubmitInfo-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitSemaphores-parameter" href="#VUID-VkSubmitInfo-pWaitSemaphores-parameter"></a> <span class="vuid">VUID-VkSubmitInfo-pWaitSemaphores-parameter</span><br>
 If <code>waitSemaphoreCount</code> is not <code>0</code>, <code>pWaitSemaphores</code> <strong>must</strong> be a valid pointer to an array of <code>waitSemaphoreCount</code> valid <a href="synchronization.html#VkSemaphore" class="xref page">VkSemaphore</a> handles</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitDstStageMask-parameter" href="#VUID-VkSubmitInfo-pWaitDstStageMask-parameter"></a> <span class="vuid">VUID-VkSubmitInfo-pWaitDstStageMask-parameter</span><br>
 If <code>waitSemaphoreCount</code> is not <code>0</code>, <code>pWaitDstStageMask</code> <strong>must</strong> be a valid pointer to an array of <code>waitSemaphoreCount</code> valid combinations of <a href="synchronization.html#VkPipelineStageFlagBits" class="xref page">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pCommandBuffers-parameter" href="#VUID-VkSubmitInfo-pCommandBuffers-parameter"></a> <span class="vuid">VUID-VkSubmitInfo-pCommandBuffers-parameter</span><br>
 If <code>commandBufferCount</code> is not <code>0</code>, <code>pCommandBuffers</code> <strong>must</strong> be a valid pointer to an array of <code>commandBufferCount</code> valid <a href="#VkCommandBuffer">VkCommandBuffer</a> handles</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pSignalSemaphores-parameter" href="#VUID-VkSubmitInfo-pSignalSemaphores-parameter"></a> <span class="vuid">VUID-VkSubmitInfo-pSignalSemaphores-parameter</span><br>
 If <code>signalSemaphoreCount</code> is not <code>0</code>, <code>pSignalSemaphores</code> <strong>must</strong> be a valid pointer to an array of <code>signalSemaphoreCount</code> valid <a href="synchronization.html#VkSemaphore" class="xref page">VkSemaphore</a> handles</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-commonparent" href="#VUID-VkSubmitInfo-commonparent"></a> <span class="vuid">VUID-VkSubmitInfo-commonparent</span><br>
 Each of the elements of <code>pCommandBuffers</code>, the elements of <code>pSignalSemaphores</code>, and the elements of <code>pWaitSemaphores</code> that are valid handles of non-ignored parameters <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To specify the values to use when waiting for and signaling semaphores
created with a <a href="synchronization.html#VkSemaphoreType" class="xref page">VkSemaphoreType</a> of <code>VK_SEMAPHORE_TYPE_TIMELINE</code>,
add a <a href="#VkTimelineSemaphoreSubmitInfo">VkTimelineSemaphoreSubmitInfo</a> structure to the <code>pNext</code> chain
of the <a href="#VkSubmitInfo">VkSubmitInfo</a> structure when using <a href="#vkQueueSubmit">vkQueueSubmit</a>
or the <a href="sparsemem.html#VkBindSparseInfo" class="xref page">VkBindSparseInfo</a> structure when using <a href="sparsemem.html#vkQueueBindSparse" class="xref page">vkQueueBindSparse</a>
.
The <code>VkTimelineSemaphoreSubmitInfo</code> structure is defined as:</p>
</div>
<div id="VkTimelineSemaphoreSubmitInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_2
typedef struct VkTimelineSemaphoreSubmitInfo {
    VkStructureType    sType;
    const void*        pNext;
    uint32_t           waitSemaphoreValueCount;
    const uint64_t*    pWaitSemaphoreValues;
    uint32_t           signalSemaphoreValueCount;
    const uint64_t*    pSignalSemaphoreValues;
} VkTimelineSemaphoreSubmitInfo;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkTimelineSemaphoreSubmitInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_timeline_semaphore
typedef VkTimelineSemaphoreSubmitInfo VkTimelineSemaphoreSubmitInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>waitSemaphoreValueCount</code> is the number of semaphore wait values
specified in <code>pWaitSemaphoreValues</code>.</p>
</li>
<li>
<p><code>pWaitSemaphoreValues</code> is a pointer to an array of
<code>waitSemaphoreValueCount</code> values for the corresponding semaphores in
<a href="#VkSubmitInfo">VkSubmitInfo</a>::<code>pWaitSemaphores</code> to wait for.</p>
</li>
<li>
<p><code>signalSemaphoreValueCount</code> is the number of semaphore signal values
specified in <code>pSignalSemaphoreValues</code>.</p>
</li>
<li>
<p><code>pSignalSemaphoreValues</code> is a pointer to an array
<code>signalSemaphoreValueCount</code> values for the corresponding semaphores
in <a href="#VkSubmitInfo">VkSubmitInfo</a>::<code>pSignalSemaphores</code> to set when signaled.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the semaphore in <a href="#VkSubmitInfo">VkSubmitInfo</a>::<code>pWaitSemaphores</code> or
<a href="#VkSubmitInfo">VkSubmitInfo</a>::<code>pSignalSemaphores</code> corresponding to an entry in
<code>pWaitSemaphoreValues</code> or <code>pSignalSemaphoreValues</code> respectively was
not created with a <a href="synchronization.html#VkSemaphoreType" class="xref page">VkSemaphoreType</a> of
<code>VK_SEMAPHORE_TYPE_TIMELINE</code>, the implementation <strong>must</strong> ignore the value
in the <code>pWaitSemaphoreValues</code> or <code>pSignalSemaphoreValues</code> entry.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkTimelineSemaphoreSubmitInfo-sType-sType" href="#VUID-VkTimelineSemaphoreSubmitInfo-sType-sType"></a> <span class="vuid">VUID-VkTimelineSemaphoreSubmitInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_TIMELINE_SEMAPHORE_SUBMIT_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkTimelineSemaphoreSubmitInfo-pWaitSemaphoreValues-parameter" href="#VUID-VkTimelineSemaphoreSubmitInfo-pWaitSemaphoreValues-parameter"></a> <span class="vuid">VUID-VkTimelineSemaphoreSubmitInfo-pWaitSemaphoreValues-parameter</span><br>
 If <code>waitSemaphoreValueCount</code> is not <code>0</code>, and <code>pWaitSemaphoreValues</code> is not <code>NULL</code>, <code>pWaitSemaphoreValues</code> <strong>must</strong> be a valid pointer to an array of <code>waitSemaphoreValueCount</code> <code>uint64_t</code> values</p>
</li>
<li>
<p><a id="VUID-VkTimelineSemaphoreSubmitInfo-pSignalSemaphoreValues-parameter" href="#VUID-VkTimelineSemaphoreSubmitInfo-pSignalSemaphoreValues-parameter"></a> <span class="vuid">VUID-VkTimelineSemaphoreSubmitInfo-pSignalSemaphoreValues-parameter</span><br>
 If <code>signalSemaphoreValueCount</code> is not <code>0</code>, and <code>pSignalSemaphoreValues</code> is not <code>NULL</code>, <code>pSignalSemaphoreValues</code> <strong>must</strong> be a valid pointer to an array of <code>signalSemaphoreValueCount</code> <code>uint64_t</code> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To specify the values to use when waiting for and signaling semaphores whose
<a href="synchronization.html#synchronization-semaphores-importing" class="xref page">current payload</a> refers to a
Direct3D 12 fence, add a <a href="#VkD3D12FenceSubmitInfoKHR">VkD3D12FenceSubmitInfoKHR</a> structure to the
<code>pNext</code> chain of the <a href="#VkSubmitInfo">VkSubmitInfo</a> structure.
The <code>VkD3D12FenceSubmitInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkD3D12FenceSubmitInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_semaphore_win32
typedef struct VkD3D12FenceSubmitInfoKHR {
    VkStructureType    sType;
    const void*        pNext;
    uint32_t           waitSemaphoreValuesCount;
    const uint64_t*    pWaitSemaphoreValues;
    uint32_t           signalSemaphoreValuesCount;
    const uint64_t*    pSignalSemaphoreValues;
} VkD3D12FenceSubmitInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>waitSemaphoreValuesCount</code> is the number of semaphore wait values
specified in <code>pWaitSemaphoreValues</code>.</p>
</li>
<li>
<p><code>pWaitSemaphoreValues</code> is a pointer to an array of
<code>waitSemaphoreValuesCount</code> values for the corresponding semaphores
in <a href="#VkSubmitInfo">VkSubmitInfo</a>::<code>pWaitSemaphores</code> to wait for.</p>
</li>
<li>
<p><code>signalSemaphoreValuesCount</code> is the number of semaphore signal
values specified in <code>pSignalSemaphoreValues</code>.</p>
</li>
<li>
<p><code>pSignalSemaphoreValues</code> is a pointer to an array of
<code>signalSemaphoreValuesCount</code> values for the corresponding semaphores
in <a href="#VkSubmitInfo">VkSubmitInfo</a>::<code>pSignalSemaphores</code> to set when signaled.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the semaphore in <a href="#VkSubmitInfo">VkSubmitInfo</a>::<code>pWaitSemaphores</code> or
<a href="#VkSubmitInfo">VkSubmitInfo</a>::<code>pSignalSemaphores</code> corresponding to an entry in
<code>pWaitSemaphoreValues</code> or <code>pSignalSemaphoreValues</code> respectively does
not currently have a <a href="synchronization.html#synchronization-semaphores-payloads" class="xref page">payload</a>
referring to a Direct3D 12 fence, the implementation <strong>must</strong> ignore the value
in the <code>pWaitSemaphoreValues</code> or <code>pSignalSemaphoreValues</code> entry.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As the introduction of the external semaphore handle type
<code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_D3D12_FENCE_BIT</code> predates that of
timeline semaphores, support for importing semaphore payloads from external
handles of that type into semaphores created (implicitly or explicitly) with
a <a href="synchronization.html#VkSemaphoreType" class="xref page">VkSemaphoreType</a> of <code>VK_SEMAPHORE_TYPE_BINARY</code> is preserved for
backwards compatibility.
However, applications <strong>should</strong> prefer importing such handle types into
semaphores created with a <a href="synchronization.html#VkSemaphoreType" class="xref page">VkSemaphoreType</a> of
<code>VK_SEMAPHORE_TYPE_TIMELINE</code>, and use the
<a href="#VkTimelineSemaphoreSubmitInfo">VkTimelineSemaphoreSubmitInfo</a> structure instead of the
<code>VkD3D12FenceSubmitInfoKHR</code> structure to specify the values to use when
waiting for and signaling such semaphores.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkD3D12FenceSubmitInfoKHR-waitSemaphoreValuesCount-00079" href="#VUID-VkD3D12FenceSubmitInfoKHR-waitSemaphoreValuesCount-00079"></a> <span class="vuid">VUID-VkD3D12FenceSubmitInfoKHR-waitSemaphoreValuesCount-00079</span><br>

<code>waitSemaphoreValuesCount</code> <strong>must</strong> be the same value as
<code>VkSubmitInfo</code>::<code>waitSemaphoreCount</code>, where this structure is in
the <code>pNext</code> chain of a <code>VkSubmitInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-VkD3D12FenceSubmitInfoKHR-signalSemaphoreValuesCount-00080" href="#VUID-VkD3D12FenceSubmitInfoKHR-signalSemaphoreValuesCount-00080"></a> <span class="vuid">VUID-VkD3D12FenceSubmitInfoKHR-signalSemaphoreValuesCount-00080</span><br>

<code>signalSemaphoreValuesCount</code> <strong>must</strong> be the same value as
<code>VkSubmitInfo</code>::<code>signalSemaphoreCount</code>, where this structure is
in the <code>pNext</code> chain of a <code>VkSubmitInfo</code> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkD3D12FenceSubmitInfoKHR-sType-sType" href="#VUID-VkD3D12FenceSubmitInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkD3D12FenceSubmitInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_D3D12_FENCE_SUBMIT_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkD3D12FenceSubmitInfoKHR-pWaitSemaphoreValues-parameter" href="#VUID-VkD3D12FenceSubmitInfoKHR-pWaitSemaphoreValues-parameter"></a> <span class="vuid">VUID-VkD3D12FenceSubmitInfoKHR-pWaitSemaphoreValues-parameter</span><br>
 If <code>waitSemaphoreValuesCount</code> is not <code>0</code>, and <code>pWaitSemaphoreValues</code> is not <code>NULL</code>, <code>pWaitSemaphoreValues</code> <strong>must</strong> be a valid pointer to an array of <code>waitSemaphoreValuesCount</code> <code>uint64_t</code> values</p>
</li>
<li>
<p><a id="VUID-VkD3D12FenceSubmitInfoKHR-pSignalSemaphoreValues-parameter" href="#VUID-VkD3D12FenceSubmitInfoKHR-pSignalSemaphoreValues-parameter"></a> <span class="vuid">VUID-VkD3D12FenceSubmitInfoKHR-pSignalSemaphoreValues-parameter</span><br>
 If <code>signalSemaphoreValuesCount</code> is not <code>0</code>, and <code>pSignalSemaphoreValues</code> is not <code>NULL</code>, <code>pSignalSemaphoreValues</code> <strong>must</strong> be a valid pointer to an array of <code>signalSemaphoreValuesCount</code> <code>uint64_t</code> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When submitting work that operates on memory imported from a Direct3D 11
resource to a queue, the keyed mutex mechanism <strong>may</strong> be used in addition to
Vulkan semaphores to synchronize the work.
Keyed mutexes are a property of a properly created shareable Direct3D 11
resource.
They <strong>can</strong> only be used if the imported resource was created with the
<code>D3D11_RESOURCE_MISC_SHARED_KEYEDMUTEX</code> flag.</p>
</div>
<div class="paragraph">
<p>To acquire keyed mutexes before submitted work and/or release them after,
add a <a href="#VkWin32KeyedMutexAcquireReleaseInfoKHR">VkWin32KeyedMutexAcquireReleaseInfoKHR</a> structure to the
<code>pNext</code> chain of the <a href="#VkSubmitInfo">VkSubmitInfo</a> structure.</p>
</div>
<div class="paragraph">
<p>The <code>VkWin32KeyedMutexAcquireReleaseInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkWin32KeyedMutexAcquireReleaseInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_win32_keyed_mutex
typedef struct VkWin32KeyedMutexAcquireReleaseInfoKHR {
    VkStructureType          sType;
    const void*              pNext;
    uint32_t                 acquireCount;
    const VkDeviceMemory*    pAcquireSyncs;
    const uint64_t*          pAcquireKeys;
    const uint32_t*          pAcquireTimeouts;
    uint32_t                 releaseCount;
    const VkDeviceMemory*    pReleaseSyncs;
    const uint64_t*          pReleaseKeys;
} VkWin32KeyedMutexAcquireReleaseInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>acquireCount</code> is the number of entries in the <code>pAcquireSyncs</code>,
<code>pAcquireKeys</code>, and <code>pAcquireTimeouts</code> arrays.</p>
</li>
<li>
<p><code>pAcquireSyncs</code> is a pointer to an array of <a href="memory.html#VkDeviceMemory" class="xref page">VkDeviceMemory</a>
objects which were imported from Direct3D 11 resources.</p>
</li>
<li>
<p><code>pAcquireKeys</code> is a pointer to an array of mutex key values to wait
for prior to beginning the submitted work.
Entries refer to the keyed mutex associated with the corresponding
entries in <code>pAcquireSyncs</code>.</p>
</li>
<li>
<p><code>pAcquireTimeouts</code> is a pointer to an array of timeout values, in
millisecond units, for each acquire specified in <code>pAcquireKeys</code>.</p>
</li>
<li>
<p><code>releaseCount</code> is the number of entries in the <code>pReleaseSyncs</code>
and <code>pReleaseKeys</code> arrays.</p>
</li>
<li>
<p><code>pReleaseSyncs</code> is a pointer to an array of <a href="memory.html#VkDeviceMemory" class="xref page">VkDeviceMemory</a>
objects which were imported from Direct3D 11 resources.</p>
</li>
<li>
<p><code>pReleaseKeys</code> is a pointer to an array of mutex key values to set
when the submitted work has completed.
Entries refer to the keyed mutex associated with the corresponding
entries in <code>pReleaseSyncs</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-pAcquireSyncs-00081" href="#VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-pAcquireSyncs-00081"></a> <span class="vuid">VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-pAcquireSyncs-00081</span><br>

Each member of <code>pAcquireSyncs</code> and <code>pReleaseSyncs</code> <strong>must</strong> be a
device memory object imported by setting
<a href="memory.html#VkImportMemoryWin32HandleInfoKHR" class="xref page">VkImportMemoryWin32HandleInfoKHR</a>::<code>handleType</code> to
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D11_TEXTURE_BIT</code> or
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D11_TEXTURE_KMT_BIT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-sType-sType" href="#VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_WIN32_KEYED_MUTEX_ACQUIRE_RELEASE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-pAcquireSyncs-parameter" href="#VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-pAcquireSyncs-parameter"></a> <span class="vuid">VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-pAcquireSyncs-parameter</span><br>
 If <code>acquireCount</code> is not <code>0</code>, <code>pAcquireSyncs</code> <strong>must</strong> be a valid pointer to an array of <code>acquireCount</code> valid <a href="memory.html#VkDeviceMemory" class="xref page">VkDeviceMemory</a> handles</p>
</li>
<li>
<p><a id="VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-pAcquireKeys-parameter" href="#VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-pAcquireKeys-parameter"></a> <span class="vuid">VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-pAcquireKeys-parameter</span><br>
 If <code>acquireCount</code> is not <code>0</code>, <code>pAcquireKeys</code> <strong>must</strong> be a valid pointer to an array of <code>acquireCount</code> <code>uint64_t</code> values</p>
</li>
<li>
<p><a id="VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-pAcquireTimeouts-parameter" href="#VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-pAcquireTimeouts-parameter"></a> <span class="vuid">VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-pAcquireTimeouts-parameter</span><br>
 If <code>acquireCount</code> is not <code>0</code>, <code>pAcquireTimeouts</code> <strong>must</strong> be a valid pointer to an array of <code>acquireCount</code> <code>uint32_t</code> values</p>
</li>
<li>
<p><a id="VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-pReleaseSyncs-parameter" href="#VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-pReleaseSyncs-parameter"></a> <span class="vuid">VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-pReleaseSyncs-parameter</span><br>
 If <code>releaseCount</code> is not <code>0</code>, <code>pReleaseSyncs</code> <strong>must</strong> be a valid pointer to an array of <code>releaseCount</code> valid <a href="memory.html#VkDeviceMemory" class="xref page">VkDeviceMemory</a> handles</p>
</li>
<li>
<p><a id="VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-pReleaseKeys-parameter" href="#VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-pReleaseKeys-parameter"></a> <span class="vuid">VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-pReleaseKeys-parameter</span><br>
 If <code>releaseCount</code> is not <code>0</code>, <code>pReleaseKeys</code> <strong>must</strong> be a valid pointer to an array of <code>releaseCount</code> <code>uint64_t</code> values</p>
</li>
<li>
<p><a id="VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-commonparent" href="#VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-commonparent"></a> <span class="vuid">VUID-VkWin32KeyedMutexAcquireReleaseInfoKHR-commonparent</span><br>
 Both of the elements of <code>pAcquireSyncs</code>, and the elements of <code>pReleaseSyncs</code> that are valid handles of non-ignored parameters <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When submitting work that operates on memory imported from a Direct3D 11
resource to a queue, the keyed mutex mechanism <strong>may</strong> be used in addition to
Vulkan semaphores to synchronize the work.
Keyed mutexes are a property of a properly created shareable Direct3D 11
resource.
They <strong>can</strong> only be used if the imported resource was created with the
<code>D3D11_RESOURCE_MISC_SHARED_KEYEDMUTEX</code> flag.</p>
</div>
<div class="paragraph">
<p>To acquire keyed mutexes before submitted work and/or release them after,
add a <a href="#VkWin32KeyedMutexAcquireReleaseInfoNV">VkWin32KeyedMutexAcquireReleaseInfoNV</a> structure to the
<code>pNext</code> chain of the <a href="#VkSubmitInfo">VkSubmitInfo</a> structure.</p>
</div>
<div class="paragraph">
<p>The <code>VkWin32KeyedMutexAcquireReleaseInfoNV</code> structure is defined as:</p>
</div>
<div id="VkWin32KeyedMutexAcquireReleaseInfoNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_NV_win32_keyed_mutex
typedef struct VkWin32KeyedMutexAcquireReleaseInfoNV {
    VkStructureType          sType;
    const void*              pNext;
    uint32_t                 acquireCount;
    const VkDeviceMemory*    pAcquireSyncs;
    const uint64_t*          pAcquireKeys;
    const uint32_t*          pAcquireTimeoutMilliseconds;
    uint32_t                 releaseCount;
    const VkDeviceMemory*    pReleaseSyncs;
    const uint64_t*          pReleaseKeys;
} VkWin32KeyedMutexAcquireReleaseInfoNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>acquireCount</code> is the number of entries in the <code>pAcquireSyncs</code>,
<code>pAcquireKeys</code>, and <code>pAcquireTimeoutMilliseconds</code> arrays.</p>
</li>
<li>
<p><code>pAcquireSyncs</code> is a pointer to an array of <a href="memory.html#VkDeviceMemory" class="xref page">VkDeviceMemory</a>
objects which were imported from Direct3D 11 resources.</p>
</li>
<li>
<p><code>pAcquireKeys</code> is a pointer to an array of mutex key values to wait
for prior to beginning the submitted work.
Entries refer to the keyed mutex associated with the corresponding
entries in <code>pAcquireSyncs</code>.</p>
</li>
<li>
<p><code>pAcquireTimeoutMilliseconds</code> is a pointer to an array of timeout
values, in millisecond units, for each acquire specified in
<code>pAcquireKeys</code>.</p>
</li>
<li>
<p><code>releaseCount</code> is the number of entries in the <code>pReleaseSyncs</code>
and <code>pReleaseKeys</code> arrays.</p>
</li>
<li>
<p><code>pReleaseSyncs</code> is a pointer to an array of <a href="memory.html#VkDeviceMemory" class="xref page">VkDeviceMemory</a>
objects which were imported from Direct3D 11 resources.</p>
</li>
<li>
<p><code>pReleaseKeys</code> is a pointer to an array of mutex key values to set
when the submitted work has completed.
Entries refer to the keyed mutex associated with the corresponding
entries in <code>pReleaseSyncs</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-sType-sType" href="#VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-sType-sType"></a> <span class="vuid">VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_WIN32_KEYED_MUTEX_ACQUIRE_RELEASE_INFO_NV</code></p>
</li>
<li>
<p><a id="VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-pAcquireSyncs-parameter" href="#VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-pAcquireSyncs-parameter"></a> <span class="vuid">VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-pAcquireSyncs-parameter</span><br>
 If <code>acquireCount</code> is not <code>0</code>, <code>pAcquireSyncs</code> <strong>must</strong> be a valid pointer to an array of <code>acquireCount</code> valid <a href="memory.html#VkDeviceMemory" class="xref page">VkDeviceMemory</a> handles</p>
</li>
<li>
<p><a id="VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-pAcquireKeys-parameter" href="#VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-pAcquireKeys-parameter"></a> <span class="vuid">VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-pAcquireKeys-parameter</span><br>
 If <code>acquireCount</code> is not <code>0</code>, <code>pAcquireKeys</code> <strong>must</strong> be a valid pointer to an array of <code>acquireCount</code> <code>uint64_t</code> values</p>
</li>
<li>
<p><a id="VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-pAcquireTimeoutMilliseconds-parameter" href="#VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-pAcquireTimeoutMilliseconds-parameter"></a> <span class="vuid">VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-pAcquireTimeoutMilliseconds-parameter</span><br>
 If <code>acquireCount</code> is not <code>0</code>, <code>pAcquireTimeoutMilliseconds</code> <strong>must</strong> be a valid pointer to an array of <code>acquireCount</code> <code>uint32_t</code> values</p>
</li>
<li>
<p><a id="VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-pReleaseSyncs-parameter" href="#VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-pReleaseSyncs-parameter"></a> <span class="vuid">VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-pReleaseSyncs-parameter</span><br>
 If <code>releaseCount</code> is not <code>0</code>, <code>pReleaseSyncs</code> <strong>must</strong> be a valid pointer to an array of <code>releaseCount</code> valid <a href="memory.html#VkDeviceMemory" class="xref page">VkDeviceMemory</a> handles</p>
</li>
<li>
<p><a id="VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-pReleaseKeys-parameter" href="#VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-pReleaseKeys-parameter"></a> <span class="vuid">VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-pReleaseKeys-parameter</span><br>
 If <code>releaseCount</code> is not <code>0</code>, <code>pReleaseKeys</code> <strong>must</strong> be a valid pointer to an array of <code>releaseCount</code> <code>uint64_t</code> values</p>
</li>
<li>
<p><a id="VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-commonparent" href="#VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-commonparent"></a> <span class="vuid">VUID-VkWin32KeyedMutexAcquireReleaseInfoNV-commonparent</span><br>
 Both of the elements of <code>pAcquireSyncs</code>, and the elements of <code>pReleaseSyncs</code> that are valid handles of non-ignored parameters <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the <code>pNext</code> chain of <a href="#VkSubmitInfo">VkSubmitInfo</a> includes a
<code>VkProtectedSubmitInfo</code> structure, then the structure indicates whether
the batch is protected.
The <code>VkProtectedSubmitInfo</code> structure is defined as:</p>
</div>
<div id="VkProtectedSubmitInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_1
typedef struct VkProtectedSubmitInfo {
    VkStructureType    sType;
    const void*        pNext;
    VkBool32           protectedSubmit;
} VkProtectedSubmitInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>protectedSubmit</code> specifies whether the batch is protected.
If <code>protectedSubmit</code> is <code>VK_TRUE</code>, the batch is protected.
If <code>protectedSubmit</code> is <code>VK_FALSE</code>, the batch is unprotected.
If the <code>VkSubmitInfo</code>::<code>pNext</code> chain does not include this
structure, the batch is unprotected.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkProtectedSubmitInfo-sType-sType" href="#VUID-VkProtectedSubmitInfo-sType-sType"></a> <span class="vuid">VUID-VkProtectedSubmitInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_PROTECTED_SUBMIT_INFO</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the <code>pNext</code> chain of <a href="#VkSubmitInfo">VkSubmitInfo</a> includes a
<code>VkDeviceGroupSubmitInfo</code> structure, then that structure includes device
indices and masks specifying which physical devices execute semaphore
operations and command buffers.</p>
</div>
<div class="paragraph">
<p>The <code>VkDeviceGroupSubmitInfo</code> structure is defined as:</p>
</div>
<div id="VkDeviceGroupSubmitInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_1
typedef struct VkDeviceGroupSubmitInfo {
    VkStructureType    sType;
    const void*        pNext;
    uint32_t           waitSemaphoreCount;
    const uint32_t*    pWaitSemaphoreDeviceIndices;
    uint32_t           commandBufferCount;
    const uint32_t*    pCommandBufferDeviceMasks;
    uint32_t           signalSemaphoreCount;
    const uint32_t*    pSignalSemaphoreDeviceIndices;
} VkDeviceGroupSubmitInfo;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkDeviceGroupSubmitInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_device_group
typedef VkDeviceGroupSubmitInfo VkDeviceGroupSubmitInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>waitSemaphoreCount</code> is the number of elements in the
<code>pWaitSemaphoreDeviceIndices</code> array.</p>
</li>
<li>
<p><code>pWaitSemaphoreDeviceIndices</code> is a pointer to an array of
<code>waitSemaphoreCount</code> device indices indicating which physical device
executes the semaphore wait operation in the corresponding element of
<a href="#VkSubmitInfo">VkSubmitInfo</a>::<code>pWaitSemaphores</code>.</p>
</li>
<li>
<p><code>commandBufferCount</code> is the number of elements in the
<code>pCommandBufferDeviceMasks</code> array.</p>
</li>
<li>
<p><code>pCommandBufferDeviceMasks</code> is a pointer to an array of
<code>commandBufferCount</code> device masks indicating which physical devices
execute the command buffer in the corresponding element of
<a href="#VkSubmitInfo">VkSubmitInfo</a>::<code>pCommandBuffers</code>.
A physical device executes the command buffer if the corresponding bit
is set in the mask.</p>
</li>
<li>
<p><code>signalSemaphoreCount</code> is the number of elements in the
<code>pSignalSemaphoreDeviceIndices</code> array.</p>
</li>
<li>
<p><code>pSignalSemaphoreDeviceIndices</code> is a pointer to an array of
<code>signalSemaphoreCount</code> device indices indicating which physical
device executes the semaphore signal operation in the corresponding
element of <a href="#VkSubmitInfo">VkSubmitInfo</a>::<code>pSignalSemaphores</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If this structure is not present, semaphore operations and command buffers
execute on device index zero.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkDeviceGroupSubmitInfo-waitSemaphoreCount-00082" href="#VUID-VkDeviceGroupSubmitInfo-waitSemaphoreCount-00082"></a> <span class="vuid">VUID-VkDeviceGroupSubmitInfo-waitSemaphoreCount-00082</span><br>

<code>waitSemaphoreCount</code> <strong>must</strong> equal
<a href="#VkSubmitInfo">VkSubmitInfo</a>::<code>waitSemaphoreCount</code></p>
</li>
<li>
<p><a id="VUID-VkDeviceGroupSubmitInfo-commandBufferCount-00083" href="#VUID-VkDeviceGroupSubmitInfo-commandBufferCount-00083"></a> <span class="vuid">VUID-VkDeviceGroupSubmitInfo-commandBufferCount-00083</span><br>

<code>commandBufferCount</code> <strong>must</strong> equal
<a href="#VkSubmitInfo">VkSubmitInfo</a>::<code>commandBufferCount</code></p>
</li>
<li>
<p><a id="VUID-VkDeviceGroupSubmitInfo-signalSemaphoreCount-00084" href="#VUID-VkDeviceGroupSubmitInfo-signalSemaphoreCount-00084"></a> <span class="vuid">VUID-VkDeviceGroupSubmitInfo-signalSemaphoreCount-00084</span><br>

<code>signalSemaphoreCount</code> <strong>must</strong> equal
<a href="#VkSubmitInfo">VkSubmitInfo</a>::<code>signalSemaphoreCount</code></p>
</li>
<li>
<p><a id="VUID-VkDeviceGroupSubmitInfo-pWaitSemaphoreDeviceIndices-00085" href="#VUID-VkDeviceGroupSubmitInfo-pWaitSemaphoreDeviceIndices-00085"></a> <span class="vuid">VUID-VkDeviceGroupSubmitInfo-pWaitSemaphoreDeviceIndices-00085</span><br>

All elements of <code>pWaitSemaphoreDeviceIndices</code> and
<code>pSignalSemaphoreDeviceIndices</code> <strong>must</strong> be valid device indices</p>
</li>
<li>
<p><a id="VUID-VkDeviceGroupSubmitInfo-pCommandBufferDeviceMasks-00086" href="#VUID-VkDeviceGroupSubmitInfo-pCommandBufferDeviceMasks-00086"></a> <span class="vuid">VUID-VkDeviceGroupSubmitInfo-pCommandBufferDeviceMasks-00086</span><br>

All elements of <code>pCommandBufferDeviceMasks</code> <strong>must</strong> be valid device
masks</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkDeviceGroupSubmitInfo-sType-sType" href="#VUID-VkDeviceGroupSubmitInfo-sType-sType"></a> <span class="vuid">VUID-VkDeviceGroupSubmitInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_DEVICE_GROUP_SUBMIT_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkDeviceGroupSubmitInfo-pWaitSemaphoreDeviceIndices-parameter" href="#VUID-VkDeviceGroupSubmitInfo-pWaitSemaphoreDeviceIndices-parameter"></a> <span class="vuid">VUID-VkDeviceGroupSubmitInfo-pWaitSemaphoreDeviceIndices-parameter</span><br>
 If <code>waitSemaphoreCount</code> is not <code>0</code>, <code>pWaitSemaphoreDeviceIndices</code> <strong>must</strong> be a valid pointer to an array of <code>waitSemaphoreCount</code> <code>uint32_t</code> values</p>
</li>
<li>
<p><a id="VUID-VkDeviceGroupSubmitInfo-pCommandBufferDeviceMasks-parameter" href="#VUID-VkDeviceGroupSubmitInfo-pCommandBufferDeviceMasks-parameter"></a> <span class="vuid">VUID-VkDeviceGroupSubmitInfo-pCommandBufferDeviceMasks-parameter</span><br>
 If <code>commandBufferCount</code> is not <code>0</code>, <code>pCommandBufferDeviceMasks</code> <strong>must</strong> be a valid pointer to an array of <code>commandBufferCount</code> <code>uint32_t</code> values</p>
</li>
<li>
<p><a id="VUID-VkDeviceGroupSubmitInfo-pSignalSemaphoreDeviceIndices-parameter" href="#VUID-VkDeviceGroupSubmitInfo-pSignalSemaphoreDeviceIndices-parameter"></a> <span class="vuid">VUID-VkDeviceGroupSubmitInfo-pSignalSemaphoreDeviceIndices-parameter</span><br>
 If <code>signalSemaphoreCount</code> is not <code>0</code>, <code>pSignalSemaphoreDeviceIndices</code> <strong>must</strong> be a valid pointer to an array of <code>signalSemaphoreCount</code> <code>uint32_t</code> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If the <code>pNext</code> chain of <a href="#VkSubmitInfo">VkSubmitInfo</a> includes a
<a href="#VkPerformanceQuerySubmitInfoKHR">VkPerformanceQuerySubmitInfoKHR</a> structure, then the structure
indicates which counter pass is active for the batch in that submit.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPerformanceQuerySubmitInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkPerformanceQuerySubmitInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_performance_query
typedef struct VkPerformanceQuerySubmitInfoKHR {
    VkStructureType    sType;
    const void*        pNext;
    uint32_t           counterPassIndex;
} VkPerformanceQuerySubmitInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>counterPassIndex</code> specifies which counter pass index is active.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <code>VkSubmitInfo</code>::<code>pNext</code> chain does not include this
structure, the batch defaults to use counter pass index 0.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPerformanceQuerySubmitInfoKHR-counterPassIndex-03221" href="#VUID-VkPerformanceQuerySubmitInfoKHR-counterPassIndex-03221"></a> <span class="vuid">VUID-VkPerformanceQuerySubmitInfoKHR-counterPassIndex-03221</span><br>

<code>counterPassIndex</code> <strong>must</strong> be less than the number of counter passes
required by any queries within the batch.
The required number of counter passes for a performance query is
obtained by calling
<a href="queries.html#vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR" class="xref page">vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPerformanceQuerySubmitInfoKHR-sType-sType" href="#VUID-VkPerformanceQuerySubmitInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkPerformanceQuerySubmitInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_PERFORMANCE_QUERY_SUBMIT_INFO_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="commandbuffers-submission-progress"><a class="anchor" href="#commandbuffers-submission-progress"></a>Queue Forward Progress</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When using binary semaphores, the application <strong>must</strong> ensure that command
buffer submissions will be able to complete without any subsequent
operations by the application on any queue.
After any call to <code>vkQueueSubmit</code> (or other queue operation), for every
queued wait on a semaphore
created with a <a href="synchronization.html#VkSemaphoreType" class="xref page">VkSemaphoreType</a> of <code>VK_SEMAPHORE_TYPE_BINARY</code>
there <strong>must</strong> be a prior signal of that semaphore that will not be consumed by
a different wait on the semaphore.</p>
</div>
<div class="paragraph">
<p>When using timeline semaphores, wait-before-signal behavior is well-defined
and applications <strong>can</strong> submit work via <code>vkQueueSubmit</code> defining a
<a href="synchronization.html#synchronization-semaphores-waiting" class="xref page">timeline semaphore wait operation</a>
before submitting a corresponding <a href="synchronization.html#synchronization-semaphores-signaling" class="xref page">semaphore signal operation</a>.
For each <a href="synchronization.html#synchronization-semaphores-waiting" class="xref page">timeline semaphore wait operation</a> defined by a call to <code>vkQueueSubmit</code>, the application <strong>must</strong>
ensure that a corresponding <a href="synchronization.html#synchronization-semaphores-signaling" class="xref page">semaphore signal operation</a> is executed before forward progress can be
made.</p>
</div>
<div class="paragraph">
<p>If a command buffer submission waits for any events to be signaled, the
application <strong>must</strong> ensure that command buffer submissions will be able to
complete without any subsequent operations by the application.
Events signaled by the host <strong>must</strong> be signaled before the command buffer
waits on those events.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The ability for commands to wait on the host to set an events was originally
added to allow low-latency updates to resources between host and device.
However, to ensure quality of service, implementations would necessarily
detect extended stalls in execution and timeout after a short period.
As this period is not defined in the Vulkan specification, it is impossible
to correctly validate any application with any wait period.
Since the original users of this functionality were highly limited and
platform-specific, this functionality is now considered defunct and should
not be used.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="commandbuffers-secondary"><a class="anchor" href="#commandbuffers-secondary"></a>Secondary Command Buffer Execution</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Secondary command buffers <strong>must</strong> not be directly submitted to a queue.
To record a secondary command buffer to execute as part of a primary command
buffer, call:</p>
</div>
<div id="vkCmdExecuteCommands" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkCmdExecuteCommands(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    commandBufferCount,
    const VkCommandBuffer*                      pCommandBuffers);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is a handle to a primary command buffer that the
secondary command buffers are executed in.</p>
</li>
<li>
<p><code>commandBufferCount</code> is the length of the <code>pCommandBuffers</code>
array.</p>
</li>
<li>
<p><code>pCommandBuffers</code> is a pointer to an array of
<code>commandBufferCount</code> secondary command buffer handles, which are
recorded to execute in the primary command buffer in the order they are
listed in the array.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If any element of <code>pCommandBuffers</code> was not recorded with the
<code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code> flag, and it was recorded
into any other primary command buffer which is currently in the
<a href="#commandbuffers-lifecycle">executable or recording state</a>, that primary
command buffer becomes <a href="#commandbuffers-lifecycle">invalid</a>.</p>
</div>
<div class="paragraph">
<p>If the <a href="features.html#features-nestedCommandBuffer" class="xref page"><code>nestedCommandBuffer</code></a> feature
is enabled it is valid usage for <code>vkCmdExecuteCommands</code> to also be
recorded to a <a href="../appendices/glossary.html#glossary" class="xref page">secondary command buffer</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00088" href="#VUID-vkCmdExecuteCommands-pCommandBuffers-00088"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pCommandBuffers-00088</span><br>

Each element of <code>pCommandBuffers</code> <strong>must</strong> have been allocated with a
<code>level</code> of <code>VK_COMMAND_BUFFER_LEVEL_SECONDARY</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00089" href="#VUID-vkCmdExecuteCommands-pCommandBuffers-00089"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pCommandBuffers-00089</span><br>

Each element of <code>pCommandBuffers</code> <strong>must</strong> be in the
<a href="#commandbuffers-lifecycle">pending or executable state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00091" href="#VUID-vkCmdExecuteCommands-pCommandBuffers-00091"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pCommandBuffers-00091</span><br>

If any element of <code>pCommandBuffers</code> was not recorded with the
<code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code> flag, it <strong>must</strong> not be
in the <a href="#commandbuffers-lifecycle">pending state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00092" href="#VUID-vkCmdExecuteCommands-pCommandBuffers-00092"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pCommandBuffers-00092</span><br>

If any element of <code>pCommandBuffers</code> was not recorded with the
<code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code> flag, it <strong>must</strong> not
have already been recorded to <code>commandBuffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00093" href="#VUID-vkCmdExecuteCommands-pCommandBuffers-00093"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pCommandBuffers-00093</span><br>

If any element of <code>pCommandBuffers</code> was not recorded with the
<code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code> flag, it <strong>must</strong> not
appear more than once in <code>pCommandBuffers</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00094" href="#VUID-vkCmdExecuteCommands-pCommandBuffers-00094"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pCommandBuffers-00094</span><br>

Each element of <code>pCommandBuffers</code> <strong>must</strong> have been allocated from a
<code>VkCommandPool</code> that was created for the same queue family as the
<code>VkCommandPool</code> from which <code>commandBuffer</code> was allocated</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00096" href="#VUID-vkCmdExecuteCommands-pCommandBuffers-00096"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pCommandBuffers-00096</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance, each element of <code>pCommandBuffers</code> <strong>must</strong> have been recorded
with the <code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00099" href="#VUID-vkCmdExecuteCommands-pCommandBuffers-00099"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pCommandBuffers-00099</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance, and any element of <code>pCommandBuffers</code> was recorded with
<a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a>::<code>framebuffer</code> not equal to
<a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, that <code>VkFramebuffer</code> <strong>must</strong> match the
<code>VkFramebuffer</code> used in the current render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-contents-09680" href="#VUID-vkCmdExecuteCommands-contents-09680"></a> <span class="vuid">VUID-vkCmdExecuteCommands-contents-09680</span><br>

    If <code>vkCmdExecuteCommands</code> is being called within a render pass
    instance begun with <a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">vkCmdBeginRenderPass</a>, and
    <a href="renderpass.html#vkCmdNextSubpass" class="xref page">vkCmdNextSubpass</a> has not been called in the current render pass
    instance, the <code>contents</code> parameter of <a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">vkCmdBeginRenderPass</a>
    <strong>must</strong> have been <code>VK_SUBPASS_CONTENTS_SECONDARY_COMMAND_BUFFERS</code>
, or <code>VK_SUBPASS_CONTENTS_INLINE_AND_SECONDARY_COMMAND_BUFFERS_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-None-09681" href="#VUID-vkCmdExecuteCommands-None-09681"></a> <span class="vuid">VUID-vkCmdExecuteCommands-None-09681</span><br>

    If <code>vkCmdExecuteCommands</code> is being called within a render pass
    instance begun with <a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">vkCmdBeginRenderPass</a>, and
    <a href="renderpass.html#vkCmdNextSubpass" class="xref page">vkCmdNextSubpass</a> has been called in the current render pass
    instance, the <code>contents</code> parameter of the last call to
    <a href="renderpass.html#vkCmdNextSubpass" class="xref page">vkCmdNextSubpass</a> <strong>must</strong> have been
    <code>VK_SUBPASS_CONTENTS_SECONDARY_COMMAND_BUFFERS</code>
, or <code>VK_SUBPASS_CONTENTS_INLINE_AND_SECONDARY_COMMAND_BUFFERS_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-06019" href="#VUID-vkCmdExecuteCommands-pCommandBuffers-06019"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pCommandBuffers-06019</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">vkCmdBeginRenderPass</a>, each element of
<code>pCommandBuffers</code> <strong>must</strong> have been recorded with
<a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a>::<code>subpass</code> set to the index of
the subpass which the given command buffer will be executed in</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pBeginInfo-06020" href="#VUID-vkCmdExecuteCommands-pBeginInfo-06020"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pBeginInfo-06020</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">vkCmdBeginRenderPass</a>, the render passes
specified in the <code>pBeginInfo-&gt;pInheritanceInfo&#8594;renderPass</code> members
of the <a href="#vkBeginCommandBuffer">vkBeginCommandBuffer</a> commands used to begin recording each
element of <code>pCommandBuffers</code> <strong>must</strong> be
<a href="renderpass.html#renderpass-compatibility" class="xref page">compatible</a> with the current render pass</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pNext-02865" href="#VUID-vkCmdExecuteCommands-pNext-02865"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pNext-02865</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance that included <a href="renderpass.html#VkRenderPassTransformBeginInfoQCOM" class="xref page">VkRenderPassTransformBeginInfoQCOM</a> in the
<code>pNext</code> chain of <a href="renderpass.html#VkRenderPassBeginInfo" class="xref page">VkRenderPassBeginInfo</a>, then each element of
<code>pCommandBuffers</code> <strong>must</strong> have been recorded with
<a href="#VkCommandBufferInheritanceRenderPassTransformInfoQCOM">VkCommandBufferInheritanceRenderPassTransformInfoQCOM</a> in the
<code>pNext</code> chain of <a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pNext-02866" href="#VUID-vkCmdExecuteCommands-pNext-02866"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pNext-02866</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance that included <a href="renderpass.html#VkRenderPassTransformBeginInfoQCOM" class="xref page">VkRenderPassTransformBeginInfoQCOM</a> in the
<code>pNext</code> chain of <a href="renderpass.html#VkRenderPassBeginInfo" class="xref page">VkRenderPassBeginInfo</a>, then each element of
<code>pCommandBuffers</code> <strong>must</strong> have been recorded with
<a href="#VkCommandBufferInheritanceRenderPassTransformInfoQCOM">VkCommandBufferInheritanceRenderPassTransformInfoQCOM</a>::<code>transform</code>
identical to <a href="renderpass.html#VkRenderPassTransformBeginInfoQCOM" class="xref page">VkRenderPassTransformBeginInfoQCOM</a>::<code>transform</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pNext-02867" href="#VUID-vkCmdExecuteCommands-pNext-02867"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pNext-02867</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance that included <a href="renderpass.html#VkRenderPassTransformBeginInfoQCOM" class="xref page">VkRenderPassTransformBeginInfoQCOM</a> in the
<code>pNext</code> chain of <a href="renderpass.html#VkRenderPassBeginInfo" class="xref page">VkRenderPassBeginInfo</a>, then each element of
<code>pCommandBuffers</code> <strong>must</strong> have been recorded with
<a href="#VkCommandBufferInheritanceRenderPassTransformInfoQCOM">VkCommandBufferInheritanceRenderPassTransformInfoQCOM</a>::<code>renderArea</code>
identical to <a href="renderpass.html#VkRenderPassBeginInfo" class="xref page">VkRenderPassBeginInfo</a>::<code>renderArea</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00100" href="#VUID-vkCmdExecuteCommands-pCommandBuffers-00100"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pCommandBuffers-00100</span><br>

If <code>vkCmdExecuteCommands</code> is not being called within a render pass
instance, each element of <code>pCommandBuffers</code> <strong>must</strong> not have been
recorded with the <code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-00101" href="#VUID-vkCmdExecuteCommands-commandBuffer-00101"></a> <span class="vuid">VUID-vkCmdExecuteCommands-commandBuffer-00101</span><br>

If the <a href="features.html#features-inheritedQueries" class="xref page"><code>inheritedQueries</code></a> feature is
not enabled, <code>commandBuffer</code> <strong>must</strong> not have any queries
<a href="queries.html#queries-operation-active" class="xref page">active</a></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-00102" href="#VUID-vkCmdExecuteCommands-commandBuffer-00102"></a> <span class="vuid">VUID-vkCmdExecuteCommands-commandBuffer-00102</span><br>

If <code>commandBuffer</code> has a <code>VK_QUERY_TYPE_OCCLUSION</code> query
<a href="queries.html#queries-operation-active" class="xref page">active</a>, then each element of
<code>pCommandBuffers</code> <strong>must</strong> have been recorded with
<code>VkCommandBufferInheritanceInfo</code>::<code>occlusionQueryEnable</code> set to
<code>VK_TRUE</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-00103" href="#VUID-vkCmdExecuteCommands-commandBuffer-00103"></a> <span class="vuid">VUID-vkCmdExecuteCommands-commandBuffer-00103</span><br>

If <code>commandBuffer</code> has a <code>VK_QUERY_TYPE_OCCLUSION</code> query
<a href="queries.html#queries-operation-active" class="xref page">active</a>, then each element of
<code>pCommandBuffers</code> <strong>must</strong> have been recorded with
<code>VkCommandBufferInheritanceInfo</code>::<code>queryFlags</code> having all bits
set that are set for the query</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-00104" href="#VUID-vkCmdExecuteCommands-commandBuffer-00104"></a> <span class="vuid">VUID-vkCmdExecuteCommands-commandBuffer-00104</span><br>

If <code>commandBuffer</code> has a <code>VK_QUERY_TYPE_PIPELINE_STATISTICS</code>
query <a href="queries.html#queries-operation-active" class="xref page">active</a>, then each element of
<code>pCommandBuffers</code> <strong>must</strong> have been recorded with
<code>VkCommandBufferInheritanceInfo</code>::<code>pipelineStatistics</code> having
all bits set that are set in the <code>VkQueryPool</code> the query uses</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00105" href="#VUID-vkCmdExecuteCommands-pCommandBuffers-00105"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pCommandBuffers-00105</span><br>

Each element of <code>pCommandBuffers</code> <strong>must</strong> not begin any query types
that are <a href="queries.html#queries-operation-active" class="xref page">active</a> in <code>commandBuffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-07594" href="#VUID-vkCmdExecuteCommands-commandBuffer-07594"></a> <span class="vuid">VUID-vkCmdExecuteCommands-commandBuffer-07594</span><br>

<code>commandBuffer</code> <strong>must</strong> not have any queries other than
<code>VK_QUERY_TYPE_OCCLUSION</code> and
<code>VK_QUERY_TYPE_PIPELINE_STATISTICS</code>
<a href="queries.html#queries-operation-active" class="xref page">active</a></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-01820" href="#VUID-vkCmdExecuteCommands-commandBuffer-01820"></a> <span class="vuid">VUID-vkCmdExecuteCommands-commandBuffer-01820</span><br>

If <code>commandBuffer</code> is a protected command buffer and
<a href="devsandqueues.html#limits-protectedNoFault" class="xref page"><code>protectedNoFault</code></a> is not supported,
each element of <code>pCommandBuffers</code> <strong>must</strong> be a protected command
buffer</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-01821" href="#VUID-vkCmdExecuteCommands-commandBuffer-01821"></a> <span class="vuid">VUID-vkCmdExecuteCommands-commandBuffer-01821</span><br>

If <code>commandBuffer</code> is an unprotected command buffer and
<a href="devsandqueues.html#limits-protectedNoFault" class="xref page"><code>protectedNoFault</code></a> is not supported,
each element of <code>pCommandBuffers</code> <strong>must</strong> be an unprotected command
buffer</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-None-02286" href="#VUID-vkCmdExecuteCommands-None-02286"></a> <span class="vuid">VUID-vkCmdExecuteCommands-None-02286</span><br>

This command <strong>must</strong> not be recorded when transform feedback is active</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-06533" href="#VUID-vkCmdExecuteCommands-commandBuffer-06533"></a> <span class="vuid">VUID-vkCmdExecuteCommands-commandBuffer-06533</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance and any recorded command in <code>commandBuffer</code> in the current
subpass will write to an image subresource as an attachment, commands
recorded in elements of <code>pCommandBuffers</code> <strong>must</strong> not read from the
memory backing that image subresource in any other way</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-06534" href="#VUID-vkCmdExecuteCommands-commandBuffer-06534"></a> <span class="vuid">VUID-vkCmdExecuteCommands-commandBuffer-06534</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance and any recorded command in <code>commandBuffer</code> in the current
subpass will read from an image subresource used as an attachment in any
way other than as an attachment, commands recorded in elements of
<code>pCommandBuffers</code> <strong>must</strong> not write to that image subresource as an
attachment</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-06535" href="#VUID-vkCmdExecuteCommands-pCommandBuffers-06535"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pCommandBuffers-06535</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance and any recorded command in a given element of
<code>pCommandBuffers</code> will write to an image subresource as an
attachment, commands recorded in elements of <code>pCommandBuffers</code> at a
higher index <strong>must</strong> not read from the memory backing that image
subresource in any other way</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-06536" href="#VUID-vkCmdExecuteCommands-pCommandBuffers-06536"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pCommandBuffers-06536</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance and any recorded command in a given element of
<code>pCommandBuffers</code> will read from an image subresource used as an
attachment in any way other than as an attachment, commands recorded in
elements of <code>pCommandBuffers</code> at a higher index <strong>must</strong> not write to
that image subresource as an attachment</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-06021" href="#VUID-vkCmdExecuteCommands-pCommandBuffers-06021"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pCommandBuffers-06021</span><br>

If <code>pCommandBuffers</code> contains any <a href="renderpass.html#renderpass-suspension" class="xref page">suspended    render pass instances</a>, there <strong>must</strong> be no action or synchronization
commands between that render pass instance and any render pass instance
that resumes it</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-06022" href="#VUID-vkCmdExecuteCommands-pCommandBuffers-06022"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pCommandBuffers-06022</span><br>

If <code>pCommandBuffers</code> contains any <a href="renderpass.html#renderpass-suspension" class="xref page">suspended    render pass instances</a>, there <strong>must</strong> be no render pass instances between
that render pass instance and any render pass instance that resumes it</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-variableSampleLocations-06023" href="#VUID-vkCmdExecuteCommands-variableSampleLocations-06023"></a> <span class="vuid">VUID-vkCmdExecuteCommands-variableSampleLocations-06023</span><br>

If the <a href="limits.html#limits-variableSampleLocations" class="xref page"><code>variableSampleLocations</code></a>
limit is not supported, and any element of <code>pCommandBuffers</code>
contains any <a href="renderpass.html#renderpass-suspension" class="xref page">suspended render pass instances</a>,
where a graphics pipeline has been bound, any pipelines bound in the
render pass instance that resumes it, or any subsequent render pass
instances that resume from that one and so on, <strong>must</strong> use the same sample
locations</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-flags-06024" href="#VUID-vkCmdExecuteCommands-flags-06024"></a> <span class="vuid">VUID-vkCmdExecuteCommands-flags-06024</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a>, its
<a href="renderpass.html#VkRenderingInfo" class="xref page">VkRenderingInfo</a>::<code>flags</code> parameter <strong>must</strong> have included
<code>VK_RENDERING_CONTENTS_SECONDARY_COMMAND_BUFFERS_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pBeginInfo-06025" href="#VUID-vkCmdExecuteCommands-pBeginInfo-06025"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pBeginInfo-06025</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a>, the render passes
specified in the <code>pBeginInfo-&gt;pInheritanceInfo&#8594;renderPass</code> members
of the <a href="#vkBeginCommandBuffer">vkBeginCommandBuffer</a> commands used to begin recording each
element of <code>pCommandBuffers</code> <strong>must</strong> be <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-flags-06026" href="#VUID-vkCmdExecuteCommands-flags-06026"></a> <span class="vuid">VUID-vkCmdExecuteCommands-flags-06026</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a>, the <code>flags</code> member of
the <a href="#VkCommandBufferInheritanceRenderingInfo">VkCommandBufferInheritanceRenderingInfo</a> structure included in
the <code>pNext</code> chain of
<a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a>::<code>pInheritanceInfo</code> used to begin
recording each element of <code>pCommandBuffers</code> <strong>must</strong> be equal to the
<a href="renderpass.html#VkRenderingInfo" class="xref page">VkRenderingInfo</a>::<code>flags</code> parameter to
<a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a>, excluding
<code>VK_RENDERING_CONTENTS_SECONDARY_COMMAND_BUFFERS_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-colorAttachmentCount-06027" href="#VUID-vkCmdExecuteCommands-colorAttachmentCount-06027"></a> <span class="vuid">VUID-vkCmdExecuteCommands-colorAttachmentCount-06027</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a>, the
<code>colorAttachmentCount</code> member of the
<a href="#VkCommandBufferInheritanceRenderingInfo">VkCommandBufferInheritanceRenderingInfo</a> structure included in the
<code>pNext</code> chain of
<a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a>::<code>pInheritanceInfo</code> used to begin
recording each element of <code>pCommandBuffers</code> <strong>must</strong> be equal to the
<a href="renderpass.html#VkRenderingInfo" class="xref page">VkRenderingInfo</a>::<code>colorAttachmentCount</code> parameter to
<a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-imageView-06028" href="#VUID-vkCmdExecuteCommands-imageView-06028"></a> <span class="vuid">VUID-vkCmdExecuteCommands-imageView-06028</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a>, if the <code>imageView</code>
member of an element of the
<a href="renderpass.html#VkRenderingInfo" class="xref page">VkRenderingInfo</a>::<code>pColorAttachments</code> parameter to
<a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, the corresponding
element of the <code>pColorAttachmentFormats</code> member of the
<a href="#VkCommandBufferInheritanceRenderingInfo">VkCommandBufferInheritanceRenderingInfo</a> structure included in the
<code>pNext</code> chain of
<a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a>::<code>pInheritanceInfo</code> used to begin
recording each element of <code>pCommandBuffers</code> <strong>must</strong> be equal to the
format used to create that image view</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-imageView-07606" href="#VUID-vkCmdExecuteCommands-imageView-07606"></a> <span class="vuid">VUID-vkCmdExecuteCommands-imageView-07606</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a>, if the <code>imageView</code>
member of an element of the
<a href="renderpass.html#VkRenderingInfo" class="xref page">VkRenderingInfo</a>::<code>pColorAttachments</code> parameter to
<a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> is <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, the corresponding
element of the <code>pColorAttachmentFormats</code> member of the
<a href="#VkCommandBufferInheritanceRenderingInfo">VkCommandBufferInheritanceRenderingInfo</a> structure included in the
<code>pNext</code> chain of
<a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a>::<code>pInheritanceInfo</code> used to begin
recording each element of <code>pCommandBuffers</code> <strong>must</strong> be
<code>VK_FORMAT_UNDEFINED</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pDepthAttachment-06029" href="#VUID-vkCmdExecuteCommands-pDepthAttachment-06029"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pDepthAttachment-06029</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a>, if the
<a href="renderpass.html#VkRenderingInfo" class="xref page">VkRenderingInfo</a>::<code>pDepthAttachment-&gt;imageView</code> parameter to
<a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, the value of the
<code>depthAttachmentFormat</code> member of the
<a href="#VkCommandBufferInheritanceRenderingInfo">VkCommandBufferInheritanceRenderingInfo</a> structure included in the
<code>pNext</code> chain of
<a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a>::<code>pInheritanceInfo</code> used to begin
recording each element of <code>pCommandBuffers</code> <strong>must</strong> be equal to the
format used to create that image view</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pStencilAttachment-06030" href="#VUID-vkCmdExecuteCommands-pStencilAttachment-06030"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pStencilAttachment-06030</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a>, if the
<a href="renderpass.html#VkRenderingInfo" class="xref page">VkRenderingInfo</a>::<code>pStencilAttachment-&gt;imageView</code> parameter to
<a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, the value of the
<code>stencilAttachmentFormat</code> member of the
<a href="#VkCommandBufferInheritanceRenderingInfo">VkCommandBufferInheritanceRenderingInfo</a> structure included in the
<code>pNext</code> chain of
<a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a>::<code>pInheritanceInfo</code> used to begin
recording each element of <code>pCommandBuffers</code> <strong>must</strong> be equal to the
format used to create that image view</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pDepthAttachment-06774" href="#VUID-vkCmdExecuteCommands-pDepthAttachment-06774"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pDepthAttachment-06774</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> and the
<a href="renderpass.html#VkRenderingInfo" class="xref page">VkRenderingInfo</a>::<code>pDepthAttachment-&gt;imageView</code> parameter to
<a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> was <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, the value of the
<code>depthAttachmentFormat</code> member of the
<a href="#VkCommandBufferInheritanceRenderingInfo">VkCommandBufferInheritanceRenderingInfo</a> structure included in the
<code>pNext</code> chain of
<a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a>::<code>pInheritanceInfo</code> used to begin
recording each element of <code>pCommandBuffers</code> <strong>must</strong> be
<code>VK_FORMAT_UNDEFINED</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pStencilAttachment-06775" href="#VUID-vkCmdExecuteCommands-pStencilAttachment-06775"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pStencilAttachment-06775</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> and the
<a href="renderpass.html#VkRenderingInfo" class="xref page">VkRenderingInfo</a>::<code>pStencilAttachment-&gt;imageView</code> parameter to
<a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> was <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, the value of the
<code>stencilAttachmentFormat</code> member of the
<a href="#VkCommandBufferInheritanceRenderingInfo">VkCommandBufferInheritanceRenderingInfo</a> structure included in the
<code>pNext</code> chain of
<a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a>::<code>pInheritanceInfo</code> used to begin
recording each element of <code>pCommandBuffers</code> <strong>must</strong> be
<code>VK_FORMAT_UNDEFINED</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-viewMask-06031" href="#VUID-vkCmdExecuteCommands-viewMask-06031"></a> <span class="vuid">VUID-vkCmdExecuteCommands-viewMask-06031</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a>, the <code>viewMask</code> member
of the <a href="#VkCommandBufferInheritanceRenderingInfo">VkCommandBufferInheritanceRenderingInfo</a> structure included
in the <code>pNext</code> chain of
<a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a>::<code>pInheritanceInfo</code> used to begin
recording each element of <code>pCommandBuffers</code> <strong>must</strong> be equal to the
<a href="renderpass.html#VkRenderingInfo" class="xref page">VkRenderingInfo</a>::<code>viewMask</code> parameter to
<a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pNext-06032" href="#VUID-vkCmdExecuteCommands-pNext-06032"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pNext-06032</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> and the <code>pNext</code> chain
of <a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a> includes a
<a href="#VkAttachmentSampleCountInfoAMD">VkAttachmentSampleCountInfoAMD</a> or
<a href="#VkAttachmentSampleCountInfoNV">VkAttachmentSampleCountInfoNV</a> structure, if the <code>imageView</code>
member of an element of the
<a href="renderpass.html#VkRenderingInfo" class="xref page">VkRenderingInfo</a>::<code>pColorAttachments</code> parameter to
<a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, the corresponding
element of the <code>pColorAttachmentSamples</code> member of the
<a href="#VkAttachmentSampleCountInfoAMD">VkAttachmentSampleCountInfoAMD</a> or
<a href="#VkAttachmentSampleCountInfoNV">VkAttachmentSampleCountInfoNV</a> structure included in the
<code>pNext</code> chain of
<a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a>::<code>pInheritanceInfo</code> used to begin
recording each element of <code>pCommandBuffers</code> <strong>must</strong> be equal to the
sample count used to create that image view</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pNext-06033" href="#VUID-vkCmdExecuteCommands-pNext-06033"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pNext-06033</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> and the <code>pNext</code> chain
of <a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a> includes a
<a href="#VkAttachmentSampleCountInfoAMD">VkAttachmentSampleCountInfoAMD</a> or
<a href="#VkAttachmentSampleCountInfoNV">VkAttachmentSampleCountInfoNV</a> structure, if the
<a href="renderpass.html#VkRenderingInfo" class="xref page">VkRenderingInfo</a>::<code>pDepthAttachment-&gt;imageView</code> parameter to
<a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, the value of the
<code>depthStencilAttachmentSamples</code> member of the
<a href="#VkAttachmentSampleCountInfoAMD">VkAttachmentSampleCountInfoAMD</a> or
<a href="#VkAttachmentSampleCountInfoNV">VkAttachmentSampleCountInfoNV</a> structure included in the
<code>pNext</code> chain of
<a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a>::<code>pInheritanceInfo</code> used to begin
recording each element of <code>pCommandBuffers</code> <strong>must</strong> be equal to the
sample count used to create that image view</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pNext-06034" href="#VUID-vkCmdExecuteCommands-pNext-06034"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pNext-06034</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> and the <code>pNext</code> chain
of <a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a> includes a
<a href="#VkAttachmentSampleCountInfoAMD">VkAttachmentSampleCountInfoAMD</a> or
<a href="#VkAttachmentSampleCountInfoNV">VkAttachmentSampleCountInfoNV</a> structure, if the
<a href="renderpass.html#VkRenderingInfo" class="xref page">VkRenderingInfo</a>::<code>pStencilAttachment-&gt;imageView</code> parameter to
<a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, the value of the
<code>depthStencilAttachmentSamples</code> member of the
<a href="#VkAttachmentSampleCountInfoAMD">VkAttachmentSampleCountInfoAMD</a> or
<a href="#VkAttachmentSampleCountInfoNV">VkAttachmentSampleCountInfoNV</a> structure included in the
<code>pNext</code> chain of
<a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a>::<code>pInheritanceInfo</code> used to begin
recording each element of <code>pCommandBuffers</code> <strong>must</strong> be equal to the
sample count used to create that image view</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pNext-06035" href="#VUID-vkCmdExecuteCommands-pNext-06035"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pNext-06035</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> and the <code>pNext</code> chain
of <a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a> does not include a
<a href="#VkAttachmentSampleCountInfoAMD">VkAttachmentSampleCountInfoAMD</a> or
<a href="#VkAttachmentSampleCountInfoNV">VkAttachmentSampleCountInfoNV</a> structure, if the <code>imageView</code>
member of an element of the
<a href="renderpass.html#VkRenderingInfo" class="xref page">VkRenderingInfo</a>::<code>pColorAttachments</code> parameter to
<a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, the value of
<a href="#VkCommandBufferInheritanceRenderingInfo">VkCommandBufferInheritanceRenderingInfo</a>::<code>rasterizationSamples</code>
<strong>must</strong> be equal to the sample count used to create that image view</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pNext-06036" href="#VUID-vkCmdExecuteCommands-pNext-06036"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pNext-06036</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> and the <code>pNext</code> chain
of <a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a> does not include a
<a href="#VkAttachmentSampleCountInfoAMD">VkAttachmentSampleCountInfoAMD</a> or
<a href="#VkAttachmentSampleCountInfoNV">VkAttachmentSampleCountInfoNV</a> structure, if the
<a href="renderpass.html#VkRenderingInfo" class="xref page">VkRenderingInfo</a>::<code>pDepthAttachment-&gt;imageView</code> parameter to
<a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, the value of
<a href="#VkCommandBufferInheritanceRenderingInfo">VkCommandBufferInheritanceRenderingInfo</a>::<code>rasterizationSamples</code>
<strong>must</strong> be equal to the sample count used to create that image view</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pNext-06037" href="#VUID-vkCmdExecuteCommands-pNext-06037"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pNext-06037</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> and the <code>pNext</code> chain
of <a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a> does not include a
<a href="#VkAttachmentSampleCountInfoAMD">VkAttachmentSampleCountInfoAMD</a> or
<a href="#VkAttachmentSampleCountInfoNV">VkAttachmentSampleCountInfoNV</a> structure, if the
<a href="renderpass.html#VkRenderingInfo" class="xref page">VkRenderingInfo</a>::<code>pStencilAttachment-&gt;imageView</code> parameter to
<a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, the value of
<a href="#VkCommandBufferInheritanceRenderingInfo">VkCommandBufferInheritanceRenderingInfo</a>::<code>rasterizationSamples</code>
<strong>must</strong> be equal to the sample count used to create that image view</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pNext-09299" href="#VUID-vkCmdExecuteCommands-pNext-09299"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pNext-09299</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a>, with any color attachment
using a resolve mode of
<code>VK_RESOLVE_MODE_EXTERNAL_FORMAT_DOWNSAMPLE_ANDROID</code>, the
<code>pNext</code> chain of <a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a> used to create
each element of <code>pCommandBuffers</code> <strong>must</strong> include a
<a href="resources.html#VkExternalFormatANDROID" class="xref page">VkExternalFormatANDROID</a> structure with an <code>externalFormat</code>
matching that used to create the resolve attachment in the render pass</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pNext-09300" href="#VUID-vkCmdExecuteCommands-pNext-09300"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pNext-09300</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a> with any color attachment
using a resolve mode of
<code>VK_RESOLVE_MODE_EXTERNAL_FORMAT_DOWNSAMPLE_ANDROID</code>, and the
<code>pNext</code> chain of <a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a> does not
include a <a href="#VkAttachmentSampleCountInfoAMD">VkAttachmentSampleCountInfoAMD</a> or
<a href="#VkAttachmentSampleCountInfoNV">VkAttachmentSampleCountInfoNV</a> structure, the value of
<a href="#VkCommandBufferInheritanceRenderingInfo">VkCommandBufferInheritanceRenderingInfo</a>::<code>rasterizationSamples</code>
<strong>must</strong> be <code>VK_SAMPLE_COUNT_1_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-09375" href="#VUID-vkCmdExecuteCommands-commandBuffer-09375"></a> <span class="vuid">VUID-vkCmdExecuteCommands-commandBuffer-09375</span><br>

<code>commandBuffer</code> <strong>must</strong> not be a <a href="../appendices/glossary.html#glossary" class="xref page">secondary command    buffer</a>
unless the <a href="features.html#features-nestedCommandBuffer" class="xref page"><code>nestedCommandBuffer</code></a>
feature is enabled</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-nestedCommandBuffer-09376" href="#VUID-vkCmdExecuteCommands-nestedCommandBuffer-09376"></a> <span class="vuid">VUID-vkCmdExecuteCommands-nestedCommandBuffer-09376</span><br>

If the <a href="features.html#features-nestedCommandBuffer" class="xref page"><code>nestedCommandBuffer</code></a>
feature is enabled, and <code>commandBuffer</code> is a <a href="../appendices/glossary.html#glossary" class="xref page">secondary    command buffer</a>, the <a href="../appendices/glossary.html#glossary" class="xref page">command buffer nesting level</a> of each
element of <code>pCommandBuffers</code> <strong>must</strong> be less than
<a href="limits.html#limits-maxCommandBufferNestingLevel" class="xref page">    <code>maxCommandBufferNestingLevel</code></a></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-nestedCommandBufferRendering-09377" href="#VUID-vkCmdExecuteCommands-nestedCommandBufferRendering-09377"></a> <span class="vuid">VUID-vkCmdExecuteCommands-nestedCommandBufferRendering-09377</span><br>

If the <a href="features.html#features-nestedCommandBufferRendering" class="xref page">    <code>nestedCommandBufferRendering</code></a> feature is not enabled, and
<code>commandBuffer</code> is a <a href="../appendices/glossary.html#glossary" class="xref page">secondary command buffer</a>,
<code>commandBuffer</code> <strong>must</strong> not have been recorded with
<code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-nestedCommandBufferSimultaneousUse-09378" href="#VUID-vkCmdExecuteCommands-nestedCommandBufferSimultaneousUse-09378"></a> <span class="vuid">VUID-vkCmdExecuteCommands-nestedCommandBufferSimultaneousUse-09378</span><br>

If the <a href="features.html#features-nestedCommandBufferSimultaneousUse" class="xref page">    <code>nestedCommandBufferSimultaneousUse</code></a> feature is not enabled, and
<code>commandBuffer</code> is a <a href="../appendices/glossary.html#glossary" class="xref page">secondary command buffer</a>, each
element of <code>pCommandBuffers</code> <strong>must</strong> not have been recorded with
<code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-09504" href="#VUID-vkCmdExecuteCommands-pCommandBuffers-09504"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pCommandBuffers-09504</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a>, the color attachment
mapping state specified by <a href="interfaces.html#VkRenderingAttachmentLocationInfo" class="xref page">VkRenderingAttachmentLocationInfo</a> in
the inheritance info of each element of <code>pCommandBuffers</code> and in the
current state of <code>commandBuffer</code> <strong>must</strong> match</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-09505" href="#VUID-vkCmdExecuteCommands-pCommandBuffers-09505"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pCommandBuffers-09505</span><br>

If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance begun with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a>, the input attachment
mapping state specified by <a href="interfaces.html#VkRenderingInputAttachmentIndexInfo" class="xref page">VkRenderingInputAttachmentIndexInfo</a> in
the inheritance info of each element of <code>pCommandBuffers</code> and in the
current state of <code>commandBuffer</code> <strong>must</strong> match</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-parameter" href="#VUID-vkCmdExecuteCommands-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdExecuteCommands-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-parameter" href="#VUID-vkCmdExecuteCommands-pCommandBuffers-parameter"></a> <span class="vuid">VUID-vkCmdExecuteCommands-pCommandBuffers-parameter</span><br>
 <code>pCommandBuffers</code> <strong>must</strong> be a valid pointer to an array of <code>commandBufferCount</code> valid <a href="#VkCommandBuffer">VkCommandBuffer</a> handles</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-recording" href="#VUID-vkCmdExecuteCommands-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdExecuteCommands-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-cmdpool" href="#VUID-vkCmdExecuteCommands-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdExecuteCommands-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support transfer, graphics, or compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-videocoding" href="#VUID-vkCmdExecuteCommands-videocoding"></a> <span class="vuid">VUID-vkCmdExecuteCommands-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBufferCount-arraylength" href="#VUID-vkCmdExecuteCommands-commandBufferCount-arraylength"></a> <span class="vuid">VUID-vkCmdExecuteCommands-commandBufferCount-arraylength</span><br>
 <code>commandBufferCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commonparent" href="#VUID-vkCmdExecuteCommands-commonparent"></a> <span class="vuid">VUID-vkCmdExecuteCommands-commonparent</span><br>
 Both of <code>commandBuffer</code>, and the elements of <code>pCommandBuffers</code> <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="videocoding.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transfer<br>
Graphics<br>
Compute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indirection</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="commandbuffers-nested"><a class="anchor" href="#commandbuffers-nested"></a>Nested Command Buffers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In addition to secondary command buffer execution from primary command
buffers, an implementation <strong>may</strong> support <a href="../appendices/glossary.html#glossary" class="xref page">nested command buffers</a>, which enable secondary command buffers to be executed from other
secondary command buffers.
If the <a href="features.html#features-nestedCommandBuffer" class="xref page"><code>nestedCommandBuffer</code></a> feature
is enabled, the implementation supports <a href="../appendices/glossary.html#glossary" class="xref page">nested command buffers</a>.</p>
</div>
<div class="paragraph">
<p>Nested command buffer execution works the same as primary-to-secondary
execution, except that it is subject to some additional
implementation-defined limits.</p>
</div>
<div class="paragraph">
<p>Each secondary command buffer has a <a href="../appendices/glossary.html#glossary" class="xref page">command buffer nesting level</a>, which is determined at <a href="#vkEndCommandBuffer">vkEndCommandBuffer</a> time and evaluated
at <a href="#vkCmdExecuteCommands">vkCmdExecuteCommands</a> time.
A secondary command buffer that executes no other secondary command buffers
has a <a href="../appendices/glossary.html#glossary" class="xref page">command buffer nesting level</a> of zero.
Otherwise, the <a href="../appendices/glossary.html#glossary" class="xref page">command buffer nesting level</a> of a secondary
command buffer is equal to the maximum nesting level of all secondary
command buffers executed by that command buffer plus one.
Some implementations <strong>may</strong> have a limit on the maximum nesting level of
secondary command buffers that <strong>can</strong> be recorded.
This limit is advertised in <a href="limits.html#limits-maxCommandBufferNestingLevel" class="xref page"><code>maxCommandBufferNestingLevel</code></a>.</p>
</div>
<div class="paragraph">
<p>If the <a href="features.html#features-nestedCommandBufferRendering" class="xref page"><code>nestedCommandBufferRendering</code></a> feature is enabled, the implementation
supports calling <a href="#vkCmdExecuteCommands">vkCmdExecuteCommands</a> inside secondary command buffers
recorded with <code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code>.
If the <a href="features.html#features-nestedCommandBufferSimultaneousUse" class="xref page"><code>nestedCommandBufferSimultaneousUse</code></a> feature is enabled, the
implementation supports calling <a href="#vkCmdExecuteCommands">vkCmdExecuteCommands</a> with secondary
command buffers recorded with
<code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code>.</p>
</div>
<div class="paragraph">
<p>Whenever <a href="#vkCmdExecuteCommands">vkCmdExecuteCommands</a> is recorded inside a secondary command
buffer recorded with <code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code>,
each member of <code>pCommandBuffers</code> <strong>must</strong> have been recorded with a
<a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a> with <a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a>
compatible with the <a href="#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a> of the command
buffer into which the <a href="#vkCmdExecuteCommands">vkCmdExecuteCommands</a> call is being recorded.
The <a href="#VkCommandBufferInheritanceRenderingInfo">VkCommandBufferInheritanceRenderingInfo</a> structures are compatible
when the <code>VkCommandBufferInheritanceRenderingInfo</code>::<code>renderpass</code> are
<a href="renderpass.html#renderpass-compatibility" class="xref page">compatible</a>, or if they are
<a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a> then the <a href="#VkCommandBufferInheritanceRenderingInfo">VkCommandBufferInheritanceRenderingInfo</a>
members match, and all other members of
<code>VkCommandBufferInheritanceRenderingInfo</code> match.
This requirement applies recursively, down to the most nested command buffer
and up to the command buffer where the render pass was originally begun.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="commandbuffers-devicemask"><a class="anchor" href="#commandbuffers-devicemask"></a>Command Buffer Device Mask</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Each command buffer has a piece of state storing the current device mask of
the command buffer.
This mask controls which physical devices within the logical device all
subsequent commands will execute on, including state-setting commands,
action commands, and synchronization commands.</p>
</div>
<div class="paragraph">
<p>Scissor, exclusive scissor,
and viewport state
(excluding the count of each)
<strong>can</strong> be different values on each physical device (only when set as dynamic
state), and each physical device will render using its local copy of the
state.
Other state is shared between physical devices, such that all physical
devices use the most recently set values for the state.
However, when recording an action command that uses a piece of state, the
most recent command that set that state <strong>must</strong> have included all physical
devices that execute the action command in its current device mask.</p>
</div>
<div class="paragraph">
<p>The command buffer&#8217;s device mask is orthogonal to the
<code>pCommandBufferDeviceMasks</code> member of <a href="#VkDeviceGroupSubmitInfo">VkDeviceGroupSubmitInfo</a>.
Commands only execute on a physical device if the device index is set in
both device masks.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the <code>pNext</code> chain of <a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a> includes a
<code>VkDeviceGroupCommandBufferBeginInfo</code> structure, then that structure
includes an initial device mask for the command buffer.</p>
</div>
<div class="paragraph">
<p>The <code>VkDeviceGroupCommandBufferBeginInfo</code> structure is defined as:</p>
</div>
<div id="VkDeviceGroupCommandBufferBeginInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_1
typedef struct VkDeviceGroupCommandBufferBeginInfo {
    VkStructureType    sType;
    const void*        pNext;
    uint32_t           deviceMask;
} VkDeviceGroupCommandBufferBeginInfo;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkDeviceGroupCommandBufferBeginInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_device_group
typedef VkDeviceGroupCommandBufferBeginInfo VkDeviceGroupCommandBufferBeginInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>deviceMask</code> is the initial value of the command buffer&#8217;s device
mask.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The initial device mask also acts as an upper bound on the set of devices
that <strong>can</strong> ever be in the device mask in the command buffer.</p>
</div>
<div class="paragraph">
<p>If this structure is not present, the initial value of a command buffer&#8217;s
device mask includes all physical devices in the logical device when the
command buffer begins recording.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkDeviceGroupCommandBufferBeginInfo-deviceMask-00106" href="#VUID-VkDeviceGroupCommandBufferBeginInfo-deviceMask-00106"></a> <span class="vuid">VUID-VkDeviceGroupCommandBufferBeginInfo-deviceMask-00106</span><br>

<code>deviceMask</code> <strong>must</strong> be a valid device mask value</p>
</li>
<li>
<p><a id="VUID-VkDeviceGroupCommandBufferBeginInfo-deviceMask-00107" href="#VUID-VkDeviceGroupCommandBufferBeginInfo-deviceMask-00107"></a> <span class="vuid">VUID-VkDeviceGroupCommandBufferBeginInfo-deviceMask-00107</span><br>

<code>deviceMask</code> <strong>must</strong> not be zero</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkDeviceGroupCommandBufferBeginInfo-sType-sType" href="#VUID-VkDeviceGroupCommandBufferBeginInfo-sType-sType"></a> <span class="vuid">VUID-VkDeviceGroupCommandBufferBeginInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_DEVICE_GROUP_COMMAND_BUFFER_BEGIN_INFO</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To update the current device mask of a command buffer, call:</p>
</div>
<div id="vkCmdSetDeviceMask" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_1
void vkCmdSetDeviceMask(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    deviceMask);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent command</p>
</div>
<div id="vkCmdSetDeviceMaskKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_device_group
void vkCmdSetDeviceMaskKHR(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    deviceMask);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is command buffer whose current device mask is
modified.</p>
</li>
<li>
<p><code>deviceMask</code> is the new value of the current device mask.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>deviceMask</code> is used to filter out subsequent commands from executing on
all physical devices whose bit indices are not set in the mask, except
commands beginning a render pass instance, commands transitioning to the
next subpass in the render pass instance, and commands ending a render pass
instance, which always execute on the set of physical devices whose bit
indices are included in the <code>deviceMask</code> member of the
<a href="renderpass.html#VkDeviceGroupRenderPassBeginInfo" class="xref page">VkDeviceGroupRenderPassBeginInfo</a> structure passed to the command
beginning the corresponding render pass instance.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetDeviceMask-deviceMask-00108" href="#VUID-vkCmdSetDeviceMask-deviceMask-00108"></a> <span class="vuid">VUID-vkCmdSetDeviceMask-deviceMask-00108</span><br>

<code>deviceMask</code> <strong>must</strong> be a valid device mask value</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDeviceMask-deviceMask-00109" href="#VUID-vkCmdSetDeviceMask-deviceMask-00109"></a> <span class="vuid">VUID-vkCmdSetDeviceMask-deviceMask-00109</span><br>

<code>deviceMask</code> <strong>must</strong> not be zero</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDeviceMask-deviceMask-00110" href="#VUID-vkCmdSetDeviceMask-deviceMask-00110"></a> <span class="vuid">VUID-vkCmdSetDeviceMask-deviceMask-00110</span><br>

<code>deviceMask</code> <strong>must</strong> not include any set bits that were not in the
<a href="#VkDeviceGroupCommandBufferBeginInfo">VkDeviceGroupCommandBufferBeginInfo</a>::<code>deviceMask</code> value when
the command buffer began recording</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDeviceMask-deviceMask-00111" href="#VUID-vkCmdSetDeviceMask-deviceMask-00111"></a> <span class="vuid">VUID-vkCmdSetDeviceMask-deviceMask-00111</span><br>

If <code>vkCmdSetDeviceMask</code> is called inside a render pass instance,
<code>deviceMask</code> <strong>must</strong> not include any set bits that were not in the
<a href="renderpass.html#VkDeviceGroupRenderPassBeginInfo" class="xref page">VkDeviceGroupRenderPassBeginInfo</a>::<code>deviceMask</code> value when the
render pass instance began recording</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetDeviceMask-commandBuffer-parameter" href="#VUID-vkCmdSetDeviceMask-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetDeviceMask-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDeviceMask-commandBuffer-recording" href="#VUID-vkCmdSetDeviceMask-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetDeviceMask-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetDeviceMask-commandBuffer-cmdpool" href="#VUID-vkCmdSetDeviceMask-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetDeviceMask-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics, compute, or transfer operations</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="videocoding.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute<br>
Transfer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="https://cdn.jsdelivr.net/pako/1.0.3/pako.min.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>

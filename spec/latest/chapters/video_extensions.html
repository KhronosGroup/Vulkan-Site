<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Video Coding :: Vulkan Documentation Project</title>
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../.."><img class="navbar-item" alt="Vulkan White Label" src="../../../_/Vulkan_White_Dec16.svg" /></a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <label for="search-input"></label><input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <!-- <a class="navbar-item" href="#">Home</a> -->
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Specs</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../spec/latest/chapters/introduction.html">Vulkan 1.3</a>
            <a class="navbar-item" href="https://registry.khronos.org/OpenGL/specs/gl/GLSLangSpec.4.60.html">GLSL</a>
            <a class="navbar-item" href="../../../guide/latest/hlsl.html">HLSL</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Education</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../guide/latest/index.html">Vulkan Guide</a>
            <a class="navbar-item" href="../../../tutorial/latest/index.html">Vulkan Tutorial</a>
            <a class="navbar-item" href="../../../samples/latest/README.html">Vulkan Samples</a>
            <a class="navbar-item" href="https://www.youtube.com/c/vulkan">YouTube</a>
            <a class="navbar-item" href="https://vulkan.org">More Info at Vulkan.org</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Community</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="https://discord.gg/vulkan">Vulkan Discord</a>
            <a class="navbar-item" href="https://reddit.com/r/vulkan">Reddit</a>
            <a class="navbar-item" href="https://stackoverflow.com/questions/tagged/vulkan">Stack Overflow</a>
            <a class="navbar-item" href="https://fosstodon.org/@vulkan">Mastodon</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="spec" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Vulkan Specification and Proposals</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fundamentals.html">Fundamentals</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="initialization.html">Initialization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="devsandqueues.html">Devices and Queues</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cmdbuffers.html">Command Buffers</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="synchronization.html">Synchronization and Cache Control</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="renderpass.html">Render Pass</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="shaders.html">Shaders</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="pipelines.html">Pipelines</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="memory.html">Memory Allocation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="resources.html">Resource Creation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="samplers.html">Samplers</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="descriptorsets.html">Resource Descriptors</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="interfaces.html">Shader Interfaces</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="textures.html">Image Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fragmentdensitymapops.html">Fragment Density Map Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="queries.html">Queries</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="clears.html">Clear Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="copies.html">Copy Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="drawing.html">Drawing Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fxvertex.html">Fixed-Function Vertex Processing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="tessellation.html">Tessellation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="geometry.html">Geometry Shading</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_mesh_shader/mesh.html">Mesh Shading</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_HUAWEI_cluster_culling_shader/clusterculling.html">Cluster Culling Shading</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="vertexpostproc.html">Fixed-Function Vertex Post-Processing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="primsrast.html">Rasterization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fragops.html">Fragment Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="framebuffer.html">The Framebuffer</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dispatch.html">Dispatching Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_device_generated_commands/generatedcommands.html">Device-Generated Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="sparsemem.html">Sparse Resources</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_KHR_surface/wsi.html">Window System Integration (WSI)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_KHR_deferred_host_operations/deferred_host_operations.html">Deferred Host Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_EXT_private_data.html">Private Data</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="accelstructures.html">Acceleration Structures</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_EXT_opacity_micromap/micromaps.html">Micromap</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="raytraversal.html">Ray Traversal</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="raytracing.html">Ray Tracing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_memory_decompression.html">Memory Decompression</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="video_extensions.html">Video Coding</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_optical_flow/optical_flow.html">Optical Flow</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="extensions.html">Extending Vulkan</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="features.html">Features</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="limits.html">Limits</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="formats.html">Formats</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="capabilities.html">Additional Capabilities</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="debugging.html">Debugging</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/spirvenv.html">Vulkan Environment for SPIR-V</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/memorymodel.html">Memory Model</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/compressedtex.html">Compressed Image Formats</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/versions.html">Core Revisions (Informative)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/extensions.html">Layers &amp; Extensions (Informative)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/roadmap.html">Vulkan Roadmap Milestones</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/boilerplate.html">API Boilerplate</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/invariance.html">Invariance</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/glossary.html">Lexicon</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/credits.html">Credits (Informative)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../proposals/index.html">Vulkan Proposals</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Vulkan Roadmap</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/Roadmap.html">Vulkan Roadmap</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Extension Proposals</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_AMD_shader_early_and_late_fragment_tests.html">VK_AMD_shader_early_and_late_fragment_tests</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_attachment_feedback_loop_layout.html">VK_EXT_attachment_feedback_loop_layout</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_graphics_pipeline_library.html">VK_EXT_graphics_pipeline_library</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_image_2d_array_of_3d.html">VK_EXT_image_2d_array_of_3d</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_image_compression_control.html">VK_EXT_image_compression_control</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_metal_objects.html">VK_EXT_metal_objects</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_multisampled_render_to_single_sampled.html">VK_EXT_multisampled_render_to_single_sampled</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_non_seamless_cube_map.html">VK_EXT_non_seamless_cube_map</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_primitives_generated_query.html">VK_EXT_primitives_generated_query</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_rasterization_order_attachment_access.html">VK_EXT_rasterization_order_attachment_access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_shader_module_identifier.html">VK_EXT_shader_module_identifier</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_subpass_merge_feedback.html">VK_EXT_subpass_merge_feedback</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_GOOGLE_surfaceless_query.html">VK_GOOGLE_surfaceless_query</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_HUAWEI_invocation_mask.html">VK_HUAWEI_invocation_mask</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_KHR_dynamic_rendering.html">VK_KHR_dynamic_rendering</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_KHR_fragment_shader_barycentric.html">VK_KHR_fragment_shader_barycentric</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_KHR_fragment_shading_rate.html">VK_KHR_fragment_shading_rate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_KHR_shader_integer_dot_product.html">VK_KHR_shader_integer_dot_product</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_QCOM_image_processing.html">VK_QCOM_image_processing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_QCOM_tile_properties.html">VK_QCOM_tile_properties</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Extension Proposal Template</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/template.html">Proposal Template</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Vulkan Specification and Proposals</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../tutorial/latest/00_Introduction.html">Khronos Vulkan Tutorial</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../tutorial/latest/00_Introduction.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../guide/latest/index.html">Vulkan Guide</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../guide/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../samples/latest/README.html">Vulkan Samples</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../samples/latest/README.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../index.html">Vulkan Specification and Proposals</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Vulkan Specification and Proposals</a></li>
    <li><a href="video_extensions.html">Video Coding</a></li>
  </ul>
</nav>
    <!--
  <div class="edit-this-page"><a href="https://github.com/KhronosGroup/Vulkan-Docs/edit/main/antora/modules/ROOT/pages/chapters/video_extensions.adoc">Edit this Page</a></div>
      -->
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Video Coding</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Vulkan implementations <strong>may</strong> expose one or more queue families supporting
video coding operations.
These operations are performed by recording them into a command buffer
within a <a href="#video-coding-scope">video coding scope</a>, and submitting them to
queues with compatible video coding capabilities.</p>
</div>
<div class="paragraph">
<p>The Vulkan video functionalities are designed to be made available through a
set of APIs built on top of each other, consisting of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A core API providing common video coding functionalities,</p>
</li>
<li>
<p>APIs providing codec-independent video decode and video encode related
functionalities, respectively,</p>
</li>
<li>
<p>Additional codec-specific APIs built on top of those.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This chapter details the fundamental components and operations of these.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="video-picture-resources"><a class="anchor" href="#video-picture-resources"></a>Video Picture Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the context of video coding, multidimensional arrays of image data that
<strong>can</strong> be used as the source or target of video coding operations are referred
to as <em>video picture resources</em>.
They <strong>may</strong> store additional metadata that includes implementation-private
information used during the execution of video coding operations, as
discussed later.</p>
</div>
<div class="paragraph">
<p>Video picture resources are backed by <a href="resources.html#VkImage" class="xref page">VkImage</a> objects.
Individual subregions of <a href="resources.html#VkImageView" class="xref page">VkImageView</a> objects created from such
resources <strong>can</strong> be used as
<a href="#decode-output-picture">decode output pictures</a>,
<a href="#encode-input-picture">encode input pictures</a>,
<a href="#reconstructed-picture">reconstructed pictures</a>, and/or
<a href="#reference-picture">reference pictures</a>.</p>
</div>
<div class="paragraph">
<p>The parameters of a video picture resource are specified using a
<code>VkVideoPictureResourceInfoKHR</code> structure.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoPictureResourceInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoPictureResourceInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef struct VkVideoPictureResourceInfoKHR {
    VkStructureType    sType;
    const void*        pNext;
    VkOffset2D         codedOffset;
    VkExtent2D         codedExtent;
    uint32_t           baseArrayLayer;
    VkImageView        imageViewBinding;
} VkVideoPictureResourceInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>codedOffset</code> is the offset in texels of the image subregion to use.</p>
</li>
<li>
<p><code>codedExtent</code> is the size in pixels of the coded image data.</p>
</li>
<li>
<p><code>baseArrayLayer</code> is the array layer of the image view specified in
<code>imageViewBinding</code> to use as the video picture resource.</p>
</li>
<li>
<p><code>imageViewBinding</code> is an image view representing the video picture
resource.</p>
</li>
</ul>
</div>
<div id="video-image-subresource-reference" class="paragraph">
<p>The image subresource referred to by such a structure is defined as the
image array layer index specified in <code>baseArrayLayer</code> relative to the
image subresource range the image view specified in <code>imageViewBinding</code>
was created with.</p>
</div>
<div class="paragraph">
<p>The meaning of the <code>codedOffset</code> and <code>codedExtent</code> depends on the
command and context the video picture resource is used in, as well as on the
used <a href="#video-profiles">video profile</a> and corresponding codec-specific
semantics, as described later.</p>
</div>
<div id="video-picture-resource-uniqueness" class="paragraph">
<p>A video picture resource is uniquely defined by the image subresource
referred to by an instance of this structure, together with the
<code>codedOffset</code> and <code>codedExtent</code> members that identify the image
subregion within the image subresource referenced corresponding to the video
picture resource according to the particular codec-specific semantics.</p>
</div>
<div class="paragraph">
<p>Accesses to image data within a video picture resource happen at the
granularity indicated by
<a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>pictureAccessGranularity</code>, as returned by
<a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used <a href="#video-profiles">video profile</a>.
As a result, given an effective image subregion corresponding to a video
picture resource, the actual image subregion accessed <strong>may</strong> be larger than
that as it <strong>may</strong> include additional padding texels due to the picture access
granularity.
Any writes performed by video coding operations to such padding texels will
result in <strong>undefined</strong> texel values.</p>
</div>
<div id="video-picture-resource-matching" class="paragraph">
<p>Two video picture resources match if they refer to the same image
subresource and they specify identical <code>codedOffset</code> and
<code>codedExtent</code> values.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoPictureResourceInfoKHR-baseArrayLayer-07175" href="#VUID-VkVideoPictureResourceInfoKHR-baseArrayLayer-07175"></a> <span class="vuid">VUID-VkVideoPictureResourceInfoKHR-baseArrayLayer-07175</span><br>

<code>baseArrayLayer</code> <strong>must</strong> be less than the
<a href="resources.html#VkImageViewCreateInfo" class="xref page">VkImageViewCreateInfo</a>::<code>subresourceRange.layerCount</code> specified
when the image view <code>imageViewBinding</code> was created</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoPictureResourceInfoKHR-sType-sType" href="#VUID-VkVideoPictureResourceInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoPictureResourceInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_PICTURE_RESOURCE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoPictureResourceInfoKHR-pNext-pNext" href="#VUID-VkVideoPictureResourceInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoPictureResourceInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkVideoPictureResourceInfoKHR-imageViewBinding-parameter" href="#VUID-VkVideoPictureResourceInfoKHR-imageViewBinding-parameter"></a> <span class="vuid">VUID-VkVideoPictureResourceInfoKHR-imageViewBinding-parameter</span><br>
 <code>imageViewBinding</code> <strong>must</strong> be a valid <a href="resources.html#VkImageView" class="xref page">VkImageView</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dpb"><a class="anchor" href="#dpb"></a>Decoded Picture Buffer</h2>
<div class="sectionbody">
<div id="reconstructed-picture" class="paragraph">
<p>An integral part of video coding pipelines is the reconstruction of pictures
from a compressed video bitstream.
A <em>reconstructed picture</em> is a <a href="#video-picture-resources">video picture resource</a> resulting from this process.</p>
</div>
<div id="reference-picture" class="paragraph">
<p>Such reconstructed pictures <strong>can</strong> be used as <em>reference pictures</em> in
subsequent video coding operations to provide predictions of the values of
samples of subsequently decoded or encoded pictures.
The correct use of such reconstructed pictures as reference pictures is
driven by the video compression standard, the implementation, and the
application-specific use cases.</p>
</div>
<div id="active-reference-pictures" class="paragraph">
<p>The list of reference pictures used to provide such predictions within a
single video coding operation is referred to as the list of <em>active
reference pictures</em>.</p>
</div>
<div class="paragraph">
<p>The <em>decoded picture buffer (DPB)</em> is an indexed data structure that
maintains the set of reference pictures available to be used in video coding
operations.
<a id="dpb-slot"></a> Individual indexed entries of the DPB are referred to as the
<em>decoded picture buffer (DPB) slots</em>.
<a id="dpb-capacity"></a> The range of valid DPB slot indices is between zero and
<code>N-1</code>, where <code>N</code> is the capacity of the DPB.
Each DPB slot <strong>can</strong> refer to a reference picture containing a <em>video frame</em>
or <strong>can</strong> refer to up to two reference pictures containing the top and/or
bottom <em>fields</em> that, when both present, together represent a full <em>video
frame</em>
.</p>
</div>
<div id="dpb-state-and-backing-store" class="paragraph">
<p>In Vulkan, the state and the backing store of the DPB is separated as
follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The state of individual DPB slots is maintained by <a href="#video-session">video    session</a> objects.</p>
</li>
<li>
<p>The backing store of DPB slots is provided by subregions of
<a href="resources.html#VkImage" class="xref page">VkImage</a> objects used as <a href="#video-picture-resources">video picture    resources</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, the implementation <strong>may</strong> also maintain opaque metadata
associated with DPB slots, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="reference-metadata"></a> <em>Reference picture metadata</em> corresponding to the
video picture resource associated with the DPB slot.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Such metadata <strong>may</strong> be stored by the implementation as part of the DPB slot
state maintained by the video session, or as part of the video picture
resource backing the DPB slot.</p>
</div>
<div class="paragraph">
<p>Any metadata stored in the video picture resources backing DPB slots are
independent of the video session used to store it, hence such video picture
resources <strong>can</strong> be shared with other video sessions.
Correspondingly, any metadata that is dependent on the video session will
always be stored as part of the DPB slot state maintained by that video
session.</p>
</div>
<div class="paragraph">
<p>The responsibility of managing the DPB is split between the application and
the implementation as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The application maintains the association between <a href="#dpb-slot">DPB slot</a>
indices and corresponding <a href="#video-picture-resources">video picture    resources</a>.</p>
</li>
<li>
<p>The implementation maintains global and per-slot opaque
<a href="#reference-metadata">reference picture metadata</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, the application is also responsible for managing the mapping
between the codec-specific picture IDs and DPB slots, and any other
codec-specific states unless otherwise specified.</p>
</div>
<div class="sect2">
<h3 id="dpb-slot-states"><a class="anchor" href="#dpb-slot-states"></a>DPB Slot States</h3>
<div class="paragraph">
<p>At a given time, each DPB slot is either in <em>active</em> or <em>inactive</em> state.
Initially, all DPB slots managed by a <a href="#video-session">video session</a> are in
<em>inactive</em> state.</p>
</div>
<div class="paragraph">
<p>A DPB slot <strong>can</strong> be <em>activated</em> by using it as the target of picture
reconstruction within a video coding operation, changing its state to
<em>active</em>.</p>
</div>
<div class="paragraph">
<p>As part of the picture reconstruction, the implementation <strong>may</strong> also generate
<a href="#reference-metadata">reference picture metadata</a>.</p>
</div>
<div class="paragraph">
<p>If such a video coding operation completes successfully, the activated DPB
slot will have a <em>valid picture reference</em> and the <a href="#reconstructed-picture">reconstructed picture</a> is associated with the DPB slot.
This is true even if the DPB slot is used as the target of a picture
reconstruction that only sets up a top field or bottom field reference
picture and thus does not yet refer to a complete frame.
However, if any data provided as input to such a video coding operation is
not compliant to the video compression standard used, that video coding
operation <strong>may</strong> complete unsuccessfully, in which case the activated DPB slot
will have an <em>invalid picture reference</em>.
This is true even if the DPB slot previously had a valid picture reference
to a top field or bottom field reference picture, but the reconstruction of
the other field corresponding to the DPB slot failed.</p>
</div>
<div class="paragraph">
<p>The application <strong>can</strong> use <a href="queries.html#queries" class="xref page">queries</a> to get feedback about the
outcome of video coding operations and use the resulting
<a href="queries.html#VkQueryResultStatusKHR" class="xref page">VkQueryResultStatusKHR</a> value to determine whether the video coding
operation completed successfully (result status is positive) or
unsuccessfully (result status is negative).</p>
</div>
<div class="paragraph">
<p>Using a <a href="#reference-picture">reference picture</a> associated with a DPB slot
that has an <em>invalid picture reference</em> as an <a href="#active-reference-pictures">active reference picture</a> in subsequent video coding operations is legal,
however, the contents of the outputs of such operations are <strong>undefined</strong>, and
any DPB slots activated by such video coding operations will also have an
<em>invalid picture reference</em>.
This is true even if such video coding operations <strong>may</strong> otherwise complete
successfully.</p>
</div>
<div class="paragraph">
<p>A DPB slot <strong>can</strong> also be <em>deactivated</em> by the application, changing its state
to <em>inactive</em> and invalidating any picture references and
<a href="#reference-metadata">reference picture metadata</a> associated with the DPB
slot.</p>
</div>
<div class="paragraph">
<p>A DPB slot <strong>can</strong> be activated with a new frame even if it is already active.
In this case all previous associations of the DPB slots with
<a href="#reference-picture">reference pictures</a> are replaced with an association
with the <a href="#reconstructed-picture">reconstructed picture</a> used to activate
it.
If an already active DPB slot is activated with a reconstructed field
picture, then the behavior is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the DPB slot is currently associated with a frame, then that
association is replaced with an association with the reconstructed field
picture used to activate it.</p>
</li>
<li>
<p>If the DPB slot is not currently associated with a top field picture and
the DPB slot is activated with a top field picture, or if the DPB slot
is not currently associated with a bottom field picture and the DPB slot
is activated with a bottom field picture, then the DPB slot is
associated with the reconstructed field picture used to activate it,
without disturbing the other field picture association, if any.</p>
</li>
<li>
<p>If the DPB slot is currently associated with a top field picture and the
DPB slot is activated with a new top field picture, or if the DPB slot
is currently associated with a bottom field picture and the DPB slot is
activated with a new bottom field picture, then that association is
replaced with an association with the reconstructed field picture used
to activate it, without disturbing the other field picture association,
if any.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="video-profiles"><a class="anchor" href="#video-profiles"></a>Video Profiles</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoProfileInfoKHR</code> structure is defined as follows:</p>
</div>
<div id="VkVideoProfileInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef struct VkVideoProfileInfoKHR {
    VkStructureType                     sType;
    const void*                         pNext;
    VkVideoCodecOperationFlagBitsKHR    videoCodecOperation;
    VkVideoChromaSubsamplingFlagsKHR    chromaSubsampling;
    VkVideoComponentBitDepthFlagsKHR    lumaBitDepth;
    VkVideoComponentBitDepthFlagsKHR    chromaBitDepth;
} VkVideoProfileInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>videoCodecOperation</code> is a <a href="#VkVideoCodecOperationFlagBitsKHR">VkVideoCodecOperationFlagBitsKHR</a>
value specifying a video codec operation.</p>
</li>
<li>
<p><code>chromaSubsampling</code> is a bitmask of
<a href="#VkVideoChromaSubsamplingFlagBitsKHR">VkVideoChromaSubsamplingFlagBitsKHR</a> specifying video chroma
subsampling information.</p>
</li>
<li>
<p><code>lumaBitDepth</code> is a bitmask of
<a href="#VkVideoComponentBitDepthFlagBitsKHR">VkVideoComponentBitDepthFlagBitsKHR</a> specifying video luma bit
depth information.</p>
</li>
<li>
<p><code>chromaBitDepth</code> is a bitmask of
<a href="#VkVideoComponentBitDepthFlagBitsKHR">VkVideoComponentBitDepthFlagBitsKHR</a> specifying video chroma bit
depth information.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Video profiles are provided as input to video capability queries such as
<a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> or
<a href="#vkGetPhysicalDeviceVideoFormatPropertiesKHR">vkGetPhysicalDeviceVideoFormatPropertiesKHR</a>, as well as when creating
resources to be used by video coding operations such as images, buffers,
query pools, and video sessions.</p>
</div>
<div class="paragraph">
<p>The full description of a video profile is specified by an instance of this
structure, and the codec-specific and auxiliary structures provided in its
<code>pNext</code> chain.</p>
</div>
<div id="video-profile-error-codes" class="paragraph">
<p>When this structure is specified as an input parameter to
<a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a>, or through the
<code>pProfiles</code> member of an <a href="#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure in
the <code>pNext</code> chain of the input parameter of a query command such as
<a href="#vkGetPhysicalDeviceVideoFormatPropertiesKHR">vkGetPhysicalDeviceVideoFormatPropertiesKHR</a> or
<a href="capabilities.html#vkGetPhysicalDeviceImageFormatProperties2" class="xref page">vkGetPhysicalDeviceImageFormatProperties2</a>, the following error codes
indicate specific causes of the failure of the query operation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_VIDEO_PICTURE_LAYOUT_NOT_SUPPORTED_KHR</code> indicates that the
requested video picture layout
(e.g. through the <code>pictureLayout</code> member of a
<a href="#VkVideoDecodeH264ProfileInfoKHR">VkVideoDecodeH264ProfileInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>VkVideoProfileInfoKHR</code>)
is not supported.</p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_OPERATION_NOT_SUPPORTED_KHR</code> indicates that
a video profile operation specified by <code>videoCodecOperation</code> is not
supported.</p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_FORMAT_NOT_SUPPORTED_KHR</code> indicates that
video format parameters specified by <code>chromaSubsampling</code>,
<code>lumaBitDepth</code>, or <code>chromaBitDepth</code> are not supported.</p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_CODEC_NOT_SUPPORTED_KHR</code> indicates that the
codec-specific parameters corresponding to the video codec operation are
not supported.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-chromaSubsampling-07013" href="#VUID-VkVideoProfileInfoKHR-chromaSubsampling-07013"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-chromaSubsampling-07013</span><br>

<code>chromaSubsampling</code> <strong>must</strong> have a single bit set</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-lumaBitDepth-07014" href="#VUID-VkVideoProfileInfoKHR-lumaBitDepth-07014"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-lumaBitDepth-07014</span><br>

<code>lumaBitDepth</code> <strong>must</strong> have a single bit set</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-chromaSubsampling-07015" href="#VUID-VkVideoProfileInfoKHR-chromaSubsampling-07015"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-chromaSubsampling-07015</span><br>

If <code>chromaSubsampling</code> is not
<code>VK_VIDEO_CHROMA_SUBSAMPLING_MONOCHROME_BIT_KHR</code>, then
<code>chromaBitDepth</code> <strong>must</strong> have a single bit set</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-videoCodecOperation-07179" href="#VUID-VkVideoProfileInfoKHR-videoCodecOperation-07179"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-videoCodecOperation-07179</span><br>

If <code>videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the <code>pNext</code>
chain <strong>must</strong> include a <a href="#VkVideoDecodeH264ProfileInfoKHR">VkVideoDecodeH264ProfileInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-videoCodecOperation-07180" href="#VUID-VkVideoProfileInfoKHR-videoCodecOperation-07180"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-videoCodecOperation-07180</span><br>

If <code>videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the <code>pNext</code>
chain <strong>must</strong> include a <a href="#VkVideoDecodeH265ProfileInfoKHR">VkVideoDecodeH265ProfileInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-videoCodecOperation-07181" href="#VUID-VkVideoProfileInfoKHR-videoCodecOperation-07181"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-videoCodecOperation-07181</span><br>

If <code>videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_EXT</code>, then the <code>pNext</code>
chain <strong>must</strong> include a <a href="#VkVideoEncodeH264ProfileInfoEXT">VkVideoEncodeH264ProfileInfoEXT</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-videoCodecOperation-07182" href="#VUID-VkVideoProfileInfoKHR-videoCodecOperation-07182"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-videoCodecOperation-07182</span><br>

If <code>videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_EXT</code>, then the <code>pNext</code>
chain <strong>must</strong> include a <a href="#VkVideoEncodeH265ProfileInfoEXT">VkVideoEncodeH265ProfileInfoEXT</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-sType-sType" href="#VUID-VkVideoProfileInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_PROFILE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-videoCodecOperation-parameter" href="#VUID-VkVideoProfileInfoKHR-videoCodecOperation-parameter"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-videoCodecOperation-parameter</span><br>
 <code>videoCodecOperation</code> <strong>must</strong> be a valid <a href="#VkVideoCodecOperationFlagBitsKHR">VkVideoCodecOperationFlagBitsKHR</a> value</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-chromaSubsampling-parameter" href="#VUID-VkVideoProfileInfoKHR-chromaSubsampling-parameter"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-chromaSubsampling-parameter</span><br>
 <code>chromaSubsampling</code> <strong>must</strong> be a valid combination of <a href="#VkVideoChromaSubsamplingFlagBitsKHR">VkVideoChromaSubsamplingFlagBitsKHR</a> values</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-chromaSubsampling-requiredbitmask" href="#VUID-VkVideoProfileInfoKHR-chromaSubsampling-requiredbitmask"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-chromaSubsampling-requiredbitmask</span><br>
 <code>chromaSubsampling</code> <strong>must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-lumaBitDepth-parameter" href="#VUID-VkVideoProfileInfoKHR-lumaBitDepth-parameter"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-lumaBitDepth-parameter</span><br>
 <code>lumaBitDepth</code> <strong>must</strong> be a valid combination of <a href="#VkVideoComponentBitDepthFlagBitsKHR">VkVideoComponentBitDepthFlagBitsKHR</a> values</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-lumaBitDepth-requiredbitmask" href="#VUID-VkVideoProfileInfoKHR-lumaBitDepth-requiredbitmask"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-lumaBitDepth-requiredbitmask</span><br>
 <code>lumaBitDepth</code> <strong>must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-chromaBitDepth-parameter" href="#VUID-VkVideoProfileInfoKHR-chromaBitDepth-parameter"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-chromaBitDepth-parameter</span><br>
 <code>chromaBitDepth</code> <strong>must</strong> be a valid combination of <a href="#VkVideoComponentBitDepthFlagBitsKHR">VkVideoComponentBitDepthFlagBitsKHR</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>::<code>videoCodecOperation</code>,
specifying the type of video coding operation and video compression standard
used by a video profile, are:</p>
</div>
<div id="VkVideoCodecOperationFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef enum VkVideoCodecOperationFlagBitsKHR {
    VK_VIDEO_CODEC_OPERATION_NONE_KHR = 0,
#ifdef VK_ENABLE_BETA_EXTENSIONS
  // Provided by VK_EXT_video_encode_h264
    VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_EXT = 0x00010000,
#endif
#ifdef VK_ENABLE_BETA_EXTENSIONS
  // Provided by VK_EXT_video_encode_h265
    VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_EXT = 0x00020000,
#endif
  // Provided by VK_KHR_video_decode_h264
    VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR = 0x00000001,
  // Provided by VK_KHR_video_decode_h265
    VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR = 0x00000002,
} VkVideoCodecOperationFlagBitsKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_CODEC_OPERATION_NONE_KHR</code> indicates no support for any
video codec operations.</p>
</li>
<li>
<p><code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> specifies support for
H.264 video decode operations.</p>
</li>
<li>
<p><code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code> specifies support for
H.265 video decode operations.</p>
</li>
<li>
<p><code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_EXT</code> specifies support for
H.264 video encode operations.</p>
</li>
<li>
<p><code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_EXT</code> specifies support for
H.265 video encode operations.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoCodecOperationFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef VkFlags VkVideoCodecOperationFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoCodecOperationFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <a href="#VkVideoCodecOperationFlagBitsKHR">VkVideoCodecOperationFlagBitsKHR</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The video format chroma subsampling is defined with the following enums:</p>
</div>
<div id="VkVideoChromaSubsamplingFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef enum VkVideoChromaSubsamplingFlagBitsKHR {
    VK_VIDEO_CHROMA_SUBSAMPLING_INVALID_KHR = 0,
    VK_VIDEO_CHROMA_SUBSAMPLING_MONOCHROME_BIT_KHR = 0x00000001,
    VK_VIDEO_CHROMA_SUBSAMPLING_420_BIT_KHR = 0x00000002,
    VK_VIDEO_CHROMA_SUBSAMPLING_422_BIT_KHR = 0x00000004,
    VK_VIDEO_CHROMA_SUBSAMPLING_444_BIT_KHR = 0x00000008,
} VkVideoChromaSubsamplingFlagBitsKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_CHROMA_SUBSAMPLING_MONOCHROME_BIT_KHR</code> specifies that the
format is monochrome.</p>
</li>
<li>
<p><code>VK_VIDEO_CHROMA_SUBSAMPLING_420_BIT_KHR</code> specified that the format
is 4:2:0 chroma subsampled, i.e. the two chroma components are sampled
horizontally and vertically at half the sample rate of the luma
component.</p>
</li>
<li>
<p><code>VK_VIDEO_CHROMA_SUBSAMPLING_422_BIT_KHR</code> - the format is 4:2:2
chroma subsampled, i.e. the two chroma components are sampled
horizontally at half the sample rate of luma component.</p>
</li>
<li>
<p><code>VK_VIDEO_CHROMA_SUBSAMPLING_444_BIT_KHR</code> - the format is 4:4:4
chroma sampled, i.e. all three components of the Yâ€²C<sub>B</sub>C<sub>R</sub> format are
sampled at the same rate, thus there is no chroma subsampling.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Chroma subsampling is described in more detail in the
<a href="textures.html#textures-chroma-reconstruction" class="xref page">Chroma Reconstruction</a> section.</p>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoChromaSubsamplingFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef VkFlags VkVideoChromaSubsamplingFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoChromaSubsamplingFlagsKHR</code> is a bitmask type for setting a mask
of zero or more <a href="#VkVideoChromaSubsamplingFlagBitsKHR">VkVideoChromaSubsamplingFlagBitsKHR</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values for the video format component bit depth are:</p>
</div>
<div id="VkVideoComponentBitDepthFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef enum VkVideoComponentBitDepthFlagBitsKHR {
    VK_VIDEO_COMPONENT_BIT_DEPTH_INVALID_KHR = 0,
    VK_VIDEO_COMPONENT_BIT_DEPTH_8_BIT_KHR = 0x00000001,
    VK_VIDEO_COMPONENT_BIT_DEPTH_10_BIT_KHR = 0x00000004,
    VK_VIDEO_COMPONENT_BIT_DEPTH_12_BIT_KHR = 0x00000010,
} VkVideoComponentBitDepthFlagBitsKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_COMPONENT_BIT_DEPTH_8_BIT_KHR</code> specifies a component bit
depth of 8 bits.</p>
</li>
<li>
<p><code>VK_VIDEO_COMPONENT_BIT_DEPTH_10_BIT_KHR</code> specifies a component bit
depth of 10 bits.</p>
</li>
<li>
<p><code>VK_VIDEO_COMPONENT_BIT_DEPTH_12_BIT_KHR</code> specifies a component bit
depth of 12 bits.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoComponentBitDepthFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef VkFlags VkVideoComponentBitDepthFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoComponentBitDepthFlagsKHR</code> is a bitmask type for setting a mask
of zero or more <a href="#VkVideoComponentBitDepthFlagBitsKHR">VkVideoComponentBitDepthFlagBitsKHR</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Additional information about the video decode use case <strong>can</strong> be provided by
adding a <code>VkVideoDecodeUsageInfoKHR</code> structure to the <code>pNext</code> chain
of <a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoDecodeUsageInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeUsageInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_queue
typedef struct VkVideoDecodeUsageInfoKHR {
    VkStructureType               sType;
    const void*                   pNext;
    VkVideoDecodeUsageFlagsKHR    videoUsageHints;
} VkVideoDecodeUsageInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>videoUsageHints</code> is a bitmask of
<a href="#VkVideoDecodeUsageFlagBitsKHR">VkVideoDecodeUsageFlagBitsKHR</a> specifying hints about the intended
use of the video decode profile.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeUsageInfoKHR-sType-sType" href="#VUID-VkVideoDecodeUsageInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeUsageInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_USAGE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeUsageInfoKHR-videoUsageHints-parameter" href="#VUID-VkVideoDecodeUsageInfoKHR-videoUsageHints-parameter"></a> <span class="vuid">VUID-VkVideoDecodeUsageInfoKHR-videoUsageHints-parameter</span><br>
 <code>videoUsageHints</code> <strong>must</strong> be a valid combination of <a href="#VkVideoDecodeUsageFlagBitsKHR">VkVideoDecodeUsageFlagBitsKHR</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The following bits <strong>can</strong> be specified in
<a href="#VkVideoDecodeUsageInfoKHR">VkVideoDecodeUsageInfoKHR</a>::<code>videoUsageHints</code> as a hint about the
video decode use case:</p>
</div>
<div id="VkVideoDecodeUsageFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_queue
typedef enum VkVideoDecodeUsageFlagBitsKHR {
    VK_VIDEO_DECODE_USAGE_DEFAULT_KHR = 0,
    VK_VIDEO_DECODE_USAGE_TRANSCODING_BIT_KHR = 0x00000001,
    VK_VIDEO_DECODE_USAGE_OFFLINE_BIT_KHR = 0x00000002,
    VK_VIDEO_DECODE_USAGE_STREAMING_BIT_KHR = 0x00000004,
} VkVideoDecodeUsageFlagBitsKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_DECODE_USAGE_TRANSCODING_BIT_KHR</code> specifies that video
decoding is intended to be used in conjunction with video encoding to
transcode a video bitstream with the same and/or different codecs.</p>
</li>
<li>
<p><code>VK_VIDEO_DECODE_USAGE_OFFLINE_BIT_KHR</code> specifies that video
decoding is intended to be used to consume a local video bitstream.</p>
</li>
<li>
<p><code>VK_VIDEO_DECODE_USAGE_STREAMING_BIT_KHR</code> specifies that video
decoding is intended to be used to consume a video bitstream received as
a continuous flow over network.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>There are no restrictions on the combination of bits that <strong>can</strong> be specified
by the application.
However, applications <strong>should</strong> use reasonable combinations in order for the
implementation to be able to select the most appropriate mode of operation
for the particular use case.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoDecodeUsageFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_queue
typedef VkFlags VkVideoDecodeUsageFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoDecodeUsageFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <a href="#VkVideoDecodeUsageFlagBitsKHR">VkVideoDecodeUsageFlagBitsKHR</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Additional information about the video encode use case <strong>can</strong> be provided by
adding a <code>VkVideoEncodeUsageInfoKHR</code> structure to the <code>pNext</code> chain
of <a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoEncodeUsageInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeUsageInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef struct VkVideoEncodeUsageInfoKHR {
    VkStructureType                 sType;
    const void*                     pNext;
    VkVideoEncodeUsageFlagsKHR      videoUsageHints;
    VkVideoEncodeContentFlagsKHR    videoContentHints;
    VkVideoEncodeTuningModeKHR      tuningMode;
} VkVideoEncodeUsageInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>videoUsageHints</code> is a bitmask of
<a href="#VkVideoEncodeUsageFlagBitsKHR">VkVideoEncodeUsageFlagBitsKHR</a> specifying hints about the intended
use of the video encode profile.</p>
</li>
<li>
<p><code>videoContentHints</code> is a bitmask of
<a href="#VkVideoEncodeContentFlagBitsKHR">VkVideoEncodeContentFlagBitsKHR</a> specifying hints about the content
to be encoded using the video encode profile.</p>
</li>
<li>
<p><code>tuningMode</code> is a <a href="#VkVideoEncodeTuningModeKHR">VkVideoEncodeTuningModeKHR</a> value specifying
the tuning mode to use when encoding with the video profile.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeUsageInfoKHR-sType-sType" href="#VUID-VkVideoEncodeUsageInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeUsageInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_USAGE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeUsageInfoKHR-videoUsageHints-parameter" href="#VUID-VkVideoEncodeUsageInfoKHR-videoUsageHints-parameter"></a> <span class="vuid">VUID-VkVideoEncodeUsageInfoKHR-videoUsageHints-parameter</span><br>
 <code>videoUsageHints</code> <strong>must</strong> be a valid combination of <a href="#VkVideoEncodeUsageFlagBitsKHR">VkVideoEncodeUsageFlagBitsKHR</a> values</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeUsageInfoKHR-videoContentHints-parameter" href="#VUID-VkVideoEncodeUsageInfoKHR-videoContentHints-parameter"></a> <span class="vuid">VUID-VkVideoEncodeUsageInfoKHR-videoContentHints-parameter</span><br>
 <code>videoContentHints</code> <strong>must</strong> be a valid combination of <a href="#VkVideoEncodeContentFlagBitsKHR">VkVideoEncodeContentFlagBitsKHR</a> values</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeUsageInfoKHR-tuningMode-parameter" href="#VUID-VkVideoEncodeUsageInfoKHR-tuningMode-parameter"></a> <span class="vuid">VUID-VkVideoEncodeUsageInfoKHR-tuningMode-parameter</span><br>
 If <code>tuningMode</code> is not <code>0</code>, <code>tuningMode</code> <strong>must</strong> be a valid <a href="#VkVideoEncodeTuningModeKHR">VkVideoEncodeTuningModeKHR</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The following bits <strong>can</strong> be specified in
<a href="#VkVideoEncodeUsageInfoKHR">VkVideoEncodeUsageInfoKHR</a>::<code>videoUsageHints</code> as a hint about the
video encode use case:</p>
</div>
<div id="VkVideoEncodeUsageFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef enum VkVideoEncodeUsageFlagBitsKHR {
    VK_VIDEO_ENCODE_USAGE_DEFAULT_KHR = 0,
    VK_VIDEO_ENCODE_USAGE_TRANSCODING_BIT_KHR = 0x00000001,
    VK_VIDEO_ENCODE_USAGE_STREAMING_BIT_KHR = 0x00000002,
    VK_VIDEO_ENCODE_USAGE_RECORDING_BIT_KHR = 0x00000004,
    VK_VIDEO_ENCODE_USAGE_CONFERENCING_BIT_KHR = 0x00000008,
} VkVideoEncodeUsageFlagBitsKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_USAGE_TRANSCODING_BIT_KHR</code> specifies that video
encoding is intended to be used in conjunction with video decoding to
transcode a video bitstream with the same and/or different codecs.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_USAGE_STREAMING_BIT_KHR</code> specifies that video
encoding is intended to be used to produce a video bitstream that is
expected to be sent as a continuous flow over network.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_USAGE_RECORDING_BIT_KHR</code> specifies that video
encoding is intended to be used for real-time recording for offline
consumption.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_USAGE_CONFERENCING_BIT_KHR</code> specifies that video
encoding is intended to be used in a video conferencing scenario.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>There are no restrictions on the combination of bits that <strong>can</strong> be specified
by the application.
However, applications <strong>should</strong> use reasonable combinations in order for the
implementation to be able to select the most appropriate mode of operation
for the particular use case.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeUsageFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef VkFlags VkVideoEncodeUsageFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeUsageFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <a href="#VkVideoEncodeUsageFlagBitsKHR">VkVideoEncodeUsageFlagBitsKHR</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The following bits <strong>can</strong> be specified in
<a href="#VkVideoEncodeUsageInfoKHR">VkVideoEncodeUsageInfoKHR</a>::<code>videoContentHints</code> as a hint about the
encoded video content:</p>
</div>
<div id="VkVideoEncodeContentFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef enum VkVideoEncodeContentFlagBitsKHR {
    VK_VIDEO_ENCODE_CONTENT_DEFAULT_KHR = 0,
    VK_VIDEO_ENCODE_CONTENT_CAMERA_BIT_KHR = 0x00000001,
    VK_VIDEO_ENCODE_CONTENT_DESKTOP_BIT_KHR = 0x00000002,
    VK_VIDEO_ENCODE_CONTENT_RENDERED_BIT_KHR = 0x00000004,
} VkVideoEncodeContentFlagBitsKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_CONTENT_CAMERA_BIT_KHR</code> specifies that video
encoding is intended to be used to encode camera content.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_CONTENT_DESKTOP_BIT_KHR</code> specifies that video
encoding is intended to be used to encode desktop content.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_CONTENT_RENDERED_BIT_KHR</code> specified that video
encoding is intended to be used to encode rendered (e.g. game) content.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>There are no restrictions on the combination of bits that <strong>can</strong> be specified
by the application.
However, applications <strong>should</strong> use reasonable combinations in order for the
implementation to be able to select the most appropriate mode of operation
for the particular content type.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeContentFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef VkFlags VkVideoEncodeContentFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeContentFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <a href="#VkVideoEncodeContentFlagBitsKHR">VkVideoEncodeContentFlagBitsKHR</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible video encode tuning mode values are as follows:</p>
</div>
<div id="VkVideoEncodeTuningModeKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef enum VkVideoEncodeTuningModeKHR {
    VK_VIDEO_ENCODE_TUNING_MODE_DEFAULT_KHR = 0,
    VK_VIDEO_ENCODE_TUNING_MODE_HIGH_QUALITY_KHR = 1,
    VK_VIDEO_ENCODE_TUNING_MODE_LOW_LATENCY_KHR = 2,
    VK_VIDEO_ENCODE_TUNING_MODE_ULTRA_LOW_LATENCY_KHR = 3,
    VK_VIDEO_ENCODE_TUNING_MODE_LOSSLESS_KHR = 4,
} VkVideoEncodeTuningModeKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_TUNING_MODE_DEFAULT_KHR</code> specifies the default
tuning mode.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_TUNING_MODE_HIGH_QUALITY_KHR</code> specifies that video
encoding is tuned for high quality.
When using this tuning mode, the implementation <strong>may</strong> compromise the
latency of video encoding operations to improve quality.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_TUNING_MODE_LOW_LATENCY_KHR</code> specifies that video
encoding is tuned for low latency.
When using this tuning mode, the implementation <strong>may</strong> compromise quality
to increase the performance and lower the latency of video encode
operations.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_TUNING_MODE_ULTRA_LOW_LATENCY_KHR</code> specifies that
video encoding is tuned for ultra-low latency.
When using this tuning mode, the implementation <strong>may</strong> compromise quality
to maximize the performance and minimize the latency of video encoding
operations.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_TUNING_MODE_LOSSLESS_KHR</code> specifies that video
encoding is tuned for lossless encoding.
When using this tuning mode, video encode operations produce lossless
output.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoProfileListInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoProfileListInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef struct VkVideoProfileListInfoKHR {
    VkStructureType                 sType;
    const void*                     pNext;
    uint32_t                        profileCount;
    const VkVideoProfileInfoKHR*    pProfiles;
} VkVideoProfileListInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>profileCount</code> is the number of elements in the <code>pProfiles</code>
array.</p>
</li>
<li>
<p><code>pProfiles</code> is a pointer to an array of <a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>
structures.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note:</div>
<div class="paragraph">
<p>Video transcoding is an example of a use case that necessitates the
specification of multiple profiles in various contexts.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When the application provides a video decode profile and one or more video
encode profiles in the profile list, the implementation ensures that any
capabilitities returned or resources created are suitable for the video
transcoding use cases without the need for manual data transformations.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoProfileListInfoKHR-pProfiles-06813" href="#VUID-VkVideoProfileListInfoKHR-pProfiles-06813"></a> <span class="vuid">VUID-VkVideoProfileListInfoKHR-pProfiles-06813</span><br>

<code>pProfiles</code> <strong>must</strong> not contain more than one element whose
<code>videoCodecOperation</code> member specifies a decode operation</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoProfileListInfoKHR-sType-sType" href="#VUID-VkVideoProfileListInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoProfileListInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_PROFILE_LIST_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoProfileListInfoKHR-pProfiles-parameter" href="#VUID-VkVideoProfileListInfoKHR-pProfiles-parameter"></a> <span class="vuid">VUID-VkVideoProfileListInfoKHR-pProfiles-parameter</span><br>
 If <code>profileCount</code> is not <code>0</code>, <code>pProfiles</code> <strong>must</strong> be a valid pointer to an array of <code>profileCount</code> valid <a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structures</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="video-capabilities"><a class="anchor" href="#video-capabilities"></a>Video Capabilities</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="video-coding-capabilities"><a class="anchor" href="#video-coding-capabilities"></a>Video Coding Capabilities</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query video coding capabilities for a specific video profile, call:</p>
</div>
<div id="vkGetPhysicalDeviceVideoCapabilitiesKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
VkResult vkGetPhysicalDeviceVideoCapabilitiesKHR(
    VkPhysicalDevice                            physicalDevice,
    const VkVideoProfileInfoKHR*                pVideoProfile,
    VkVideoCapabilitiesKHR*                     pCapabilities);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>physicalDevice</code> is the physical device from which to query the
video decode or encode capabilities.</p>
</li>
<li>
<p><code>pVideoProfile</code> is a pointer to a <a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>
structure.</p>
</li>
<li>
<p><code>pCapabilities</code> is a pointer to a <a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>
structure in which the capabilities are returned.</p>
</li>
</ul>
</div>
<div id="video-profile-support" class="paragraph">
<p>If the <a href="#video-profiles">video profile</a> described by <code>pVideoProfile</code> is
supported by the implementation, then this command returns <code>VK_SUCCESS</code>
and <code>pCapabilities</code> is filled with the capabilities supported with the
specified video profile.
Otherwise, one of the <a href="#video-profile-error-codes">video-profile-specific error codes</a> are returned.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07183" href="#VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07183"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07183</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> specifies a decode
operation, then the <code>pNext</code> chain of <code>pCapabilities</code> <strong>must</strong>
include a <a href="#VkVideoDecodeCapabilitiesKHR">VkVideoDecodeCapabilitiesKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07184" href="#VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07184"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07184</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the <code>pNext</code>
chain of <code>pCapabilities</code> <strong>must</strong> include a
<a href="#VkVideoDecodeH264CapabilitiesKHR">VkVideoDecodeH264CapabilitiesKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07185" href="#VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07185"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07185</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the <code>pNext</code>
chain of <code>pCapabilities</code> <strong>must</strong> include a
<a href="#VkVideoDecodeH265CapabilitiesKHR">VkVideoDecodeH265CapabilitiesKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07186" href="#VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07186"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07186</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> specifies an encode
operation, then the <code>pNext</code> chain of <code>pCapabilities</code> <strong>must</strong>
include a <a href="#VkVideoEncodeCapabilitiesKHR">VkVideoEncodeCapabilitiesKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07187" href="#VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07187"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07187</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_EXT</code>, then the <code>pNext</code>
chain of <code>pCapabilities</code> <strong>must</strong> include a
<a href="#VkVideoEncodeH264CapabilitiesEXT">VkVideoEncodeH264CapabilitiesEXT</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07188" href="#VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07188"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07188</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_EXT</code>, then the <code>pNext</code>
chain of <code>pCapabilities</code> <strong>must</strong> include a
<a href="#VkVideoEncodeH265CapabilitiesEXT">VkVideoEncodeH265CapabilitiesEXT</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-physicalDevice-parameter" href="#VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-physicalDevice-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-physicalDevice-parameter</span><br>
 <code>physicalDevice</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkPhysicalDevice" class="xref page">VkPhysicalDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-parameter" href="#VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-parameter</span><br>
 <code>pVideoProfile</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pCapabilities-parameter" href="#VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pCapabilities-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pCapabilities-parameter</span><br>
 <code>pCapabilities</code> <strong>must</strong> be a valid pointer to a <a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_OPERATION_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_FORMAT_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PICTURE_LAYOUT_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_CODEC_NOT_SUPPORTED_KHR</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoCapabilitiesKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoCapabilitiesKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef struct VkVideoCapabilitiesKHR {
    VkStructureType              sType;
    void*                        pNext;
    VkVideoCapabilityFlagsKHR    flags;
    VkDeviceSize                 minBitstreamBufferOffsetAlignment;
    VkDeviceSize                 minBitstreamBufferSizeAlignment;
    VkExtent2D                   pictureAccessGranularity;
    VkExtent2D                   minCodedExtent;
    VkExtent2D                   maxCodedExtent;
    uint32_t                     maxDpbSlots;
    uint32_t                     maxActiveReferencePictures;
    VkExtensionProperties        stdHeaderVersion;
} VkVideoCapabilitiesKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkVideoCapabilityFlagBitsKHR">VkVideoCapabilityFlagBitsKHR</a>
specifying capability flags.</p>
</li>
<li>
<p><code>minBitstreamBufferOffsetAlignment</code> is the minimum alignment for
bitstream buffer offsets.</p>
</li>
<li>
<p><code>minBitstreamBufferSizeAlignment</code> is the minimum alignment for
bitstream buffer range sizes.</p>
</li>
<li>
<p><code>pictureAccessGranularity</code> is the granularity at which image access
to video picture resources happen.</p>
</li>
<li>
<p><code>minCodedExtent</code> is the minimum width and height of the coded
frames.</p>
</li>
<li>
<p><code>maxCodedExtent</code> is the maximum width and height of the coded
frames.</p>
</li>
<li>
<p><code>maxDpbSlots</code> is the maximum number of <a href="#dpb-slot">DPB slots</a>
supported by a single video session.</p>
</li>
<li>
<p><code>maxActiveReferencePictures</code> is the maximum number of
<a href="#active-reference-pictures">active reference pictures</a> a single video
coding operation <strong>can</strong> use.</p>
</li>
<li>
<p><a id="video-std-header-version"></a> <code>stdHeaderVersion</code> is a
<a href="extensions.html#VkExtensionProperties" class="xref page">VkExtensionProperties</a> structure reporting the Video Std header
name and version supported for the video profile.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note:</div>
<div class="paragraph">
<p>It is common for video compression standards to allow using all reference
pictures associated with active DPB slots as active reference pictures,
hence for video decode profiles the values returned in <code>maxDpbSlots</code> and
<code>maxActiveReferencePictures</code> are often equal.
Similarly, in case of video decode profiles supporting field pictures the
value of <code>maxActiveReferencePictures</code> often equals
<span class="eq"><code>maxDpbSlots</code> Ã— 2</span>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoCapabilitiesKHR-sType-sType" href="#VUID-VkVideoCapabilitiesKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoCapabilitiesKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_CAPABILITIES_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoCapabilitiesKHR-pNext-pNext" href="#VUID-VkVideoCapabilitiesKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoCapabilitiesKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="#VkVideoDecodeCapabilitiesKHR">VkVideoDecodeCapabilitiesKHR</a>, <a href="#VkVideoDecodeH264CapabilitiesKHR">VkVideoDecodeH264CapabilitiesKHR</a>, <a href="#VkVideoDecodeH265CapabilitiesKHR">VkVideoDecodeH265CapabilitiesKHR</a>, <a href="#VkVideoEncodeCapabilitiesKHR">VkVideoEncodeCapabilitiesKHR</a>, <a href="#VkVideoEncodeH264CapabilitiesEXT">VkVideoEncodeH264CapabilitiesEXT</a>, or <a href="#VkVideoEncodeH265CapabilitiesEXT">VkVideoEncodeH265CapabilitiesEXT</a></p>
</li>
<li>
<p><a id="VUID-VkVideoCapabilitiesKHR-sType-unique" href="#VUID-VkVideoCapabilitiesKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoCapabilitiesKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in <a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>flags</code> are:</p>
</div>
<div id="VkVideoCapabilityFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef enum VkVideoCapabilityFlagBitsKHR {
    VK_VIDEO_CAPABILITY_PROTECTED_CONTENT_BIT_KHR = 0x00000001,
    VK_VIDEO_CAPABILITY_SEPARATE_REFERENCE_IMAGES_BIT_KHR = 0x00000002,
} VkVideoCapabilityFlagBitsKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_CAPABILITY_PROTECTED_CONTENT_BIT_KHR</code> specifies that video
sessions support producing and consuming protected content.</p>
</li>
<li>
<p><a id="separate-reference-images"></a>
<code>VK_VIDEO_CAPABILITY_SEPARATE_REFERENCE_IMAGES_BIT_KHR</code> specifies
that the <a href="#video-picture-resources">video picture resources</a> associated
with the <a href="#dpb-slot">DPB slots</a> of a video session <strong>can</strong> be backed by
separate <code>VkImage</code> objects.
If this capability flag is not present, then all DPB slots of a video
session <strong>must</strong> be associated with video picture resources backed by the
same <code>VkImage</code> object (e.g. using different layers of the same
image).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoCapabilityFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef VkFlags VkVideoCapabilityFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoCapabilityFlagsKHR</code> is a bitmask type for setting a mask of zero
or more <a href="#VkVideoCapabilityFlagBitsKHR">VkVideoCapabilityFlagBitsKHR</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="video-format-capabilities"><a class="anchor" href="#video-format-capabilities"></a>Video Format Capabilities</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To enumerate the supported output, input and DPB image formats and
corresponding capabilities for a specific video profile, call:</p>
</div>
<div id="vkGetPhysicalDeviceVideoFormatPropertiesKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
VkResult vkGetPhysicalDeviceVideoFormatPropertiesKHR(
    VkPhysicalDevice                            physicalDevice,
    const VkPhysicalDeviceVideoFormatInfoKHR*   pVideoFormatInfo,
    uint32_t*                                   pVideoFormatPropertyCount,
    VkVideoFormatPropertiesKHR*                 pVideoFormatProperties);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>physicalDevice</code> is the physical device from which to query the
video format properties.</p>
</li>
<li>
<p><code>pVideoFormatInfo</code> is a pointer to a
<a href="#VkPhysicalDeviceVideoFormatInfoKHR">VkPhysicalDeviceVideoFormatInfoKHR</a> structure specifying the usage
and video profiles for which supported image formats and capabilities
are returned.</p>
</li>
<li>
<p><code>pVideoFormatPropertyCount</code> is a pointer to an integer related to
the number of video format properties available or queried, as described
below.</p>
</li>
<li>
<p><code>pVideoFormatProperties</code> is a pointer to an array of
<a href="#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a> structures in which supported image
formats and capabilities are returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>pVideoFormatProperties</code> is <code>NULL</code>, then the number of video format
properties supported for the given <code>physicalDevice</code> is returned in
<code>pVideoFormatPropertyCount</code>.
Otherwise, <code>pVideoFormatPropertyCount</code> <strong>must</strong> point to a variable set by
the user to the number of elements in the <code>pVideoFormatProperties</code>
array, and on return the variable is overwritten with the number of values
actually written to <code>pVideoFormatProperties</code>.
If the value of <code>pVideoFormatPropertyCount</code> is less than the number of
video format properties supported, at most <code>pVideoFormatPropertyCount</code>
values will be written to <code>pVideoFormatProperties</code>, and
<code>VK_INCOMPLETE</code> will be returned instead of <code>VK_SUCCESS</code>, to
indicate that not all the available values were returned.</p>
</div>
<div class="paragraph">
<p>Video format properties are always queried with respect to a specific set of
video profiles.
These are specified by chaining the <a href="#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a>
structure to <code>pVideoFormatInfo</code>.</p>
</div>
<div class="paragraph">
<p>For most use cases, the images are used by a single video session and a
single video profile is provided.
For a use case such as video transcoding, where a decode session output
image <strong>can</strong> be used as encode input in one or more encode sessions, multiple
video profiles corresponding to the video sessions that will share the image
<strong>must</strong> be provided.</p>
</div>
<div class="paragraph">
<p>If any of the <a href="#video-profiles">video profiles</a> specified via
<a href="#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a>::<code>pProfiles</code> are not supported, then
this command returns one of the <a href="#video-profile-error-codes">video-profile-specific error codes</a>.
Furthermore, if <a href="#VkPhysicalDeviceVideoFormatInfoKHR">VkPhysicalDeviceVideoFormatInfoKHR</a>::<code>imageUsage</code>
includes any image usage flags not supported by the specified video
profiles, then this command returns
<code>VK_ERROR_IMAGE_USAGE_NOT_SUPPORTED_KHR</code>.</p>
</div>
<div class="paragraph">
<p>This command also returns <code>VK_ERROR_IMAGE_USAGE_NOT_SUPPORTED_KHR</code> if
<a href="#VkPhysicalDeviceVideoFormatInfoKHR">VkPhysicalDeviceVideoFormatInfoKHR</a>::<code>imageUsage</code> does not include
the appropriate flags as dictated by the decode capability flags returned in
<a href="#VkVideoDecodeCapabilitiesKHR">VkVideoDecodeCapabilitiesKHR</a>::<code>flags</code> for any of the profiles
specified in the <a href="#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure provided in the
<code>pNext</code> chain of <code>pVideoFormatInfo</code>.</p>
</div>
<div class="paragraph">
<p>If the decode capability flags include
<code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_COINCIDE_BIT_KHR</code> but not
<code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_DISTINCT_BIT_KHR</code>, then in
order to query video format properties for decode DPB and output usage,
<a href="#VkPhysicalDeviceVideoFormatInfoKHR">VkPhysicalDeviceVideoFormatInfoKHR</a>::<code>imageUsage</code> <strong>must</strong> include
both <code>VK_IMAGE_USAGE_VIDEO_DECODE_DPB_BIT_KHR</code> and
<code>VK_IMAGE_USAGE_VIDEO_DECODE_DST_BIT_KHR</code>.
Otherwise, the call will fail with
<code>VK_ERROR_IMAGE_USAGE_NOT_SUPPORTED_KHR</code>.</p>
</div>
<div class="paragraph">
<p>If the decode capability flags include
<code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_DISTINCT_BIT_KHR</code> but not
<code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_COINCIDE_BIT_KHR</code>, then in
order to query video format properties for decode DPB usage,
<a href="#VkPhysicalDeviceVideoFormatInfoKHR">VkPhysicalDeviceVideoFormatInfoKHR</a>::<code>imageUsage</code> <strong>must</strong> include
<code>VK_IMAGE_USAGE_VIDEO_DECODE_DPB_BIT_KHR</code>, but not
<code>VK_IMAGE_USAGE_VIDEO_DECODE_DST_BIT_KHR</code>.
Otherwise, the call will fail with
<code>VK_ERROR_IMAGE_USAGE_NOT_SUPPORTED_KHR</code>.
Similarly, to query video format properties for decode output usage,
<a href="#VkPhysicalDeviceVideoFormatInfoKHR">VkPhysicalDeviceVideoFormatInfoKHR</a>::<code>imageUsage</code> <strong>must</strong> include
<code>VK_IMAGE_USAGE_VIDEO_DECODE_DST_BIT_KHR</code>, but not
<code>VK_IMAGE_USAGE_VIDEO_DECODE_DPB_BIT_KHR</code>.
Otherwise, the call will fail with
<code>VK_ERROR_IMAGE_USAGE_NOT_SUPPORTED_KHR</code>.</p>
</div>
<div class="paragraph">
<p>The <code>imageUsage</code> member of the <a href="#VkPhysicalDeviceVideoFormatInfoKHR">VkPhysicalDeviceVideoFormatInfoKHR</a>
structure specifies the expected video usage flags that the returned video
formats <strong>must</strong> support.
Correspondingly, the <code>imageUsageFlags</code> member of each
<a href="#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a> structure returned will contain at least
the same set of image usage flags.</p>
</div>
<div class="paragraph">
<p>If the implementation supports using video input, output, or DPB images of a
particular format in operations other than video decode/encode then the
<code>imageUsageFlags</code> member of the corresponding
<a href="#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a> structure returned will include additional
image usage flags indicating that.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note:</div>
<div class="paragraph">
<p>For most use cases, only decode or encode related usage flags are going to
be specified.
For a use case such as transcode, if the image were to be shared between
decode and encode session(s), then both decode and encode related usage
flags <strong>can</strong> be set.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Multiple <code>VkVideoFormatPropertiesKHR</code> entries <strong>may</strong> be returned with the
same <code>format</code> member with different <code>componentMapping</code>,
<code>imageType</code>, or <code>imageTiling</code> values, as described later.</p>
</div>
<div class="paragraph">
<p>In addition, a different set of <code>VkVideoFormatPropertiesKHR</code> entries
<strong>may</strong> be returned depending on the <code>imageUsage</code> member of the
<code>VkPhysicalDeviceVideoFormatInfoKHR</code> structure, even for the same set of
video profiles, for example, based on whether encode input, encode DPB,
decode output, and/or decode DPB usage is requested.</p>
</div>
<div class="paragraph">
<p>The application <strong>can</strong> select the parameters returned in the
<code>VkVideoFormatPropertiesKHR</code> entries and use compatible parameters when
creating the input, output, and DPB images.
The implementation will report all image creation and usage flags that are
valid for images used with the requested video profiles but applications
<strong>should</strong> create images only with those that are necessary for the particular
use case.</p>
</div>
<div class="paragraph">
<p>Before creating an image, the application <strong>can</strong> obtain the complete set of
supported image format features by calling
<a href="capabilities.html#vkGetPhysicalDeviceImageFormatProperties2" class="xref page">vkGetPhysicalDeviceImageFormatProperties2</a> using parameters derived
from the members of one of the reported <code>VkVideoFormatPropertiesKHR</code>
entries and adding the same <a href="#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure to the
<code>pNext</code> chain of <a href="capabilities.html#VkPhysicalDeviceImageFormatInfo2" class="xref page">VkPhysicalDeviceImageFormatInfo2</a>.</p>
</div>
<div class="paragraph">
<p>The following applies to all <code>VkVideoFormatPropertiesKHR</code> entries
returned by <code>vkGetPhysicalDeviceVideoFormatPropertiesKHR</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="formats.html#vkGetPhysicalDeviceFormatProperties2" class="xref page">vkGetPhysicalDeviceFormatProperties2</a> <strong>must</strong> succeed when called
with <code>VkVideoFormatPropertiesKHR</code>::<code>format</code></p>
</li>
<li>
<p>If <code>VkVideoFormatPropertiesKHR</code>::<code>imageTiling</code> is
<code>VK_IMAGE_TILING_OPTIMAL</code>, then the <code>optimalTilingFeatures</code>
returned by <a href="formats.html#vkGetPhysicalDeviceFormatProperties2" class="xref page">vkGetPhysicalDeviceFormatProperties2</a> <strong>must</strong> include all
format features required by the image usage flags reported in
<code>VkVideoFormatPropertiesKHR</code>::<code>imageUsageFlags</code> for the format,
as indicated in the <a href="formats.html#format-feature-dependent-usage-flags" class="xref page">Format    Feature Dependent Usage Flags</a> section.</p>
</li>
<li>
<p>If <code>VkVideoFormatPropertiesKHR</code>::<code>imageTiling</code> is
<code>VK_IMAGE_TILING_LINEAR</code>, then the <code>linearTilingFeatures</code>
returned by <a href="formats.html#vkGetPhysicalDeviceFormatProperties2" class="xref page">vkGetPhysicalDeviceFormatProperties2</a> <strong>must</strong> include all
format features required by the image usage flags reported in
<code>VkVideoFormatPropertiesKHR</code>::<code>imageUsageFlags</code> for the format,
as indicated in the <a href="formats.html#format-feature-dependent-usage-flags" class="xref page">Format    Feature Dependent Usage Flags</a> section.</p>
</li>
<li>
<p><a href="capabilities.html#vkGetPhysicalDeviceImageFormatProperties2" class="xref page">vkGetPhysicalDeviceImageFormatProperties2</a> <strong>must</strong> succeed when
called with a <a href="capabilities.html#VkPhysicalDeviceImageFormatInfo2" class="xref page">VkPhysicalDeviceImageFormatInfo2</a> structure
containing the following information:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>pNext</code> chain including the same
<a href="#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure used to call
<code>vkGetPhysicalDeviceVideoFormatPropertiesKHR</code>.</p>
</li>
<li>
<p><code>format</code> set to the value of
<code>VkVideoFormatPropertiesKHR</code>::<code>format</code>.</p>
</li>
<li>
<p><code>type</code> set to the value of
<code>VkVideoFormatPropertiesKHR</code>::<code>imageType</code>.</p>
</li>
<li>
<p><code>tiling</code> set to the value of
<code>VkVideoFormatPropertiesKHR</code>::<code>imageTiling</code>.</p>
</li>
<li>
<p><code>usage</code> set to the value of
<code>VkVideoFormatPropertiesKHR</code>::<code>imageUsageFlags</code>.</p>
</li>
<li>
<p><code>flags</code> set to the value of
<code>VkVideoFormatPropertiesKHR</code>::<code>imageCreateFlags</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>componentMapping</code> member of <code>VkVideoFormatPropertiesKHR</code>
defines the ordering of the Yâ€²C<sub>B</sub>C<sub>R</sub> color channels from the perspective of
the video codec operations specified in <a href="#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a>.
For example, if the implementation produces video decode output with the
format <code>VK_FORMAT_G8_B8R8_2PLANE_420_UNORM</code> where the blue and red
chrominance channels are swapped then the <code>componentMapping</code> member of
the corresponding <code>VkVideoFormatPropertiesKHR</code> structure will have the
following member values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">components.r = VK_COMPONENT_SWIZZLE_B;        // Cb component
components.g = VK_COMPONENT_SWIZZLE_IDENTITY; // Y component
components.b = VK_COMPONENT_SWIZZLE_R;        // Cr component
components.a = VK_COMPONENT_SWIZZLE_IDENTITY; // unused, defaults to 1.0</code></pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pNext-06812" href="#VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pNext-06812"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pNext-06812</span><br>

The <code>pNext</code> chain of <code>pVideoFormatInfo</code> <strong>must</strong> include a
<a href="#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure with <code>profileCount</code>
greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-physicalDevice-parameter" href="#VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-physicalDevice-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-physicalDevice-parameter</span><br>
 <code>physicalDevice</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkPhysicalDevice" class="xref page">VkPhysicalDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pVideoFormatInfo-parameter" href="#VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pVideoFormatInfo-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pVideoFormatInfo-parameter</span><br>
 <code>pVideoFormatInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkPhysicalDeviceVideoFormatInfoKHR">VkPhysicalDeviceVideoFormatInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pVideoFormatPropertyCount-parameter" href="#VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pVideoFormatPropertyCount-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pVideoFormatPropertyCount-parameter</span><br>
 <code>pVideoFormatPropertyCount</code> <strong>must</strong> be a valid pointer to a <code>uint32_t</code> value</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pVideoFormatProperties-parameter" href="#VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pVideoFormatProperties-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pVideoFormatProperties-parameter</span><br>
 If the value referenced by <code>pVideoFormatPropertyCount</code> is not <code>0</code>, and <code>pVideoFormatProperties</code> is not <code>NULL</code>, <code>pVideoFormatProperties</code> <strong>must</strong> be a valid pointer to an array of <code>pVideoFormatPropertyCount</code> <a href="#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a> structures</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_INCOMPLETE</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_IMAGE_USAGE_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_OPERATION_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_FORMAT_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PICTURE_LAYOUT_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_CODEC_NOT_SUPPORTED_KHR</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPhysicalDeviceVideoFormatInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkPhysicalDeviceVideoFormatInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef struct VkPhysicalDeviceVideoFormatInfoKHR {
    VkStructureType      sType;
    const void*          pNext;
    VkImageUsageFlags    imageUsage;
} VkPhysicalDeviceVideoFormatInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>imageUsage</code> is a bitmask of <a href="resources.html#VkImageUsageFlagBits" class="xref page">VkImageUsageFlagBits</a> specifying
the intended usage of the video images.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPhysicalDeviceVideoFormatInfoKHR-sType-sType" href="#VUID-VkPhysicalDeviceVideoFormatInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkPhysicalDeviceVideoFormatInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_PHYSICAL_DEVICE_VIDEO_FORMAT_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkPhysicalDeviceVideoFormatInfoKHR-pNext-pNext" href="#VUID-VkPhysicalDeviceVideoFormatInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkPhysicalDeviceVideoFormatInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code> or a pointer to a valid instance of <a href="#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkPhysicalDeviceVideoFormatInfoKHR-sType-unique" href="#VUID-VkPhysicalDeviceVideoFormatInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkPhysicalDeviceVideoFormatInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkPhysicalDeviceVideoFormatInfoKHR-imageUsage-parameter" href="#VUID-VkPhysicalDeviceVideoFormatInfoKHR-imageUsage-parameter"></a> <span class="vuid">VUID-VkPhysicalDeviceVideoFormatInfoKHR-imageUsage-parameter</span><br>
 <code>imageUsage</code> <strong>must</strong> be a valid combination of <a href="resources.html#VkImageUsageFlagBits" class="xref page">VkImageUsageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkPhysicalDeviceVideoFormatInfoKHR-imageUsage-requiredbitmask" href="#VUID-VkPhysicalDeviceVideoFormatInfoKHR-imageUsage-requiredbitmask"></a> <span class="vuid">VUID-VkPhysicalDeviceVideoFormatInfoKHR-imageUsage-requiredbitmask</span><br>
 <code>imageUsage</code> <strong>must</strong> not be <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoFormatPropertiesKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoFormatPropertiesKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef struct VkVideoFormatPropertiesKHR {
    VkStructureType       sType;
    void*                 pNext;
    VkFormat              format;
    VkComponentMapping    componentMapping;
    VkImageCreateFlags    imageCreateFlags;
    VkImageType           imageType;
    VkImageTiling         imageTiling;
    VkImageUsageFlags     imageUsageFlags;
} VkVideoFormatPropertiesKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>format</code> is a <a href="formats.html#VkFormat" class="xref page">VkFormat</a> that specifies the format that <strong>can</strong> be
used with the specified video profiles and image usages.</p>
</li>
<li>
<p><code>componentMapping</code> defines the color channel order used for the
format.
<code>format</code> along with <code>componentMapping</code> describe how the color
channels are ordered when producing video decoder output or are expected
to be ordered in video encoder input, when applicable.
If the <code>format</code> reported does not require component swizzling then
all members of <code>componentMapping</code> will be set to
<code>VK_COMPONENT_SWIZZLE_IDENTITY</code>.</p>
</li>
<li>
<p><code>imageCreateFlags</code> is a bitmask of <a href="resources.html#VkImageCreateFlagBits" class="xref page">VkImageCreateFlagBits</a>
specifying the supported image creation flags for the format.</p>
</li>
<li>
<p><code>imageType</code> is a <a href="resources.html#VkImageType" class="xref page">VkImageType</a> that specifies the image type the
format <strong>can</strong> be used with.</p>
</li>
<li>
<p><code>imageTiling</code> is a <a href="resources.html#VkImageTiling" class="xref page">VkImageTiling</a> that specifies the image
tiling the format <strong>can</strong> be used with.</p>
</li>
<li>
<p><code>imageUsageFlags</code> is a bitmask of <a href="resources.html#VkImageUsageFlagBits" class="xref page">VkImageUsageFlagBits</a>
specifying the supported image usage flags for the format.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoFormatPropertiesKHR-sType-sType" href="#VUID-VkVideoFormatPropertiesKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoFormatPropertiesKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_FORMAT_PROPERTIES_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoFormatPropertiesKHR-pNext-pNext" href="#VUID-VkVideoFormatPropertiesKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoFormatPropertiesKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="video-session"><a class="anchor" href="#video-session"></a>Video Sessions</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Video sessions are objects that represent and maintain the state needed to
perform video decode or encode operations using a specific video profile.</p>
</div>
<div class="paragraph">
<p>Video sessions are represented by <code>VkVideoSessionKHR</code> handles:</p>
</div>
<div id="VkVideoSessionKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkVideoSessionKHR)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="video-session-creation"><a class="anchor" href="#video-session-creation"></a>Creating a Video Session</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a video session object, call:</p>
</div>
<div id="vkCreateVideoSessionKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
VkResult vkCreateVideoSessionKHR(
    VkDevice                                    device,
    const VkVideoSessionCreateInfoKHR*          pCreateInfo,
    const VkAllocationCallbacks*                pAllocator,
    VkVideoSessionKHR*                          pVideoSession);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the video session.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to a <a href="#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>
structure containing parameters to be used to create the video session.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="memory.html#memory-allocation" class="xref page">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pVideoSession</code> is a pointer to a <a href="#VkVideoSessionKHR">VkVideoSessionKHR</a> handle in
which the resulting video session object is returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The resulting video session object is said to be created with the video
codec operation specified in
<code>pCreateInfo-&gt;pVideoProfile&#8594;videoCodecOperation</code>.</p>
</div>
<div class="paragraph">
<p>The name and version of the codec-specific Video Std header to be used with
the video session is specified by the <a href="extensions.html#VkExtensionProperties" class="xref page">VkExtensionProperties</a> structure
pointed to by <code>pCreateInfo-&gt;pStdHeaderVersion</code>.
If a non-existent or unsupported Video Std header version is specified in
<code>pCreateInfo-&gt;pStdHeaderVersion&#8594;specVersion</code>, then this command returns
<code>VK_ERROR_VIDEO_STD_VERSION_NOT_SUPPORTED_KHR</code>.</p>
</div>
<div id="video-session-uninitialized" class="paragraph">
<p>Video session objects are created in <em>uninitialized</em> state.
In order to transition the video session into <em>initial</em> state, the
application <strong>must</strong> issue a <a href="#vkCmdControlVideoCodingKHR">vkCmdControlVideoCodingKHR</a> command with
<a href="#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a>::<code>flags</code> including
<code>VK_VIDEO_CODING_CONTROL_RESET_BIT_KHR</code>.</p>
</div>
<div class="paragraph">
<p>Video session objects also maintain the
<a href="#dpb-state-and-backing-store">state</a> of the DPB.
The number of DPB slots usable with the created video session is specified
in <code>pCreateInfo-&gt;maxDpbSlots</code>, and each slot is initially in the
<a href="#dpb-slot-states">inactive state</a>.</p>
</div>
<div class="paragraph">
<p>Each <a href="#dpb-slot">DPB slot</a> maintained by the created video session <strong>can</strong>
refer to a <a href="#reference-picture">reference picture</a> representing a video
frame.</p>
</div>
<div id="decode-h264-interlaced-support" class="paragraph">
<p>In addition, if the <code>videoCodecOperation</code> member of the
<a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure pointed to by
<code>pCreateInfo-&gt;pVideoProfile</code> is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> and the
<code>pictureLayout</code> member of the <a href="#VkVideoDecodeH264ProfileInfoKHR">VkVideoDecodeH264ProfileInfoKHR</a>
structure provided in the <a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>::<code>pNext</code> chain is
not <code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_PROGRESSIVE_KHR</code>, then the
created video session supports <em>interlaced</em> frames and each <a href="#dpb-slot">DPB slot</a> maintained by the created video session <strong>can</strong> instead refer to
separate top field and bottom field <a href="#reference-picture">reference pictures</a>
that together <strong>can</strong> represent a full video frame.
In this case, it is up to the application, driven by the video content,
whether it associates any individual DPB slot with separate top and/or
bottom field pictures or a single picture representing a full frame.</p>
</div>
<div class="paragraph">
<p>The created video session <strong>can</strong> be used to perform video coding operations
using video frames up to the maximum size specified in
<code>pCreateInfo-&gt;maxCodedExtent</code>.
The minimum frame size allowed is implicitly derived from
<a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>minCodedExtent</code>, as returned by
<a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile
specified by <code>pCreateInfo-&gt;pVideoProfile</code>.
Accordingly, the created video session is said to be created with a
<code>minCodedExtent</code> equal to that.</p>
</div>
<div class="paragraph">
<p>In case of video session objects created with a video encode operation,
implementations <strong>may</strong> return the
<code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code> error if any of the
specified Video Std parameters do not adhere to the syntactic or semantic
requirements of the used video compression standard, or if values derived
from parameters according to the rules defined by the used video compression
standard do not adhere to the capabilities of the video compression standard
or the implementation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications <strong>should</strong> not rely on the
<code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code> error being returned by any
command as a means to verify Video Std parameters, as implementations are
not required to report the error in any specific set of cases.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateVideoSessionKHR-device-parameter" href="#VUID-vkCreateVideoSessionKHR-device-parameter"></a> <span class="vuid">VUID-vkCreateVideoSessionKHR-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateVideoSessionKHR-pCreateInfo-parameter" href="#VUID-vkCreateVideoSessionKHR-pCreateInfo-parameter"></a> <span class="vuid">VUID-vkCreateVideoSessionKHR-pCreateInfo-parameter</span><br>
 <code>pCreateInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateVideoSessionKHR-pAllocator-parameter" href="#VUID-vkCreateVideoSessionKHR-pAllocator-parameter"></a> <span class="vuid">VUID-vkCreateVideoSessionKHR-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong>must</strong> be a valid pointer to a valid <a href="memory.html#VkAllocationCallbacks" class="xref page">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateVideoSessionKHR-pVideoSession-parameter" href="#VUID-vkCreateVideoSessionKHR-pVideoSession-parameter"></a> <span class="vuid">VUID-vkCreateVideoSessionKHR-pVideoSession-parameter</span><br>
 <code>pVideoSession</code> <strong>must</strong> be a valid pointer to a <a href="#VkVideoSessionKHR">VkVideoSessionKHR</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_INITIALIZATION_FAILED</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_STD_VERSION_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <a href="#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a> structure is defined as:</p>
</div>
<div id="VkVideoSessionCreateInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef struct VkVideoSessionCreateInfoKHR {
    VkStructureType                 sType;
    const void*                     pNext;
    uint32_t                        queueFamilyIndex;
    VkVideoSessionCreateFlagsKHR    flags;
    const VkVideoProfileInfoKHR*    pVideoProfile;
    VkFormat                        pictureFormat;
    VkExtent2D                      maxCodedExtent;
    VkFormat                        referencePictureFormat;
    uint32_t                        maxDpbSlots;
    uint32_t                        maxActiveReferencePictures;
    const VkExtensionProperties*    pStdHeaderVersion;
} VkVideoSessionCreateInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>queueFamilyIndex</code> is the index of the queue family the created
video session will be used with.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkVideoSessionCreateFlagBitsKHR">VkVideoSessionCreateFlagBitsKHR</a>
specifying creation flags.</p>
</li>
<li>
<p><code>pVideoProfile</code> is a pointer to a <a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>
structure specifying the video profile the created video session will be
used with.</p>
</li>
<li>
<p><code>pictureFormat</code> is the image format the created video session will
be used with.
If <code>pVideoProfile-&gt;videoCodecOperation</code> specifies a decode
operation, then <code>pictureFormat</code> is the image format of
<a href="#decode-output-picture">decode output pictures</a> usable with the
created video session.
If <code>pVideoProfile-&gt;videoCodecOperation</code> specifies an encode
operation, then <code>pictureFormat</code> is the image format of
<a href="#encode-input-picture">encode input pictures</a> usable with the created
video session.</p>
</li>
<li>
<p><code>maxCodedExtent</code> is the maximum width and height of the coded frames
the created video session will be used with.</p>
</li>
<li>
<p><code>referencePictureFormat</code> is the image format of
<a href="#reference-picture">reference pictures</a> stored in the <a href="#dpb">DPB</a> the
created video session will be used with.</p>
</li>
<li>
<p><code>maxDpbSlots</code> is the maximum number of <a href="#dpb-slot">DPB Slots</a> that
<strong>can</strong> be used with the created video session.</p>
</li>
<li>
<p><code>maxActiveReferencePictures</code> is the maximum number of
<a href="#active-reference-pictures">active reference pictures</a> that <strong>can</strong> be
used in a single video coding operation using the created video session.</p>
</li>
<li>
<p><code>pStdHeaderVersion</code> is a pointer to a <a href="extensions.html#VkExtensionProperties" class="xref page">VkExtensionProperties</a>
structure requesting the Video Std header version to use for the
<code>videoCodecOperation</code> specified in <code>pVideoProfile</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-protectedMemory-07189" href="#VUID-VkVideoSessionCreateInfoKHR-protectedMemory-07189"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-protectedMemory-07189</span><br>

If the <a href="features.html#features-protectedMemory" class="xref page"><code>protectedMemory</code></a> feature is
not enabled or if <a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>flags</code> does not
include <code>VK_VIDEO_CAPABILITY_PROTECTED_CONTENT_BIT_KHR</code>, as returned
by <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile
specified by <code>pVideoProfile</code>, then <code>flags</code> <strong>must</strong> not include
<code>VK_VIDEO_SESSION_CREATE_PROTECTED_CONTENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-04845" href="#VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-04845"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-04845</span><br>

<code>pVideoProfile</code> <strong>must</strong> be a <a href="#video-profile-support">supported video    profile</a></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-maxDpbSlots-04847" href="#VUID-VkVideoSessionCreateInfoKHR-maxDpbSlots-04847"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-maxDpbSlots-04847</span><br>

<code>maxDpbSlots</code> <strong>must</strong> be less than or equal to
<a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>maxDpbSlots</code>, as returned by
<a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile
specified by <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-maxActiveReferencePictures-04849" href="#VUID-VkVideoSessionCreateInfoKHR-maxActiveReferencePictures-04849"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-maxActiveReferencePictures-04849</span><br>

<code>maxActiveReferencePictures</code> <strong>must</strong> be less than or equal to
<a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>maxActiveReferencePictures</code>, as
returned by <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile specified by <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-maxDpbSlots-04850" href="#VUID-VkVideoSessionCreateInfoKHR-maxDpbSlots-04850"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-maxDpbSlots-04850</span><br>

If either <code>maxDpbSlots</code> or <code>maxActiveReferencePictures</code> is <code>0</code>,
then both <strong>must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-maxCodedExtent-04851" href="#VUID-VkVideoSessionCreateInfoKHR-maxCodedExtent-04851"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-maxCodedExtent-04851</span><br>

<code>maxCodedExtent</code> <strong>must</strong> be between
<a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>minCodedExtent</code> and
<a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>maxCodedExtent</code>, inclusive, as
returned by <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile specified by <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-referencePictureFormat-04852" href="#VUID-VkVideoSessionCreateInfoKHR-referencePictureFormat-04852"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-referencePictureFormat-04852</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> specifies a decode operation
and <code>maxActiveReferencePictures</code> is greater than <code>0</code>, then
<code>referencePictureFormat</code> <strong>must</strong> be one of the supported decode DPB
formats, as returned by
<a href="#vkGetPhysicalDeviceVideoFormatPropertiesKHR">vkGetPhysicalDeviceVideoFormatPropertiesKHR</a> in
<a href="#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a>::<code>format</code> when called with the
<code>imageUsage</code> member of its <code>pVideoFormatInfo</code> parameter
containing <code>VK_IMAGE_USAGE_VIDEO_DECODE_DPB_BIT_KHR</code>, and with a
<a href="#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure specified in the <code>pNext</code>
chain of its <code>pVideoFormatInfo</code> parameter whose <code>pProfiles</code>
member contains an element matching <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-referencePictureFormat-06814" href="#VUID-VkVideoSessionCreateInfoKHR-referencePictureFormat-06814"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-referencePictureFormat-06814</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> specifies an encode
operation and <code>maxActiveReferencePictures</code> is greater than <code>0</code>, then
<code>referencePictureFormat</code> <strong>must</strong> be one of the supported decode DPB
formats, as returned by then <code>referencePictureFormat</code> <strong>must</strong> be one
of the supported encode DPB formats, as returned by
<a href="#vkGetPhysicalDeviceVideoFormatPropertiesKHR">vkGetPhysicalDeviceVideoFormatPropertiesKHR</a> in
<a href="#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a>::<code>format</code> when called with the
<code>imageUsage</code> member of its <code>pVideoFormatInfo</code> parameter
containing <code>VK_IMAGE_USAGE_VIDEO_ENCODE_DPB_BIT_KHR</code>, and with a
<a href="#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure specified in the <code>pNext</code>
chain of its <code>pVideoFormatInfo</code> parameter whose <code>pProfiles</code>
member contains an element matching <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pictureFormat-04853" href="#VUID-VkVideoSessionCreateInfoKHR-pictureFormat-04853"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pictureFormat-04853</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> specifies a decode
operation, then <code>pictureFormat</code> <strong>must</strong> be one of the supported decode
output formats, as returned by
<a href="#vkGetPhysicalDeviceVideoFormatPropertiesKHR">vkGetPhysicalDeviceVideoFormatPropertiesKHR</a> in
<a href="#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a>::<code>format</code> when called with the
<code>imageUsage</code> member of its <code>pVideoFormatInfo</code> parameter
containing <code>VK_IMAGE_USAGE_VIDEO_DECODE_DST_BIT_KHR</code>, and with a
<a href="#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure specified in the <code>pNext</code>
chain of its <code>pVideoFormatInfo</code> parameter whose <code>pProfiles</code>
member contains an element matching <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pictureFormat-04854" href="#VUID-VkVideoSessionCreateInfoKHR-pictureFormat-04854"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pictureFormat-04854</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> specifies an encode
operation, then <code>pictureFormat</code> <strong>must</strong> be one of the supported encode
input formats, as returned by
<a href="#vkGetPhysicalDeviceVideoFormatPropertiesKHR">vkGetPhysicalDeviceVideoFormatPropertiesKHR</a> in
<a href="#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a>::<code>format</code> when called with the
<code>imageUsage</code> member of its <code>pVideoFormatInfo</code> parameter
containing <code>VK_IMAGE_USAGE_VIDEO_ENCODE_SRC_BIT_KHR</code>, and with a
<a href="#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure specified in the <code>pNext</code>
chain of its <code>pVideoFormatInfo</code> parameter whose <code>pProfiles</code>
member contains an element matching <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-07190" href="#VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-07190"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-07190</span><br>

<code>pStdHeaderVersion-&gt;extensionName</code> <strong>must</strong> match
<a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>stdHeaderVersion.extensionName</code>, as
returned by <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile specified by <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-07191" href="#VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-07191"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-07191</span><br>

<code>pStdHeaderVersion-&gt;specVersion</code> <strong>must</strong> be less than or equal to
<a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>stdHeaderVersion.specVersion</code>, as
returned by <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile specified by <code>pVideoProfile</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-sType-sType" href="#VUID-VkVideoSessionCreateInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_SESSION_CREATE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pNext-pNext" href="#VUID-VkVideoSessionCreateInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="#VkVideoEncodeH264SessionCreateInfoEXT">VkVideoEncodeH264SessionCreateInfoEXT</a> or <a href="#VkVideoEncodeH265SessionCreateInfoEXT">VkVideoEncodeH265SessionCreateInfoEXT</a></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-sType-unique" href="#VUID-VkVideoSessionCreateInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-flags-parameter" href="#VUID-VkVideoSessionCreateInfoKHR-flags-parameter"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkVideoSessionCreateFlagBitsKHR">VkVideoSessionCreateFlagBitsKHR</a> values</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-parameter" href="#VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-parameter"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-parameter</span><br>
 <code>pVideoProfile</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pictureFormat-parameter" href="#VUID-VkVideoSessionCreateInfoKHR-pictureFormat-parameter"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pictureFormat-parameter</span><br>
 <code>pictureFormat</code> <strong>must</strong> be a valid <a href="formats.html#VkFormat" class="xref page">VkFormat</a> value</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-referencePictureFormat-parameter" href="#VUID-VkVideoSessionCreateInfoKHR-referencePictureFormat-parameter"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-referencePictureFormat-parameter</span><br>
 <code>referencePictureFormat</code> <strong>must</strong> be a valid <a href="formats.html#VkFormat" class="xref page">VkFormat</a> value</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-parameter" href="#VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-parameter"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-parameter</span><br>
 <code>pStdHeaderVersion</code> <strong>must</strong> be a valid pointer to a valid <a href="extensions.html#VkExtensionProperties" class="xref page">VkExtensionProperties</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in <a href="#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>flags</code>
are:</p>
</div>
<div id="VkVideoSessionCreateFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef enum VkVideoSessionCreateFlagBitsKHR {
    VK_VIDEO_SESSION_CREATE_PROTECTED_CONTENT_BIT_KHR = 0x00000001,
#ifdef VK_ENABLE_BETA_EXTENSIONS
  // Provided by VK_KHR_video_encode_queue
    VK_VIDEO_SESSION_CREATE_ALLOW_ENCODE_PARAMETER_OPTIMIZATIONS_BIT_KHR = 0x00000002,
#endif
} VkVideoSessionCreateFlagBitsKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_SESSION_CREATE_PROTECTED_CONTENT_BIT_KHR</code> specifies that
the video session uses protected video content.</p>
</li>
<li>
<p><code>VK_VIDEO_SESSION_CREATE_ALLOW_ENCODE_PARAMETER_OPTIMIZATIONS_BIT_KHR</code>
specifies that the implementation is allowed to override video session
parameters and other codec-specific encoding parameters to optimize
video encode operations based on the specific use case defined by the
<a href="#video-profiles">video profile</a> and the used video encode quality
level.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoSessionCreateFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef VkFlags VkVideoSessionCreateFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoSessionCreateFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <a href="#VkVideoSessionCreateFlagBitsKHR">VkVideoSessionCreateFlagBitsKHR</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="video-session-destruction"><a class="anchor" href="#video-session-destruction"></a>Destroying a Video Session</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a video session, call:</p>
</div>
<div id="vkDestroyVideoSessionKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
void vkDestroyVideoSessionKHR(
    VkDevice                                    device,
    VkVideoSessionKHR                           videoSession,
    const VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the video session.</p>
</li>
<li>
<p><code>videoSession</code> is the video session to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="memory.html#memory-allocation" class="xref page">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyVideoSessionKHR-videoSession-07192" href="#VUID-vkDestroyVideoSessionKHR-videoSession-07192"></a> <span class="vuid">VUID-vkDestroyVideoSessionKHR-videoSession-07192</span><br>

All submitted commands that refer to <code>videoSession</code> <strong>must</strong> have
completed execution</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionKHR-videoSession-07193" href="#VUID-vkDestroyVideoSessionKHR-videoSession-07193"></a> <span class="vuid">VUID-vkDestroyVideoSessionKHR-videoSession-07193</span><br>

If <code>VkAllocationCallbacks</code> were provided when <code>videoSession</code> was
created, a compatible set of callbacks <strong>must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionKHR-videoSession-07194" href="#VUID-vkDestroyVideoSessionKHR-videoSession-07194"></a> <span class="vuid">VUID-vkDestroyVideoSessionKHR-videoSession-07194</span><br>

If no <code>VkAllocationCallbacks</code> were provided when <code>videoSession</code>
was created, <code>pAllocator</code> <strong>must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyVideoSessionKHR-device-parameter" href="#VUID-vkDestroyVideoSessionKHR-device-parameter"></a> <span class="vuid">VUID-vkDestroyVideoSessionKHR-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionKHR-videoSession-parameter" href="#VUID-vkDestroyVideoSessionKHR-videoSession-parameter"></a> <span class="vuid">VUID-vkDestroyVideoSessionKHR-videoSession-parameter</span><br>
 If <code>videoSession</code> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, <code>videoSession</code> <strong>must</strong> be a valid <a href="#VkVideoSessionKHR">VkVideoSessionKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionKHR-pAllocator-parameter" href="#VUID-vkDestroyVideoSessionKHR-pAllocator-parameter"></a> <span class="vuid">VUID-vkDestroyVideoSessionKHR-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong>must</strong> be a valid pointer to a valid <a href="memory.html#VkAllocationCallbacks" class="xref page">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionKHR-videoSession-parent" href="#VUID-vkDestroyVideoSessionKHR-videoSession-parent"></a> <span class="vuid">VUID-vkDestroyVideoSessionKHR-videoSession-parent</span><br>
 If <code>videoSession</code> is a valid handle, it <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>videoSession</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="video-session-memory-association"><a class="anchor" href="#video-session-memory-association"></a>Video Session Memory Association</h3>
<div class="paragraph">
<p>After creating a video session object, and before the object <strong>can</strong> be used to
record video coding operations into command buffers using it, the
application <strong>must</strong> allocate and bind device memory to the video session.
Device memory is allocated separately (see <a href="memory.html#memory-device" class="xref page">Device Memory</a>) and then
associated with the video session.</p>
</div>
<div class="paragraph">
<p>Video sessions <strong>may</strong> have multiple memory bindings identified by unique
unsigned integer values.
Appropriate device memory <strong>must</strong> be bound to each such memory binding before
using the video session to record command buffer commands with it.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To determine the memory requirements for a video session object, call:</p>
</div>
<div id="vkGetVideoSessionMemoryRequirementsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
VkResult vkGetVideoSessionMemoryRequirementsKHR(
    VkDevice                                    device,
    VkVideoSessionKHR                           videoSession,
    uint32_t*                                   pMemoryRequirementsCount,
    VkVideoSessionMemoryRequirementsKHR*        pMemoryRequirements);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the video session.</p>
</li>
<li>
<p><code>videoSession</code> is the video session to query.</p>
</li>
<li>
<p><code>pMemoryRequirementsCount</code> is a pointer to an integer related to the
number of memory binding requirements available or queried, as described
below.</p>
</li>
<li>
<p><code>pMemoryRequirements</code> is <code>NULL</code> or a pointer to an array of
<a href="#VkVideoSessionMemoryRequirementsKHR">VkVideoSessionMemoryRequirementsKHR</a> structures in which the memory
binding requirements of the video session are returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>pMemoryRequirements</code> is <code>NULL</code>, then the number of memory bindings
required for the video session is returned in
<code>pMemoryRequirementsCount</code>.
Otherwise, <code>pMemoryRequirementsCount</code> <strong>must</strong> point to a variable set by
the user with the number of elements in the <code>pMemoryRequirements</code> array,
and on return the variable is overwritten with the number of memory binding
requirements actually written to <code>pMemoryRequirements</code>.
If <code>pMemoryRequirementsCount</code> is less than the number of memory bindings
required for the video session, then at most <code>pMemoryRequirementsCount</code>
elements will be written to <code>pMemoryRequirements</code>, and
<code>VK_INCOMPLETE</code> will be returned, instead of <code>VK_SUCCESS</code>, to
indicate that not all required memory binding requirements were returned.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetVideoSessionMemoryRequirementsKHR-device-parameter" href="#VUID-vkGetVideoSessionMemoryRequirementsKHR-device-parameter"></a> <span class="vuid">VUID-vkGetVideoSessionMemoryRequirementsKHR-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetVideoSessionMemoryRequirementsKHR-videoSession-parameter" href="#VUID-vkGetVideoSessionMemoryRequirementsKHR-videoSession-parameter"></a> <span class="vuid">VUID-vkGetVideoSessionMemoryRequirementsKHR-videoSession-parameter</span><br>
 <code>videoSession</code> <strong>must</strong> be a valid <a href="#VkVideoSessionKHR">VkVideoSessionKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetVideoSessionMemoryRequirementsKHR-pMemoryRequirementsCount-parameter" href="#VUID-vkGetVideoSessionMemoryRequirementsKHR-pMemoryRequirementsCount-parameter"></a> <span class="vuid">VUID-vkGetVideoSessionMemoryRequirementsKHR-pMemoryRequirementsCount-parameter</span><br>
 <code>pMemoryRequirementsCount</code> <strong>must</strong> be a valid pointer to a <code>uint32_t</code> value</p>
</li>
<li>
<p><a id="VUID-vkGetVideoSessionMemoryRequirementsKHR-pMemoryRequirements-parameter" href="#VUID-vkGetVideoSessionMemoryRequirementsKHR-pMemoryRequirements-parameter"></a> <span class="vuid">VUID-vkGetVideoSessionMemoryRequirementsKHR-pMemoryRequirements-parameter</span><br>
 If the value referenced by <code>pMemoryRequirementsCount</code> is not <code>0</code>, and <code>pMemoryRequirements</code> is not <code>NULL</code>, <code>pMemoryRequirements</code> <strong>must</strong> be a valid pointer to an array of <code>pMemoryRequirementsCount</code> <a href="#VkVideoSessionMemoryRequirementsKHR">VkVideoSessionMemoryRequirementsKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-vkGetVideoSessionMemoryRequirementsKHR-videoSession-parent" href="#VUID-vkGetVideoSessionMemoryRequirementsKHR-videoSession-parent"></a> <span class="vuid">VUID-vkGetVideoSessionMemoryRequirementsKHR-videoSession-parent</span><br>
 <code>videoSession</code> <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_INCOMPLETE</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoSessionMemoryRequirementsKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoSessionMemoryRequirementsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef struct VkVideoSessionMemoryRequirementsKHR {
    VkStructureType         sType;
    void*                   pNext;
    uint32_t                memoryBindIndex;
    VkMemoryRequirements    memoryRequirements;
} VkVideoSessionMemoryRequirementsKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>memoryBindIndex</code> is the index of the memory binding.</p>
</li>
<li>
<p><code>memoryRequirements</code> is a <a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a> structure in
which the requested memory binding requirements for the binding index
specified by <code>memoryBindIndex</code> are returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoSessionMemoryRequirementsKHR-sType-sType" href="#VUID-VkVideoSessionMemoryRequirementsKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoSessionMemoryRequirementsKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_SESSION_MEMORY_REQUIREMENTS_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionMemoryRequirementsKHR-pNext-pNext" href="#VUID-VkVideoSessionMemoryRequirementsKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoSessionMemoryRequirementsKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To attach memory to a video session object, call:</p>
</div>
<div id="vkBindVideoSessionMemoryKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
VkResult vkBindVideoSessionMemoryKHR(
    VkDevice                                    device,
    VkVideoSessionKHR                           videoSession,
    uint32_t                                    bindSessionMemoryInfoCount,
    const VkBindVideoSessionMemoryInfoKHR*      pBindSessionMemoryInfos);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the video session.</p>
</li>
<li>
<p><code>videoSession</code> is the video session to be bound with device memory.</p>
</li>
<li>
<p><code>bindSessionMemoryInfoCount</code> is the number of elements in
<code>pBindSessionMemoryInfos</code>.</p>
</li>
<li>
<p><code>pBindSessionMemoryInfos</code> is a pointer to an array of
<code>bindSessionMemoryInfoCount</code> <a href="#VkBindVideoSessionMemoryInfoKHR">VkBindVideoSessionMemoryInfoKHR</a>
structures specifying memory regions to be bound to specific memory
bindings of the video session.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The valid usage statements below refer to the <a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a>
structure corresponding to a specific element of
<code>pBindSessionMemoryInfos</code>, which is defined as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the <code>memoryBindIndex</code> member of the element of
<code>pBindSessionMemoryInfos</code> in question matches the
<code>memoryBindIndex</code> member of one of the elements returned in
<code>pMemoryRequirements</code> when
<a href="#vkGetVideoSessionMemoryRequirementsKHR">vkGetVideoSessionMemoryRequirementsKHR</a> is called with the same
<code>videoSession</code> and with <code>pMemoryRequirementsCount</code> equal to
<code>bindSessionMemoryInfoCount</code>, then the <code>memoryRequirements</code>
member of that element of <code>pMemoryRequirements</code> is the
<a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a> structure corresponding to the element of
<code>pBindSessionMemoryInfos</code> in question.</p>
</li>
<li>
<p>Otherwise the element of <code>pBindSessionMemoryInfos</code> in question is
said to not have a corresponding <a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a> structure.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-videoSession-07195" href="#VUID-vkBindVideoSessionMemoryKHR-videoSession-07195"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-videoSession-07195</span><br>

The memory binding of <code>videoSession</code> identified by the
<code>memoryBindIndex</code> member of any element of
<code>pBindSessionMemoryInfos</code> <strong>must</strong> not already be backed by a memory
object</p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-memoryBindIndex-07196" href="#VUID-vkBindVideoSessionMemoryKHR-memoryBindIndex-07196"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-memoryBindIndex-07196</span><br>

The <code>memoryBindIndex</code> member of each element of
<code>pBindSessionMemoryInfos</code> <strong>must</strong> be unique within
<code>pBindSessionMemoryInfos</code></p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07197" href="#VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07197"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07197</span><br>

Each element of <code>pBindSessionMemoryInfos</code> <strong>must</strong> have a corresponding
<a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a> structure</p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07198" href="#VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07198"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07198</span><br>

If an element of <code>pBindSessionMemoryInfos</code> has a corresponding
<a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a> structure, then the <code>memory</code> member of
that element of <code>pBindSessionMemoryInfos</code> <strong>must</strong> have been allocated
using one of the memory types allowed in the <code>memoryTypeBits</code> member
of the corresponding <a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a> structure</p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07199" href="#VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07199"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07199</span><br>

If an element of <code>pBindSessionMemoryInfos</code> has a corresponding
<a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a> structure, then the <code>memoryOffset</code> member
of that element of <code>pBindSessionMemoryInfos</code> <strong>must</strong> be an integer
multiple of the <code>alignment</code> member of the corresponding
<a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a> structure</p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07200" href="#VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07200"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07200</span><br>

If an element of <code>pBindSessionMemoryInfos</code> has a corresponding
<a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a> structure, then the <code>memorySize</code> member
of that element of <code>pBindSessionMemoryInfos</code> <strong>must</strong> equal the
<code>size</code> member of the corresponding <a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a>
structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-device-parameter" href="#VUID-vkBindVideoSessionMemoryKHR-device-parameter"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-videoSession-parameter" href="#VUID-vkBindVideoSessionMemoryKHR-videoSession-parameter"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-videoSession-parameter</span><br>
 <code>videoSession</code> <strong>must</strong> be a valid <a href="#VkVideoSessionKHR">VkVideoSessionKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-parameter" href="#VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-parameter"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-parameter</span><br>
 <code>pBindSessionMemoryInfos</code> <strong>must</strong> be a valid pointer to an array of <code>bindSessionMemoryInfoCount</code> valid <a href="#VkBindVideoSessionMemoryInfoKHR">VkBindVideoSessionMemoryInfoKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-bindSessionMemoryInfoCount-arraylength" href="#VUID-vkBindVideoSessionMemoryKHR-bindSessionMemoryInfoCount-arraylength"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-bindSessionMemoryInfoCount-arraylength</span><br>
 <code>bindSessionMemoryInfoCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-videoSession-parent" href="#VUID-vkBindVideoSessionMemoryKHR-videoSession-parent"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-videoSession-parent</span><br>
 <code>videoSession</code> <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>videoSession</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkBindVideoSessionMemoryInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkBindVideoSessionMemoryInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef struct VkBindVideoSessionMemoryInfoKHR {
    VkStructureType    sType;
    const void*        pNext;
    uint32_t           memoryBindIndex;
    VkDeviceMemory     memory;
    VkDeviceSize       memoryOffset;
    VkDeviceSize       memorySize;
} VkBindVideoSessionMemoryInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>memoryBindIndex</code> is the memory binding index to bind memory to.</p>
</li>
<li>
<p><code>memory</code> is the allocated device memory to be bound to the video
session&#8217;s memory binding with index <code>memoryBindIndex</code>.</p>
</li>
<li>
<p><code>memoryOffset</code> is the start offset of the region of <code>memory</code>
which is to be bound.</p>
</li>
<li>
<p><code>memorySize</code> is the size in bytes of the region of <code>memory</code>,
starting from <code>memoryOffset</code> bytes, to be bound.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBindVideoSessionMemoryInfoKHR-memoryOffset-07201" href="#VUID-VkBindVideoSessionMemoryInfoKHR-memoryOffset-07201"></a> <span class="vuid">VUID-VkBindVideoSessionMemoryInfoKHR-memoryOffset-07201</span><br>

<code>memoryOffset</code> <strong>must</strong> be less than the size of <code>memory</code></p>
</li>
<li>
<p><a id="VUID-VkBindVideoSessionMemoryInfoKHR-memorySize-07202" href="#VUID-VkBindVideoSessionMemoryInfoKHR-memorySize-07202"></a> <span class="vuid">VUID-VkBindVideoSessionMemoryInfoKHR-memorySize-07202</span><br>

<code>memorySize</code> <strong>must</strong> be less than or equal to the size of <code>memory</code>
minus <code>memoryOffset</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBindVideoSessionMemoryInfoKHR-sType-sType" href="#VUID-VkBindVideoSessionMemoryInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkBindVideoSessionMemoryInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_BIND_VIDEO_SESSION_MEMORY_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkBindVideoSessionMemoryInfoKHR-pNext-pNext" href="#VUID-VkBindVideoSessionMemoryInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkBindVideoSessionMemoryInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkBindVideoSessionMemoryInfoKHR-memory-parameter" href="#VUID-VkBindVideoSessionMemoryInfoKHR-memory-parameter"></a> <span class="vuid">VUID-VkBindVideoSessionMemoryInfoKHR-memory-parameter</span><br>
 <code>memory</code> <strong>must</strong> be a valid <a href="memory.html#VkDeviceMemory" class="xref page">VkDeviceMemory</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="video-profile-compatibility"><a class="anchor" href="#video-profile-compatibility"></a>Video Profile Compatibility</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Resources and query pools used with a particular video session <strong>must</strong> be
compatible with the <a href="#video-profiles">video profile</a> the video session was
created with.</p>
</div>
<div class="paragraph">
<p>A <a href="resources.html#VkBuffer" class="xref page">VkBuffer</a> is compatible with a video profile if it was created with
the <a href="resources.html#VkBufferCreateInfo" class="xref page">VkBufferCreateInfo</a>::<code>pNext</code> chain including a
<a href="#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure with its <code>pProfiles</code> member
containing an element matching the <a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure
chain describing the video profile, and
<a href="resources.html#VkBufferCreateInfo" class="xref page">VkBufferCreateInfo</a>::<code>usage</code> including at least one bit specific to
video coding usage.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_BUFFER_USAGE_VIDEO_DECODE_SRC_BIT_KHR</code></p>
</li>
<li>
<p><code>VK_BUFFER_USAGE_VIDEO_DECODE_DST_BIT_KHR</code></p>
</li>
<li>
<p><code>VK_BUFFER_USAGE_VIDEO_ENCODE_SRC_BIT_KHR</code></p>
</li>
<li>
<p><code>VK_BUFFER_USAGE_VIDEO_ENCODE_DST_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A <a href="resources.html#VkImage" class="xref page">VkImage</a> is compatible with a video profile if it was created with
the <a href="resources.html#VkImageCreateInfo" class="xref page">VkImageCreateInfo</a>::<code>pNext</code> chain including a
<a href="#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure with its <code>pProfiles</code> member
containing an element matching the <a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure
chain describing the video profile, and <a href="resources.html#VkImageCreateInfo" class="xref page">VkImageCreateInfo</a>::<code>usage</code>
including at least one bit specific to video coding usage.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_IMAGE_USAGE_VIDEO_DECODE_SRC_BIT_KHR</code></p>
</li>
<li>
<p><code>VK_IMAGE_USAGE_VIDEO_DECODE_DST_BIT_KHR</code></p>
</li>
<li>
<p><code>VK_IMAGE_USAGE_VIDEO_DECODE_DPB_BIT_KHR</code></p>
</li>
<li>
<p><code>VK_IMAGE_USAGE_VIDEO_ENCODE_SRC_BIT_KHR</code></p>
</li>
<li>
<p><code>VK_IMAGE_USAGE_VIDEO_ENCODE_DST_BIT_KHR</code></p>
</li>
<li>
<p><code>VK_IMAGE_USAGE_VIDEO_ENCODE_DPB_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A <a href="resources.html#VkImageView" class="xref page">VkImageView</a> is compatible with a video profile if the <a href="resources.html#VkImage" class="xref page">VkImage</a>
it was created from is also compatible with that video profile.</p>
</div>
<div class="paragraph">
<p>A <a href="queries.html#VkQueryPool" class="xref page">VkQueryPool</a> is compatible with a video profile if it was created
with the <a href="queries.html#VkQueryPoolCreateInfo" class="xref page">VkQueryPoolCreateInfo</a>::<code>pNext</code> chain including a
<a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure chain describing the same video
profile, and <a href="queries.html#VkQueryPoolCreateInfo" class="xref page">VkQueryPoolCreateInfo</a>::<code>queryType</code> having one of the
following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code></p>
</li>
<li>
<p><code>VK_QUERY_TYPE_VIDEO_ENCODE_FEEDBACK_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="video-session-parameters"><a class="anchor" href="#video-session-parameters"></a>Video Session Parameters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Video session parameters objects <strong>can</strong> store preprocessed codec-specific
parameters used with a compatible video session, and enable reducing the
number of parameters needed to be provided and processed by the
implementation while recording video coding operations into command buffers.</p>
</div>
<div class="paragraph">
<p>Parameters stored in such objects are <em>immutable</em> to facilitate the
concurrent use of the stored parameters in multiple threads.
At the same time, new parameters <strong>can</strong> be added to existing objects using the
<a href="#vkUpdateVideoSessionParametersKHR">vkUpdateVideoSessionParametersKHR</a> command.</p>
</div>
<div class="paragraph">
<p>In order to support concurrent use of the stored immutable parameters while
also allowing the video session parameters object to be extended with new
parameters, each video session parameters object maintains an <em>update
sequence counter</em> that is set to <code>0</code> at object creation time and <strong>must</strong> be
incremented by each subsequent update operation.</p>
</div>
<div class="paragraph">
<p>Certain video sequences that adhere to particular video compression
standards permit updating previously supplied parameters.
If a parameter update is necessary, the application has the following
options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Cache the set of parameters on the application side and create a new
video session parameters object adding all the parameters with
appropriate changes, as necessary; or</p>
</li>
<li>
<p>Create a new video session parameters object providing only the updated
parameters and the previously used object as the template, which ensures
that parameters not specified at creation time will be copied unmodified
from the template object.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The actual types of parameters that <strong>can</strong> be stored and the capacity for
individual parameter types, and the methods of initializing, updating, and
referring to individual parameters are specific to the video codec operation
the video session parameters object was created with.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For <code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> these are defined
in the <a href="#decode-h264-parameter-sets">H.264 Decode Parameter Sets</a>
section.</p>
</li>
<li>
<p>For <code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code> these are defined
in the <a href="#decode-h265-parameter-sets">H.265 Decode Parameter Sets</a>
section.</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Video session parameters are represented by
<code>VkVideoSessionParametersKHR</code> handles:</p>
</div>
<div id="VkVideoSessionParametersKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkVideoSessionParametersKHR)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="creating-video-session-parameters"><a class="anchor" href="#creating-video-session-parameters"></a>Creating Video Session Parameters</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a video session parameters object, call:</p>
</div>
<div id="vkCreateVideoSessionParametersKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
VkResult vkCreateVideoSessionParametersKHR(
    VkDevice                                    device,
    const VkVideoSessionParametersCreateInfoKHR* pCreateInfo,
    const VkAllocationCallbacks*                pAllocator,
    VkVideoSessionParametersKHR*                pVideoSessionParameters);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the video session
parameters object.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to
<a href="#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a> structure containing
parameters to be used to create the video session parameters object.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="memory.html#memory-allocation" class="xref page">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pVideoSessionParameters</code> is a pointer to a
<a href="#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> handle in which the resulting video
session parameters object is returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The resulting video session parameters object is said to be created with the
video codec operation <code>pCreateInfo-&gt;videoSession</code> was created with.</p>
</div>
<div class="paragraph">
<p>If <code>pCreateInfo-&gt;videoSessionParametersTemplate</code> is not
<code>VK_NULL_HANDLE</code>, then it will be used as a template for constructing
the new video session parameters object.
This happens by first adding any parameters according to the additional
creation parameters provided in the <code>pCreateInfo-&gt;pNext</code> chain, followed
by adding any parameters from the template object that have a key that does
not match the key of any of the already added parameters.</p>
</div>
<div class="paragraph">
<p>If <code>pCreateInfo-&gt;videoSession</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the
created video session parameters object will initially contain the following
sets of parameter entries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>StdVideoH264SequenceParameterSet</code> structures representing
<a href="#decode-h264-sps">H.264 SPS</a> entries, as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a> structure
provided in the <code>pCreateInfo-&gt;pNext</code> chain is not <code>NULL</code>, then the
set of <code>StdVideoH264SequenceParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdSPSs</code> are added first;</p>
</li>
<li>
<p>If <code>pCreateInfo-&gt;videoSessionParametersTemplate</code> is not
<code>VK_NULL_HANDLE</code>, then each <code>StdVideoH264SequenceParameterSet</code>
entry stored in it is copied to the created video session parameters
object if the created object does not already contain such an entry
with the same <code>seq_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>StdVideoH264PictureParameterSet</code> structures representing
<a href="#decode-h264-pps">H.264 PPS</a> entries, as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a> structure
provided in the <code>pCreateInfo-&gt;pNext</code> chain is not <code>NULL</code>, then the
set of <code>StdVideoH264PictureParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdPPSs</code> are added first;</p>
</li>
<li>
<p>If <code>pCreateInfo-&gt;videoSessionParametersTemplate</code> is not
<code>VK_NULL_HANDLE</code>, then each <code>StdVideoH264PictureParameterSet</code>
entry stored in it is copied to the created video session parameters
object if the created object does not already contain such an entry
with the same <code>seq_parameter_set_id</code> and
<code>pic_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>pCreateInfo-&gt;videoSession</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the
created video session parameters object will initially contain the following
sets of parameter entries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>StdVideoH265VideoParameterSet</code> structures representing
<a href="#decode-h265-vps">H.265 VPS</a> entries, as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure
provided in the <code>pCreateInfo-&gt;pNext</code> chain is not <code>NULL</code>, then the
set of <code>StdVideoH265VideoParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdVPSs</code> are added first;</p>
</li>
<li>
<p>If <code>pCreateInfo-&gt;videoSessionParametersTemplate</code> is not
<code>VK_NULL_HANDLE</code>, then each <code>StdVideoH265VideoParameterSet</code>
entry stored in it is copied to the created video session parameters
object if the created object does not already contain such an entry
with the same <code>vps_video_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>StdVideoH265SequenceParameterSet</code> structures representing
<a href="#decode-h265-sps">H.265 SPS</a> entries, as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure
provided in the <code>pCreateInfo-&gt;pNext</code> chain is not <code>NULL</code>, then the
set of <code>StdVideoH265SequenceParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdSPSs</code> are added first;</p>
</li>
<li>
<p>If <code>pCreateInfo-&gt;videoSessionParametersTemplate</code> is not
<code>VK_NULL_HANDLE</code>, then each <code>StdVideoH265SequenceParameterSet</code>
entry stored in it is copied to the created video session parameters
object if the created object does not already contain such an entry
with the same <code>sps_video_parameter_set_id</code> and
<code>sps_seq_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>StdVideoH265PictureParameterSet</code> structures representing
<a href="#decode-h265-pps">H.265 PPS</a> entries, as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure
provided in the <code>pCreateInfo-&gt;pNext</code> chain is not <code>NULL</code>, then the
set of <code>StdVideoH265PictureParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdPPSs</code> are added first;</p>
</li>
<li>
<p>If <code>pCreateInfo-&gt;videoSessionParametersTemplate</code> is not
<code>VK_NULL_HANDLE</code>, then each <code>StdVideoH265PictureParameterSet</code>
entry stored in it is copied to the created video session parameters
object if the created object does not already contain such an entry
with the same <code>sps_video_parameter_set_id</code>,
<code>pps_seq_parameter_set_id</code>, and <code>pps_pic_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In case of video session parameters objects created with a video encode
operation, implementations <strong>may</strong> return the
<code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code> error if any of the
specified Video Std parameters do not adhere to the syntactic or semantic
requirements of the used video compression standard, or if values derived
from parameters according to the rules defined by the used video compression
standard do not adhere to the capabilities of the video compression standard
or the implementation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications <strong>should</strong> not rely on the
<code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code> error being returned by any
command as a means to verify Video Std parameters, as implementations are
not required to report the error in any specific set of cases.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateVideoSessionParametersKHR-device-parameter" href="#VUID-vkCreateVideoSessionParametersKHR-device-parameter"></a> <span class="vuid">VUID-vkCreateVideoSessionParametersKHR-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateVideoSessionParametersKHR-pCreateInfo-parameter" href="#VUID-vkCreateVideoSessionParametersKHR-pCreateInfo-parameter"></a> <span class="vuid">VUID-vkCreateVideoSessionParametersKHR-pCreateInfo-parameter</span><br>
 <code>pCreateInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateVideoSessionParametersKHR-pAllocator-parameter" href="#VUID-vkCreateVideoSessionParametersKHR-pAllocator-parameter"></a> <span class="vuid">VUID-vkCreateVideoSessionParametersKHR-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong>must</strong> be a valid pointer to a valid <a href="memory.html#VkAllocationCallbacks" class="xref page">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateVideoSessionParametersKHR-pVideoSessionParameters-parameter" href="#VUID-vkCreateVideoSessionParametersKHR-pVideoSessionParameters-parameter"></a> <span class="vuid">VUID-vkCreateVideoSessionParametersKHR-pVideoSessionParameters-parameter</span><br>
 <code>pVideoSessionParameters</code> <strong>must</strong> be a valid pointer to a <a href="#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_INITIALIZATION_FAILED</code></p>
</li>
<li>
<p><code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoSessionParametersCreateInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoSessionParametersCreateInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef struct VkVideoSessionParametersCreateInfoKHR {
    VkStructureType                           sType;
    const void*                               pNext;
    VkVideoSessionParametersCreateFlagsKHR    flags;
    VkVideoSessionParametersKHR               videoSessionParametersTemplate;
    VkVideoSessionKHR                         videoSession;
} VkVideoSessionParametersCreateInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>videoSessionParametersTemplate</code> is <code>VK_NULL_HANDLE</code> or a valid
handle to a <a href="#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> object used as a template
for constructing the new video session parameters object.</p>
</li>
<li>
<p><code>videoSession</code> is the video session object against which the video
session parameters object is going to be created.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Limiting values are defined below that are referenced by the relevant valid
usage statements of this structure.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If <code>videoSession</code> was created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then let
<code>StdVideoH264SequenceParameterSet spsAddList[]</code> be the list of
<a href="#decode-h264-sps">H.264 SPS</a> entries to add to the created video
session parameters object, defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a> structure
provided in the <code>pNext</code> chain is not <code>NULL</code>, then the set of
<code>StdVideoH264SequenceParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdSPSs</code> are added to <code>spsAddList</code>;</p>
</li>
<li>
<p>If <code>videoSessionParametersTemplate</code> is not <code>VK_NULL_HANDLE</code>,
then each <code>StdVideoH264SequenceParameterSet</code> entry stored in it with
<code>seq_parameter_set_id</code> not matching any of the entries already in
<code>spsAddList</code> is added to <code>spsAddList</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>videoSession</code> was created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then let
<code>StdVideoH264PictureParameterSet ppsAddList[]</code> be the list of
<a href="#decode-h264-pps">H.264 PPS</a> entries to add to the created video
session parameters object, defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a> structure
provided in the <code>pNext</code> chain is not <code>NULL</code>, then the set of
<code>StdVideoH264PictureParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdPPSs</code> are added to <code>ppsAddList</code>;</p>
</li>
<li>
<p>If <code>videoSessionParametersTemplate</code> is not <code>VK_NULL_HANDLE</code>,
then each <code>StdVideoH264PictureParameterSet</code> entry stored in it with
<code>seq_parameter_set_id</code> or <code>pic_parameter_set_id</code> not matching
any of the entries already in <code>ppsAddList</code> is added to
<code>ppsAddList</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>videoSession</code> was created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then let
<code>StdVideoH265VideoParameterSet vpsAddList[]</code> be the list of
<a href="#decode-h265-vps">H.265 VPS</a> entries to add to the created video
session parameters object, defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure
provided in the <code>pNext</code> chain is not <code>NULL</code>, then the set of
<code>StdVideoH265VideoParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdVPSs</code> are added to <code>vpsAddList</code>;</p>
</li>
<li>
<p>If <code>videoSessionParametersTemplate</code> is not <code>VK_NULL_HANDLE</code>,
then each <code>StdVideoH265VideoParameterSet</code> entry stored in it with
<code>vps_video_parameter_set_id</code> not matching any of the entries
already in <code>vpsAddList</code> is added to <code>vpsAddList</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>videoSession</code> was created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then let
<code>StdVideoH265SequenceParameterSet spsAddList[]</code> be the list of
<a href="#decode-h265-sps">H.265 SPS</a> entries to add to the created video
session parameters object, defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure
provided in the <code>pNext</code> chain is not <code>NULL</code>, then the set of
<code>StdVideoH265SequenceParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdSPSs</code> are added to <code>spsAddList</code>;</p>
</li>
<li>
<p>If <code>videoSessionParametersTemplate</code> is not <code>VK_NULL_HANDLE</code>,
then each <code>StdVideoH265SequenceParameterSet</code> entry stored in it with
<code>sps_video_parameter_set_id</code> or <code>sps_seq_parameter_set_id</code> not
matching any of the entries already in <code>spsAddList</code> is added to
<code>spsAddList</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>videoSession</code> was created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then let
<code>StdVideoH265PictureParameterSet ppsAddList[]</code> be the list of
<a href="#decode-h265-pps">H.265 PPS</a> entries to add to the created video
session parameters object, defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure
provided in the <code>pNext</code> chain is not <code>NULL</code>, then the set of
<code>StdVideoH265PictureParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdPPSs</code> are added to <code>ppsAddList</code>;</p>
</li>
<li>
<p>If <code>videoSessionParametersTemplate</code> is not <code>VK_NULL_HANDLE</code>,
then each <code>StdVideoH265PictureParameterSet</code> entry stored in it with
<code>sps_video_parameter_set_id</code>, <code>pps_seq_parameter_set_id</code>, or
<code>pps_pic_parameter_set_id</code> not matching any of the entries already
in <code>ppsAddList</code> is added to <code>ppsAddList</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-04855" href="#VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-04855"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-04855</span><br>

If <code>videoSessionParametersTemplate</code> represents a valid handle, it
<strong>must</strong> have been created against <code>videoSession</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07203" href="#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07203"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07203</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the <code>pNext</code>
chain <strong>must</strong> include a
<a href="#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07204" href="#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07204"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07204</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the number of
elements of <code>spsAddList</code> <strong>must</strong> be less than or equal to the
<code>maxStdSPSCount</code> specified in the
<a href="#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a> structure included
in the <code>pNext</code> chain</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07205" href="#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07205"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07205</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the number of
elements of <code>ppsAddList</code> <strong>must</strong> be less than or equal to the
<code>maxStdPPSCount</code> specified in the
<a href="#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a> structure included
in the <code>pNext</code> chain</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07206" href="#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07206"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07206</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the <code>pNext</code>
chain <strong>must</strong> include a
<a href="#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07207" href="#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07207"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07207</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the number of
elements of <code>vpsAddList</code> <strong>must</strong> be less than or equal to the
<code>maxStdVPSCount</code> specified in the
<a href="#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure included
in the <code>pNext</code> chain</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07208" href="#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07208"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07208</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the number of
elements of <code>spsAddList</code> <strong>must</strong> be less than or equal to the
<code>maxStdSPSCount</code> specified in the
<a href="#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure included
in the <code>pNext</code> chain</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07209" href="#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07209"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07209</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the number of
elements of <code>ppsAddList</code> <strong>must</strong> be less than or equal to the
<code>maxStdPPSCount</code> specified in the
<a href="#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure included
in the <code>pNext</code> chain</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07210" href="#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07210"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07210</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_EXT</code>, then the <code>pNext</code>
chain <strong>must</strong> include a
<a href="#VkVideoEncodeH264SessionParametersCreateInfoEXT">VkVideoEncodeH264SessionParametersCreateInfoEXT</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07211" href="#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07211"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07211</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_EXT</code>, then the <code>pNext</code>
chain <strong>must</strong> include a
<a href="#VkVideoEncodeH265SessionParametersCreateInfoEXT">VkVideoEncodeH265SessionParametersCreateInfoEXT</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-sType-sType" href="#VUID-VkVideoSessionParametersCreateInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_SESSION_PARAMETERS_CREATE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-pNext-pNext" href="#VUID-VkVideoSessionParametersCreateInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a>, <a href="#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a>, <a href="#VkVideoEncodeH264SessionParametersCreateInfoEXT">VkVideoEncodeH264SessionParametersCreateInfoEXT</a>, <a href="#VkVideoEncodeH265SessionParametersCreateInfoEXT">VkVideoEncodeH265SessionParametersCreateInfoEXT</a>, or <a href="#VkVideoEncodeQualityLevelInfoKHR">VkVideoEncodeQualityLevelInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-sType-unique" href="#VUID-VkVideoSessionParametersCreateInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-flags-zerobitmask" href="#VUID-VkVideoSessionParametersCreateInfoKHR-flags-zerobitmask"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-flags-zerobitmask</span><br>
 <code>flags</code> <strong>must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-parameter" href="#VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-parameter"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-parameter</span><br>
 If <code>videoSessionParametersTemplate</code> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, <code>videoSessionParametersTemplate</code> <strong>must</strong> be a valid <a href="#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-parameter" href="#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-parameter"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-parameter</span><br>
 <code>videoSession</code> <strong>must</strong> be a valid <a href="#VkVideoSessionKHR">VkVideoSessionKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-parent" href="#VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-parent"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-parent</span><br>
 If <code>videoSessionParametersTemplate</code> is a valid handle, it <strong>must</strong> have been created, allocated, or retrieved from <code>videoSession</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-commonparent" href="#VUID-VkVideoSessionParametersCreateInfoKHR-commonparent"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-commonparent</span><br>
 Both of <code>videoSession</code>, and <code>videoSessionParametersTemplate</code> that are valid handles of non-ignored parameters <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoSessionParametersCreateFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef VkFlags VkVideoSessionParametersCreateFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoSessionParametersCreateFlagsKHR</code> is a bitmask type for setting a
mask, but is currently reserved for future use.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="destroying-video-session-parameters"><a class="anchor" href="#destroying-video-session-parameters"></a>Destroying Video Session Parameters</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a video session parameters object, call:</p>
</div>
<div id="vkDestroyVideoSessionParametersKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
void vkDestroyVideoSessionParametersKHR(
    VkDevice                                    device,
    VkVideoSessionParametersKHR                 videoSessionParameters,
    const VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the video session
parameters object.</p>
</li>
<li>
<p><code>videoSessionParameters</code> is the video session parameters object to
destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="memory.html#memory-allocation" class="xref page">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07212" href="#VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07212"></a> <span class="vuid">VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07212</span><br>

All submitted commands that refer to <code>videoSessionParameters</code> <strong>must</strong>
have completed execution</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07213" href="#VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07213"></a> <span class="vuid">VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07213</span><br>

If <code>VkAllocationCallbacks</code> were provided when
<code>videoSessionParameters</code> was created, a compatible set of callbacks
<strong>must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07214" href="#VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07214"></a> <span class="vuid">VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07214</span><br>

If no <code>VkAllocationCallbacks</code> were provided when
<code>videoSessionParameters</code> was created, <code>pAllocator</code> <strong>must</strong> be
<code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyVideoSessionParametersKHR-device-parameter" href="#VUID-vkDestroyVideoSessionParametersKHR-device-parameter"></a> <span class="vuid">VUID-vkDestroyVideoSessionParametersKHR-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-parameter" href="#VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-parameter"></a> <span class="vuid">VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-parameter</span><br>
 If <code>videoSessionParameters</code> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, <code>videoSessionParameters</code> <strong>must</strong> be a valid <a href="#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionParametersKHR-pAllocator-parameter" href="#VUID-vkDestroyVideoSessionParametersKHR-pAllocator-parameter"></a> <span class="vuid">VUID-vkDestroyVideoSessionParametersKHR-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong>must</strong> be a valid pointer to a valid <a href="memory.html#VkAllocationCallbacks" class="xref page">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-parent" href="#VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-parent"></a> <span class="vuid">VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-parent</span><br>
 If <code>videoSessionParameters</code> is a valid handle, it <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>videoSessionParameters</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="video-session-parameters-update"><a class="anchor" href="#video-session-parameters-update"></a>Updating Video Session Parameters</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To update video session parameters object with new parameters, call:</p>
</div>
<div id="vkUpdateVideoSessionParametersKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
VkResult vkUpdateVideoSessionParametersKHR(
    VkDevice                                    device,
    VkVideoSessionParametersKHR                 videoSessionParameters,
    const VkVideoSessionParametersUpdateInfoKHR* pUpdateInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that updates the video session
parameters.</p>
</li>
<li>
<p><code>videoSessionParameters</code> is the video session parameters object to
update.</p>
</li>
<li>
<p><code>pUpdateInfo</code> is a pointer to a
<a href="#VkVideoSessionParametersUpdateInfoKHR">VkVideoSessionParametersUpdateInfoKHR</a> structure specifying the
parameter update information.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After a successful call to this command, the
<a href="#video-session-parameters">update sequence counter</a> of
<code>videoSessionParameters</code> is changed to the value specified in
<code>pUpdateInfo-&gt;updateSequenceCount</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note:</div>
<div class="paragraph">
<p>As each update issued to a video session parameters object needs to specify
the next available update sequence count value, concurrent updates of the
same video session parameters object are inherently disallowed.
However, recording video coding operations to command buffers referring to
parameters previously added to the video session parameters object is
allowed, even if there is a concurrent update in progress adding some new
entries to the object.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code>videoSessionParameters</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> and the
<code>pUpdateInfo-&gt;pNext</code> chain includes a
<a href="#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a> structure, then this
command adds the following parameter entries to
<code>videoSessionParameters</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="#decode-h264-sps">H.264 SPS</a> entries specified in
<a href="#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a>::<code>pStdSPSs</code>.</p>
</li>
<li>
<p>The <a href="#decode-h264-pps">H.264 PPS</a> entries specified in
<a href="#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a>::<code>pStdPPSs</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>videoSessionParameters</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code> and the
<code>pUpdateInfo-&gt;pNext</code> chain includes a
<a href="#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a> structure, then this
command adds the following parameter entries to
<code>videoSessionParameters</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="#decode-h265-vps">H.265 VPS</a> entries specified in
<a href="#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a>::<code>pStdVPSs</code>.</p>
</li>
<li>
<p>The <a href="#decode-h265-sps">H.265 SPS</a> entries specified in
<a href="#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a>::<code>pStdSPSs</code>.</p>
</li>
<li>
<p>The <a href="#decode-h265-pps">H.265 PPS</a> entries specified in
<a href="#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a>::<code>pStdPPSs</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In case of video session parameters objects created with a video encode
operation, implementations <strong>may</strong> return the
<code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code> error if any of the
specified Video Std parameters do not adhere to the syntactic or semantic
requirements of the used video compression standard, or if values derived
from parameters according to the rules defined by the used video compression
standard do not adhere to the capabilities of the video compression standard
or the implementation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications <strong>should</strong> not rely on the
<code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code> error being returned by any
command as a means to verify Video Std parameters, as implementations are
not required to report the error in any specific set of cases.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-pUpdateInfo-07215" href="#VUID-vkUpdateVideoSessionParametersKHR-pUpdateInfo-07215"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-pUpdateInfo-07215</span><br>

<code>pUpdateInfo-&gt;updateSequenceCount</code> <strong>must</strong> equal the current
<a href="#video-session-parameters">update sequence counter</a> of
<code>videoSessionParameters</code> plus one</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07216" href="#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07216"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07216</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a> structure, then
<code>videoSessionParameters</code> <strong>must</strong> not already contain a
<code>StdVideoH264SequenceParameterSet</code> entry with
<code>seq_parameter_set_id</code> matching any of the elements of
<a href="#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a>::<code>pStdSPSs</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07217" href="#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07217"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07217</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the
number of <code>StdVideoH264SequenceParameterSet</code> entries already stored
in it plus the value of the <code>stdSPSCount</code> member of the
<a href="#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a> structure included in
the <code>pUpdateInfo-&gt;pNext</code> chain <strong>must</strong> be less than or equal to the
<a href="#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a>::<code>maxStdSPSCount</code>
<code>videoSessionParameters</code> was created with</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07218" href="#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07218"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07218</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a> structure, then
<code>videoSessionParameters</code> <strong>must</strong> not already contain a
<code>StdVideoH264PictureParameterSet</code> entry with both
<code>seq_parameter_set_id</code> and <code>pic_parameter_set_id</code> matching any
of the elements of
<a href="#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a>::<code>pStdPPSs</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07219" href="#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07219"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07219</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the
number of <code>StdVideoH264PictureParameterSet</code> entries already stored in
it plus the value of the <code>stdPPSCount</code> member of the
<a href="#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a> structure included in
the <code>pUpdateInfo-&gt;pNext</code> chain <strong>must</strong> be less than or equal to the
<a href="#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a>::<code>maxStdPPSCount</code>
<code>videoSessionParameters</code> was created with</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07220" href="#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07220"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07220</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a> structure, then
<code>videoSessionParameters</code> <strong>must</strong> not already contain a
<code>StdVideoH265VideoParameterSet</code> entry with
<code>vps_video_parameter_set_id</code> matching any of the elements of
<a href="#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a>::<code>pStdVPSs</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07221" href="#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07221"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07221</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the
number of <code>StdVideoH265VideoParameterSet</code> entries already stored in
it plus the value of the <code>stdVPSCount</code> member of the
<a href="#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a> structure included in
the <code>pUpdateInfo-&gt;pNext</code> chain <strong>must</strong> be less than or equal to the
<a href="#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a>::<code>maxStdVPSCount</code>
<code>videoSessionParameters</code> was created with</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07222" href="#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07222"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07222</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a> structure, then
<code>videoSessionParameters</code> <strong>must</strong> not already contain a
<code>StdVideoH265SequenceParameterSet</code> entry with both
<code>sps_video_parameter_set_id</code> and <code>sps_seq_parameter_set_id</code>
matching any of the elements of
<a href="#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a>::<code>pStdSPSs</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07223" href="#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07223"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07223</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the
number of <code>StdVideoH265SequenceParameterSet</code> entries already stored
in it plus the value of the <code>stdSPSCount</code> member of the
<a href="#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a> structure included in
the <code>pUpdateInfo-&gt;pNext</code> chain <strong>must</strong> be less than or equal to the
<a href="#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a>::<code>maxStdSPSCount</code>
<code>videoSessionParameters</code> was created with</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07224" href="#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07224"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07224</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a> structure, then
<code>videoSessionParameters</code> <strong>must</strong> not already contain a
<code>StdVideoH265PictureParameterSet</code> entry with
<code>sps_video_parameter_set_id</code>, <code>pps_seq_parameter_set_id</code>, and
<code>pps_pic_parameter_set_id</code> all matching any of the elements of
<a href="#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a>::<code>pStdPPSs</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07225" href="#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07225"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07225</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the
number of <code>StdVideoH265PictureParameterSet</code> entries already stored in
it plus the value of the <code>stdPPSCount</code> member of the
<a href="#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a> structure included in
the <code>pUpdateInfo-&gt;pNext</code> chain <strong>must</strong> be less than or equal to the
<a href="#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a>::<code>maxStdPPSCount</code>
<code>videoSessionParameters</code> was created with</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07226" href="#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07226"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07226</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_EXT</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="#VkVideoEncodeH264SessionParametersAddInfoEXT">VkVideoEncodeH264SessionParametersAddInfoEXT</a> structure, then
<code>videoSessionParameters</code> <strong>must</strong> not already contain a
<code>StdVideoH264SequenceParameterSet</code> entry with
<code>seq_parameter_set_id</code> matching any of the elements of
<a href="#VkVideoEncodeH264SessionParametersAddInfoEXT">VkVideoEncodeH264SessionParametersAddInfoEXT</a>::<code>pStdSPSs</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07227" href="#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07227"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07227</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_EXT</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="#VkVideoEncodeH264SessionParametersAddInfoEXT">VkVideoEncodeH264SessionParametersAddInfoEXT</a> structure, then
<code>videoSessionParameters</code> <strong>must</strong> not already contain a
<code>StdVideoH264PictureParameterSet</code> entry with both
<code>seq_parameter_set_id</code> and <code>pic_parameter_set_id</code> matching any
of the elements of
<a href="#VkVideoEncodeH264SessionParametersAddInfoEXT">VkVideoEncodeH264SessionParametersAddInfoEXT</a>::<code>pStdPPSs</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07228" href="#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07228"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07228</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_EXT</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="#VkVideoEncodeH265SessionParametersAddInfoEXT">VkVideoEncodeH265SessionParametersAddInfoEXT</a> structure, then
<code>videoSessionParameters</code> <strong>must</strong> not already contain a
<code>StdVideoH265VideoParameterSet</code> entry with
<code>vps_video_parameter_set_id</code> matching any of the elements of
<a href="#VkVideoEncodeH265SessionParametersAddInfoEXT">VkVideoEncodeH265SessionParametersAddInfoEXT</a>::<code>pStdVPSs</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07229" href="#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07229"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07229</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_EXT</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="#VkVideoEncodeH265SessionParametersAddInfoEXT">VkVideoEncodeH265SessionParametersAddInfoEXT</a> structure, then
<code>videoSessionParameters</code> <strong>must</strong> not already contain a
<code>StdVideoH265SequenceParameterSet</code> entry with both
<code>sps_video_parameter_set_id</code> and <code>sps_seq_parameter_set_id</code>
matching any of the elements of
<a href="#VkVideoEncodeH265SessionParametersAddInfoEXT">VkVideoEncodeH265SessionParametersAddInfoEXT</a>::<code>pStdSPSs</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07230" href="#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07230"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07230</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_EXT</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="#VkVideoEncodeH265SessionParametersAddInfoEXT">VkVideoEncodeH265SessionParametersAddInfoEXT</a> structure, then
<code>videoSessionParameters</code> <strong>must</strong> not already contain a
<code>StdVideoH265PictureParameterSet</code> entry with
<code>sps_video_parameter_set_id</code>, <code>pps_seq_parameter_set_id</code>, and
<code>pps_pic_parameter_set_id</code> all matching any of the elements of
<a href="#VkVideoEncodeH265SessionParametersAddInfoEXT">VkVideoEncodeH265SessionParametersAddInfoEXT</a>::<code>pStdPPSs</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-device-parameter" href="#VUID-vkUpdateVideoSessionParametersKHR-device-parameter"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-parameter" href="#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-parameter"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-parameter</span><br>
 <code>videoSessionParameters</code> <strong>must</strong> be a valid <a href="#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-pUpdateInfo-parameter" href="#VUID-vkUpdateVideoSessionParametersKHR-pUpdateInfo-parameter"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-pUpdateInfo-parameter</span><br>
 <code>pUpdateInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkVideoSessionParametersUpdateInfoKHR">VkVideoSessionParametersUpdateInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-parent" href="#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-parent"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-parent</span><br>
 <code>videoSessionParameters</code> <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoSessionParametersUpdateInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoSessionParametersUpdateInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef struct VkVideoSessionParametersUpdateInfoKHR {
    VkStructureType    sType;
    const void*        pNext;
    uint32_t           updateSequenceCount;
} VkVideoSessionParametersUpdateInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>updateSequenceCount</code> is the new <a href="#video-session-parameters">update    sequence count</a> to set for the video session parameters object.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoSessionParametersUpdateInfoKHR-sType-sType" href="#VUID-VkVideoSessionParametersUpdateInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoSessionParametersUpdateInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_SESSION_PARAMETERS_UPDATE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersUpdateInfoKHR-pNext-pNext" href="#VUID-VkVideoSessionParametersUpdateInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoSessionParametersUpdateInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a>, <a href="#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a>, <a href="#VkVideoEncodeH264SessionParametersAddInfoEXT">VkVideoEncodeH264SessionParametersAddInfoEXT</a>, or <a href="#VkVideoEncodeH265SessionParametersAddInfoEXT">VkVideoEncodeH265SessionParametersAddInfoEXT</a></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersUpdateInfoKHR-sType-unique" href="#VUID-VkVideoSessionParametersUpdateInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoSessionParametersUpdateInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="video-coding-scope"><a class="anchor" href="#video-coding-scope"></a>Video Coding Scope</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Applications <strong>can</strong> record video coding commands for a video session only
within a video coding scope.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To begin a video coding scope, call:</p>
</div>
<div id="vkCmdBeginVideoCodingKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
void vkCmdBeginVideoCodingKHR(
    VkCommandBuffer                             commandBuffer,
    const VkVideoBeginCodingInfoKHR*            pBeginInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer in which to record the
command.</p>
</li>
<li>
<p><code>pBeginInfo</code> is a pointer to a <a href="#VkVideoBeginCodingInfoKHR">VkVideoBeginCodingInfoKHR</a>
structure specifying the parameters of the video coding scope, including
the video session and video session parameters object to use.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After beginning a video coding scope, the video session object specified in
<code>pBeginInfo-&gt;videoSession</code> is <em>bound</em> to the command buffer, and the
command buffer is ready to record video coding operations.
Similarly, if <code>pBeginInfo-&gt;videoSessionParameters</code> is not
<code>VK_NULL_HANDLE</code>, it is also <em>bound</em> to the command buffer, and video
coding operations <strong>can</strong> refer to the codec-specific parameters stored in it.</p>
</div>
<div id="bound-reference-picture-resources" class="paragraph">
<p>This command also establishes the set of <em>bound reference picture resources</em>
that <strong>can</strong> be used as <a href="#reconstructed-picture">reconstructed pictures</a> or
<a href="#reference-picture">reference pictures</a> within the video coding scope.
Each element of this set consists of a <a href="#video-picture-resources">video picture resource</a> and the <a href="#dpb-slot">DPB slot</a> index associated with it,
if there is one.</p>
</div>
<div class="paragraph">
<p>The set of bound reference picture resources is immutable within a video
coding scope, however, the DPB slot index associated with any of the bound
reference picture resources <strong>can</strong> change during the video coding scope in
response to video coding operations.</p>
</div>
<div class="paragraph">
<p>The <a href="#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structures provided as the elements of
<code>pBeginInfo-&gt;pReferenceSlots</code> are interpreted by this command as
follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If <code>slotIndex</code> is non-negative and <code>pPictureResource</code> is not
<code>NULL</code>, then the <a href="#video-picture-resources">video picture resource</a>
defined by the <a href="#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure pointed to
by <code>pPictureResource</code> is added to the set of bound reference picture
resources and is associated with the DPB slot index specified in
<code>slotIndex</code>.</p>
</li>
<li>
<p>If <code>slotIndex</code> is non-negative and <code>pPictureResource</code> is <code>NULL</code>,
then the DPB slot with index <code>slotIndex</code> is <a href="#dpb-slot-states">    deactivated</a> by this command.</p>
</li>
<li>
<p>If <code>slotIndex</code> is negative and <code>pPictureResource</code> is not <code>NULL</code>,
then the <a href="#video-picture-resources">video picture resource</a> defined by
the <a href="#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure pointed to by
<code>pPictureResource</code> is added to the set of bound reference picture
resources without an associated DPB slot.
Such a picture resource <strong>can</strong> be subsequently used as a
<a href="#reconstructed-picture">reconstructed picture</a> to associate it with a
DPB slot.</p>
</li>
<li>
<p>If <code>slotIndex</code> is negative and <code>pPictureResource</code> is <code>NULL</code>,
then the element is ignored.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note:</div>
<div class="paragraph">
<p>It is possible for multiple bound reference picture resources to be
associated with the same DPB slot index, or for a single bound reference
picture to refer to multiple separate reference pictures.
For example, in case of an <a href="#decode-h264-profile">H.264 decode profile</a> with
<a href="#decode-h264-interlaced-support">interlaced frame support</a> a single DPB
slot can refer to two separate pictures for the top and bottom fields.
Depending on the picture layout used by the <a href="#decode-h264-profile">H.264 decode profile</a>, the following special cases <strong>may</strong> arise:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the picture layout is
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_INTERLEAVED_LINES_BIT_KHR</code>,
then the top and bottom field pictures are physically co-located in the
same video picture resource with even scanlines corresponding to the top
field and odd scanlines corresponding to the bottom field, respectively.</p>
</li>
<li>
<p>If the picture layout is
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR</code>,
then the top and bottom field pictures are stored in separate video
picture resources (in separate subregions of the same image layer, in
separate layers of the same image, or in entirely separate images),
hence two elements of
<a href="#VkVideoBeginCodingInfoKHR">VkVideoBeginCodingInfoKHR</a>::<code>pReferenceSlots</code> <strong>can</strong> contain the
same <code>slotIndex</code> but specify different video picture resources in
their <code>pPictureResource</code> members.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All non-negative <code>slotIndex</code> values specified in the elements of
<code>pBeginInfo-&gt;pReferenceSlots</code> <strong>must</strong> identify DPB slots of the video
session that are in the <a href="#dpb-slot-states">active state</a> at the time this
command is executed on the device.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note:</div>
<div class="paragraph">
<p>The application does not have to specify an entry in
<code>pBeginInfo-&gt;pReferenceSlots</code> corresponding to all active DPB slots of
the video session, but only for those which are intended to be used in the
video coding scope.
This way the application can avoid any potential runtime cost associated
with binding the corresponding picture resources to the command buffer.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07231" href="#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07231"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07231</span><br>

The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from
<strong>must</strong> support the video codec operation <code>pBeginInfo-&gt;videoSession</code>
was created with, as returned by
<a href="devsandqueues.html#vkGetPhysicalDeviceQueueFamilyProperties2" class="xref page">vkGetPhysicalDeviceQueueFamilyProperties2</a> in
<a href="devsandqueues.html#VkQueueFamilyVideoPropertiesKHR" class="xref page">VkQueueFamilyVideoPropertiesKHR</a>::<code>videoCodecOperations</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-None-07232" href="#VUID-vkCmdBeginVideoCodingKHR-None-07232"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-None-07232</span><br>

There <strong>must</strong> be no <a href="queries.html#queries-operation-active" class="xref page">active</a> queries</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07233" href="#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07233"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07233</span><br>

If <code>commandBuffer</code> is an unprotected command buffer and
<a href="devsandqueues.html#limits-protectedNoFault" class="xref page"><code>protectedNoFault</code></a> is not supported,
then <code>pBeginInfo-&gt;videoSession</code> <strong>must</strong> not have been created with
<code>VK_VIDEO_SESSION_CREATE_PROTECTED_CONTENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07234" href="#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07234"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07234</span><br>

If <code>commandBuffer</code> is a protected command buffer and
<a href="devsandqueues.html#limits-protectedNoFault" class="xref page"><code>protectedNoFault</code></a> is not supported,
then <code>pBeginInfo-&gt;videoSession</code> <strong>must</strong> have been created with
<code>VK_VIDEO_SESSION_CREATE_PROTECTED_CONTENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07235" href="#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07235"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07235</span><br>

If <code>commandBuffer</code> is an unprotected command buffer,
<a href="devsandqueues.html#limits-protectedNoFault" class="xref page"><code>protectedNoFault</code></a> is not supported,
and the <code>pPictureResource</code> member of any element of
<code>pBeginInfo-&gt;pReferenceSlots</code> is not <code>NULL</code>, then
<code>pPictureResource-&gt;imageViewBinding</code> for that element <strong>must</strong> not
specify an image view created from a protected image</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07236" href="#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07236"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07236</span><br>

If <code>commandBuffer</code> is a protected command buffer
<a href="devsandqueues.html#limits-protectedNoFault" class="xref page"><code>protectedNoFault</code></a> is not supported,
and the <code>pPictureResource</code> member of any element of
<code>pBeginInfo-&gt;pReferenceSlots</code> is not <code>NULL</code>, then
<code>pPictureResource-&gt;imageViewBinding</code> for that element <strong>must</strong> specify
an image view created from a protected image</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-slotIndex-07239" href="#VUID-vkCmdBeginVideoCodingKHR-slotIndex-07239"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-slotIndex-07239</span><br>

If the <code>slotIndex</code> member of any element of
<code>pBeginInfo-&gt;pReferenceSlots</code> is not negative, then it <strong>must</strong> specify
the index of a DPB slot that is in the <a href="#dpb-slot-states">active state</a>
in <code>pBeginInfo-&gt;videoSession</code> at the time the command is executed on
the device</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-pPictureResource-07265" href="#VUID-vkCmdBeginVideoCodingKHR-pPictureResource-07265"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-pPictureResource-07265</span><br>

Each video picture resource specified by any non-<code>NULL</code>
<code>pPictureResource</code> member specified in the elements of
<code>pBeginInfo-&gt;pReferenceSlots</code> for which <code>slotIndex</code> is not
negative <strong>must</strong> <a href="#video-picture-resource-matching">match</a> one of the
video picture resources currently associated with the DPB slot index of
<code>pBeginInfo-&gt;videoSession</code> specified by <code>slotIndex</code> at the time
the command is executed on the device</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-parameter" href="#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-pBeginInfo-parameter" href="#VUID-vkCmdBeginVideoCodingKHR-pBeginInfo-parameter"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-pBeginInfo-parameter</span><br>
 <code>pBeginInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkVideoBeginCodingInfoKHR">VkVideoBeginCodingInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-recording" href="#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-cmdpool" href="#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support decode, or encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-renderpass" href="#VUID-vkCmdBeginVideoCodingKHR-renderpass"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-renderpass</span><br>
 This command <strong>must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-videocoding" href="#VUID-vkCmdBeginVideoCodingKHR-videocoding"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-bufferlevel" href="#VUID-vkCmdBeginVideoCodingKHR-bufferlevel"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-bufferlevel</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a primary <code>VkCommandBuffer</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action<br>
State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <a href="#VkVideoBeginCodingInfoKHR">VkVideoBeginCodingInfoKHR</a> structure is defined as:</p>
</div>
<div id="VkVideoBeginCodingInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef struct VkVideoBeginCodingInfoKHR {
    VkStructureType                       sType;
    const void*                           pNext;
    VkVideoBeginCodingFlagsKHR            flags;
    VkVideoSessionKHR                     videoSession;
    VkVideoSessionParametersKHR           videoSessionParameters;
    uint32_t                              referenceSlotCount;
    const VkVideoReferenceSlotInfoKHR*    pReferenceSlots;
} VkVideoBeginCodingInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>videoSession</code> is the video session object to be bound for the
processing of the video commands.</p>
</li>
<li>
<p><code>videoSessionParameters</code> is <code>VK_NULL_HANDLE</code> or a handle of a
<a href="#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> object to be used for the processing
of the video commands.
If <code>VK_NULL_HANDLE</code>, then no video session parameters object is
bound for the duration of the video coding scope.</p>
</li>
<li>
<p><code>referenceSlotCount</code> is the number of elements in the
<code>pReferenceSlots</code> array.</p>
</li>
<li>
<p><code>pReferenceSlots</code> is a pointer to an array of
<a href="#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structures specifying the information
used to determine the set of <a href="#bound-reference-picture-resources">bound    reference picture resources</a> for the video coding scope and their
initial association with <a href="#dpb-slot">DPB slot</a> indices.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Limiting values are defined below that are referenced by the relevant valid
usage statements of this structure.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Let <code>VkOffset2D codedOffsetGranularity</code> be the minimum alignment
requirement for the coded offset of video picture resources.
Unless otherwise defined, the value of the <code>x</code> and <code>y</code> members
of <code>codedOffsetGranularity</code> are <code>0</code>.</p>
<div class="ulist">
<ul>
<li>
<p>If <code>videoSession</code> was created with an <a href="#decode-h264-profile">H.264     decode profile</a> with a
<a href="#VkVideoDecodeH264ProfileInfoKHR">VkVideoDecodeH264ProfileInfoKHR</a>::<code>pictureLayout</code> of
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR</code>,
then <code>codedOffsetGranularity</code> is equal to
<a href="#VkVideoDecodeH264CapabilitiesKHR">VkVideoDecodeH264CapabilitiesKHR</a>::<code>fieldOffsetGranularity</code>,
as returned by <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for that
video profile.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSession-07237" href="#VUID-VkVideoBeginCodingInfoKHR-videoSession-07237"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSession-07237</span><br>

<code>videoSession</code> <strong>must</strong> have memory bound to all of its memory bindings
returned by <a href="#vkGetVideoSessionMemoryRequirementsKHR">vkGetVideoSessionMemoryRequirementsKHR</a> for
<code>videoSession</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-slotIndex-04856" href="#VUID-VkVideoBeginCodingInfoKHR-slotIndex-04856"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-slotIndex-04856</span><br>

Each non-negative <a href="#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a>::<code>slotIndex</code>
specified in the elements of <code>pReferenceSlots</code> <strong>must</strong> be less than
the <a href="#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>maxDpbSlots</code> specified when
<code>videoSession</code> was created</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07238" href="#VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07238"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07238</span><br>

Each video picture resource corresponding to any non-<code>NULL</code>
<code>pPictureResource</code> member specified in the elements of
<code>pReferenceSlots</code> <strong>must</strong> be <a href="#video-picture-resource-uniqueness">    unique</a> within <code>pReferenceSlots</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07240" href="#VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07240"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07240</span><br>

If the <code>pPictureResource</code> member of any element of
<code>pReferenceSlots</code> is not <code>NULL</code>, then the image view specified in
<code>pPictureResource-&gt;imageViewBinding</code> for that element <strong>must</strong> be
<a href="#video-profile-compatibility">compatible</a> with the video profile
<code>videoSession</code> was created with</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07241" href="#VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07241"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07241</span><br>

If the <code>pPictureResource</code> member of any element of
<code>pReferenceSlots</code> is not <code>NULL</code>, then the format of the image view
specified in <code>pPictureResource-&gt;imageViewBinding</code> for that element
<strong>must</strong> match the
<a href="#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>referencePictureFormat</code>
<code>videoSession</code> was created with</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07242" href="#VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07242"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07242</span><br>

If the <code>pPictureResource</code> member of any element of
<code>pReferenceSlots</code> is not <code>NULL</code>, then its <code>codedOffset</code> member
<strong>must</strong> be an integer multiple of <code>codedOffsetGranularity</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07243" href="#VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07243"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07243</span><br>

If the <code>pPictureResource</code> member of any element of
<code>pReferenceSlots</code> is not <code>NULL</code>, then its <code>codedExtent</code> member
<strong>must</strong> be between <code>minCodedExtent</code> and <code>maxCodedExtent</code>,
inclusive, <code>videoSession</code> was created with</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-flags-07244" href="#VUID-VkVideoBeginCodingInfoKHR-flags-07244"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-flags-07244</span><br>

If <a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>flags</code> does not include
<code>VK_VIDEO_CAPABILITY_SEPARATE_REFERENCE_IMAGES_BIT_KHR</code>, as returned
by <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile
<code>videoSession</code> was created with, then
<code>pPictureResource-&gt;imageViewBinding</code> of all elements of
<code>pReferenceSlots</code> with a non-<code>NULL</code> <code>pPictureResource</code> member
<strong>must</strong> specify image views created from the same image</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-slotIndex-07245" href="#VUID-VkVideoBeginCodingInfoKHR-slotIndex-07245"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-slotIndex-07245</span><br>

If <code>videoSession</code> was created with a decode operation and the
<code>slotIndex</code> member of any element of <code>pReferenceSlots</code> is not
negative, then the image view specified in
<code>pPictureResource-&gt;imageViewBinding</code> for that element <strong>must</strong> have
been created with <code>VK_IMAGE_USAGE_VIDEO_DECODE_DPB_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-slotIndex-07246" href="#VUID-VkVideoBeginCodingInfoKHR-slotIndex-07246"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-slotIndex-07246</span><br>

If <code>videoSession</code> was created with an encode operation and the
<code>slotIndex</code> member of any element of <code>pReferenceSlots</code> is not
negative, then the image view specified in
<code>pPictureResource-&gt;imageViewBinding</code> for that element <strong>must</strong> have
been created with <code>VK_IMAGE_USAGE_VIDEO_ENCODE_DPB_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSession-07247" href="#VUID-VkVideoBeginCodingInfoKHR-videoSession-07247"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSession-07247</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then
<code>videoSessionParameters</code> <strong>must</strong> not be <code>VK_NULL_HANDLE</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSession-07248" href="#VUID-VkVideoBeginCodingInfoKHR-videoSession-07248"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSession-07248</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then
<code>videoSessionParameters</code> <strong>must</strong> not be <code>VK_NULL_HANDLE</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSession-07249" href="#VUID-VkVideoBeginCodingInfoKHR-videoSession-07249"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSession-07249</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_EXT</code>, then
<code>videoSessionParameters</code> <strong>must</strong> not be <code>VK_NULL_HANDLE</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSession-07250" href="#VUID-VkVideoBeginCodingInfoKHR-videoSession-07250"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSession-07250</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_EXT</code>, then
<code>videoSessionParameters</code> <strong>must</strong> not be <code>VK_NULL_HANDLE</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-04857" href="#VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-04857"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-04857</span><br>

If <code>videoSessionParameters</code> is not <code>VK_NULL_HANDLE</code>, it <strong>must</strong>
have been created with <code>videoSession</code> specified in
<a href="#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a>::<code>videoSession</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-sType-sType" href="#VUID-VkVideoBeginCodingInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_BEGIN_CODING_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-pNext-pNext" href="#VUID-VkVideoBeginCodingInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="#VkVideoEncodeH264GopRemainingFrameInfoEXT">VkVideoEncodeH264GopRemainingFrameInfoEXT</a>, <a href="#VkVideoEncodeH264RateControlInfoEXT">VkVideoEncodeH264RateControlInfoEXT</a>, <a href="#VkVideoEncodeH265GopRemainingFrameInfoEXT">VkVideoEncodeH265GopRemainingFrameInfoEXT</a>, <a href="#VkVideoEncodeH265RateControlInfoEXT">VkVideoEncodeH265RateControlInfoEXT</a>, or <a href="#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-sType-unique" href="#VUID-VkVideoBeginCodingInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-flags-zerobitmask" href="#VUID-VkVideoBeginCodingInfoKHR-flags-zerobitmask"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-flags-zerobitmask</span><br>
 <code>flags</code> <strong>must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSession-parameter" href="#VUID-VkVideoBeginCodingInfoKHR-videoSession-parameter"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSession-parameter</span><br>
 <code>videoSession</code> <strong>must</strong> be a valid <a href="#VkVideoSessionKHR">VkVideoSessionKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-parameter" href="#VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-parameter"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-parameter</span><br>
 If <code>videoSessionParameters</code> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, <code>videoSessionParameters</code> <strong>must</strong> be a valid <a href="#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-pReferenceSlots-parameter" href="#VUID-VkVideoBeginCodingInfoKHR-pReferenceSlots-parameter"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-pReferenceSlots-parameter</span><br>
 If <code>referenceSlotCount</code> is not <code>0</code>, <code>pReferenceSlots</code> <strong>must</strong> be a valid pointer to an array of <code>referenceSlotCount</code> valid <a href="#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-parent" href="#VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-parent"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-parent</span><br>
 If <code>videoSessionParameters</code> is a valid handle, it <strong>must</strong> have been created, allocated, or retrieved from <code>videoSession</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-commonparent" href="#VUID-VkVideoBeginCodingInfoKHR-commonparent"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-commonparent</span><br>
 Both of <code>videoSession</code>, and <code>videoSessionParameters</code> that are valid handles of non-ignored parameters <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoBeginCodingFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef VkFlags VkVideoBeginCodingFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoBeginCodingFlagsKHR</code> is a bitmask type for setting a mask, but
is currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoReferenceSlotInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoReferenceSlotInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef struct VkVideoReferenceSlotInfoKHR {
    VkStructureType                         sType;
    const void*                             pNext;
    int32_t                                 slotIndex;
    const VkVideoPictureResourceInfoKHR*    pPictureResource;
} VkVideoReferenceSlotInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>slotIndex</code> is the index of the <a href="#dpb-slot">DPB slot</a> or a negative
integer value.</p>
</li>
<li>
<p><code>pPictureResource</code> is <code>NULL</code> or a pointer to a
<a href="#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure describing the
<a href="#video-picture-resources">video picture resource</a> associated with the
DPB slot index specified by <code>slotIndex</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoReferenceSlotInfoKHR-sType-sType" href="#VUID-VkVideoReferenceSlotInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoReferenceSlotInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_REFERENCE_SLOT_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoReferenceSlotInfoKHR-pNext-pNext" href="#VUID-VkVideoReferenceSlotInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoReferenceSlotInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a>, <a href="#VkVideoDecodeH265DpbSlotInfoKHR">VkVideoDecodeH265DpbSlotInfoKHR</a>, <a href="#VkVideoEncodeH264DpbSlotInfoEXT">VkVideoEncodeH264DpbSlotInfoEXT</a>, or <a href="#VkVideoEncodeH265DpbSlotInfoEXT">VkVideoEncodeH265DpbSlotInfoEXT</a></p>
</li>
<li>
<p><a id="VUID-VkVideoReferenceSlotInfoKHR-sType-unique" href="#VUID-VkVideoReferenceSlotInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoReferenceSlotInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkVideoReferenceSlotInfoKHR-pPictureResource-parameter" href="#VUID-VkVideoReferenceSlotInfoKHR-pPictureResource-parameter"></a> <span class="vuid">VUID-VkVideoReferenceSlotInfoKHR-pPictureResource-parameter</span><br>
 If <code>pPictureResource</code> is not <code>NULL</code>, <code>pPictureResource</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To end a video coding scope, call:</p>
</div>
<div id="vkCmdEndVideoCodingKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
void vkCmdEndVideoCodingKHR(
    VkCommandBuffer                             commandBuffer,
    const VkVideoEndCodingInfoKHR*              pEndCodingInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer in which to record the
command.</p>
</li>
<li>
<p><code>pEndCodingInfo</code> is a pointer to a <a href="#VkVideoEndCodingInfoKHR">VkVideoEndCodingInfoKHR</a>
structure specifying the parameters for ending the video coding scope.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After ending a video coding scope, the video session object, the optional
video session parameters object, and all
<a href="#bound-reference-picture-resources">reference picture resources</a>
previously bound by the corresponding <a href="#vkCmdBeginVideoCodingKHR">vkCmdBeginVideoCodingKHR</a> command
are <em>unbound</em>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdEndVideoCodingKHR-None-07251" href="#VUID-vkCmdEndVideoCodingKHR-None-07251"></a> <span class="vuid">VUID-vkCmdEndVideoCodingKHR-None-07251</span><br>

There <strong>must</strong> be no <a href="queries.html#queries-operation-active" class="xref page">active</a> queries</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdEndVideoCodingKHR-commandBuffer-parameter" href="#VUID-vkCmdEndVideoCodingKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdEndVideoCodingKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdEndVideoCodingKHR-pEndCodingInfo-parameter" href="#VUID-vkCmdEndVideoCodingKHR-pEndCodingInfo-parameter"></a> <span class="vuid">VUID-vkCmdEndVideoCodingKHR-pEndCodingInfo-parameter</span><br>
 <code>pEndCodingInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkVideoEndCodingInfoKHR">VkVideoEndCodingInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdEndVideoCodingKHR-commandBuffer-recording" href="#VUID-vkCmdEndVideoCodingKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdEndVideoCodingKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdEndVideoCodingKHR-commandBuffer-cmdpool" href="#VUID-vkCmdEndVideoCodingKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdEndVideoCodingKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support decode, or encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdEndVideoCodingKHR-renderpass" href="#VUID-vkCmdEndVideoCodingKHR-renderpass"></a> <span class="vuid">VUID-vkCmdEndVideoCodingKHR-renderpass</span><br>
 This command <strong>must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdEndVideoCodingKHR-videocoding" href="#VUID-vkCmdEndVideoCodingKHR-videocoding"></a> <span class="vuid">VUID-vkCmdEndVideoCodingKHR-videocoding</span><br>
 This command <strong>must</strong> only be called inside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdEndVideoCodingKHR-bufferlevel" href="#VUID-vkCmdEndVideoCodingKHR-bufferlevel"></a> <span class="vuid">VUID-vkCmdEndVideoCodingKHR-bufferlevel</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a primary <code>VkCommandBuffer</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action<br>
State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEndCodingInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEndCodingInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef struct VkVideoEndCodingInfoKHR {
    VkStructureType             sType;
    const void*                 pNext;
    VkVideoEndCodingFlagsKHR    flags;
} VkVideoEndCodingInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEndCodingInfoKHR-sType-sType" href="#VUID-VkVideoEndCodingInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEndCodingInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_END_CODING_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEndCodingInfoKHR-pNext-pNext" href="#VUID-VkVideoEndCodingInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoEndCodingInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEndCodingInfoKHR-flags-zerobitmask" href="#VUID-VkVideoEndCodingInfoKHR-flags-zerobitmask"></a> <span class="vuid">VUID-VkVideoEndCodingInfoKHR-flags-zerobitmask</span><br>
 <code>flags</code> <strong>must</strong> be <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEndCodingFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef VkFlags VkVideoEndCodingFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEndCodingFlagsKHR</code> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="video-coding-control"><a class="anchor" href="#video-coding-control"></a>Video Coding Control</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To apply dynamic controls to the currently bound video session object, call:</p>
</div>
<div id="vkCmdControlVideoCodingKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
void vkCmdControlVideoCodingKHR(
    VkCommandBuffer                             commandBuffer,
    const VkVideoCodingControlInfoKHR*          pCodingControlInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer in which to record the
command.</p>
</li>
<li>
<p><code>pCodingControlInfo</code> is a pointer to a
<a href="#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a> structure specifying the control
parameters.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The control parameters provided in this call are applied to the video
session at the time the command executes on the device and are in effect
until a subsequent call to this command with the same video session bound
changes the corresponding control parameters.</p>
</div>
<div class="paragraph">
<p>A newly created video session <strong>must</strong> be reset before performing video coding
operations using it by including <code>VK_VIDEO_CODING_CONTROL_RESET_BIT_KHR</code>
in <code>pCodingControlInfo-&gt;flags</code>.
The reset operation also returns all DPB slots of the video session to the
<a href="#dpb-slot-states">inactive state</a>.
Correspondingly, any DPB slot index associated with the
<a href="#bound-reference-picture-resources">bound reference picture resources</a> is
removed.</p>
</div>
<div class="paragraph">
<p>For encode sessions, the reset operation returns rate control configuration
to implementation default settings and sets the video encode quality level
to zero.</p>
</div>
<div class="paragraph">
<p>After video coding operations are performed using a video session, the reset
operation <strong>can</strong> be used to return the video session to the same <em>initial</em>
state as after the reset of a newly created video session.
This <strong>can</strong> be used, for example, when different video sequences are needed to
be processed with the same video session object.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdControlVideoCodingKHR-flags-07017" href="#VUID-vkCmdControlVideoCodingKHR-flags-07017"></a> <span class="vuid">VUID-vkCmdControlVideoCodingKHR-flags-07017</span><br>

If <code>pCodingControlInfo-&gt;flags</code> does not include
<code>VK_VIDEO_CODING_CONTROL_RESET_BIT_KHR</code>, then the bound video
session <strong>must</strong> not be in <a href="#video-session-uninitialized">uninitialized</a>
state at the time the command is executed on the device</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdControlVideoCodingKHR-commandBuffer-parameter" href="#VUID-vkCmdControlVideoCodingKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdControlVideoCodingKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdControlVideoCodingKHR-pCodingControlInfo-parameter" href="#VUID-vkCmdControlVideoCodingKHR-pCodingControlInfo-parameter"></a> <span class="vuid">VUID-vkCmdControlVideoCodingKHR-pCodingControlInfo-parameter</span><br>
 <code>pCodingControlInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdControlVideoCodingKHR-commandBuffer-recording" href="#VUID-vkCmdControlVideoCodingKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdControlVideoCodingKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdControlVideoCodingKHR-commandBuffer-cmdpool" href="#VUID-vkCmdControlVideoCodingKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdControlVideoCodingKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support decode, or encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdControlVideoCodingKHR-renderpass" href="#VUID-vkCmdControlVideoCodingKHR-renderpass"></a> <span class="vuid">VUID-vkCmdControlVideoCodingKHR-renderpass</span><br>
 This command <strong>must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdControlVideoCodingKHR-videocoding" href="#VUID-vkCmdControlVideoCodingKHR-videocoding"></a> <span class="vuid">VUID-vkCmdControlVideoCodingKHR-videocoding</span><br>
 This command <strong>must</strong> only be called inside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdControlVideoCodingKHR-bufferlevel" href="#VUID-vkCmdControlVideoCodingKHR-bufferlevel"></a> <span class="vuid">VUID-vkCmdControlVideoCodingKHR-bufferlevel</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a primary <code>VkCommandBuffer</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoCodingControlInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoCodingControlInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef struct VkVideoCodingControlInfoKHR {
    VkStructureType                 sType;
    const void*                     pNext;
    VkVideoCodingControlFlagsKHR    flags;
} VkVideoCodingControlInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkVideoCodingControlFlagsKHR">VkVideoCodingControlFlagsKHR</a>
specifying control flags.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoCodingControlInfoKHR-flags-07018" href="#VUID-VkVideoCodingControlInfoKHR-flags-07018"></a> <span class="vuid">VUID-VkVideoCodingControlInfoKHR-flags-07018</span><br>

If <code>flags</code> includes
<code>VK_VIDEO_CODING_CONTROL_ENCODE_RATE_CONTROL_BIT_KHR</code>, then the
<code>pNext</code> chain <strong>must</strong> include a <a href="#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a>
structure</p>
</li>
<li>
<p><a id="VUID-VkVideoCodingControlInfoKHR-flags-07021" href="#VUID-VkVideoCodingControlInfoKHR-flags-07021"></a> <span class="vuid">VUID-VkVideoCodingControlInfoKHR-flags-07021</span><br>

If <code>flags</code> includes
<code>VK_VIDEO_CODING_CONTROL_ENCODE_RATE_CONTROL_BIT_KHR</code>, the
<code>rateControlMode</code> member of <a href="#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a>
included in the <code>pNext</code> chain is not
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DEFAULT_KHR</code> or
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR</code>, and the bound
video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_EXT</code>, then the <code>pNext</code>
chain <strong>must</strong> include a <a href="#VkVideoEncodeH264RateControlInfoEXT">VkVideoEncodeH264RateControlInfoEXT</a>
structure</p>
</li>
<li>
<p><a id="VUID-VkVideoCodingControlInfoKHR-pNext-07022" href="#VUID-VkVideoCodingControlInfoKHR-pNext-07022"></a> <span class="vuid">VUID-VkVideoCodingControlInfoKHR-pNext-07022</span><br>

If the <code>pNext</code> chain includes a
<a href="#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a>, and
<a href="#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a>::<code>layerCount</code> is greater than
<code>1</code>, then
<a href="#VkVideoEncodeH264RateControlInfoEXT">VkVideoEncodeH264RateControlInfoEXT</a>::<code>temporalLayerCount</code>
<strong>must</strong> be equal to <code>layerCount</code></p>
</li>
<li>
<p><a id="VUID-VkVideoCodingControlInfoKHR-flags-07024" href="#VUID-VkVideoCodingControlInfoKHR-flags-07024"></a> <span class="vuid">VUID-VkVideoCodingControlInfoKHR-flags-07024</span><br>

If <code>flags</code> includes
<code>VK_VIDEO_CODING_CONTROL_ENCODE_RATE_CONTROL_BIT_KHR</code>, the
<code>rateControlMode</code> member of <a href="#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a>
included in the <code>pNext</code> chain is not
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DEFAULT_KHR</code> or
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR</code>, and the bound
video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_EXT</code>, then the <code>pNext</code>
chain <strong>must</strong> include a <a href="#VkVideoEncodeH265RateControlInfoEXT">VkVideoEncodeH265RateControlInfoEXT</a>
structure</p>
</li>
<li>
<p><a id="VUID-VkVideoCodingControlInfoKHR-pNext-07025" href="#VUID-VkVideoCodingControlInfoKHR-pNext-07025"></a> <span class="vuid">VUID-VkVideoCodingControlInfoKHR-pNext-07025</span><br>

If the <code>pNext</code> chain includes a
<a href="#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a>, and
<a href="#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a>::<code>layerCount</code> is greater than
<code>1</code>, then <a href="#VkVideoEncodeH265RateControlInfoEXT">VkVideoEncodeH265RateControlInfoEXT</a>::<code>subLayerCount</code>
<strong>must</strong> be equal to <code>layerCount</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoCodingControlInfoKHR-sType-sType" href="#VUID-VkVideoCodingControlInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoCodingControlInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_CODING_CONTROL_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoCodingControlInfoKHR-pNext-pNext" href="#VUID-VkVideoCodingControlInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoCodingControlInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="#VkVideoEncodeH264RateControlInfoEXT">VkVideoEncodeH264RateControlInfoEXT</a>, <a href="#VkVideoEncodeH265RateControlInfoEXT">VkVideoEncodeH265RateControlInfoEXT</a>, <a href="#VkVideoEncodeQualityLevelInfoKHR">VkVideoEncodeQualityLevelInfoKHR</a>, or <a href="#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkVideoCodingControlInfoKHR-sType-unique" href="#VUID-VkVideoCodingControlInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoCodingControlInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkVideoCodingControlInfoKHR-flags-parameter" href="#VUID-VkVideoCodingControlInfoKHR-flags-parameter"></a> <span class="vuid">VUID-VkVideoCodingControlInfoKHR-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkVideoCodingControlFlagBitsKHR">VkVideoCodingControlFlagBitsKHR</a> values</p>
</li>
<li>
<p><a id="VUID-VkVideoCodingControlInfoKHR-flags-requiredbitmask" href="#VUID-VkVideoCodingControlInfoKHR-flags-requiredbitmask"></a> <span class="vuid">VUID-VkVideoCodingControlInfoKHR-flags-requiredbitmask</span><br>
 <code>flags</code> <strong>must</strong> not be <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in <a href="#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a>::<code>flags</code>,
specifying the video coding control parameters to be modified, are:</p>
</div>
<div id="VkVideoCodingControlFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef enum VkVideoCodingControlFlagBitsKHR {
    VK_VIDEO_CODING_CONTROL_RESET_BIT_KHR = 0x00000001,
#ifdef VK_ENABLE_BETA_EXTENSIONS
  // Provided by VK_KHR_video_encode_queue
    VK_VIDEO_CODING_CONTROL_ENCODE_RATE_CONTROL_BIT_KHR = 0x00000002,
#endif
#ifdef VK_ENABLE_BETA_EXTENSIONS
  // Provided by VK_KHR_video_encode_queue
    VK_VIDEO_CODING_CONTROL_ENCODE_QUALITY_LEVEL_BIT_KHR = 0x00000004,
#endif
} VkVideoCodingControlFlagBitsKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_CODING_CONTROL_RESET_BIT_KHR</code> indicates a request for the
bound video session to be reset before other coding control parameters
are applied.</p>
</li>
<li>
<p><code>VK_VIDEO_CODING_CONTROL_ENCODE_RATE_CONTROL_BIT_KHR</code> indicates that
the coding control parameters include video encode rate control
parameters (see <a href="#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a>).</p>
</li>
<li>
<p><code>VK_VIDEO_CODING_CONTROL_ENCODE_QUALITY_LEVEL_BIT_KHR</code> indicates
that the coding control parameters include video encode quality level
parameters (see <a href="#VkVideoEncodeQualityLevelInfoKHR">VkVideoEncodeQualityLevelInfoKHR</a>).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoCodingControlFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef VkFlags VkVideoCodingControlFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoCodingControlFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <a href="#VkVideoCodingControlFlagBitsKHR">VkVideoCodingControlFlagBitsKHR</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="video-decode-operations"><a class="anchor" href="#video-decode-operations"></a>Video Decode Operations</h2>
<div class="sectionbody">
<div id="decode-output-picture" class="paragraph">
<p>Video decode operations consume compressed video data from a video bitstream
buffer and zero or more reference pictures, and produce a <em>decode output
picture</em> and an optional <a href="#reconstructed-picture">reconstructed picture</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note:</div>
<div class="paragraph">
<p>Such decode output pictures can be shared with the <a href="#dpb">Decoded Picture Buffer</a>, and can also be used
as the <a href="#encode-input-picture">input</a> of video encode operations,
with graphics or compute operations,
or with <a href="VK_KHR_surface/wsi.html#wsi" class="xref page">Window System Integration</a> APIs,
depending on the capabilities of the implementation.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Video decode operations <strong>may</strong> access the following resources in the
<code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code> stage:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The source video bitstream buffer range and the image subregions
corresponding to the list of <a href="#decode-active-reference-picture-info">    active reference pictures</a> with access
<code>VK_ACCESS_2_VIDEO_DECODE_READ_BIT_KHR</code>.</p>
</li>
<li>
<p>The image subregions corresponding to the target
<a href="#decode-output-picture-info">decode output picture</a> and
<a href="#decode-reconstructed-picture-info">reconstructed picture</a> with access
<code>VK_ACCESS_2_VIDEO_DECODE_WRITE_BIT_KHR</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The image subresource of each <a href="#video-picture-resources">video picture resource</a> accessed by the video coding operation is specified using a
corresponding <a href="#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure.
Each such image subresource <strong>must</strong> be in the appropriate image layout as
follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the image subresource is used in the video decode operation only as
<a href="#decode-output-picture">decode output picture</a>, then it <strong>must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_DST_KHR</code> layout.</p>
</li>
<li>
<p>If the image subresource is used in the video decode operation both as
<a href="#decode-output-picture">decode output picture</a> and
<a href="#reconstructed-picture">reconstructed picture</a>, then it <strong>must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_DPB_KHR</code> layout.</p>
</li>
<li>
<p>If the image subresource is used in the video decode operation only as
<a href="#reconstructed-picture">reconstructed picture</a>, then it <strong>must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_DPB_KHR</code> layout.</p>
</li>
<li>
<p>If the image subresource is used in the video decode operation as a
<a href="#reference-picture">reference picture</a>, then it <strong>must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_DPB_KHR</code> layout.</p>
</li>
</ul>
</div>
<div id="decode-unsuccessful" class="paragraph">
<p>A video decode operation <strong>may</strong> complete unsuccessfully.
In this case the <a href="#decode-output-picture">decode output picture</a> will have
<strong>undefined</strong> contents.
Similarly, if a <a href="#reconstructed-picture">reconstructed picture</a> is
specified, it will also have <strong>undefined</strong> contents, and the activated DPB slot
will have an <a href="#dpb-slot-states">invalid picture reference</a>.</p>
</div>
<div class="sect2">
<h3 id="decode-codec-specific-semantics"><a class="anchor" href="#decode-codec-specific-semantics"></a>Codec-Specific Semantics</h3>
<div class="paragraph">
<p>The following aspects of video decode operations are codec-specific:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The interpretation of the contents of the source video bitstream buffer
range.</p>
</li>
<li>
<p>The construction and interpretation of the list of
<a href="#decode-active-reference-picture-info">active reference pictures</a> and
the interpretation of the picture data referred to by the corresponding
image subregions.</p>
</li>
<li>
<p>The construction and interpretation of information related to the
<a href="#decode-output-picture-info">decode output picture</a> and the generation
of picture data to the corresponding image subregion.</p>
</li>
<li>
<p>The construction and interpretation of information related to the
optional <a href="#decode-reconstructed-picture-info">reconstructed picture</a> and
the generation of picture data to the corresponding image subregion.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These codec-specific behaviors are defined for each video codec operation
separately.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the used video codec operation is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the
codec-specific aspects of the video decoding process are performed as
defined in the <a href="#decode-h264">H.264 Decode Operations</a> section.</p>
</li>
<li>
<p>If the used video codec operation is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the
codec-specific aspects of the video decoding process are performed as
defined in the <a href="#decode-h265">H.265 Decode Operations</a> section.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="decode-operation-steps"><a class="anchor" href="#decode-operation-steps"></a>Video Decode Operation Steps</h3>
<div class="paragraph">
<p>Each video decode operation performs the following steps in the
<code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code> stage:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Reads the encoded video data from the source video bitstream buffer
range.</p>
</li>
<li>
<p>Performs picture reconstruction of the encoded video data according to
the <a href="#decode-codec-specific-semantics">codec-specific semantics</a>,
applying any prediction data read from the <a href="#active-reference-pictures">     active reference pictures</a> in the process;</p>
</li>
<li>
<p>Writes the decoded picture data to the <a href="#decode-output-picture">decode     output picture</a>, and to the <a href="#reconstructed-picture">reconstructed     picture</a>, if one is specified and is different from the decode output
picture, according to the <a href="#decode-codec-specific-semantics">     codec-specific semantics</a>;</p>
</li>
<li>
<p>When <a href="#decode-reconstructed-picture-info">reconstructed picture     information</a> is provided, the requested <a href="#dpb-slot">DPB slot</a> is
<a href="#dpb-slot-states">activated</a> with the specified picture and the DPB
slot index is associated with the corresponding
<a href="#bound-reference-picture-resources">bound reference picture resource</a>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_capabilities"><a class="anchor" href="#_capabilities"></a>Capabilities</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When calling <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> with
<code>pVideoProfile-&gt;videoCodecOperation</code> specifying a decode operation, the
<code>VkVideoDecodeCapabilitiesKHR</code> structure <strong>must</strong> be included in the
<code>pNext</code> chain of the <a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a> structure to retrieve
capabilities specific to video decoding.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoDecodeCapabilitiesKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeCapabilitiesKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_queue
typedef struct VkVideoDecodeCapabilitiesKHR {
    VkStructureType                    sType;
    void*                              pNext;
    VkVideoDecodeCapabilityFlagsKHR    flags;
} VkVideoDecodeCapabilitiesKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkVideoDecodeCapabilityFlagBitsKHR">VkVideoDecodeCapabilityFlagBitsKHR</a>
describing the supported video decoding capabilities.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeCapabilitiesKHR-sType-sType" href="#VUID-VkVideoDecodeCapabilitiesKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeCapabilitiesKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_CAPABILITIES_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>may</strong> be set in <a href="#VkVideoDecodeCapabilitiesKHR">VkVideoDecodeCapabilitiesKHR</a>::<code>flags</code>,
indicating the decoding capabilities supported, are:</p>
</div>
<div id="VkVideoDecodeCapabilityFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_queue
typedef enum VkVideoDecodeCapabilityFlagBitsKHR {
    VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_COINCIDE_BIT_KHR = 0x00000001,
    VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_DISTINCT_BIT_KHR = 0x00000002,
} VkVideoDecodeCapabilityFlagBitsKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_COINCIDE_BIT_KHR</code>
indicates support for using the same video picture resource as the
<a href="#reconstructed-picture">reconstructed picture</a> and
<a href="#decode-output-picture">decode output picture</a> in a video decode
operation.</p>
</li>
<li>
<p><code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_DISTINCT_BIT_KHR</code>
indicates support for using distinct video picture resources as the
<a href="#reconstructed-picture">reconstructed picture</a> and
<a href="#decode-output-picture">decode output picture</a> in a video decode
operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Implementations are only <strong>required</strong> to support one of
<code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_COINCIDE_BIT_KHR</code> and
<code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_DISTINCT_BIT_KHR</code>.
Accordingly, applications <strong>should</strong> handle both cases to maximize portability.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note:</div>
<div class="paragraph">
<p>If both <code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_COINCIDE_BIT_KHR</code> and
<code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_DISTINCT_BIT_KHR</code> are
supported, an application can choose to create separate images for decode
DPB and decode output.
E.g. in cases when linear tiling is preferred (and supported) for the decode
output picture and the DPB requires optimal tiling, this avoids the need for
a separate copy at the expense of additional memory bandwidth requirements
during decoding.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoDecodeCapabilityFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_queue
typedef VkFlags VkVideoDecodeCapabilityFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoDecodeCapabilityFlagsKHR</code> is a bitmask type for setting a mask
of zero or more <a href="#VkVideoDecodeCapabilityFlagBitsKHR">VkVideoDecodeCapabilityFlagBitsKHR</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_video_decode_commands"><a class="anchor" href="#_video_decode_commands"></a>Video Decode Commands</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To launch video decode operations, call:</p>
</div>
<div id="vkCmdDecodeVideoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_queue
void vkCmdDecodeVideoKHR(
    VkCommandBuffer                             commandBuffer,
    const VkVideoDecodeInfoKHR*                 pDecodeInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer in which to record the
command.</p>
</li>
<li>
<p><code>pDecodeInfo</code> is a pointer to a <a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a> structure
specifying the parameters of the video decode operations.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each call issues one or more video decode operations.
The implicit parameter <code>opCount</code> corresponds to the number of video
decode operations issued by the command.
After calling this command, the
<a href="queries.html#queries-operation-active-query-index" class="xref page">active query index</a> of each
<a href="queries.html#queries-operation-active" class="xref page">active</a> query is incremented by <code>opCount</code>.</p>
</div>
<div class="paragraph">
<p>Currently each call to this command results in the issue of a single video
decode operation.</p>
</div>
<div id="decode-active-reference-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Active Reference Picture Information</dt>
<dd>
<p>The list of <a href="#active-reference-pictures">active reference pictures</a> used by
a video decode operation is a list of image subregions used as the source of
<a href="#reference-picture">reference picture</a> data and related parameters, and is
derived from the <a href="#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structures provided as
the elements of the <code>pDecodeInfo-&gt;pReferenceSlots</code> array.
For each element of <code>pDecodeInfo-&gt;pReferenceSlots</code>, one or more elements
are added to the active reference picture list, as defined by the
<a href="#decode-codec-specific-semantics">codec-specific semantics</a>.
Each element of this list contains the following information:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion within the image subresource
<a href="#video-image-subresource-reference">referred</a> to by the
<a href="#video-picture-resources">video picture resource</a> used as the reference
picture.</p>
</li>
<li>
<p>The <a href="#dpb-slot">DPB slot</a> index the reference picture is associated
with.</p>
</li>
<li>
<p>The codec-specific reference information related to the reference
picture.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-reconstructed-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Reconstructed Picture Information</dt>
<dd>
<p>Information related to the optional <a href="#reconstructed-picture">reconstructed picture</a> used by a video decode operation is derived from the
<a href="#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structure pointed to by
<code>pDecodeInfo-&gt;pSetupReferenceSlot</code>, if not <code>NULL</code>, as defined by the
<a href="#decode-codec-specific-semantics">codec-specific semantics</a>, and consists
of the following:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion within the image subresource
<a href="#video-image-subresource-reference">referred</a> to by the
<a href="#video-picture-resources">video picture resource</a> used as the
reconstructed picture.</p>
</li>
<li>
<p>The <a href="#dpb-slot">DPB slot</a> index to <a href="#dpb-slot-states">activate</a> with the
reconstructed picture.</p>
</li>
<li>
<p>The codec-specific reference information related to the reconstructed
picture.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-output-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Decode Output Picture Information</dt>
<dd>
<p>Information related to the <a href="#decode-output-picture">decode output picture</a>
used by a video decode operation is derived from
<code>pDecodeInfo-&gt;dstPictureResource</code> and any codec-specific parameters
provided in the <code>pDecodeInfo-&gt;pNext</code> chain, as defined by the
<a href="#decode-codec-specific-semantics">codec-specific semantics</a>, and consists
of the following:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion within the image subresource
<a href="#video-image-subresource-reference">referred</a> to by the
<a href="#video-picture-resources">video picture resource</a> used as the decode
output picture.</p>
</li>
<li>
<p>The codec-specific picture information related to the decode output
picture.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Several limiting values are defined below that are referenced by the
relevant valid usage statements of this command.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Let <code>uint32_t activeReferencePictureCount</code> be the size of the list of
active reference pictures used by the video decode operation.
Unless otherwise defined, <code>activeReferencePictureCount</code> is set to
the value of <code>pDecodeInfo-&gt;referenceSlotCount</code>.</p>
<div class="ulist">
<ul>
<li>
<p>If the bound video session was created with an <a href="#decode-h264-profile">     H.264 decode profile</a>, then let <code>activeReferencePictureCount</code> be
the value of <code>pDecodeInfo-&gt;referenceSlotCount</code> plus the number of
elements of the <code>pDecodeInfo-&gt;pReferenceSlots</code> array that have a
<a href="#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a> structure included in their
<code>pNext</code> chain with both
<code>pStdReferenceInfo-&gt;flags.top_field_flag</code> and
<code>pStdReferenceInfo-&gt;flags.bottom_field_flag</code> set.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This means that the elements of <code>pDecodeInfo-&gt;pReferenceSlots</code> that
include both a top and bottom field reference are counted as two separate
active reference pictures, as described in the
<a href="#decode-h264-active-reference-picture-info">active reference picture list construction rules for H.264 decode operations</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Let <code>VkOffset2D codedOffsetGranularity</code> be the minimum alignment
requirement for the coded offset of video picture resources.
Unless otherwise defined, the value of the <code>x</code> and <code>y</code> members
of <code>codedOffsetGranularity</code> are <code>0</code>.</p>
<div class="ulist">
<ul>
<li>
<p>If the bound video session was created with an <a href="#decode-h264-profile">     H.264 decode profile</a> with a
<a href="#VkVideoDecodeH264ProfileInfoKHR">VkVideoDecodeH264ProfileInfoKHR</a>::<code>pictureLayout</code> of
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR</code>,
then <code>codedOffsetGranularity</code> is equal to
<a href="#VkVideoDecodeH264CapabilitiesKHR">VkVideoDecodeH264CapabilitiesKHR</a>::<code>fieldOffsetGranularity</code>,
as returned by <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for that
video profile.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Let <code>uint32_t dpbFrameUseCount[]</code> be an array of size <code>maxDpbSlots</code>,
where <code>maxDpbSlots</code> is the
<a href="#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>maxDpbSlots</code> the bound video
session was created with, with each element indicating the number of
times a frame associated with the corresponding DPB slot index is
referred to by the video coding operation.
Let the initial value of each element of the array be <code>0</code>.</p>
<div class="ulist">
<ul>
<li>
<p>If <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then
<code>dpbFrameUseCount[i]</code> is incremented by one, where <code>i</code> equals
<code>pDecodeInfo-&gt;pSetupReferenceSlot&#8594;slotIndex</code>.
If the bound video session object was created with an
<a href="#decode-h264-profile">H.264 decode profile</a>, then
<code>dpbFrameUseCount[i]</code> is decremented by one if either
<code>pStdReferenceInfo-&gt;flags.top_field_flag</code> or
<code>pStdReferenceInfo-&gt;flags.bottom_field_flag</code> is set in the
<a href="#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a> structure in the
<code>pDecodeInfo-&gt;pSetupReferenceSlot&#8594;pNext</code> chain.</p>
</li>
<li>
<p>For each element of <code>pDecodeInfo-&gt;pReferenceSlots</code>,
<code>dpbFrameUseCount[i]</code> is incremented by one, where <code>i</code> equals the
<code>slotIndex</code> member of the corresponding element.
If the bound video session object was created with an
<a href="#decode-h264-profile">H.264 decode profile</a>, then
<code>dpbFrameUseCount[i]</code> is decremented by one if either
<code>pStdReferenceInfo-&gt;flags.top_field_flag</code> or
<code>pStdReferenceInfo-&gt;flags.bottom_field_flag</code> is set in the
<a href="#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a> structure in the <code>pNext</code>
chain of the corresponding element of
<code>pDecodeInfo-&gt;pReferenceSlots</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Let <code>uint32_t dpbTopFieldUseCount[]</code> and <code>uint32_t
dpbBottomFieldUseCount[]</code> be arrays of size <code>maxDpbSlots</code>, where
<code>maxDpbSlots</code> is the
<a href="#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>maxDpbSlots</code> the bound video
session was created with, with each element indicating the number of
times the top field or the bottom field, respectively, associated with
the corresponding DPB slot index is referred to by the video coding
operation.
Let the initial value of each element of the arrays be <code>0</code>.</p>
<div class="ulist">
<ul>
<li>
<p>If the bound video session object was created with an
<a href="#decode-h264-profile">H.264 decode profile</a> and
<code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then perform the
following:</p>
<div class="ulist">
<ul>
<li>
<p>If <code>pStdReferenceInfo-&gt;flags.top_field_flag</code> is set in the
<a href="#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a> structure in the
<code>pDecodeInfo-&gt;pSetupReferenceSlot&#8594;pNext</code> chain, then
<code>dpbTopFieldUseCount[i]</code> is incremented by one, where <code>i</code> equals
<code>pDecodeInfo-&gt;pSetupReferenceSlot&#8594;slotIndex</code>.</p>
</li>
<li>
<p>If <code>pStdReferenceInfo-&gt;flags.bottom_field_flag</code> is set in the
<a href="#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a> structure in the
<code>pDecodeInfo-&gt;pSetupReferenceSlot&#8594;pNext</code> chain, then
<code>dpbBottomFieldUseCount[i]</code> is incremented by one, where <code>i</code>
equals <code>pDecodeInfo-&gt;pSetupReferenceSlot&#8594;slotIndex</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If the bound video session object was created with an
<a href="#decode-h264-profile">H.264 decode profile</a>, then perform the
following for each element of <code>pDecodeInfo-&gt;pReferenceSlots</code>:</p>
<div class="ulist">
<ul>
<li>
<p>If <code>pStdReferenceInfo-&gt;flags.top_field_flag</code> is set in the
<a href="#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a> structure in the <code>pNext</code>
chain of the element, then <code>dpbTopFieldUseCount[i]</code> is incremented by
one, where <code>i</code> equals the <code>slotIndex</code> member of the element.</p>
</li>
<li>
<p>If <code>pStdReferenceInfo-&gt;flags.bottom_field_flag</code> is set in the
<a href="#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a> structure in the <code>pNext</code>
chain of the element, then <code>dpbBottomFieldUseCount[i]</code> is incremented
by one, where <code>i</code> equals the <code>slotIndex</code> member of the
element.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-None-07011" href="#VUID-vkCmdDecodeVideoKHR-None-07011"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-None-07011</span><br>

The bound video session <strong>must</strong> not be in <a href="#video-session-uninitialized">    uninitialized</a> state at the time the command is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-opCount-07134" href="#VUID-vkCmdDecodeVideoKHR-opCount-07134"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-opCount-07134</span><br>

For each <a href="queries.html#queries-operation-active" class="xref page">active</a> query, the
<a href="queries.html#queries-operation-active-query-index" class="xref page">active query index</a>
corresponding to the query type of that query plus <code>opCount</code> <strong>must</strong>
be less than or equal to the
<a href="queries.html#queries-operation-last-activatable-query-index" class="xref page">last activatable query    index</a> corresponding to the query type of that query plus one</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07135" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07135"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07135</span><br>

<code>pDecodeInfo-&gt;srcBuffer</code> <strong>must</strong> be <a href="#video-profile-compatibility">    compatible</a> with the video profile the bound video session was created
with</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-commandBuffer-07136" href="#VUID-vkCmdDecodeVideoKHR-commandBuffer-07136"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-commandBuffer-07136</span><br>

If <code>commandBuffer</code> is an unprotected command buffer and
<a href="devsandqueues.html#limits-protectedNoFault" class="xref page"><code>protectedNoFault</code></a> is not supported,
then <code>pDecodeInfo-&gt;srcBuffer</code> <strong>must</strong> not be a protected buffer</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-commandBuffer-07137" href="#VUID-vkCmdDecodeVideoKHR-commandBuffer-07137"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-commandBuffer-07137</span><br>

If <code>commandBuffer</code> is a protected command buffer and
<a href="devsandqueues.html#limits-protectedNoFault" class="xref page"><code>protectedNoFault</code></a> is not supported,
then <code>pDecodeInfo-&gt;srcBuffer</code> <strong>must</strong> be a protected buffer</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07138" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07138"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07138</span><br>

<code>pDecodeInfo-&gt;srcBufferOffset</code> <strong>must</strong> be an integer multiple of
<a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>minBitstreamBufferOffsetAlignment</code>,
as returned by <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the
video profile the bound video session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07139" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07139"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07139</span><br>

<code>pDecodeInfo-&gt;srcBufferRange</code> <strong>must</strong> be an integer multiple of
<a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>minBitstreamBufferSizeAlignment</code>, as
returned by <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile the bound video session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07140" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07140"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07140</span><br>

If <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code> and
<a href="#VkVideoDecodeCapabilitiesKHR">VkVideoDecodeCapabilitiesKHR</a>::<code>flags</code> does not include
<code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_COINCIDE_BIT_KHR</code>, as
returned by <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile the bound video session was created with, then the video picture
resources specified by <code>pDecodeInfo-&gt;dstPictureResource</code> and
<code>pDecodeInfo-&gt;pSetupReferenceSlot&#8594;pPictureResource</code> <strong>must</strong> not
<a href="#video-picture-resource-matching">match</a></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07141" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07141"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07141</span><br>

If <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code> and
<a href="#VkVideoDecodeCapabilitiesKHR">VkVideoDecodeCapabilitiesKHR</a>::<code>flags</code> does not include
<code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_DISTINCT_BIT_KHR</code>, as
returned by <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile the bound video session was created with, then the video picture
resources specified by <code>pDecodeInfo-&gt;dstPictureResource</code> and
<code>pDecodeInfo-&gt;pSetupReferenceSlot&#8594;pPictureResource</code> <strong>must</strong>
<a href="#video-picture-resource-matching">match</a></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07142" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07142"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07142</span><br>

<code>pDecodeInfo-&gt;dstPictureResource.imageViewBinding</code> <strong>must</strong> be
<a href="#video-profile-compatibility">compatible</a> with the video profile the
bound video session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07143" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07143"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07143</span><br>

The format of <code>pDecodeInfo-&gt;dstPictureResource.imageViewBinding</code>
<strong>must</strong> match the <a href="#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>pictureFormat</code>
the bound video session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07144" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07144"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07144</span><br>

<code>pDecodeInfo-&gt;dstPictureResource.codedOffset</code> <strong>must</strong> be an integer
multiple of <code>codedOffsetGranularity</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07145" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07145"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07145</span><br>

<code>pDecodeInfo-&gt;dstPictureResource.codedExtent</code> <strong>must</strong> be between
<code>minCodedExtent</code> and <code>maxCodedExtent</code>, inclusive, the bound
video session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07146" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07146"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07146</span><br>

<code>pDecodeInfo-&gt;dstPictureResource.imageViewBinding</code> <strong>must</strong> have been
created with <code>VK_IMAGE_USAGE_VIDEO_DECODE_DST_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-commandBuffer-07147" href="#VUID-vkCmdDecodeVideoKHR-commandBuffer-07147"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-commandBuffer-07147</span><br>

If <code>commandBuffer</code> is an unprotected command buffer and
<a href="devsandqueues.html#limits-protectedNoFault" class="xref page"><code>protectedNoFault</code></a> is not supported,
then <code>pDecodeInfo-&gt;dstPictureResource.imageViewBinding</code> <strong>must</strong> not
have been created from a protected image</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-commandBuffer-07148" href="#VUID-vkCmdDecodeVideoKHR-commandBuffer-07148"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-commandBuffer-07148</span><br>

If <code>commandBuffer</code> is a protected command buffer and
<a href="devsandqueues.html#limits-protectedNoFault" class="xref page"><code>protectedNoFault</code></a> is not supported,
then <code>pDecodeInfo-&gt;dstPictureResource.imageViewBinding</code> <strong>must</strong> have
been created from a protected image</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07170" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07170"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07170</span><br>

If <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then
<code>pDecodeInfo-&gt;pSetupReferenceSlot&#8594;slotIndex</code> <strong>must</strong> be less than the
<a href="#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>maxDpbSlots</code> specified when the
bound video session was created</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07173" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07173"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07173</span><br>

If <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then
<code>pDecodeInfo-&gt;pSetupReferenceSlot&#8594;pPictureResource&#8594;codedOffset</code>
<strong>must</strong> be an integer multiple of <code>codedOffsetGranularity</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07149" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07149"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07149</span><br>

If <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then
<code>pDecodeInfo-&gt;pSetupReferenceSlot&#8594;pPictureResource</code> <strong>must</strong>
<a href="#video-picture-resource-matching">match</a> one of the
<a href="#bound-reference-picture-resources">bound reference picture resource</a></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-activeReferencePictureCount-07150" href="#VUID-vkCmdDecodeVideoKHR-activeReferencePictureCount-07150"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-activeReferencePictureCount-07150</span><br>

<code>activeReferencePictureCount</code> <strong>must</strong> be less than or equal to the
<a href="#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>maxActiveReferencePictures</code>
specified when the bound video session was created</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-slotIndex-07256" href="#VUID-vkCmdDecodeVideoKHR-slotIndex-07256"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-slotIndex-07256</span><br>

The <code>slotIndex</code> member of each element of
<code>pDecodeInfo-&gt;pReferenceSlots</code> <strong>must</strong> be less than the
<a href="#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>maxDpbSlots</code> specified when the
bound video session was created</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-codedOffset-07257" href="#VUID-vkCmdDecodeVideoKHR-codedOffset-07257"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-codedOffset-07257</span><br>

The <code>codedOffset</code> member of the <a href="#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a>
structure pointed to by the <code>pPictureResource</code> member of each
element of <code>pDecodeInfo-&gt;pReferenceSlots</code> <strong>must</strong> be an integer
multiple of <code>codedOffsetGranularity</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07151" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07151"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07151</span><br>

The <code>pPictureResource</code> member of each element of
<code>pDecodeInfo-&gt;pReferenceSlots</code> <strong>must</strong>
<a href="#video-picture-resource-matching">match</a> one of the
<a href="#bound-reference-picture-resources">bound reference picture resource</a>
associated with the DPB slot index specified in the <code>slotIndex</code>
member of that element</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07264" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07264"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07264</span><br>

Each video picture resource corresponding to the <code>pPictureResource</code>
member specified in the elements of <code>pDecodeInfo-&gt;pReferenceSlots</code>
<strong>must</strong> be <a href="#video-picture-resource-uniqueness">unique</a> within
<code>pDecodeInfo-&gt;pReferenceSlots</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-dpbFrameUseCount-07176" href="#VUID-vkCmdDecodeVideoKHR-dpbFrameUseCount-07176"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-dpbFrameUseCount-07176</span><br>

All elements of <code>dpbFrameUseCount</code> <strong>must</strong> be less than or equal to
<code>1</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-dpbTopFieldUseCount-07177" href="#VUID-vkCmdDecodeVideoKHR-dpbTopFieldUseCount-07177"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-dpbTopFieldUseCount-07177</span><br>

All elements of <code>dpbTopFieldUseCount</code> <strong>must</strong> be less than or equal to
<code>1</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-dpbBottomFieldUseCount-07178" href="#VUID-vkCmdDecodeVideoKHR-dpbBottomFieldUseCount-07178"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-dpbBottomFieldUseCount-07178</span><br>

All elements of <code>dpbBottomFieldUseCount</code> <strong>must</strong> be less than or equal
to <code>1</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07252" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07252"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07252</span><br>

If <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is <code>NULL</code> or
<code>pDecodeInfo-&gt;pSetupReferenceSlot&#8594;pPictureResource</code> does not
<a href="#video-image-subresource-reference">refer</a> to the same image
subresource as <code>pDecodeInfo-&gt;dstPictureResource</code>, then the image
subresource <a href="#video-image-subresource-reference">referred</a> to by
<code>pDecodeInfo-&gt;dstPictureResource</code> <strong>must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_DST_KHR</code> layout at the time the video
decode operation is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07253" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07253"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07253</span><br>

If <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code> and
<code>pDecodeInfo-&gt;pSetupReferenceSlot&#8594;pPictureResource</code>
<a href="#video-image-subresource-reference">refers</a> to the same image
subresource as <code>pDecodeInfo-&gt;dstPictureResource</code>, then the image
subresource <a href="#video-image-subresource-reference">referred</a> to by
<code>pDecodeInfo-&gt;dstPictureResource</code> <strong>must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_DPB_KHR</code> layout at the time the video
decode operation is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07254" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07254"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07254</span><br>

If <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then the image
subresource <a href="#video-image-subresource-reference">referred</a> to by
<code>pDecodeInfo-&gt;pSetupReferenceSlot&#8594;pPictureResource</code> <strong>must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_DPB_KHR</code> layout at the time the video
decode operation is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pPictureResource-07255" href="#VUID-vkCmdDecodeVideoKHR-pPictureResource-07255"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pPictureResource-07255</span><br>

The image subresource <a href="#video-image-subresource-reference">referred</a> to
by the <code>pPictureResource</code> member of each element of
<code>pDecodeInfo-&gt;pReferenceSlots</code> <strong>must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_DPB_KHR</code> layout at the time the video
decode operation is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pNext-07152" href="#VUID-vkCmdDecodeVideoKHR-pNext-07152"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pNext-07152</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the <code>pNext</code>
chain of <code>pDecodeInfo</code> <strong>must</strong> include a
<a href="#VkVideoDecodeH264PictureInfoKHR">VkVideoDecodeH264PictureInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-None-07258" href="#VUID-vkCmdDecodeVideoKHR-None-07258"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-None-07258</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> but was not created
with <a href="#decode-h264-interlaced-support">interlaced frame support</a>, then
the <a href="#decode-h264-output-picture-info">decode output picture</a> <strong>must</strong>
represent a frame</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pSliceOffsets-07153" href="#VUID-vkCmdDecodeVideoKHR-pSliceOffsets-07153"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pSliceOffsets-07153</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then all elements of
the <code>pSliceOffsets</code> member of the
<a href="#VkVideoDecodeH264PictureInfoKHR">VkVideoDecodeH264PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pDecodeInfo</code> <strong>must</strong> be less than
<code>pDecodeInfo-&gt;srcBufferRange</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-StdVideoH264SequenceParameterSet-07154" href="#VUID-vkCmdDecodeVideoKHR-StdVideoH264SequenceParameterSet-07154"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-StdVideoH264SequenceParameterSet-07154</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the bound video
session parameters object <strong>must</strong> contain a
<code>StdVideoH264SequenceParameterSet</code> entry with
<code>seq_parameter_set_id</code> matching
<code>StdVideoDecodeH264PictureInfo</code>::<code>seq_parameter_set_id</code> that is
provided in the <code>pStdPictureInfo</code> member of the
<a href="#VkVideoDecodeH264PictureInfoKHR">VkVideoDecodeH264PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pDecodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-StdVideoH264PictureParameterSet-07155" href="#VUID-vkCmdDecodeVideoKHR-StdVideoH264PictureParameterSet-07155"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-StdVideoH264PictureParameterSet-07155</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the bound video
session parameters object <strong>must</strong> contain a
<code>StdVideoH264PictureParameterSet</code> entry with
<code>seq_parameter_set_id</code> and <code>pic_parameter_set_id</code> matching
<code>StdVideoDecodeH264PictureInfo</code>::<code>seq_parameter_set_id</code> and
<code>StdVideoDecodeH264PictureInfo</code>::<code>pic_parameter_set_id</code>,
respectively, that are provided in the <code>pStdPictureInfo</code> member of
the <a href="#VkVideoDecodeH264PictureInfoKHR">VkVideoDecodeH264PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pDecodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07156" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07156"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07156</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> and
<code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then the
<code>pNext</code> chain of <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> <strong>must</strong>
include a <a href="#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07259" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07259"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07259</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> but was not created
with <a href="#decode-h264-interlaced-support">interlaced frame support</a>, and
<code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then the
<a href="#decode-h264-reconstructed-picture-info">reconstructed picture</a> <strong>must</strong>
represent a frame</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pNext-07157" href="#VUID-vkCmdDecodeVideoKHR-pNext-07157"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pNext-07157</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the <code>pNext</code>
chain of each element of <code>pDecodeInfo-&gt;pReferenceSlots</code> <strong>must</strong>
include a <a href="#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07260" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07260"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07260</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> but was not created
with <a href="#decode-h264-interlaced-support">interlaced frame support</a>, then
each <a href="#decode-h264-active-reference-picture-info">active reference    picture</a> corresponding to the elements of
<code>pDecodeInfo-&gt;pReferenceSlots</code> <strong>must</strong> represent a frame</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07261" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07261"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07261</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>,
<code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, and the
<a href="#decode-h264-output-picture-info">decode output picture</a> represents a
frame, then the <a href="#decode-h264-reconstructed-picture-info">reconstructed    picture</a> <strong>must</strong> also represent a frame</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07262" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07262"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07262</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>,
<code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, and the
<a href="#decode-h264-output-picture-info">decode output picture</a> represents a
top field, then the
<a href="#decode-h264-reconstructed-picture-info">reconstructed picture</a> <strong>must</strong>
also represent a top field</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07263" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07263"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07263</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>,
<code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, and the
<a href="#decode-h264-output-picture-info">decode output picture</a> represents a
bottom field, then the <a href="#decode-h264-reconstructed-picture-info">    reconstructed picture</a> <strong>must</strong> also represent a bottom field</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07266" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07266"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07266</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> and an
<a href="#decode-h264-active-reference-picture-info">active reference picture</a>
corresponding to any element of <code>pDecodeInfo-&gt;pReferenceSlots</code>
represents a frame, then the DPB slot index of the bound video session
specified by the <code>slotIndex</code> member of that element <strong>must</strong> be
currently associated with a frame picture
<a href="#video-picture-resource-matching">matching</a> the video picture resource
specified by the <code>pPictureResource</code> member of the same element at
the time the command is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07267" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07267"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07267</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> and an
<a href="#decode-h264-active-reference-picture-info">active reference picture</a>
corresponding to any element of <code>pDecodeInfo-&gt;pReferenceSlots</code>
represents a top field, then the DPB slot index of the bound video
session specified by the <code>slotIndex</code> member of that element <strong>must</strong> be
currently associated with a top field picture
<a href="#video-picture-resource-matching">matching</a> the video picture resource
specified by the <code>pPictureResource</code> member of the same element at
the time the command is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07268" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07268"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07268</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> and an
<a href="#decode-h264-active-reference-picture-info">active reference picture</a>
corresponding to any element of <code>pDecodeInfo-&gt;pReferenceSlots</code>
represents a bottom field, then the DPB slot index of the bound video
session specified by the <code>slotIndex</code> member of that element <strong>must</strong> be
currently associated with a bottom field picture
<a href="#video-picture-resource-matching">matching</a> the video picture resource
specified by the <code>pPictureResource</code> member of the same element at
the time the command is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pNext-07158" href="#VUID-vkCmdDecodeVideoKHR-pNext-07158"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pNext-07158</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the <code>pNext</code>
chain of <code>pDecodeInfo</code> <strong>must</strong> include a
<a href="#VkVideoDecodeH265PictureInfoKHR">VkVideoDecodeH265PictureInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pSliceSegmentOffsets-07159" href="#VUID-vkCmdDecodeVideoKHR-pSliceSegmentOffsets-07159"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pSliceSegmentOffsets-07159</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then all elements of
the <code>pSliceSegmentOffsets</code> member of the
<a href="#VkVideoDecodeH265PictureInfoKHR">VkVideoDecodeH265PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pDecodeInfo</code> <strong>must</strong> be less than
<code>pDecodeInfo-&gt;srcBufferRange</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-StdVideoH265VideoParameterSet-07160" href="#VUID-vkCmdDecodeVideoKHR-StdVideoH265VideoParameterSet-07160"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-StdVideoH265VideoParameterSet-07160</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the bound video
session parameters object <strong>must</strong> contain a
<code>StdVideoH265VideoParameterSet</code> entry with
<code>vps_video_parameter_set_id</code> matching
<code>StdVideoDecodeH265PictureInfo</code>::<code>sps_video_parameter_set_id</code>
that is provided in the <code>pStdPictureInfo</code> member of the
<a href="#VkVideoDecodeH265PictureInfoKHR">VkVideoDecodeH265PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pDecodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-StdVideoH265SequenceParameterSet-07161" href="#VUID-vkCmdDecodeVideoKHR-StdVideoH265SequenceParameterSet-07161"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-StdVideoH265SequenceParameterSet-07161</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the bound video
session parameters object <strong>must</strong> contain a
<code>StdVideoH265SequenceParameterSet</code> entry with
<code>sps_video_parameter_set_id</code> and <code>sps_seq_parameter_set_id</code>
matching
<code>StdVideoDecodeH265PictureInfo</code>::<code>sps_video_parameter_set_id</code> and
<code>StdVideoDecodeH265PictureInfo</code>::<code>pps_seq_parameter_set_id</code>,
respectively, that are provided in the <code>pStdPictureInfo</code> member of
the <a href="#VkVideoDecodeH265PictureInfoKHR">VkVideoDecodeH265PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pDecodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-StdVideoH265PictureParameterSet-07162" href="#VUID-vkCmdDecodeVideoKHR-StdVideoH265PictureParameterSet-07162"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-StdVideoH265PictureParameterSet-07162</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the bound video
session parameters object <strong>must</strong> contain a
<code>StdVideoH265PictureParameterSet</code> entry with
<code>sps_video_parameter_set_id</code>, <code>pps_seq_parameter_set_id</code>, and
<code>pps_pic_parameter_set_id</code> matching
<code>StdVideoDecodeH265PictureInfo</code>::<code>sps_video_parameter_set_id</code>,
<code>StdVideoDecodeH265PictureInfo</code>::<code>pps_seq_parameter_set_id</code>, and
<code>StdVideoDecodeH265PictureInfo</code>::<code>pps_pic_parameter_set_id</code>,
respectively, that are provided in the <code>pStdPictureInfo</code> member of
the <a href="#VkVideoDecodeH265PictureInfoKHR">VkVideoDecodeH265PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pDecodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07163" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07163"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07163</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code> and
<code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then the
<code>pNext</code> chain of <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> <strong>must</strong>
include a <a href="#VkVideoDecodeH265DpbSlotInfoKHR">VkVideoDecodeH265DpbSlotInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pNext-07164" href="#VUID-vkCmdDecodeVideoKHR-pNext-07164"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pNext-07164</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the <code>pNext</code>
chain of each element of <code>pDecodeInfo-&gt;pReferenceSlots</code> <strong>must</strong>
include a <a href="#VkVideoDecodeH265DpbSlotInfoKHR">VkVideoDecodeH265DpbSlotInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-commandBuffer-parameter" href="#VUID-vkCmdDecodeVideoKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-parameter" href="#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-parameter"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-parameter</span><br>
 <code>pDecodeInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-commandBuffer-recording" href="#VUID-vkCmdDecodeVideoKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-commandBuffer-cmdpool" href="#VUID-vkCmdDecodeVideoKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support decode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-renderpass" href="#VUID-vkCmdDecodeVideoKHR-renderpass"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-renderpass</span><br>
 This command <strong>must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-videocoding" href="#VUID-vkCmdDecodeVideoKHR-videocoding"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-videocoding</span><br>
 This command <strong>must</strong> only be called inside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-bufferlevel" href="#VUID-vkCmdDecodeVideoKHR-bufferlevel"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-bufferlevel</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a primary <code>VkCommandBuffer</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoDecodeInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_queue
typedef struct VkVideoDecodeInfoKHR {
    VkStructureType                       sType;
    const void*                           pNext;
    VkVideoDecodeFlagsKHR                 flags;
    VkBuffer                              srcBuffer;
    VkDeviceSize                          srcBufferOffset;
    VkDeviceSize                          srcBufferRange;
    VkVideoPictureResourceInfoKHR         dstPictureResource;
    const VkVideoReferenceSlotInfoKHR*    pSetupReferenceSlot;
    uint32_t                              referenceSlotCount;
    const VkVideoReferenceSlotInfoKHR*    pReferenceSlots;
} VkVideoDecodeInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>srcBuffer</code> is the source video bitstream buffer to read the encoded
bitstream from.</p>
</li>
<li>
<p><code>srcBufferOffset</code> is the starting offset in bytes from the start of
<code>srcBuffer</code> to read the encoded bitstream from.</p>
</li>
<li>
<p><code>srcBufferRange</code> is the size in bytes of the encoded bitstream to
decode from <code>srcBuffer</code>, starting from <code>srcBufferOffset</code>.</p>
</li>
<li>
<p><code>dstPictureResource</code> is the video picture resource to use as the
<a href="#decode-output-picture">decode output picture</a>.</p>
</li>
<li>
<p><code>pSetupReferenceSlot</code> is <code>NULL</code> or a pointer to a
<a href="#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structure describing the DPB slot to
<a href="#dpb-slot-states">activate</a> and the video picture resource to use as
the <a href="#reconstructed-picture">reconstructed picture</a> to activate the DPB
slot with.</p>
</li>
<li>
<p><code>referenceSlotCount</code> is the number of elements in the
<code>pReferenceSlots</code> array.</p>
</li>
<li>
<p><code>pReferenceSlots</code> is <code>NULL</code> or a pointer to an array of
<a href="#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structures describing the DPB slots
and corresponding <a href="#reference-picture">reference picture</a> resources to
use in this video decode operation (the set of
<a href="#active-reference-pictures">active reference pictures</a>).</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-srcBuffer-07165" href="#VUID-VkVideoDecodeInfoKHR-srcBuffer-07165"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-srcBuffer-07165</span><br>

<code>srcBuffer</code> <strong>must</strong> have been created with
<code>VK_BUFFER_USAGE_VIDEO_DECODE_SRC_BIT_KHR</code> set</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-srcBufferOffset-07166" href="#VUID-VkVideoDecodeInfoKHR-srcBufferOffset-07166"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-srcBufferOffset-07166</span><br>

<code>srcBufferOffset</code> <strong>must</strong> be less than the size of <code>srcBuffer</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-srcBufferRange-07167" href="#VUID-VkVideoDecodeInfoKHR-srcBufferRange-07167"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-srcBufferRange-07167</span><br>

<code>srcBufferRange</code> <strong>must</strong> be less than or equal to the size of
<code>srcBuffer</code> minus <code>srcBufferOffset</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-pSetupReferenceSlot-07168" href="#VUID-VkVideoDecodeInfoKHR-pSetupReferenceSlot-07168"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-pSetupReferenceSlot-07168</span><br>

If <code>pSetupReferenceSlot</code> is not <code>NULL</code>, then its <code>slotIndex</code>
member <strong>must</strong> not be negative</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-pSetupReferenceSlot-07169" href="#VUID-VkVideoDecodeInfoKHR-pSetupReferenceSlot-07169"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-pSetupReferenceSlot-07169</span><br>

If <code>pSetupReferenceSlot</code> is not <code>NULL</code>, then its
<code>pPictureResource</code> <strong>must</strong> not be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-slotIndex-07171" href="#VUID-VkVideoDecodeInfoKHR-slotIndex-07171"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-slotIndex-07171</span><br>

The <code>slotIndex</code> member of each element of <code>pReferenceSlots</code>
<strong>must</strong> not be negative</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-pPictureResource-07172" href="#VUID-VkVideoDecodeInfoKHR-pPictureResource-07172"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-pPictureResource-07172</span><br>

The <code>pPictureResource</code> member of each element of
<code>pReferenceSlots</code> <strong>must</strong> not be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-sType-sType" href="#VUID-VkVideoDecodeInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-pNext-pNext" href="#VUID-VkVideoDecodeInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="#VkVideoDecodeH264PictureInfoKHR">VkVideoDecodeH264PictureInfoKHR</a> or <a href="#VkVideoDecodeH265PictureInfoKHR">VkVideoDecodeH265PictureInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-sType-unique" href="#VUID-VkVideoDecodeInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-flags-zerobitmask" href="#VUID-VkVideoDecodeInfoKHR-flags-zerobitmask"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-flags-zerobitmask</span><br>
 <code>flags</code> <strong>must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-srcBuffer-parameter" href="#VUID-VkVideoDecodeInfoKHR-srcBuffer-parameter"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-srcBuffer-parameter</span><br>
 <code>srcBuffer</code> <strong>must</strong> be a valid <a href="resources.html#VkBuffer" class="xref page">VkBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-dstPictureResource-parameter" href="#VUID-VkVideoDecodeInfoKHR-dstPictureResource-parameter"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-dstPictureResource-parameter</span><br>
 <code>dstPictureResource</code> <strong>must</strong> be a valid <a href="#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-pSetupReferenceSlot-parameter" href="#VUID-VkVideoDecodeInfoKHR-pSetupReferenceSlot-parameter"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-pSetupReferenceSlot-parameter</span><br>
 If <code>pSetupReferenceSlot</code> is not <code>NULL</code>, <code>pSetupReferenceSlot</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-pReferenceSlots-parameter" href="#VUID-VkVideoDecodeInfoKHR-pReferenceSlots-parameter"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-pReferenceSlots-parameter</span><br>
 If <code>referenceSlotCount</code> is not <code>0</code>, <code>pReferenceSlots</code> <strong>must</strong> be a valid pointer to an array of <code>referenceSlotCount</code> valid <a href="#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structures</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoDecodeFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_queue
typedef VkFlags VkVideoDecodeFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoDecodeFlagsKHR</code> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="decode-h264"><a class="anchor" href="#decode-h264"></a>H.264 Decode Operations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Video decode operations using an <a href="#decode-h264-profile">H.264 decode profile</a> <strong>can</strong> be used to decode elementary video stream sequences compliant
to the <a href="introduction.html#itu-t-h264" class="xref page">ITU-T H.264 Specification</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Refer to the <a href="preamble.html#preamble" class="xref page">Preamble</a> for information on how the Khronos
Intellectual Property Rights Policy relates to normative references to
external materials not created by Khronos.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This process is performed according to the <a href="#decode-operation-steps">video decode operation steps</a> with the codec-specific semantics defined in
section 8 of the <a href="introduction.html#itu-t-h264" class="xref page">ITU-T H.264 Specification</a> as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Syntax elements, derived values, and other parameters are applied from
the following structures:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>StdVideoH264SequenceParameterSet</code> structure corresponding to
the <a href="#decode-h264-active-sps">active SPS</a> specifying the
<a href="#decode-h264-sps">H.264 sequence parameter set</a>.</p>
</li>
<li>
<p>The <code>StdVideoH264PictureParameterSet</code> structure corresponding to the
<a href="#decode-h264-active-pps">active PPS</a> specifying the <a href="#decode-h264-pps">     H.264 picture parameter set</a>.</p>
</li>
<li>
<p>The <code>StdVideoDecodeH264PictureInfo</code> structure specifying the
<a href="#decode-h264-picture-info">H.264 picture information</a>.</p>
</li>
<li>
<p>The <code>StdVideoDecodeH264ReferenceInfo</code> structures specifying the
<a href="#decode-h264-reference-info">H.264 reference information</a>
corresponding to the optional <a href="#reconstructed-picture">reconstructed     picture</a> and any <a href="#active-reference-pictures">active reference     pictures</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The contents of the provided video bitstream buffer range are
interpreted as defined in the <a href="#decode-h264-bitstream-data-access">H.264    Decode Bitstream Data Access</a> section.</p>
</li>
<li>
<p>Picture data in the <a href="#video-picture-resources">video picture resources</a>
corresponding to the used <a href="#decode-h264-active-reference-picture-info">    active reference pictures</a>, <a href="#decode-h264-output-picture-info">decode    output picture</a>, and optional <a href="#decode-h264-reconstructed-picture-info">    reconstructed picture</a> is accessed as defined in the
<a href="#decode-h264-picture-data-access">H.264 Decode Picture Data Access</a>
section.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the parameters and the bitstream adhere to the syntactic and semantic
requirements defined in the corresponding sections of the <a href="introduction.html#itu-t-h264" class="xref page">ITU-T H.264 Specification</a>, as described above, and the <a href="#dpb-slot">DPB slots</a>
associated with the <a href="#active-reference-pictures">active reference pictures</a>
all refer to <a href="#dpb-slot-states">valid picture references</a>, then the video
decode operation will complete successfully.
Otherwise, the video decode operation <strong>may</strong> complete
<a href="#decode-unsuccessful">unsuccessfully</a>.</p>
</div>
<div class="sect2">
<h3 id="decode-h264-bitstream-data-access"><a class="anchor" href="#decode-h264-bitstream-data-access"></a>H.264 Decode Bitstream Data Access</h3>
<div class="paragraph">
<p>If the target <a href="#decode-h264-output-picture-info">decode output picture</a> is a
frame, then the video bitstream buffer range <strong>should</strong> contain a VCL NAL unit
comprised of the slice headers and data of a picture representing an entire
frame, as defined in sections 7.3.3 and 7.3.4, and this data is interpreted
as defined in sections 7.4.3 and 7.4.4 of the <a href="introduction.html#itu-t-h264" class="xref page">ITU-T H.264 Specification</a>, respectively.</p>
</div>
<div class="paragraph">
<p>If the target <a href="#decode-h264-output-picture-info">decode output picture</a> is a
field, then the video bitstream buffer range should contain a VCL NAL unit
comprised of the slice headers and data of a picture representing a field,
as defined in sections 7.3.3 and 7.3.4, and this data is interpreted as
defined in sections 7.4.3 and 7.4.4 of the <a href="introduction.html#itu-t-h264" class="xref page">ITU-T H.264 Specification</a>, respectively.</p>
</div>
<div class="paragraph">
<p>The offsets provided in
<a href="#VkVideoDecodeH264PictureInfoKHR">VkVideoDecodeH264PictureInfoKHR</a>::<code>pSliceOffsets</code> <strong>should</strong> specify
the starting offsets corresponding to each slice header within the video
bitstream buffer range.</p>
</div>
</div>
<div class="sect2">
<h3 id="decode-h264-picture-data-access"><a class="anchor" href="#decode-h264-picture-data-access"></a>H.264 Decode Picture Data Access</h3>
<div class="paragraph">
<p>The effective <code>imageOffset</code> and <code>imageExtent</code> corresponding to a
<a href="#decode-output-picture">decode output picture</a>,
<a href="#reference-picture">reference picture</a>, or
<a href="#reconstructed-picture">reconstructed picture</a> used in video decode
operations with an <a href="#decode-h264-profile">H.264 decode profile</a> are defined
as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>imageOffset</code> is <span class="eq">(<code>codedOffset.x</code>,<code>codedOffset.y</code>)</span> and
<code>imageExtent</code> is <span class="eq">(<code>codedExtent.width</code>,
<code>codedExtent.height</code>)</span>, if the picture represents a frame.</p>
</li>
<li>
<p><code>imageOffset</code> is <span class="eq">(<code>codedOffset.x</code>,<code>codedOffset.y</code>)</span> and
<code>imageExtent</code> is <span class="eq">(<code>codedExtent.width</code>,
<code>codedExtent.height</code>)</span>, if the picture represents a field and the
picture layout of the used <a href="#decode-h264-profile">H.264 decode profile</a>
is
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_INTERLEAVED_LINES_BIT_KHR</code>.</p>
</li>
<li>
<p><code>imageOffset</code> is <span class="eq">(<code>codedOffset.x</code>,<code>codedOffset.y</code>)</span> and
<code>imageExtent</code> is <span class="eq">(<code>codedExtent.width</code>,
<code>codedExtent.height</code> / 2)</span>, if the picture represents a field and
the picture layout of the used <a href="#decode-h264-profile">H.264 decode    profile</a> is
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Where <code>codedOffset</code> and <code>codedExtent</code> are the members of the
<a href="#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure corresponding to the picture.</p>
</div>
<div class="paragraph">
<p>However, accesses to image data within a video picture resource happen at
the granularity indicated by
<a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>pictureAccessGranularity</code>, as returned by
<a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used <a href="#video-profiles">video profile</a>.
This means that the complete image subregion accessed by video coding
operations using an <a href="#decode-h264-profile">H.264 decode profile</a> for the
video picture resource is defined as the set of texels within the coordinate
range:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq">([<code>startX</code>,<code>endX</code>),[<code>startY</code>,<code>endY</code>))</span></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="eq"><code>startX</code></span> equals <code>imageOffset.x</code> rounded down to the
nearest integer multiple of <code>pictureAccessGranularity.width</code>;</p>
</li>
<li>
<p><span class="eq"><code>endX</code></span> equals <span class="eq"><code>imageOffset.x</code> + 
<code>imageExtent.width</code></span> rounded up to the nearest integer multiple of
<code>pictureAccessGranularity.width</code> and clamped to the width of the
image subresource <a href="#video-image-subresource-reference">referred</a> to by
the corresponding <a href="#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure;</p>
</li>
<li>
<p><span class="eq">startY</span> equals <code>imageOffset.y</code> rounded down to the nearest
integer multiple of <code>pictureAccessGranularity.height</code>;</p>
</li>
<li>
<p><span class="eq">endY</span> equals <span class="eq"><code>imageOffset.y</code> + 
<code>imageExtent.height</code></span> rounded up to the nearest integer multiple of
<code>pictureAccessGranularity.height</code> and clamped to the height of the
image subresource <a href="#video-image-subresource-reference">referred</a> to by
the corresponding <a href="#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In case of video decode operations using an <a href="#decode-h264-profile">H.264 decode profile</a>, any access to a picture at the coordinates
<span class="eq">(<code>x</code>,<code>y</code>)</span>, as defined by the <a href="introduction.html#itu-t-h264" class="xref page">ITU-T H.264 Specification</a>, is an access to the image subresource
<a href="#video-image-subresource-reference">referred</a> to by the corresponding
<a href="#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure at the texel coordinates
specified below:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="eq">(<code>x</code>,<code>y</code>)</span>, if the accessed picture represents a frame.</p>
</li>
<li>
<p><span class="eq">(<code>x</code>,<code>y</code> Ã— 2)</span>, if the accessed picture represents a
top field and the picture layout of the used <a href="#decode-h264-profile">H.264    decode profile</a> is
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_INTERLEAVED_LINES_BIT_KHR</code>.</p>
</li>
<li>
<p><span class="eq">(<code>x</code>,<code>y</code> Ã— 2 +  1)</span>, if the accessed picture
represents a bottom field and the picture layout of the used
<a href="#decode-h264-profile">H.264 decode profile</a> is
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_INTERLEAVED_LINES_BIT_KHR</code>.</p>
</li>
<li>
<p><span class="eq">(<code>x</code>,<code>y</code>)</span>, if the accessed picture represents a top field
and the picture layout of the used <a href="#decode-h264-profile">H.264 decode    profile</a> is
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR</code>.</p>
</li>
<li>
<p><span class="eq">(<code>codedOffset.x</code> +  <code>x</code>,<code>codedOffset.y</code> + 
<code>y</code>)</span>, if the accessed picture represents a bottom field and the
picture layout of the used <a href="#decode-h264-profile">H.264 decode profile</a>
is
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Where <code>codedOffset</code> is the member of the corresponding
<a href="#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure.</p>
</div>
</div>
<div class="sect2">
<h3 id="decode-h264-profile"><a class="anchor" href="#decode-h264-profile"></a>H.264 Decode Profile</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A video profile supporting H.264 video decode operations is specified by
setting <a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>::<code>videoCodecOperation</code> to
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> and adding a
<code>VkVideoDecodeH264ProfileInfoKHR</code> structure to the
<a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>::<code>pNext</code> chain.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoDecodeH264ProfileInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeH264ProfileInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_h264
typedef struct VkVideoDecodeH264ProfileInfoKHR {
    VkStructureType                              sType;
    const void*                                  pNext;
    StdVideoH264ProfileIdc                       stdProfileIdc;
    VkVideoDecodeH264PictureLayoutFlagBitsKHR    pictureLayout;
} VkVideoDecodeH264ProfileInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>stdProfileIdc</code> is a <code>StdVideoH264ProfileIdc</code> value specifying
the H.264 codec profile IDC, as defined in section A.2 of the
<a href="introduction.html#itu-t-h264" class="xref page">ITU-T H.264 Specification</a>.</p>
</li>
<li>
<p><code>pictureLayout</code> is a <a href="#VkVideoDecodeH264PictureLayoutFlagBitsKHR">VkVideoDecodeH264PictureLayoutFlagBitsKHR</a>
value specifying the picture layout used by the H.264 video sequence to
be decoded.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH264ProfileInfoKHR-sType-sType" href="#VUID-VkVideoDecodeH264ProfileInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH264ProfileInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H264_PROFILE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH264ProfileInfoKHR-pictureLayout-parameter" href="#VUID-VkVideoDecodeH264ProfileInfoKHR-pictureLayout-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH264ProfileInfoKHR-pictureLayout-parameter</span><br>
 If <code>pictureLayout</code> is not <code>0</code>, <code>pictureLayout</code> <strong>must</strong> be a valid <a href="#VkVideoDecodeH264PictureLayoutFlagBitsKHR">VkVideoDecodeH264PictureLayoutFlagBitsKHR</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The H.264 video decode picture layout flags are defined as follows:</p>
</div>
<div id="VkVideoDecodeH264PictureLayoutFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_h264
typedef enum VkVideoDecodeH264PictureLayoutFlagBitsKHR {
    VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_PROGRESSIVE_KHR = 0,
    VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_INTERLEAVED_LINES_BIT_KHR = 0x00000001,
    VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR = 0x00000002,
} VkVideoDecodeH264PictureLayoutFlagBitsKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_PROGRESSIVE_KHR</code> specifies
support for progressive content.
This flag has the value <code>0</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_INTERLEAVED_LINES_BIT_KHR</code>
specifies support for or use of a picture layout for interlaced content
where all lines belonging to the top field are decoded to the
even-numbered lines within the picture resource, and all lines belonging
to the bottom field are decoded to the odd-numbered lines within the
picture resource.</p>
</li>
<li>
<p><code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR</code>
specifies support for or use of a picture layout for interlaced content
where all lines belonging to a field are grouped together in a single
image subregion, and the two fields comprising the frame <strong>can</strong> be stored
in separate image subregions of the same image subresource or in
separate image subresources.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoDecodeH264PictureLayoutFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_h264
typedef VkFlags VkVideoDecodeH264PictureLayoutFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoDecodeH264PictureLayoutFlagsKHR</code> is a bitmask type for setting a
mask of zero or more <a href="#VkVideoDecodeH264PictureLayoutFlagBitsKHR">VkVideoDecodeH264PictureLayoutFlagBitsKHR</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_h_264_decode_capabilities"><a class="anchor" href="#_h_264_decode_capabilities"></a>H.264 Decode Capabilities</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When calling <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> to query the
capabilities for an <a href="#decode-h264-profile">H.264 decode profile</a>, the
<a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>pNext</code> chain <strong>must</strong> include a
<code>VkVideoDecodeH264CapabilitiesKHR</code> structure that will be filled with
the profile-specific capabilities.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoDecodeH264CapabilitiesKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeH264CapabilitiesKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_h264
typedef struct VkVideoDecodeH264CapabilitiesKHR {
    VkStructureType         sType;
    void*                   pNext;
    StdVideoH264LevelIdc    maxLevelIdc;
    VkOffset2D              fieldOffsetGranularity;
} VkVideoDecodeH264CapabilitiesKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>maxLevelIdc</code> is a <code>StdVideoH264LevelIdc</code> value specifying the
maximum H.264 level supported by the profile, where enum constant
<code>STD_VIDEO_H264_LEVEL_IDC_&lt;major&gt;_&lt;minor&gt;</code> identifies H.264 level
<code>&lt;major&gt;.&lt;minor&gt;</code> as defined in section A.3 of the <a href="introduction.html#itu-t-h264" class="xref page">ITU-T    H.264 Specification</a>.</p>
</li>
<li>
<p><code>fieldOffsetGranularity</code> is the minimum alignment for
<a href="#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a>::<code>codedOffset</code> specified for a
<a href="#video-picture-resources">video picture resource</a> when using the
picture layout
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH264CapabilitiesKHR-sType-sType" href="#VUID-VkVideoDecodeH264CapabilitiesKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH264CapabilitiesKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H264_CAPABILITIES_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="decode-h264-parameter-sets"><a class="anchor" href="#decode-h264-parameter-sets"></a>H.264 Decode Parameter Sets</h3>
<div class="paragraph">
<p><a href="#video-session-parameters">Video session parameters</a> objects created with
the video codec operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>
<strong>can</strong> contain the following types of parameters:</p>
</div>
<div id="decode-h264-sps" class="dlist">
<dl>
<dt class="hdlist1">H.264 Sequence Parameter Sets (SPS)</dt>
<dd>
<p>Represented by <code>StdVideoH264SequenceParameterSet</code> structures and
interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code> and <code>reserved2</code> are used only for padding purposes and
are otherwise ignored;</p>
</li>
<li>
<p><code>seq_parameter_set_id</code> is used as the key of the SPS entry;</p>
</li>
<li>
<p><code>level_idc</code> is one of the enum constants
<code>STD_VIDEO_H264_LEVEL_IDC_&lt;major&gt;_&lt;minor&gt;</code> identifying the H.264 level
<code>&lt;major&gt;.&lt;minor&gt;</code> as defined in section A.3 of the <a href="introduction.html#itu-t-h264" class="xref page">ITU-T    H.264 Specification</a>;</p>
</li>
<li>
<p>if <code>flags.seq_scaling_matrix_present_flag</code> is set, then the
<code>StdVideoH264ScalingLists</code> structure pointed to by <code>pScalingLists</code>
is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>scaling_list_present_mask</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>seq_scaling_list_present_flag[i]</code> as defined in section
7.4.2.1 of the <a href="introduction.html#itu-t-h264" class="xref page">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p><code>use_default_scaling_matrix_mask</code> is a bitmask where bit index
<span class="eq">i</span> corresponds to <code>UseDefaultScalingMatrix4x4Flag[i]</code>, when <span class="eq">i
&lt; 6</span>, or corresponds to <code>UseDefaultScalingMatrix8x8Flag[i-6]</code>,
otherwise, as defined in section 7.3.2.1 of the <a href="introduction.html#itu-t-h264" class="xref page">ITU-T     H.264 Specification</a>;</p>
</li>
<li>
<p><code>ScalingList4x4</code> and <code>ScalingList8x8</code> correspond to the
identically named syntax elements defined in section 7.3.2.1 of the
<a href="introduction.html#itu-t-h264" class="xref page">ITU-T H.264 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.vui_parameters_present_flag</code> is set, then
<code>pSequenceParameterSetVui</code> is a pointer to a
<code>StdVideoH264SequenceParameterSetVui</code> structure that is interpreted
as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code> is used only for padding purposes and is otherwise
ignored;</p>
</li>
<li>
<p>if <code>flags.nal_hrd_parameters_present_flag</code> or
<code>flags.vcl_hrd_parameters_present_flag</code> is set, then the
<code>StdVideoH264HrdParameters</code> structure pointed to by
<code>pHrdParameters</code> is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code> is used only for padding purposes and is otherwise
ignored;</p>
</li>
<li>
<p>all other members of <code>StdVideoH264HrdParameters</code> are interpreted as
defined in section E.2.2 of the <a href="introduction.html#itu-t-h264" class="xref page">ITU-T H.264      Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>StdVideoH264SequenceParameterSetVui</code> are
interpreted as defined in section E.2.1 of the <a href="introduction.html#itu-t-h264" class="xref page">ITU-T H.264     Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>StdVideoH264SequenceParameterSet</code> are
interpreted as defined in section 7.4.2.1 of the <a href="introduction.html#itu-t-h264" class="xref page">ITU-T    H.264 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-h264-pps" class="dlist">
<dl>
<dt class="hdlist1">H.264 Picture Parameter Sets (PPS)</dt>
<dd>
<p>Represented by <code>StdVideoH264PictureParameterSet</code> structures and
interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p>the pair constructed from <code>seq_parameter_set_id</code> and
<code>pic_parameter_set_id</code> is used as the key of the PPS entry;</p>
</li>
<li>
<p>if <code>flags.pic_scaling_matrix_present_flag</code> is set, then the
<code>StdVideoH264ScalingLists</code> structure pointed to by <code>pScalingLists</code>
is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>scaling_list_present_mask</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>pic_scaling_list_present_flag[i]</code> as defined in section
7.4.2.2 of the <a href="introduction.html#itu-t-h264" class="xref page">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p><code>use_default_scaling_matrix_mask</code> is a bitmask where bit index
<span class="eq">i</span> corresponds to <code>UseDefaultScalingMatrix4x4Flag[i]</code>, when <span class="eq">i
&lt; 6</span>, or corresponds to <code>UseDefaultScalingMatrix8x8Flag[i-6]</code>,
otherwise, as defined in section 7.3.2.2 of the <a href="introduction.html#itu-t-h264" class="xref page">ITU-T     H.264 Specification</a>;</p>
</li>
<li>
<p><code>ScalingList4x4</code> and <code>ScalingList8x8</code> correspond to the
identically named syntax elements defined in section 7.3.2.2 of the
<a href="introduction.html#itu-t-h264" class="xref page">ITU-T H.264 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>StdVideoH264PictureParameterSet</code> are
interpreted as defined in section 7.4.2.2 of the <a href="introduction.html#itu-t-h264" class="xref page">ITU-T    H.264 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When a <a href="#video-session-parameters">video session parameters</a> object is
created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, the
<a href="#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a>::<code>pNext</code> chain <strong>must</strong> include
a <code>VkVideoDecodeH264SessionParametersCreateInfoKHR</code> structure specifying
the capacity and initial contents of the object.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoDecodeH264SessionParametersCreateInfoKHR</code> structure is
defined as:</p>
</div>
<div id="VkVideoDecodeH264SessionParametersCreateInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_h264
typedef struct VkVideoDecodeH264SessionParametersCreateInfoKHR {
    VkStructureType                                        sType;
    const void*                                            pNext;
    uint32_t                                               maxStdSPSCount;
    uint32_t                                               maxStdPPSCount;
    const VkVideoDecodeH264SessionParametersAddInfoKHR*    pParametersAddInfo;
} VkVideoDecodeH264SessionParametersCreateInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>maxStdSPSCount</code> is the maximum number of <a href="#decode-h264-sps">H.264    SPS</a> entries the created <code>VkVideoSessionParametersKHR</code> <strong>can</strong>
contain.</p>
</li>
<li>
<p><code>maxStdPPSCount</code> is the maximum number of <a href="#decode-h264-pps">H.264    PPS</a> entries the created <code>VkVideoSessionParametersKHR</code> <strong>can</strong>
contain.</p>
</li>
<li>
<p><code>pParametersAddInfo</code> is <code>NULL</code> or a pointer to a
<a href="#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a> structure specifying
H.264 parameters to add upon object creation.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH264SessionParametersCreateInfoKHR-sType-sType" href="#VUID-VkVideoDecodeH264SessionParametersCreateInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH264SessionParametersCreateInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H264_SESSION_PARAMETERS_CREATE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH264SessionParametersCreateInfoKHR-pParametersAddInfo-parameter" href="#VUID-VkVideoDecodeH264SessionParametersCreateInfoKHR-pParametersAddInfo-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH264SessionParametersCreateInfoKHR-pParametersAddInfo-parameter</span><br>
 If <code>pParametersAddInfo</code> is not <code>NULL</code>, <code>pParametersAddInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoDecodeH264SessionParametersAddInfoKHR</code> structure is defined
as:</p>
</div>
<div id="VkVideoDecodeH264SessionParametersAddInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_h264
typedef struct VkVideoDecodeH264SessionParametersAddInfoKHR {
    VkStructureType                            sType;
    const void*                                pNext;
    uint32_t                                   stdSPSCount;
    const StdVideoH264SequenceParameterSet*    pStdSPSs;
    uint32_t                                   stdPPSCount;
    const StdVideoH264PictureParameterSet*     pStdPPSs;
} VkVideoDecodeH264SessionParametersAddInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>stdSPSCount</code> is the number of elements in the <code>pStdSPSs</code> array.</p>
</li>
<li>
<p><code>pStdSPSs</code> is a pointer to an array of
<code>StdVideoH264SequenceParameterSet</code> structures describing the
<a href="#decode-h264-sps">H.264 SPS</a> entries to add.</p>
</li>
<li>
<p><code>stdPPSCount</code> is the number of elements in the <code>pStdPPSs</code> array.</p>
</li>
<li>
<p><code>pStdPPSs</code> is a pointer to an array of
<code>StdVideoH264PictureParameterSet</code> structures describing the
<a href="#decode-h264-pps">H.264 PPS</a> entries to add.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure <strong>can</strong> be specified in the following places:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <code>pParametersAddInfo</code> member of the
<a href="#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a> structure
specified in the <code>pNext</code> chain of
<a href="#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a> used to create a
<a href="#video-session-parameters">video session parameters</a> object.
In this case, if the video codec operation the video session parameters
object is created with is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then it defines the
set of initial parameters to add to the created object (see
<a href="#creating-video-session-parameters">Creating Video Session    Parameters</a>).</p>
</li>
<li>
<p>In the <code>pNext</code> chain of <a href="#VkVideoSessionParametersUpdateInfoKHR">VkVideoSessionParametersUpdateInfoKHR</a>.
In this case, if the video codec operation the
<a href="#video-session-parameters">video session parameters</a> object to be
updated was created with is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then it defines the
set of parameters to add to it (see
<a href="#video-session-parameters-update">Updating Video Session Parameters</a>).</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-None-04825" href="#VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-None-04825"></a> <span class="vuid">VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-None-04825</span><br>

The <code>seq_parameter_set_id</code> member of each
<code>StdVideoH264SequenceParameterSet</code> structure specified in the
elements of <code>pStdSPSs</code> <strong>must</strong> be unique within <code>pStdSPSs</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-None-04826" href="#VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-None-04826"></a> <span class="vuid">VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-None-04826</span><br>

The pair constructed from the <code>seq_parameter_set_id</code> and
<code>pic_parameter_set_id</code> members of each
<code>StdVideoH264PictureParameterSet</code> structure specified in the elements
of <code>pStdPPSs</code> <strong>must</strong> be unique within <code>pStdPPSs</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-sType-sType" href="#VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H264_SESSION_PARAMETERS_ADD_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-pStdSPSs-parameter" href="#VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-pStdSPSs-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-pStdSPSs-parameter</span><br>
 If <code>stdSPSCount</code> is not <code>0</code>, <code>pStdSPSs</code> <strong>must</strong> be a valid pointer to an array of <code>stdSPSCount</code> <code>StdVideoH264SequenceParameterSet</code> values</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-pStdPPSs-parameter" href="#VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-pStdPPSs-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-pStdPPSs-parameter</span><br>
 If <code>stdPPSCount</code> is not <code>0</code>, <code>pStdPPSs</code> <strong>must</strong> be a valid pointer to an array of <code>stdPPSCount</code> <code>StdVideoH264PictureParameterSet</code> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_h_264_decoding_parameters"><a class="anchor" href="#_h_264_decoding_parameters"></a>H.264 Decoding Parameters</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoDecodeH264PictureInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeH264PictureInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_h264
typedef struct VkVideoDecodeH264PictureInfoKHR {
    VkStructureType                         sType;
    const void*                             pNext;
    const StdVideoDecodeH264PictureInfo*    pStdPictureInfo;
    uint32_t                                sliceCount;
    const uint32_t*                         pSliceOffsets;
} VkVideoDecodeH264PictureInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pStdPictureInfo</code> is a pointer to a
<code>StdVideoDecodeH264PictureInfo</code> structure specifying
<a href="#decode-h264-picture-info">H.264 picture information</a>.</p>
</li>
<li>
<p><code>sliceCount</code> is the number of elements in <code>pSliceOffsets</code>.</p>
</li>
<li>
<p><code>pSliceOffsets</code> is a pointer to an array of <code>sliceCount</code> offsets
specifying the start offset of the slices of the picture within the
video bitstream buffer range specified in <a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure is specified in the <code>pNext</code> chain of the
<a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a> structure passed to <a href="#vkCmdDecodeVideoKHR">vkCmdDecodeVideoKHR</a> to
specify the codec-specific picture information for an <a href="#decode-h264">H.264 decode operation</a>.</p>
</div>
<div id="decode-h264-output-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Decode Output Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of the
<a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a> structure passed to <a href="#vkCmdDecodeVideoKHR">vkCmdDecodeVideoKHR</a>,
the information related to the <a href="#decode-output-picture-info">decode output picture</a> is defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If <code>pStdPictureInfo-&gt;flags.field_pic_flag</code> is not set, then the
picture represents a frame.</p>
</li>
<li>
<p>If <code>pStdPictureInfo-&gt;flags.field_pic_flag</code> is set, then the picture
represents a field.
Specifically:</p>
<div class="ulist">
<ul>
<li>
<p>If <code>pStdPictureInfo-&gt;flags.bottom_field_flag</code> is not set, then the
picture represents the top field of the frame.</p>
</li>
<li>
<p>If <code>pStdPictureInfo-&gt;flags.bottom_field_flag</code> is set, then the
picture represents the bottom field of the frame.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The image subregion used is determined according to the
<a href="#decode-h264-picture-data-access">H.264 Decode Picture Data Access</a>
section.</p>
</li>
<li>
<p>The decode output picture is associated with the
<a href="#decode-h264-picture-info">H.264 picture information</a> provided in
<code>pStdPictureInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-h264-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Std Picture Information</dt>
<dd>
<p>The members of the <code>StdVideoDecodeH264PictureInfo</code> structure pointed to
by <code>pStdPictureInfo</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code> and <code>reserved2</code> are used only for padding purposes and
are otherwise ignored;</p>
</li>
<li>
<p><code>flags.is_intra</code> as defined in section 3.73 of the <a href="introduction.html#itu-t-h264" class="xref page">ITU-T    H.264 Specification</a>;</p>
</li>
<li>
<p><code>flags.is_reference</code> as defined in section 3.136 of the <a href="introduction.html#itu-t-h264" class="xref page">    ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p><code>flags.complementary_field_pair</code> as defined in section 3.35 of the
<a href="introduction.html#itu-t-h264" class="xref page">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p><code>seq_parameter_set_id</code> and <code>pic_parameter_set_id</code> are used to
identify the active parameter sets, as described below;</p>
</li>
<li>
<p>all other members are interpreted as defined in section 7.4.3 of the
<a href="introduction.html#itu-t-h264" class="xref page">ITU-T H.264 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Active Parameter Sets</dt>
<dd>
<p>The members of the <code>StdVideoDecodeH264PictureInfo</code> structure pointed to
by <code>pStdPictureInfo</code> are used to select the active parameter sets to use
from the bound video session parameters object, as follows:</p>
<div class="ulist">
<ul>
<li>
<p><a id="decode-h264-active-sps"></a> The <em>active SPS</em> is the
<a href="#decode-h264-sps">SPS</a> identified by the key specified in
<code>StdVideoDecodeH264PictureInfo</code>::<code>seq_parameter_set_id</code>.</p>
</li>
<li>
<p><a id="decode-h264-active-pps"></a> The <em>active PPS</em> is the
<a href="#decode-h264-pps">PPS</a> identified by the key specified by the pair
constructed from
<code>StdVideoDecodeH264PictureInfo</code>::<code>seq_parameter_set_id</code> and
<code>StdVideoDecodeH264PictureInfo</code>::<code>pic_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH264PictureInfoKHR-sType-sType" href="#VUID-VkVideoDecodeH264PictureInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH264PictureInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H264_PICTURE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH264PictureInfoKHR-pStdPictureInfo-parameter" href="#VUID-VkVideoDecodeH264PictureInfoKHR-pStdPictureInfo-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH264PictureInfoKHR-pStdPictureInfo-parameter</span><br>
 <code>pStdPictureInfo</code> <strong>must</strong> be a valid pointer to a valid <code>StdVideoDecodeH264PictureInfo</code> value</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH264PictureInfoKHR-pSliceOffsets-parameter" href="#VUID-VkVideoDecodeH264PictureInfoKHR-pSliceOffsets-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH264PictureInfoKHR-pSliceOffsets-parameter</span><br>
 <code>pSliceOffsets</code> <strong>must</strong> be a valid pointer to an array of <code>sliceCount</code> <code>uint32_t</code> values</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH264PictureInfoKHR-sliceCount-arraylength" href="#VUID-VkVideoDecodeH264PictureInfoKHR-sliceCount-arraylength"></a> <span class="vuid">VUID-VkVideoDecodeH264PictureInfoKHR-sliceCount-arraylength</span><br>
 <code>sliceCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoDecodeH264DpbSlotInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeH264DpbSlotInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_h264
typedef struct VkVideoDecodeH264DpbSlotInfoKHR {
    VkStructureType                           sType;
    const void*                               pNext;
    const StdVideoDecodeH264ReferenceInfo*    pStdReferenceInfo;
} VkVideoDecodeH264DpbSlotInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pStdReferenceInfo</code> is a pointer to a
<code>StdVideoDecodeH264ReferenceInfo</code> structure specifying
<a href="#decode-h264-reference-info">H.264 reference information</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure is specified in the <code>pNext</code> chain of
<a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pSetupReferenceSlot</code>, if not <code>NULL</code>, and
the <code>pNext</code> chain of the elements of
<a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pReferenceSlots</code> to specify the
codec-specific reference picture information for an <a href="#decode-h264">H.264 decode operation</a>.</p>
</div>
<div id="decode-h264-active-reference-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Active Reference Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of the elements of
<a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pReferenceSlots</code>, one or two elements are
added to the list of <a href="#decode-active-reference-picture-info">active reference pictures</a> used by the video decode operation for each element of
<a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pReferenceSlots</code> as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If neither <code>pStdReferenceInfo-&gt;flags.top_field_flag</code> nor
<code>pStdReferenceInfo-&gt;flags.bottom_field_flag</code> is set, then the
picture is added as a frame reference to the list of active reference
pictures.</p>
</li>
<li>
<p>If <code>pStdReferenceInfo-&gt;flags.top_field_flag</code> is set, then the
picture is added as a top field reference to the list of active
reference pictures.</p>
</li>
<li>
<p>If <code>pStdReferenceInfo-&gt;flags.bottom_field_flag</code> is set, then the
picture is added as a bottom field reference to the list of active
reference pictures.</p>
</li>
<li>
<p>For each added reference picture, the corresponding image subregion used
is determined according to the <a href="#decode-h264-picture-data-access">H.264    Decode Picture Data Access</a> section.</p>
</li>
<li>
<p>Each added reference picture is associated with the <a href="#dpb-slot">DPB    slot</a> index specified in the <code>slotIndex</code> member of the
corresponding element of
<a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pReferenceSlots</code>.</p>
</li>
<li>
<p>Each added reference picture is associated with the
<a href="#decode-h264-reference-info">H.264 reference information</a> provided in
<code>pStdReferenceInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>When both the top and bottom field of an interlaced frame currently
associated with a DPB slot is intended to be used as an active reference
picture and both fields are stored in the same image subregion (which is the
case when using
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_INTERLEAVED_LINES_BIT_KHR</code>
which stores the two fields at even and odd scanlines of the same image
subregion), both references have to be provided through a single
<a href="#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structure that has both
<code>flags.top_field_flag</code> and <code>flags.bottom_field_flag</code> set in the
<code>StdVideoDecodeH264ReferenceInfo</code> structure pointed to by the
<code>pStdReferenceInfo</code> member of the <a href="#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a>
structure included in the corresponding <a href="#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a>
structure&#8217;s <code>pNext</code> chain.
However, this approach can only be used when both fields are stored in the
same image subregion.
If that is not the case (e.g. when using
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR</code>
which requires separate <code>codedOffset</code> values for the two fields and also
allows storing the two fields of a frame in separate image layers or
entirely separate images), then a separate <a href="#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a>
structure needs to be provided for referencing the two fields, each only
setting one of <code>flags.top_field_flag</code> or <code>flags.bottom_field_flag</code>,
and providing the appropriate video picture resource information in
<a href="#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a>::<code>pPictureResource</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="decode-h264-reconstructed-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Reconstructed Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of
<a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pSetupReferenceSlot</code>, the information
related to the <a href="#decode-reconstructed-picture-info">reconstructed picture</a>
is defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If neither <code>pStdReferenceInfo-&gt;flags.top_field_flag</code> nor
<code>pStdReferenceInfo-&gt;flags.bottom_field_flag</code> is set, then the
picture represents a frame.</p>
</li>
<li>
<p>If <code>pStdReferenceInfo-&gt;flags.top_field_flag</code> is set, then the
picture represents a field, specifically, the top field of the frame.</p>
</li>
<li>
<p>If <code>pStdReferenceInfo-&gt;flags.bottom_field_flag</code> is set, then the
picture represents a field, specifically, the bottom field of the frame.</p>
</li>
<li>
<p>The image subregion used is determined according to the
<a href="#decode-h264-picture-data-access">H.264 Decode Picture Data Access</a>
section.</p>
</li>
<li>
<p>The reconstructed picture is used to <a href="#dpb-slot-states">activate</a> the
<a href="#dpb-slot">DPB slot</a> with the index specified in
<a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pSetupReferenceSlot-&gt;slotIndex</code>.</p>
</li>
<li>
<p>The reconstructed picture is associated with the
<a href="#decode-h264-reference-info">H.264 reference information</a> provided in
<code>pStdReferenceInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-h264-reference-info" class="dlist">
<dl>
<dt class="hdlist1">Std Reference Information</dt>
<dd>
<p>The members of the <code>StdVideoDecodeH264ReferenceInfo</code> structure pointed to
by <code>pStdReferenceInfo</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.top_field_flag</code> is used to indicate whether the reference is
used as top field reference;</p>
</li>
<li>
<p><code>flags.bottom_field_flag</code> is used to indicate whether the reference
is used as bottom field reference;</p>
</li>
<li>
<p><code>flags.used_for_long_term_reference</code> is used to indicate whether the
picture is marked as &#8220;used for long-term reference&#8221; as defined in
section 8.2.5.1 of the <a href="introduction.html#itu-t-h264" class="xref page">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p><code>flags.is_non_existing</code> is used to indicate whether the picture is
marked as &#8220;non-existing&#8221; as defined in section 8.2.5.2 of the
<a href="introduction.html#itu-t-h264" class="xref page">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p>all other members are interpreted as defined in section 8.2 of the
<a href="introduction.html#itu-t-h264" class="xref page">ITU-T H.264 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH264DpbSlotInfoKHR-sType-sType" href="#VUID-VkVideoDecodeH264DpbSlotInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH264DpbSlotInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H264_DPB_SLOT_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH264DpbSlotInfoKHR-pStdReferenceInfo-parameter" href="#VUID-VkVideoDecodeH264DpbSlotInfoKHR-pStdReferenceInfo-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH264DpbSlotInfoKHR-pStdReferenceInfo-parameter</span><br>
 <code>pStdReferenceInfo</code> <strong>must</strong> be a valid pointer to a valid <code>StdVideoDecodeH264ReferenceInfo</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="decode-h264-requirements"><a class="anchor" href="#decode-h264-requirements"></a>H.264 Decode Requirements</h3>
<div class="paragraph">
<p>This section describes the <strong>required</strong> H.264 decoding capabilities for
physical devices that have at least one queue family that supports the video
codec operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, as
returned by <a href="devsandqueues.html#vkGetPhysicalDeviceQueueFamilyProperties2" class="xref page">vkGetPhysicalDeviceQueueFamilyProperties2</a> in
<a href="devsandqueues.html#VkQueueFamilyVideoPropertiesKHR" class="xref page">VkQueueFamilyVideoPropertiesKHR</a>::<code>videoCodecOperations</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Required <a href="#video-std-header-version">Video Std Header Versions</a></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Video Std Header Name</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vulkan_video_codec_h264std_decode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="decode-h265"><a class="anchor" href="#decode-h265"></a>H.265 Decode Operations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Video decode operations using an <a href="#decode-h265-profile">H.265 decode profile</a> <strong>can</strong> be used to decode elementary video stream sequences compliant
to the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Refer to the <a href="preamble.html#preamble" class="xref page">Preamble</a> for information on how the Khronos
Intellectual Property Rights Policy relates to normative references to
external materials not created by Khronos.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This process is performed according to the <a href="#decode-operation-steps">video decode operation steps</a> with the codec-specific semantics defined in
section 8 of <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Syntax elements, derived values, and other parameters are applied from
the following structures:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>StdVideoH265VideoParameterSet</code> structure corresponding to the
<a href="#decode-h265-active-vps">active VPS</a> specifying the <a href="#decode-h265-vps">     H.265 video parameter set</a>.</p>
</li>
<li>
<p>The <code>StdVideoH265SequenceParameterSet</code> structure corresponding to
the <a href="#decode-h265-active-sps">active SPS</a> specifying the
<a href="#decode-h265-sps">H.265 sequence parameter set</a>.</p>
</li>
<li>
<p>The <code>StdVideoH265PictureParameterSet</code> structure corresponding to the
<a href="#decode-h265-active-pps">active PPS</a> specifying the <a href="#decode-h265-pps">     H.265 picture parameter set</a>.</p>
</li>
<li>
<p>The <code>StdVideoDecodeH265PictureInfo</code> structure specifying the
<a href="#decode-h265-picture-info">H.265 picture information</a>.</p>
</li>
<li>
<p>The <code>StdVideoDecodeH265ReferenceInfo</code> structures specifying the
<a href="#decode-h265-reference-info">H.265 reference information</a>
corresponding to the optional <a href="#reconstructed-picture">reconstructed     picture</a> and any <a href="#active-reference-pictures">active reference     pictures</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The contents of the provided video bitstream buffer range are
interpreted as defined in the <a href="#decode-h265-bitstream-data-access">H.265    Decode Bitstream Data Access</a> section.</p>
</li>
<li>
<p>Picture data in the <a href="#video-picture-resources">video picture resources</a>
corresponding to the used <a href="#decode-h265-active-reference-picture-info">    active reference pictures</a>, <a href="#decode-h265-output-picture-info">decode    output picture</a>, and optional <a href="#decode-h265-reconstructed-picture-info">    reconstructed picture</a> is accessed as defined in the
<a href="#decode-h265-picture-data-access">H.265 Decode Picture Data Access</a>
section.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the parameters and the bitstream adhere to the syntactic and semantic
requirements defined in the corresponding sections of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>, as described above, and the <a href="#dpb-slot">DPB slots</a>
associated with the <a href="#active-reference-pictures">active reference pictures</a>
all refer to <a href="#dpb-slot-states">valid picture references</a>, then the video
decode operation will complete successfully.
Otherwise, the video decode operation <strong>may</strong> complete
<a href="#decode-unsuccessful">unsuccessfully</a>.</p>
</div>
<div class="sect2">
<h3 id="decode-h265-bitstream-data-access"><a class="anchor" href="#decode-h265-bitstream-data-access"></a>H.265 Decode Bitstream Data Access</h3>
<div class="paragraph">
<p>The video bitstream buffer range <strong>should</strong> contain a VCL NAL unit comprised of
the slice segment headers and data of a picture representing a frame, as
defined in sections 7.3.6 and 7.3.8, and this data is interpreted as defined
in sections 7.4.7 and 7.4.9 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>, respectively.</p>
</div>
<div class="paragraph">
<p>The offsets provided in
<a href="#VkVideoDecodeH265PictureInfoKHR">VkVideoDecodeH265PictureInfoKHR</a>::<code>pSliceSegmentOffsets</code> <strong>should</strong>
specify the starting offsets corresponding to each slice segment header
within the video bitstream buffer range.</p>
</div>
</div>
<div class="sect2">
<h3 id="decode-h265-picture-data-access"><a class="anchor" href="#decode-h265-picture-data-access"></a>H.265 Decode Picture Data Access</h3>
<div class="paragraph">
<p>Accesses to image data within a video picture resource happen at the
granularity indicated by
<a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>pictureAccessGranularity</code>, as returned by
<a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used <a href="#video-profiles">video profile</a>.
Accordingly, the complete image subregion of a
<a href="#decode-output-picture">decode output picture</a>,
<a href="#reference-picture">reference picture</a>, or
<a href="#reconstructed-picture">reconstructed picture</a> accessed by video coding
operations using an <a href="#decode-h265-profile">H.265 decode profile</a> is defined
as the set of texels within the coordinate range:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq">([0,<code>endX</code>),[0,<code>endY</code>))</span></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="eq"><code>endX</code></span> equals <span class="eq"><code>codedExtent.width</code></span> rounded up to the
nearest integer multiple of <code>pictureAccessGranularity.width</code> and
clamped to the width of the image subresource
<a href="#video-image-subresource-reference">referred</a> to by the corresponding
<a href="#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure;</p>
</li>
<li>
<p><span class="eq">endY</span> equals <span class="eq"><code>codedExtent.height</code></span> rounded up to the
nearest integer multiple of <code>pictureAccessGranularity.height</code> and
clamped to the height of the image subresource
<a href="#video-image-subresource-reference">referred</a> to by the corresponding
<a href="#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Where <code>codedExtent</code> is the member of the
<a href="#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure corresponding to the picture.</p>
</div>
<div class="paragraph">
<p>In case of video decode operations using an <a href="#decode-h265-profile">H.265 decode profile</a>, any access to a picture at the coordinates
<span class="eq">(<code>x</code>,<code>y</code>)</span>, as defined by the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>, is an access to the image subresource
<a href="#video-image-subresource-reference">referred</a> to by the corresponding
<a href="#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure at the texel coordinates
<span class="eq">(<code>x</code>,<code>y</code>)</span>.</p>
</div>
</div>
<div class="sect2">
<h3 id="decode-h265-profile"><a class="anchor" href="#decode-h265-profile"></a>H.265 Decode Profile</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A video profile supporting H.265 video decode operations is specified by
setting <a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>::<code>videoCodecOperation</code> to
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code> and adding a
<code>VkVideoDecodeH265ProfileInfoKHR</code> structure to the
<a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>::<code>pNext</code> chain.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoDecodeH265ProfileInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeH265ProfileInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_h265
typedef struct VkVideoDecodeH265ProfileInfoKHR {
    VkStructureType           sType;
    const void*               pNext;
    StdVideoH265ProfileIdc    stdProfileIdc;
} VkVideoDecodeH265ProfileInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>stdProfileIdc</code> is a <code>StdVideoH265ProfileIdc</code> value specifying
the H.265 codec profile IDC, as defined in section A3 of the
<a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH265ProfileInfoKHR-sType-sType" href="#VUID-VkVideoDecodeH265ProfileInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH265ProfileInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H265_PROFILE_INFO_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_h_265_decode_capabilities"><a class="anchor" href="#_h_265_decode_capabilities"></a>H.265 Decode Capabilities</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When calling <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> to query the
capabilities for an <a href="#decode-h265-profile">H.265 decode profile</a>, the
<a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>pNext</code> chain <strong>must</strong> include a
<code>VkVideoDecodeH265CapabilitiesKHR</code> structure that will be filled with
the profile-specific capabilities.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoDecodeH265CapabilitiesKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeH265CapabilitiesKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_h265
typedef struct VkVideoDecodeH265CapabilitiesKHR {
    VkStructureType         sType;
    void*                   pNext;
    StdVideoH265LevelIdc    maxLevelIdc;
} VkVideoDecodeH265CapabilitiesKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>maxLevelIdc</code> is a <code>StdVideoH265LevelIdc</code> value specifying the
maximum H.265 level supported by the profile, where enum constant
<code>STD_VIDEO_H265_LEVEL_IDC_&lt;major&gt;_&lt;minor&gt;</code> identifies H.265 level
<code>&lt;major&gt;.&lt;minor&gt;</code> as defined in section A.4 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T    H.265 Specification</a>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH265CapabilitiesKHR-sType-sType" href="#VUID-VkVideoDecodeH265CapabilitiesKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH265CapabilitiesKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H265_CAPABILITIES_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="decode-h265-parameter-sets"><a class="anchor" href="#decode-h265-parameter-sets"></a>H.265 Decode Parameter Sets</h3>
<div class="paragraph">
<p><a href="#video-session-parameters">Video session parameters</a> objects created with
the video codec operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>
<strong>can</strong> contain the following types of parameters:</p>
</div>
<div id="decode-h265-vps" class="dlist">
<dl>
<dt class="hdlist1">H.265 Video Parameter Sets (VPS)</dt>
<dd>
<p>Represented by <code>StdVideoH265VideoParameterSet</code> structures and interpreted
as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code>, <code>reserved2</code>, and <code>reserved3</code> are used only for
padding purposes and are otherwise ignored;</p>
</li>
<li>
<p><code>vps_video_parameter_set_id</code> is used as the key of the VPS entry;</p>
</li>
<li>
<p>the <code>max_latency_increase_plus1</code>, <code>max_dec_pic_buffering_minus1</code>,
and <code>max_num_reorder_pics</code> members of the
<code>StdVideoH265DecPicBufMgr</code> structure pointed to by <code>pDecPicBufMgr</code>
correspond to <code>vps_max_latency_increase_plus1</code>,
<code>vps_max_dec_pic_buffering_minus1</code>, and <code>vps_max_num_reorder_pics</code>,
respectively, as defined in section 7.4.3.1 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T    H.265 Specification</a>;</p>
</li>
<li>
<p>the <code>StdVideoH265HrdParameters</code> structure pointed to by
<code>pHrdParameters</code> is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved</code> is used only for padding purposes and is otherwise
ignored;</p>
</li>
<li>
<p><code>flags.fixed_pic_rate_general_flag</code> is a bitmask where bit index
<span class="eq">i</span> corresponds to <code>fixed_pic_rate_general_flag[i]</code> as defined in
section E.3.2 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.fixed_pic_rate_within_cvs_flag</code> is a bitmask where bit index
<span class="eq">i</span> corresponds to <code>fixed_pic_rate_within_cvs_flag[i]</code> as defined
in section E.3.2 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.low_delay_hrd_flag</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>low_delay_hrd_flag[i]</code> as defined in section E.3.2 of
the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>if <code>flags.nal_hrd_parameters_present_flag</code> is set, then
<code>pSubLayerHrdParametersNal</code> is a pointer to an array of
<span class="eq"><code>vps_max_sub_layers_minus1</code> + 1</span> number of
<code>StdVideoH265SubLayerHrdParameters</code> structures where
<code>vps_max_sub_layers_minus1</code> is the corresponding member of the
encompassing <code>StdVideoH265VideoParameterSet</code> structure and each
element is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>cbr_flag</code> is a bitmask where bit index <span class="eq">i</span> corresponds to
<code>cbr_flag[i]</code> as defined in section E.3.3 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T      H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of the <code>StdVideoH265SubLayerHrdParameters</code>
structure are interpreted as defined in section E.3.3 of the
<a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.vcl_hrd_parameters_present_flag</code> is set, then
<code>pSubLayerHrdParametersVcl</code> is a pointer to an array of
<span class="eq"><code>vps_max_sub_layers_minus1</code> + 1</span> number of
<code>StdVideoH265SubLayerHrdParameters</code> structures where
<code>vps_max_sub_layers_minus1</code> is the corresponding member of the
encompassing <code>StdVideoH265VideoParameterSet</code> structure and each
element is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>cbr_flag</code> is a bitmask where bit index <span class="eq">i</span> corresponds to
<code>cbr_flag[i]</code> as defined in section E.3.3 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T      H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of the <code>StdVideoH265SubLayerHrdParameters</code>
structure are interpreted as defined in section E.3.3 of the
<a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>StdVideoH265HrdParameters</code> are interpreted as
defined in section E.3.2 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265     Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>the <code>StdVideoH265ProfileTierLevel</code> structure pointed to by
<code>pProfileTierLevel</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>general_level_idc</code> is one of the enum constants
<code>STD_VIDEO_H265_LEVEL_IDC_&lt;major&gt;_&lt;minor&gt;</code> identifying the H.265 level
<code>&lt;major&gt;.&lt;minor&gt;</code> as defined in section A.4 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T     H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoH265ProfileTierLevel</code> are interpreted
as defined in section 7.4.4 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265     Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>StdVideoH265VideoParameterSet</code> are interpreted
as defined in section 7.4.3.1 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265    Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-h265-sps" class="dlist">
<dl>
<dt class="hdlist1">H.265 Sequence Parameter Sets (SPS)</dt>
<dd>
<p>Represented by <code>StdVideoH265SequenceParameterSet</code> structures and
interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code> and <code>reserved2</code> are used only for padding purposes and
are otherwise ignored;</p>
</li>
<li>
<p>the pair constructed from <code>sps_video_parameter_set_id</code> and
<code>sps_seq_parameter_set_id</code> is used as the key of the SPS entry;</p>
</li>
<li>
<p>the <code>StdVideoH265ProfileTierLevel</code> structure pointed to by
<code>pProfileTierLevel</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>general_level_idc</code> is one of the enum constants
<code>STD_VIDEO_H265_LEVEL_IDC_&lt;major&gt;_&lt;minor&gt;</code> identifying the H.265 level
<code>&lt;major&gt;.&lt;minor&gt;</code> as defined in section A.4 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T     H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoH265ProfileTierLevel</code> are interpreted
as defined in section 7.4.4 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265     Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>the <code>max_latency_increase_plus1</code>, <code>max_dec_pic_buffering_minus1</code>,
and <code>max_num_reorder_pics</code> members of the
<code>StdVideoH265DecPicBufMgr</code> structure pointed to by <code>pDecPicBufMgr</code>
correspond to <code>sps_max_latency_increase_plus1</code>,
<code>sps_max_dec_pic_buffering_minus1</code>, and <code>sps_max_num_reorder_pics</code>,
respectively, as defined in section 7.4.3.2 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T    H.265 Specification</a>;</p>
</li>
<li>
<p>if <code>flags.sps_scaling_list_data_present_flag</code> is set, then the
<code>StdVideoH265ScalingLists</code> structure pointed to by <code>pScalingLists</code>
is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>ScalingList4x4</code>, <code>ScalingList8x8</code>, <code>ScalingList16x16</code>, and
<code>ScalingList32x32</code> correspond to <code>ScalingList[0]</code>, <code>ScalingList[1]</code>,
<code>ScalingList[2]</code>, and <code>ScalingList[3]</code>, respectively, as defined in
section 7.3.4 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>ScalingListDCCoef16x16</code> and <code>ScalingListDCCoef32x32</code> correspond
to <code>scaling_list_dc_coef_minus8[0]</code> and
<code>scaling_list_dc_coef_minus8[1]</code>, respectively, as defined in section
7.3.4 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>pShortTermRefPicSet</code> is a pointer to an array of
<code>num_short_term_ref_pic_sets</code> number of
<code>StdVideoH265ShortTermRefPicSet</code> structures where each element is
interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code>, <code>reserved2</code>, and <code>reserved3</code> are used only for
padding purposes and are otherwise ignored;</p>
</li>
<li>
<p><code>used_by_curr_pic_flag</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>used_by_curr_pic_flag[i]</code> as defined in section 7.4.8
of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>use_delta_flag</code> is a bitmask where bit index <span class="eq">i</span> corresponds to
<code>use_delta_flag[i]</code> as defined in section 7.4.8 of the <a href="introduction.html#itu-t-h265" class="xref page">     ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>used_by_curr_pic_s0_flag</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>used_by_curr_pic_s0_flag[i]</code> as defined in section
7.4.8 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>used_by_curr_pic_s1_flag</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>used_by_curr_pic_s1_flag[i]</code> as defined in section
7.4.8 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoH265ShortTermRefPicSet</code> are
interpreted as defined in section 7.4.8 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265     Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.long_term_ref_pics_present_flag</code> is set then the
<code>StdVideoH265LongTermRefPicsSps</code> structure pointed to by
<code>pLongTermRefPicsSps</code> is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>used_by_curr_pic_lt_sps_flag</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>used_by_curr_pic_lt_sps_flag[i]</code> as defined in section
7.4.3.2 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoH265LongTermRefPicsSps</code> are
interpreted as defined in section 7.4.3.2 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T     H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.vui_parameters_present_flag</code> is set, then the
<code>StdVideoH265SequenceParameterSetVui</code> structure pointed to by
<code>pSequenceParameterSetVui</code> is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code>, <code>reserved2</code>, and <code>reserved3</code> are used only for
padding purposes and are otherwise ignored;</p>
</li>
<li>
<p>the <code>StdVideoH265HrdParameters</code> structure pointed to by
<code>pHrdParameters</code> is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.fixed_pic_rate_general_flag</code> is a bitmask where bit index
<span class="eq">i</span> corresponds to <code>fixed_pic_rate_general_flag[i]</code> as defined in
section E.3.2 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.fixed_pic_rate_within_cvs_flag</code> is a bitmask where bit index
<span class="eq">i</span> corresponds to <code>fixed_pic_rate_within_cvs_flag[i]</code> as defined
in section E.3.2 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.low_delay_hrd_flag</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>low_delay_hrd_flag[i]</code> as defined in section E.3.2 of
the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>if <code>flags.nal_hrd_parameters_present_flag</code> is set, then
<code>pSubLayerHrdParametersNal</code> is a pointer to an array of
<span class="eq"><code>sps_max_sub_layers_minus1</code> + 1</span> number of
<code>StdVideoH265SubLayerHrdParameters</code> structures where
<code>sps_max_sub_layers_minus1</code> is the corresponding member of the
encompassing <code>StdVideoH265SequenceParameterSet</code> structure and each
element is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>cbr_flag</code> is a bitmask where bit index <span class="eq">i</span> corresponds to
<code>cbr_flag[i]</code> as defined in section E.3.3 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T       H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of the <code>StdVideoH265SubLayerHrdParameters</code>
structure are interpreted as defined in section E.3.3 of the
<a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.vcl_hrd_parameters_present_flag</code> is set, then
<code>pSubLayerHrdParametersVcl</code> is a pointer to an array of
<span class="eq"><code>sps_max_sub_layers_minus1</code> + 1</span> number of
<code>StdVideoH265SubLayerHrdParameters</code> structures where
<code>sps_max_sub_layers_minus1</code> is the corresponding member of the
encompassing <code>StdVideoH265SequenceParameterSet</code> structure and each
element is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>cbr_flag</code> is a bitmask where bit index <span class="eq">i</span> corresponds to
<code>cbr_flag[i]</code> as defined in section E.3.3 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T       H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of the <code>StdVideoH265SubLayerHrdParameters</code>
structure are interpreted as defined in section E.3.3 of the
<a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>StdVideoH265HrdParameters</code> are interpreted as
defined in section E.3.2 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265      Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>pSequenceParameterSetVui</code> are interpreted as
defined in section E.3.1 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265     Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.sps_palette_predictor_initializer_present_flag</code> is set,
then the <code>PredictorPaletteEntries</code> member of the
<code>StdVideoH265PredictorPaletteEntries</code> structure pointed to by
<code>pPredictorPaletteEntries</code> is interpreted as defined in section
7.4.9.13 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoH265SequenceParameterSet</code> are
interpreted as defined in section 7.4.3.1 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T    H.265 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-h265-pps" class="dlist">
<dl>
<dt class="hdlist1">H.265 Picture Parameter Sets (PPS)</dt>
<dd>
<p>Represented by <code>StdVideoH265PictureParameterSet</code> structures and
interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code>, <code>reserved2</code>, and <code>reserved3</code> are used only for
padding purposes and are otherwise ignored;</p>
</li>
<li>
<p>the triplet constructed from <code>sps_video_parameter_set_id</code>,
<code>pps_seq_parameter_set_id</code>, and <code>pps_pic_parameter_set_id</code> is used
as the key of the PPS entry;</p>
</li>
<li>
<p>if <code>flags.pps_scaling_list_data_present_flag</code> is set, then the
<code>StdVideoH265ScalingLists</code> structure pointed to by <code>pScalingLists</code>
is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>ScalingList4x4</code>, <code>ScalingList8x8</code>, <code>ScalingList16x16</code>, and
<code>ScalingList32x32</code> correspond to <code>ScalingList[0]</code>, <code>ScalingList[1]</code>,
<code>ScalingList[2]</code>, and <code>ScalingList[3]</code>, respectively, as defined in
section 7.3.4 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>ScalingListDCCoef16x16</code> and <code>ScalingListDCCoef32x32</code> correspond
to <code>scaling_list_dc_coef_minus8[0]</code> and
<code>scaling_list_dc_coef_minus8[1]</code>, respectively, as defined in section
7.3.4 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.pps_palette_predictor_initializer_present_flag</code> is set,
then the <code>PredictorPaletteEntries</code> member of the
<code>StdVideoH265PredictorPaletteEntries</code> structure pointed to by
<code>pPredictorPaletteEntries</code> is interpreted as defined in section
7.4.9.13 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoH265PictureParameterSet</code> are
interpreted as defined in section 7.4.3.3 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T    H.265 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When a <a href="#video-session-parameters">video session parameters</a> object is
created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, the
<a href="#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a>::<code>pNext</code> chain <strong>must</strong> include
a <code>VkVideoDecodeH265SessionParametersCreateInfoKHR</code> structure specifying
the capacity and initial contents of the object.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoDecodeH265SessionParametersCreateInfoKHR</code> structure is
defined as:</p>
</div>
<div id="VkVideoDecodeH265SessionParametersCreateInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_h265
typedef struct VkVideoDecodeH265SessionParametersCreateInfoKHR {
    VkStructureType                                        sType;
    const void*                                            pNext;
    uint32_t                                               maxStdVPSCount;
    uint32_t                                               maxStdSPSCount;
    uint32_t                                               maxStdPPSCount;
    const VkVideoDecodeH265SessionParametersAddInfoKHR*    pParametersAddInfo;
} VkVideoDecodeH265SessionParametersCreateInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>maxStdVPSCount</code> is the maximum number of <a href="#decode-h265-vps">H.265    VPS</a> entries the created <code>VkVideoSessionParametersKHR</code> <strong>can</strong>
contain.</p>
</li>
<li>
<p><code>maxStdSPSCount</code> is the maximum number of <a href="#decode-h265-sps">H.265    SPS</a> entries the created <code>VkVideoSessionParametersKHR</code> <strong>can</strong>
contain.</p>
</li>
<li>
<p><code>maxStdPPSCount</code> is the maximum number of <a href="#decode-h265-pps">H.265    PPS</a> entries the created <code>VkVideoSessionParametersKHR</code> <strong>can</strong>
contain.</p>
</li>
<li>
<p><code>pParametersAddInfo</code> is <code>NULL</code> or a pointer to a
<a href="#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a> structure specifying
H.265 parameters to add upon object creation.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH265SessionParametersCreateInfoKHR-sType-sType" href="#VUID-VkVideoDecodeH265SessionParametersCreateInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH265SessionParametersCreateInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H265_SESSION_PARAMETERS_CREATE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH265SessionParametersCreateInfoKHR-pParametersAddInfo-parameter" href="#VUID-VkVideoDecodeH265SessionParametersCreateInfoKHR-pParametersAddInfo-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH265SessionParametersCreateInfoKHR-pParametersAddInfo-parameter</span><br>
 If <code>pParametersAddInfo</code> is not <code>NULL</code>, <code>pParametersAddInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoDecodeH265SessionParametersAddInfoKHR</code> structure is defined
as:</p>
</div>
<div id="VkVideoDecodeH265SessionParametersAddInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_h265
typedef struct VkVideoDecodeH265SessionParametersAddInfoKHR {
    VkStructureType                            sType;
    const void*                                pNext;
    uint32_t                                   stdVPSCount;
    const StdVideoH265VideoParameterSet*       pStdVPSs;
    uint32_t                                   stdSPSCount;
    const StdVideoH265SequenceParameterSet*    pStdSPSs;
    uint32_t                                   stdPPSCount;
    const StdVideoH265PictureParameterSet*     pStdPPSs;
} VkVideoDecodeH265SessionParametersAddInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>stdVPSCount</code> is the number of elements in the <code>pStdVPSs</code> array.</p>
</li>
<li>
<p><code>pStdVPSs</code> is a pointer to an array of
<code>StdVideoH265VideoParameterSet</code> structures describing the
<a href="#decode-h265-vps">H.265 VPS</a> entries to add.</p>
</li>
<li>
<p><code>stdSPSCount</code> is the number of elements in the <code>pStdSPSs</code> array.</p>
</li>
<li>
<p><code>pStdSPSs</code> is a pointer to an array of
<code>StdVideoH265SequenceParameterSet</code> structures describing the
<a href="#decode-h265-sps">H.265 SPS</a> entries to add.</p>
</li>
<li>
<p><code>stdPPSCount</code> is the number of elements in the <code>pStdPPSs</code> array.</p>
</li>
<li>
<p><code>pStdPPSs</code> is a pointer to an array of
<code>StdVideoH265PictureParameterSet</code> structures describing the
<a href="#decode-h265-pps">H.265 PPS</a> entries to add.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure <strong>can</strong> be specified in the following places:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <code>pParametersAddInfo</code> member of the
<a href="#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure
specified in the <code>pNext</code> chain of
<a href="#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a> used to create a
<a href="#video-session-parameters">video session parameters</a> object.
In this case, if the video codec operation the video session parameters
object is created with is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then it defines the
set of initial parameters to add to the created object (see
<a href="#creating-video-session-parameters">Creating Video Session    Parameters</a>).</p>
</li>
<li>
<p>In the <code>pNext</code> chain of <a href="#VkVideoSessionParametersUpdateInfoKHR">VkVideoSessionParametersUpdateInfoKHR</a>.
In this case, if the video codec operation the
<a href="#video-session-parameters">video session parameters</a> object to be
updated was created with is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then it defines the
set of parameters to add to it (see
<a href="#video-session-parameters-update">Updating Video Session Parameters</a>).</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-None-04833" href="#VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-None-04833"></a> <span class="vuid">VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-None-04833</span><br>

The <code>vps_video_parameter_set_id</code> member of each
<code>StdVideoH265VideoParameterSet</code> structure specified in the elements
of <code>pStdVPSs</code> <strong>must</strong> be unique within <code>pStdVPSs</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-None-04834" href="#VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-None-04834"></a> <span class="vuid">VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-None-04834</span><br>

The pair constructed from the <code>sps_video_parameter_set_id</code> and
<code>sps_seq_parameter_set_id</code> members of each
<code>StdVideoH265SequenceParameterSet</code> structure specified in the
elements of <code>pStdSPSs</code> <strong>must</strong> be unique within <code>pStdSPSs</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-None-04835" href="#VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-None-04835"></a> <span class="vuid">VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-None-04835</span><br>

The triplet constructed from the <code>sps_video_parameter_set_id</code>,
<code>pps_seq_parameter_set_id</code>, and <code>pps_pic_parameter_set_id</code>
members of each <code>StdVideoH265PictureParameterSet</code> structure specified
in the elements of <code>pStdPPSs</code> <strong>must</strong> be unique within <code>pStdPPSs</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-sType-sType" href="#VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H265_SESSION_PARAMETERS_ADD_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-pStdVPSs-parameter" href="#VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-pStdVPSs-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-pStdVPSs-parameter</span><br>
 If <code>stdVPSCount</code> is not <code>0</code>, <code>pStdVPSs</code> <strong>must</strong> be a valid pointer to an array of <code>stdVPSCount</code> <code>StdVideoH265VideoParameterSet</code> values</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-pStdSPSs-parameter" href="#VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-pStdSPSs-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-pStdSPSs-parameter</span><br>
 If <code>stdSPSCount</code> is not <code>0</code>, <code>pStdSPSs</code> <strong>must</strong> be a valid pointer to an array of <code>stdSPSCount</code> <code>StdVideoH265SequenceParameterSet</code> values</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-pStdPPSs-parameter" href="#VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-pStdPPSs-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-pStdPPSs-parameter</span><br>
 If <code>stdPPSCount</code> is not <code>0</code>, <code>pStdPPSs</code> <strong>must</strong> be a valid pointer to an array of <code>stdPPSCount</code> <code>StdVideoH265PictureParameterSet</code> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_h_265_decoding_parameters"><a class="anchor" href="#_h_265_decoding_parameters"></a>H.265 Decoding Parameters</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoDecodeH265PictureInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeH265PictureInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_h265
typedef struct VkVideoDecodeH265PictureInfoKHR {
    VkStructureType                         sType;
    const void*                             pNext;
    const StdVideoDecodeH265PictureInfo*    pStdPictureInfo;
    uint32_t                                sliceSegmentCount;
    const uint32_t*                         pSliceSegmentOffsets;
} VkVideoDecodeH265PictureInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pStdPictureInfo</code> is a pointer to a
<code>StdVideoDecodeH265PictureInfo</code> structure specifying
<a href="#decode-h265-picture-info">H.265 picture information</a>.</p>
</li>
<li>
<p><code>sliceSegmentCount</code> is the number of elements in
<code>pSliceSegmentOffsets</code>.</p>
</li>
<li>
<p><code>pSliceSegmentOffsets</code> is a pointer to an array of
<code>sliceSegmentCount</code> offsets specifying the start offset of the slice
segments of the picture within the video bitstream buffer range
specified in <a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure is specified in the <code>pNext</code> chain of the
<a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a> structure passed to <a href="#vkCmdDecodeVideoKHR">vkCmdDecodeVideoKHR</a> to
specify the codec-specific picture information for an <a href="#decode-h265">H.265 decode operation</a>.</p>
</div>
<div id="decode-h265-output-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Decode Output Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of the
<a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a> structure passed to <a href="#vkCmdDecodeVideoKHR">vkCmdDecodeVideoKHR</a>,
the information related to the <a href="#decode-output-picture-info">decode output picture</a> is defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion used is determined according to the
<a href="#decode-h265-picture-data-access">H.265 Decode Picture Data Access</a>
section.</p>
</li>
<li>
<p>The decode output picture is associated with the
<a href="#decode-h265-picture-info">H.265 picture information</a> provided in
<code>pStdPictureInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-h265-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Std Picture Information</dt>
<dd>
<p>The members of the <code>StdVideoDecodeH265PictureInfo</code> structure pointed to
by <code>pStdPictureInfo</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved</code> is used only for padding purposes and is otherwise
ignored;</p>
</li>
<li>
<p><code>flags.IrapPicFlag</code> as defined in section 3.73 of the <a href="introduction.html#itu-t-h265" class="xref page">    ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.IdrPicFlag</code> as defined in section 3.67 of the
<a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.IsReference</code> as defined in section 3.132 of the <a href="introduction.html#itu-t-h265" class="xref page">    ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>sps_video_parameter_set_id</code>, <code>pps_seq_parameter_set_id</code>, and
<code>pps_pic_parameter_set_id</code> are used to identify the active parameter
sets, as described below;</p>
</li>
<li>
<p><code>PicOrderCntVal</code> as defined in section 8.3.1 of the
<a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>NumBitsForSTRefPicSetInSlice</code> is the number of bits used in
<code>st_ref_pic_set</code> when <code>short_term_ref_pic_set_sps_flag</code> is <code>0</code>, or <code>0</code>
otherwise, as defined in sections 7.4.7 and 7.4.8 of the <a href="introduction.html#itu-t-h265" class="xref page">    ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>NumDeltaPocsOfRefRpsIdx</code> is the value of <code>NumDeltaPocs[RefRpsIdx]</code>
when <code>short_term_ref_pic_set_sps_flag</code> is <code>1</code>, or <code>0</code> otherwise, as
defined in sections 7.4.7 and 7.4.8 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265    Specification</a>;</p>
</li>
<li>
<p><code>RefPicSetStCurrBefore</code>, <code>RefPicSetStCurrAfter</code>, and
<code>RefPicSetLtCurr</code> are interpreted as defined in section 8.3.2 of the
<a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a> where each element of these
arrays either identifies an
<a href="#decode-active-reference-picture-info">active reference picture</a> using
its <a href="#dpb-slot">DPB slot</a> index or contains the value 0xFF to indicate
"no reference picture";</p>
</li>
<li>
<p>all other members are interpreted as defined in section 8.3.2 of the
<a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Active Parameter Sets</dt>
<dd>
<p>The members of the <code>StdVideoDecodeH265PictureInfo</code> structure pointed to
by <code>pStdPictureInfo</code> are used to select the active parameter sets to use
from the bound video session parameters object, as follows:</p>
<div class="ulist">
<ul>
<li>
<p><a id="decode-h265-active-vps"></a> The <em>active VPS</em> is the
<a href="#decode-h265-vps">VPS</a> identified by the key specified in
<code>StdVideoDecodeH265PictureInfo</code>::<code>sps_video_parameter_set_id</code>.</p>
</li>
<li>
<p><a id="decode-h265-active-sps"></a> The <em>active SPS</em> is the
<a href="#decode-h265-sps">SPS</a> identified by the key specified by the pair
constructed from
<code>StdVideoDecodeH265PictureInfo</code>::<code>sps_video_parameter_set_id</code> and
<code>StdVideoDecodeH265PictureInfo</code>::<code>pps_seq_parameter_set_id</code>.</p>
</li>
<li>
<p><a id="decode-h265-active-pps"></a> The <em>active PPS</em> is the
<a href="#decode-h265-pps">PPS</a> identified by the key specified by the triplet
constructed from
<code>StdVideoDecodeH265PictureInfo</code>::<code>sps_video_parameter_set_id</code>,
<code>StdVideoDecodeH265PictureInfo</code>::<code>pps_seq_parameter_set_id</code>, and
<code>StdVideoDecodeH265PictureInfo</code>::<code>pps_pic_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH265PictureInfoKHR-sType-sType" href="#VUID-VkVideoDecodeH265PictureInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH265PictureInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H265_PICTURE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH265PictureInfoKHR-pStdPictureInfo-parameter" href="#VUID-VkVideoDecodeH265PictureInfoKHR-pStdPictureInfo-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH265PictureInfoKHR-pStdPictureInfo-parameter</span><br>
 <code>pStdPictureInfo</code> <strong>must</strong> be a valid pointer to a valid <code>StdVideoDecodeH265PictureInfo</code> value</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH265PictureInfoKHR-pSliceSegmentOffsets-parameter" href="#VUID-VkVideoDecodeH265PictureInfoKHR-pSliceSegmentOffsets-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH265PictureInfoKHR-pSliceSegmentOffsets-parameter</span><br>
 <code>pSliceSegmentOffsets</code> <strong>must</strong> be a valid pointer to an array of <code>sliceSegmentCount</code> <code>uint32_t</code> values</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH265PictureInfoKHR-sliceSegmentCount-arraylength" href="#VUID-VkVideoDecodeH265PictureInfoKHR-sliceSegmentCount-arraylength"></a> <span class="vuid">VUID-VkVideoDecodeH265PictureInfoKHR-sliceSegmentCount-arraylength</span><br>
 <code>sliceSegmentCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoDecodeH265DpbSlotInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeH265DpbSlotInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_decode_h265
typedef struct VkVideoDecodeH265DpbSlotInfoKHR {
    VkStructureType                           sType;
    const void*                               pNext;
    const StdVideoDecodeH265ReferenceInfo*    pStdReferenceInfo;
} VkVideoDecodeH265DpbSlotInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pStdReferenceInfo</code> is a pointer to a
<code>StdVideoDecodeH265ReferenceInfo</code> structure specifying reference
picture information described in section 8.3 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T    H.265 Specification</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure is specified in the <code>pNext</code> chain of
<a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pSetupReferenceSlot</code>, if not <code>NULL</code>, and
the <code>pNext</code> chain of the elements of
<a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pReferenceSlots</code> to specify the
codec-specific reference picture information for an <a href="#decode-h265">H.265 decode operation</a>.</p>
</div>
<div id="decode-h265-active-reference-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Active Reference Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of the elements of
<a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pReferenceSlots</code>, one element is added to
the list of <a href="#decode-active-reference-picture-info">active reference pictures</a> used by the video decode operation for each element of
<a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pReferenceSlots</code> as follows:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion used is determined according to the
<a href="#decode-h265-picture-data-access">H.265 Decode Picture Data Access</a>
section.</p>
</li>
<li>
<p>The reference picture is associated with the <a href="#dpb-slot">DPB slot</a> index
specified in the <code>slotIndex</code> member of the corresponding element of
<a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pReferenceSlots</code>.</p>
</li>
<li>
<p>The reference picture is associated with the
<a href="#decode-h265-reference-info">H.265 reference information</a> provided in
<code>pStdReferenceInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-h265-reconstructed-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Reconstructed Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of
<a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pSetupReferenceSlot</code>, the information
related to the <a href="#decode-reconstructed-picture-info">reconstructed picture</a>
is defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion used is determined according to the
<a href="#decode-h265-picture-data-access">H.265 Decode Picture Data Access</a>
section.</p>
</li>
<li>
<p>The reconstructed picture is used to <a href="#dpb-slot-states">activate</a> the
<a href="#dpb-slot">DPB slot</a> with the index specified in
<a href="#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pSetupReferenceSlot-&gt;slotIndex</code>.</p>
</li>
<li>
<p>The reconstructed picture is associated with the
<a href="#decode-h265-reference-info">H.265 reference information</a> provided in
<code>pStdReferenceInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-h265-reference-info" class="dlist">
<dl>
<dt class="hdlist1">Std Reference Information</dt>
<dd>
<p>The members of the <code>StdVideoDecodeH265ReferenceInfo</code> structure pointed to
by <code>pStdReferenceInfo</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.used_for_long_term_reference</code> is used to indicate whether the
picture is marked as &#8220;used for long-term reference&#8221; as defined in
section 8.3.2 of the <a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.unused_for_reference</code> is used to indicate whether the picture
is marked as &#8220;unused for reference&#8221; as defined in section 8.3.2 of the
<a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>all other members are interpreted as defined in section 8.3 of the
<a href="introduction.html#itu-t-h265" class="xref page">ITU-T H.265 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH265DpbSlotInfoKHR-sType-sType" href="#VUID-VkVideoDecodeH265DpbSlotInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH265DpbSlotInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H265_DPB_SLOT_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH265DpbSlotInfoKHR-pStdReferenceInfo-parameter" href="#VUID-VkVideoDecodeH265DpbSlotInfoKHR-pStdReferenceInfo-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH265DpbSlotInfoKHR-pStdReferenceInfo-parameter</span><br>
 <code>pStdReferenceInfo</code> <strong>must</strong> be a valid pointer to a valid <code>StdVideoDecodeH265ReferenceInfo</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="decode-h265-requirements"><a class="anchor" href="#decode-h265-requirements"></a>H.265 Decode Requirements</h3>
<div class="paragraph">
<p>This section describes the <strong>required</strong> H.265 decoding capabilities for
physical devices that have at least one queue family that supports the video
codec operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, as
returned by <a href="devsandqueues.html#vkGetPhysicalDeviceQueueFamilyProperties2" class="xref page">vkGetPhysicalDeviceQueueFamilyProperties2</a> in
<a href="devsandqueues.html#VkQueueFamilyVideoPropertiesKHR" class="xref page">VkQueueFamilyVideoPropertiesKHR</a>::<code>videoCodecOperations</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Required <a href="#video-std-header-version">Video Std Header Versions</a></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Video Std Header Name</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vulkan_video_codec_h265std_decode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="video-encode-operations"><a class="anchor" href="#video-encode-operations"></a>Video Encode Operations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before the application can start recording Vulkan command buffers for the
Video Encode Operations, it <strong>must</strong> do the following, beforehand:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the implementation can encode the Video Content by querying
the supported codec operations and profiles using
<a href="devsandqueues.html#vkGetPhysicalDeviceQueueFamilyProperties2" class="xref page">vkGetPhysicalDeviceQueueFamilyProperties2</a>.</p>
</li>
<li>
<p>By using <a href="#vkGetPhysicalDeviceVideoFormatPropertiesKHR">vkGetPhysicalDeviceVideoFormatPropertiesKHR</a> and providing
one or more video profiles, choose the Vulkan formats supported by the
implementation.
The formats for <a href="#encode-input-picture">input</a> and
<a href="#reference-picture">reference</a> pictures <strong>must</strong> be queried and chosen
separately.
Refer to the section on <a href="#video-format-capabilities">Video Format    Capabilities</a>.</p>
</li>
<li>
<p>Before creating an image to be used as a video picture resource, obtain
the supported image creation parameters by querying with
<a href="formats.html#vkGetPhysicalDeviceFormatProperties2" class="xref page">vkGetPhysicalDeviceFormatProperties2</a> and
<a href="capabilities.html#vkGetPhysicalDeviceImageFormatProperties2" class="xref page">vkGetPhysicalDeviceImageFormatProperties2</a> using one of the
reported formats and adding <a href="#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> to the
<code>pNext</code> chain of <a href="formats.html#VkFormatProperties2" class="xref page">VkFormatProperties2</a>.
When querying the parameters with
<a href="capabilities.html#vkGetPhysicalDeviceImageFormatProperties2" class="xref page">vkGetPhysicalDeviceImageFormatProperties2</a> for images targeting
<a href="#encode-input-picture">input</a> and <a href="#reference-picture">reference (DPB)</a>
pictures, the <a href="capabilities.html#VkPhysicalDeviceImageFormatInfo2" class="xref page">VkPhysicalDeviceImageFormatInfo2</a>::<code>usage</code> field
should contain <code>VK_IMAGE_USAGE_VIDEO_ENCODE_SRC_BIT_KHR</code> and
<code>VK_IMAGE_USAGE_VIDEO_ENCODE_DPB_BIT_KHR</code>, respectively.</p>
</li>
<li>
<p>Create none, some, or all of the required <a href="resources.html#VkImage" class="xref page">images</a> for the
<a href="#encode-input-picture">input</a> and <a href="#reference-picture">reference</a>
pictures.
More Video Picture Resources <strong>can</strong> be created at some later point if
needed while processing the content to be encoded.
Also, if the size of the picture to be encoded is expected to change,
the images <strong>can</strong> be created based on the maximum expected content size.</p>
</li>
<li>
<p>Create the <a href="#video-session">video session</a> to be used for video encode
operations.
Before creating the Encode Video Session, the encode capabilities
<strong>should</strong> be queried with <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> to
obtain the limits of the parameters allowed by the implementation for a
particular codec profile.</p>
</li>
<li>
<p>Bind memory resources with the encode video session by calling
<a href="#vkBindVideoSessionMemoryKHR">vkBindVideoSessionMemoryKHR</a>.
The video session <strong>cannot</strong> be used until memory resources are allocated
and bound to it.
In order to determine the required memory sizes and heap types of the
device memory allocations, <a href="#vkGetVideoSessionMemoryRequirementsKHR">vkGetVideoSessionMemoryRequirementsKHR</a>
<strong>should</strong> be called.</p>
</li>
<li>
<p>Create one or more <a href="#video-session-parameters">Video Session Parameter    objects</a> for use across command buffer recording operations, if
required by the codec extension in use.
These objects <strong>must</strong> be created against a <a href="#video-session">video session</a>
with the parameters required by the codec.
Each <a href="#video-session-parameters">Video Session Parameter object</a> created
is a child object of the associated <a href="#video-session">Session object</a>
and <strong>cannot</strong> be bound in the command buffer with any other
<a href="#video-session">Session Object</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The recording of Video Encode Commands against a Vulkan Command Buffer
consists of the following sequence:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#vkCmdBeginVideoCodingKHR">vkCmdBeginVideoCodingKHR</a> starts the recording of one or more Video
Encode operations in the command buffer.
For each Video Encode Command operation, a Video Session <strong>must</strong> be bound
to the command buffer within this command.
This command establishes a Vulkan Video Encode Context that consists of
the bound Video Session Object, Session Parameters Object, and the
required Video Picture Resources.
The established Video Encode Context is in effect until the
<a href="#vkCmdEndVideoCodingKHR">vkCmdEndVideoCodingKHR</a> command is recorded.
If more Video Encode operations are to be required after the
<a href="#vkCmdEndVideoCodingKHR">vkCmdEndVideoCodingKHR</a> command, another Video Encode Context <strong>can</strong>
be started with the <a href="#vkCmdBeginVideoCodingKHR">vkCmdBeginVideoCodingKHR</a> command.</p>
</li>
<li>
<p><a href="#vkCmdEncodeVideoKHR">vkCmdEncodeVideoKHR</a> specifies one or more frames to be encoded.
The <a href="#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a> parameters, and the codec extension
structures chained to this, specify the details of the encode operation.</p>
</li>
<li>
<p><a href="#vkCmdControlVideoCodingKHR">vkCmdControlVideoCodingKHR</a> records operations against the encoded
data, encoding device, or the Video Session state.</p>
</li>
<li>
<p><a href="#vkCmdEndVideoCodingKHR">vkCmdEndVideoCodingKHR</a> signals the end of the recording of the
Vulkan Video Encode Context, as established by
<a href="#vkCmdBeginVideoCodingKHR">vkCmdBeginVideoCodingKHR</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In addition to the above, the following commands <strong>can</strong> be recorded between
<a href="#vkCmdBeginVideoCodingKHR">vkCmdBeginVideoCodingKHR</a> and <a href="#vkCmdEndVideoCodingKHR">vkCmdEndVideoCodingKHR</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Query operations</p>
</li>
<li>
<p>Global Memory Barriers</p>
</li>
<li>
<p>Buffer Memory Barriers</p>
</li>
<li>
<p>Image Memory Barriers (these <strong>must</strong> be used to transition the Video
Picture Resources to the proper
<code>VK_IMAGE_LAYOUT_VIDEO_ENCODE_SRC_KHR</code> and
<code>VK_IMAGE_LAYOUT_VIDEO_ENCODE_DPB_KHR</code> layouts).</p>
</li>
<li>
<p>Pipeline Barriers</p>
</li>
<li>
<p>Events</p>
</li>
<li>
<p>Timestamps</p>
</li>
<li>
<p>Device Groups (device mask)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following Video Encode related commands <strong>must</strong> be recorded <strong>outside</strong> the
Vulkan Video Encode Context established with the
<a href="#vkCmdBeginVideoCodingKHR">vkCmdBeginVideoCodingKHR</a> and <a href="#vkCmdEndVideoCodingKHR">vkCmdEndVideoCodingKHR</a> commands:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Sparse Memory Binding</p>
</li>
<li>
<p>Copy Commands</p>
</li>
<li>
<p>Clear Commands</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="encode-input-picture"><a class="anchor" href="#encode-input-picture"></a>Encode Input Picture</h3>
<div class="paragraph">
<p>The primary source of input pixels for the video encoding process is the
<em>Encode Input Picture</em>, represented by a <a href="resources.html#VkImageView" class="xref page">VkImageView</a>.
It <strong>may</strong> also be a direct target of
video decode,
graphics, or compute operations
, or with <a href="VK_KHR_surface/wsi.html#wsi" class="xref page">Window System Integration</a> APIs
.</p>
</div>
</div>
<div class="sect2">
<h3 id="_capabilities_2"><a class="anchor" href="#_capabilities_2"></a>Capabilities</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When calling <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> with
<code>pVideoProfile-&gt;videoCodecOperation</code> specified as one of the encode
operation bits, the <a href="#VkVideoEncodeCapabilitiesKHR">VkVideoEncodeCapabilitiesKHR</a> structure <strong>must</strong> be
included in the <code>pNext</code> chain of the <a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>
structure to retrieve capabilities specific to video encoding.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoEncodeCapabilitiesKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeCapabilitiesKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef struct VkVideoEncodeCapabilitiesKHR {
    VkStructureType                         sType;
    void*                                   pNext;
    VkVideoEncodeCapabilityFlagsKHR         flags;
    VkVideoEncodeRateControlModeFlagsKHR    rateControlModes;
    uint32_t                                maxRateControlLayers;
    uint64_t                                maxBitrate;
    uint32_t                                maxQualityLevels;
    VkExtent2D                              encodeInputPictureGranularity;
    VkVideoEncodeFeedbackFlagsKHR           supportedEncodeFeedbackFlags;
} VkVideoEncodeCapabilitiesKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkVideoEncodeCapabilityFlagBitsKHR">VkVideoEncodeCapabilityFlagBitsKHR</a>
describing supported encoding features.</p>
</li>
<li>
<p><code>rateControlModes</code> is a bitmask of
<a href="#VkVideoEncodeRateControlModeFlagBitsKHR">VkVideoEncodeRateControlModeFlagBitsKHR</a> indicating supported rate
control modes.</p>
</li>
<li>
<p><code>maxRateControlLayers</code> indicates the maximum number of rate control
layers supported.</p>
</li>
<li>
<p><code>maxBitrate</code> indicates the maximum supported bitrate.</p>
</li>
<li>
<p><code>maxQualityLevels</code> indicates the number of discrete video encode
quality levels supported.
Implementations <strong>must</strong> report at least 1.</p>
</li>
<li>
<p><code>encodeInputPictureGranularity</code> indicates the granularity at which
<a href="#encode-input-picture">encode input picture</a> data is encoded.</p>
</li>
<li>
<p><code>supportedEncodeFeedbackFlags</code> is a bitmask of
<a href="queries.html#VkVideoEncodeFeedbackFlagBitsKHR" class="xref page">VkVideoEncodeFeedbackFlagBitsKHR</a> values specifying the supported
flags for <a href="queries.html#queries-video-encode-feedback" class="xref page">video encode feedback    queries</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Implementations <strong>must</strong> include support for at least
<code>VK_VIDEO_ENCODE_FEEDBACK_BITSTREAM_BUFFER_OFFSET_BIT_KHR</code> and
<code>VK_VIDEO_ENCODE_FEEDBACK_BITSTREAM_BYTES_WRITTEN_BIT_KHR</code> in
<code>supportedEncodeFeedbackFlags</code>.</p>
</div>
<div class="paragraph">
<p>The input content and encode resolution (specified in
<a href="#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>::<code>codedExtent</code>) may not be aligned with the
codec-specific coding block size.
For example, the input content may be 1920x1080 and the coding block size
may be 16x16 pixel blocks.
In this example, the content is horizontally aligned with the coding block
size, but not vertically aligned with the coding block size.
Encoding of the last row of blocks may be impacted by contents of the input
image in pixel rows 1081 to 1088 (the next vertical alignment with the
coding block size).
In general, to ensure efficient encoding for the last row/column of blocks,
and/or to ensure consistent encoding results between repeated encoding of
the same input content, these extra pixel rows/columns should be filled to
known values up to the coding block size alignment before encoding
operations are performed.
Some implementations support performing auto-fill of unaligned pixels beyond
a specific alignment for the purposes of encoding, which is reported in
<code>encodeInputPictureGranularity</code>.
For example, if an implementation reports 1x1 in
<code>encodeInputPictureGranularity</code>, then the implementation will perform
auto-fill for any unaligned pixels beyond the encode resolution up to the
next coding block size.
For a coding block size of 16x16, if the implementation reports 16x16 in
<code>encodeInputPictureGranularity</code>, then it is the application&#8217;s
responsibility to fill any unaligned pixels, if desired.
When the application does not fill these unaligned pixels, there <strong>may</strong> be an
impact on the encoding efficiency but there will be no effect on the
validity of the generated bitstream.
If the implementation reports 8x8 in <code>encodeInputPictureGranularity</code>,
then for the 1920x1080 example, since the content is aligned to 8 pixels
vertically, the implementation will auto-fill pixel rows 1081 to 1088 (up to
the 16x16 coding block size in the example).
The auto-fill value(s) are implementation-specific.
The auto-fill value(s) are not written to the input image memory, but are
used as part of the encoding operation on the input image.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeCapabilitiesKHR-sType-sType" href="#VUID-VkVideoEncodeCapabilitiesKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeCapabilitiesKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_CAPABILITIES_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeCapabilityFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef VkFlags VkVideoEncodeCapabilityFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeCapabilityFlagsKHR</code> is a bitmask type for setting a mask
of zero or more <a href="#VkVideoEncodeCapabilityFlagBitsKHR">VkVideoEncodeCapabilityFlagBitsKHR</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>may</strong> be set in <a href="#VkVideoEncodeCapabilitiesKHR">VkVideoEncodeCapabilitiesKHR</a>::<code>flags</code>,
indicating the encoding tools supported, are:</p>
</div>
<div id="VkVideoEncodeCapabilityFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef enum VkVideoEncodeCapabilityFlagBitsKHR {
    VK_VIDEO_ENCODE_CAPABILITY_PRECEDING_EXTERNALLY_ENCODED_BYTES_BIT_KHR = 0x00000001,
    VK_VIDEO_ENCODE_CAPABILITY_INSUFFICIENT_BITSTREAM_BUFFER_RANGE_DETECTION_BIT_KHR = 0x00000002,
} VkVideoEncodeCapabilityFlagBitsKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_CAPABILITY_PRECEDING_EXTERNALLY_ENCODED_BYTES_BIT_KHR</code>
indicates that the implementation supports the use of
<a href="#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>::<code>precedingExternallyEncodedBytes</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_CAPABILITY_INSUFFICIENT_BITSTREAM_BUFFER_RANGE_DETECTION_BIT_KHR</code>
indicates that the implementation is able to detect and report when the
destination video bitstream buffer range provided by the application is
not sufficiently large to fit the encoded bitstream data produced by a
video encode operation by reporting the
<code>VK_QUERY_RESULT_STATUS_INSUFFICIENT_BITSTREAM_BUFFER_RANGE_KHR</code>
<a href="queries.html#query-result-status-codes" class="xref page">query result status code</a>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Some implementations <strong>may</strong> not be able to reliably detect insufficient
bitstream buffer range conditions in all situations.
Such implementations will not report support for the
<code>VK_VIDEO_ENCODE_CAPABILITY_INSUFFICIENT_BITSTREAM_BUFFER_RANGE_DETECTION_BIT_KHR</code>
encode capability flag for the video profile, but <strong>may</strong> still report the
<code>VK_QUERY_RESULT_STATUS_INSUFFICIENT_BITSTREAM_BUFFER_RANGE_KHR</code> query
result status code in certain cases.
Applications <strong>should</strong> always check for the specific query result status code
<code>VK_QUERY_RESULT_STATUS_INSUFFICIENT_BITSTREAM_BUFFER_RANGE_KHR</code> even
when this encode capability flag is not supported by the implementation for
the video profile in question.
However, applications <strong>must</strong> not assume that a different negative query
result status code indicating an unsuccessful completion of a video encode
operation is not the result of an insufficient bitstream buffer condition
unless this encode capability flag is supported.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_video_encode_quality_levels"><a class="anchor" href="#_video_encode_quality_levels"></a>Video Encode Quality Levels</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query properties for a specific video encode quality level supported by a
video encode profile, call:</p>
</div>
<div id="vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
VkResult vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR(
    VkPhysicalDevice                            physicalDevice,
    const VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR* pQualityLevelInfo,
    VkVideoEncodeQualityLevelPropertiesKHR*     pQualityLevelProperties);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>physicalDevice</code> is the physical device to query the video encode
quality level properties for.</p>
</li>
<li>
<p><code>pQualityLevelInfo</code> is a pointer to a
<a href="#VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR">VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR</a> structure
specifying the video encode profile and quality level to query
properties for.</p>
</li>
<li>
<p><code>pQualityLevelProperties</code> is a pointer to a
<a href="#VkVideoEncodeQualityLevelPropertiesKHR">VkVideoEncodeQualityLevelPropertiesKHR</a> structure in which the
properties are returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-physicalDevice-parameter" href="#VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-physicalDevice-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-physicalDevice-parameter</span><br>
 <code>physicalDevice</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkPhysicalDevice" class="xref page">VkPhysicalDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-pQualityLevelInfo-parameter" href="#VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-pQualityLevelInfo-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-pQualityLevelInfo-parameter</span><br>
 <code>pQualityLevelInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR">VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-pQualityLevelProperties-parameter" href="#VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-pQualityLevelProperties-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-pQualityLevelProperties-parameter</span><br>
 <code>pQualityLevelProperties</code> <strong>must</strong> be a valid pointer to a <a href="#VkVideoEncodeQualityLevelPropertiesKHR">VkVideoEncodeQualityLevelPropertiesKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_OPERATION_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_FORMAT_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PICTURE_LAYOUT_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_CODEC_NOT_SUPPORTED_KHR</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR</code> structure is
defined as:</p>
</div>
<div id="VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef struct VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR {
    VkStructureType                 sType;
    const void*                     pNext;
    const VkVideoProfileInfoKHR*    pVideoProfile;
    uint32_t                        qualityLevel;
} VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pVideoProfile</code> is a pointer to a <a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>
structure specifying the video profile to query the video encode quality
level properties for.</p>
</li>
<li>
<p><code>qualityLevel</code> is the video encode quality level to query properties
for.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-sType-sType" href="#VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_PHYSICAL_DEVICE_VIDEO_ENCODE_QUALITY_LEVEL_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-pNext-pNext" href="#VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-pVideoProfile-parameter" href="#VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-pVideoProfile-parameter"></a> <span class="vuid">VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-pVideoProfile-parameter</span><br>
 <code>pVideoProfile</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeQualityLevelPropertiesKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeQualityLevelPropertiesKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef struct VkVideoEncodeQualityLevelPropertiesKHR {
    VkStructureType                            sType;
    void*                                      pNext;
    VkVideoEncodeRateControlModeFlagBitsKHR    preferredRateControlMode;
    uint32_t                                   preferredRateControlLayerCount;
} VkVideoEncodeQualityLevelPropertiesKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>preferredRateControlMode</code> is a
<a href="#VkVideoEncodeRateControlModeFlagBitsKHR">VkVideoEncodeRateControlModeFlagBitsKHR</a> value indicating the
preferred rate control mode to use with the video encode quality level.</p>
</li>
<li>
<p><code>preferredRateControlLayerCount</code> indicates the preferred number of
rate control layers to use with the quality level.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeQualityLevelPropertiesKHR-sType-sType" href="#VUID-VkVideoEncodeQualityLevelPropertiesKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeQualityLevelPropertiesKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_QUALITY_LEVEL_PROPERTIES_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeQualityLevelPropertiesKHR-pNext-pNext" href="#VUID-VkVideoEncodeQualityLevelPropertiesKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoEncodeQualityLevelPropertiesKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="#VkVideoEncodeH264QualityLevelPropertiesEXT">VkVideoEncodeH264QualityLevelPropertiesEXT</a> or <a href="#VkVideoEncodeH265QualityLevelPropertiesEXT">VkVideoEncodeH265QualityLevelPropertiesEXT</a></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeQualityLevelPropertiesKHR-sType-unique" href="#VUID-VkVideoEncodeQualityLevelPropertiesKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoEncodeQualityLevelPropertiesKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeQualityLevelInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeQualityLevelInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef struct VkVideoEncodeQualityLevelInfoKHR {
    VkStructureType    sType;
    const void*        pNext;
    uint32_t           qualityLevel;
} VkVideoEncodeQualityLevelInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>qualityLevel</code> is the used video encode quality level.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure <strong>can</strong> be specified in the following places:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <code>pNext</code> chain of <a href="#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a>
to specify the video encode quality level to use for a video session
parameters object created for a video encode session.
If no instance of this structure is included in the <code>pNext</code> chain of
<a href="#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a>, then the video session
parameters object is created with a video encode quality level of zero.</p>
</li>
<li>
<p>In the <code>pNext</code> chain of <a href="#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a> to change
the video encode quality level state of the bound video session.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeQualityLevelInfoKHR-sType-sType" href="#VUID-VkVideoEncodeQualityLevelInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeQualityLevelInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_QUALITY_LEVEL_INFO_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_retrieving_encoded_session_parameters"><a class="anchor" href="#_retrieving_encoded_session_parameters"></a>Retrieving Encoded Session Parameters</h3>
<div class="paragraph">
<p>Any codec-specific parameters stored in video session parameters objects
<strong>may</strong> need to be separately encoded and included in the final video bitstream
data, depending on the used video compression standard.
In such cases the application <strong>must</strong> call the
<a href="#vkGetEncodedVideoSessionParametersKHR">vkGetEncodedVideoSessionParametersKHR</a> command to retrieve the encoded
parameter data from the used video session parameters object in order to be
able to produce a compliant video bitstream.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Encoded parameter data <strong>can</strong> be retrieved from a video session parameters
object created with a video encode operation using the command:</p>
</div>
<div id="vkGetEncodedVideoSessionParametersKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
VkResult vkGetEncodedVideoSessionParametersKHR(
    VkDevice                                    device,
    const VkVideoEncodeSessionParametersGetInfoKHR* pVideoSessionParametersInfo,
    VkVideoEncodeSessionParametersFeedbackInfoKHR* pFeedbackInfo,
    size_t*                                     pDataSize,
    void*                                       pData);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the video session
parameters object.</p>
</li>
<li>
<p><code>pVideoSessionParametersInfo</code> is a pointer to a
<a href="#VkVideoEncodeSessionParametersGetInfoKHR">VkVideoEncodeSessionParametersGetInfoKHR</a> structure specifying the
parameters of the encoded parameter data to retrieve.</p>
</li>
<li>
<p><code>pFeedbackInfo</code> is either <code>NULL</code> or a pointer to a
<a href="#VkVideoEncodeSessionParametersFeedbackInfoKHR">VkVideoEncodeSessionParametersFeedbackInfoKHR</a> structure in which
feedback about the requested parameter data is returned.</p>
</li>
<li>
<p><code>pDataSize</code> is a pointer to a <code>size_t</code> value related to the
amount of encode parameter data returned, as described below.</p>
</li>
<li>
<p><code>pData</code> is either <code>NULL</code> or a pointer to a buffer to write the
encoded parameter data to.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>pData</code> is <code>NULL</code>, then the size of the encoded parameter data, in
bytes, that <strong>can</strong> be retrieved is returned in <code>pDataSize</code>.
Otherwise, <code>pDataSize</code> <strong>must</strong> point to a variable set by the application
to the size of the buffer, in bytes, pointed to by <code>pData</code>, and on
return the variable is overwritten with the number of bytes actually written
to <code>pData</code>.
If <code>pDataSize</code> is less than the size of the encoded parameter data that
<strong>can</strong> be retrieved, then no data will be written to <code>pData</code>, zero will be
written to <code>pDataSize</code>, and <code>VK_INCOMPLETE</code> will be returned instead
of <code>VK_SUCCESS</code>, to indicate that no encoded parameter data was
returned.</p>
</div>
<div class="paragraph">
<p>If <code>pFeedbackInfo</code> is not <code>NULL</code> then the members of the
<a href="#VkVideoEncodeSessionParametersFeedbackInfoKHR">VkVideoEncodeSessionParametersFeedbackInfoKHR</a> structure and any
additional structures included in its <code>pNext</code> chain that are applicable
to the video session parameters object specified in
<code>pVideoSessionParametersInfo</code>::<code>videoSessionParameters</code> will be
filled with feedback about the requested parameter data on all successful
calls to this command.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note:</div>
<div class="paragraph">
<p>This includes the cases when <code>pData</code> is <code>NULL</code> or when
<code>VK_INCOMPLETE</code> is returned by the command, and enables the application
to determine whether the implementation overrode any of the requested video
session parameters without actually needing to retrieve the encoded
parameter data itself.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetEncodedVideoSessionParametersKHR-device-parameter" href="#VUID-vkGetEncodedVideoSessionParametersKHR-device-parameter"></a> <span class="vuid">VUID-vkGetEncodedVideoSessionParametersKHR-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-parameter" href="#VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-parameter"></a> <span class="vuid">VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-parameter</span><br>
 <code>pVideoSessionParametersInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkVideoEncodeSessionParametersGetInfoKHR">VkVideoEncodeSessionParametersGetInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetEncodedVideoSessionParametersKHR-pFeedbackInfo-parameter" href="#VUID-vkGetEncodedVideoSessionParametersKHR-pFeedbackInfo-parameter"></a> <span class="vuid">VUID-vkGetEncodedVideoSessionParametersKHR-pFeedbackInfo-parameter</span><br>
 If <code>pFeedbackInfo</code> is not <code>NULL</code>, <code>pFeedbackInfo</code> <strong>must</strong> be a valid pointer to a <a href="#VkVideoEncodeSessionParametersFeedbackInfoKHR">VkVideoEncodeSessionParametersFeedbackInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetEncodedVideoSessionParametersKHR-pDataSize-parameter" href="#VUID-vkGetEncodedVideoSessionParametersKHR-pDataSize-parameter"></a> <span class="vuid">VUID-vkGetEncodedVideoSessionParametersKHR-pDataSize-parameter</span><br>
 <code>pDataSize</code> <strong>must</strong> be a valid pointer to a <code>size_t</code> value</p>
</li>
<li>
<p><a id="VUID-vkGetEncodedVideoSessionParametersKHR-pData-parameter" href="#VUID-vkGetEncodedVideoSessionParametersKHR-pData-parameter"></a> <span class="vuid">VUID-vkGetEncodedVideoSessionParametersKHR-pData-parameter</span><br>
 If the value referenced by <code>pDataSize</code> is not <code>0</code>, and <code>pData</code> is not <code>NULL</code>, <code>pData</code> <strong>must</strong> be a valid pointer to an array of <code>pDataSize</code> bytes</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_INCOMPLETE</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeSessionParametersGetInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeSessionParametersGetInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef struct VkVideoEncodeSessionParametersGetInfoKHR {
    VkStructureType                sType;
    const void*                    pNext;
    VkVideoSessionParametersKHR    videoSessionParameters;
} VkVideoEncodeSessionParametersGetInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>videoSessionParameters</code> is the <a href="#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a>
object to retrieve encoded parameter data from.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Depending on the used video encode operation, additional codec-specific
structures <strong>may</strong> need to be included in the <code>pNext</code> chain of this
structure to identify the specific video session parameters to retrieve
encoded parameter data for, as described in the corresponding sections.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeSessionParametersGetInfoKHR-sType-sType" href="#VUID-VkVideoEncodeSessionParametersGetInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeSessionParametersGetInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_SESSION_PARAMETERS_GET_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeSessionParametersGetInfoKHR-pNext-pNext" href="#VUID-VkVideoEncodeSessionParametersGetInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoEncodeSessionParametersGetInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="#VkVideoEncodeH264SessionParametersGetInfoEXT">VkVideoEncodeH264SessionParametersGetInfoEXT</a> or <a href="#VkVideoEncodeH265SessionParametersGetInfoEXT">VkVideoEncodeH265SessionParametersGetInfoEXT</a></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeSessionParametersGetInfoKHR-sType-unique" href="#VUID-VkVideoEncodeSessionParametersGetInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoEncodeSessionParametersGetInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeSessionParametersGetInfoKHR-videoSessionParameters-parameter" href="#VUID-VkVideoEncodeSessionParametersGetInfoKHR-videoSessionParameters-parameter"></a> <span class="vuid">VUID-VkVideoEncodeSessionParametersGetInfoKHR-videoSessionParameters-parameter</span><br>
 <code>videoSessionParameters</code> <strong>must</strong> be a valid <a href="#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeSessionParametersFeedbackInfoKHR</code> structure is defined
as:</p>
</div>
<div id="VkVideoEncodeSessionParametersFeedbackInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef struct VkVideoEncodeSessionParametersFeedbackInfoKHR {
    VkStructureType    sType;
    void*              pNext;
    VkBool32           hasOverrides;
} VkVideoEncodeSessionParametersFeedbackInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>hasOverrides</code> indicates whether any of the requested parameter data
were overridden by the implementation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Depending on the used video encode operation, additional codec-specific
structures <strong>may</strong> need to be included in the <code>pNext</code> chain of this
structure to capture feedback information about the requested parameter
data, as described in the corresponding sections.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeSessionParametersFeedbackInfoKHR-sType-sType" href="#VUID-VkVideoEncodeSessionParametersFeedbackInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeSessionParametersFeedbackInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_SESSION_PARAMETERS_FEEDBACK_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeSessionParametersFeedbackInfoKHR-pNext-pNext" href="#VUID-VkVideoEncodeSessionParametersFeedbackInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoEncodeSessionParametersFeedbackInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="#VkVideoEncodeH264SessionParametersFeedbackInfoEXT">VkVideoEncodeH264SessionParametersFeedbackInfoEXT</a> or <a href="#VkVideoEncodeH265SessionParametersFeedbackInfoEXT">VkVideoEncodeH265SessionParametersFeedbackInfoEXT</a></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeSessionParametersFeedbackInfoKHR-sType-unique" href="#VUID-VkVideoEncodeSessionParametersFeedbackInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoEncodeSessionParametersFeedbackInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_video_encode_commands"><a class="anchor" href="#_video_encode_commands"></a>Video Encode Commands</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To launch video encode operations, call:</p>
</div>
<div id="vkCmdEncodeVideoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
void vkCmdEncodeVideoKHR(
    VkCommandBuffer                             commandBuffer,
    const VkVideoEncodeInfoKHR*                 pEncodeInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer to be filled with this
function for encoding to generate a bitstream.</p>
</li>
<li>
<p><code>pEncodeInfo</code> is a pointer to a <a href="#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>
structure.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each call issues one or more video encode operations.
The implicit parameter <code>opCount</code> corresponds to the number of video
encode operations issued by the command.
After calling this command, the
<a href="queries.html#queries-operation-active-query-index" class="xref page">active query index</a> of each
<a href="queries.html#queries-operation-active" class="xref page">active</a> query is incremented by <code>opCount</code>.</p>
</div>
<div class="paragraph">
<p>Currently each call to this command results in the issue of a single video
encode operation.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-opCount-07174" href="#VUID-vkCmdEncodeVideoKHR-opCount-07174"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-opCount-07174</span><br>

For each <a href="queries.html#queries-operation-active" class="xref page">active</a> query, the
<a href="queries.html#queries-operation-active-query-index" class="xref page">active query index</a>
corresponding to the query type of that query plus <code>opCount</code> <strong>must</strong>
be less than or equal to the
<a href="queries.html#queries-operation-last-activatable-query-index" class="xref page">last activatable query    index</a> corresponding to the query type of that query plus one</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-commandBuffer-parameter" href="#VUID-vkCmdEncodeVideoKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pEncodeInfo-parameter" href="#VUID-vkCmdEncodeVideoKHR-pEncodeInfo-parameter"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pEncodeInfo-parameter</span><br>
 <code>pEncodeInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-commandBuffer-recording" href="#VUID-vkCmdEncodeVideoKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-commandBuffer-cmdpool" href="#VUID-vkCmdEncodeVideoKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-renderpass" href="#VUID-vkCmdEncodeVideoKHR-renderpass"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-renderpass</span><br>
 This command <strong>must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-videocoding" href="#VUID-vkCmdEncodeVideoKHR-videocoding"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-videocoding</span><br>
 This command <strong>must</strong> only be called inside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-bufferlevel" href="#VUID-vkCmdEncodeVideoKHR-bufferlevel"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-bufferlevel</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a primary <code>VkCommandBuffer</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef struct VkVideoEncodeInfoKHR {
    VkStructureType                       sType;
    const void*                           pNext;
    VkVideoEncodeFlagsKHR                 flags;
    VkBuffer                              dstBuffer;
    VkDeviceSize                          dstBufferOffset;
    VkDeviceSize                          dstBufferRange;
    VkVideoPictureResourceInfoKHR         srcPictureResource;
    const VkVideoReferenceSlotInfoKHR*    pSetupReferenceSlot;
    uint32_t                              referenceSlotCount;
    const VkVideoReferenceSlotInfoKHR*    pReferenceSlots;
    uint32_t                              precedingExternallyEncodedBytes;
} VkVideoEncodeInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is a pointer to a structure extending this structure.
A codec-specific extension structure <strong>must</strong> be chained to specify what
bitstream unit to generate with this encode operation.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>dstBuffer</code> is the destination video bitstream buffer to write the
encoded bitstream to.</p>
</li>
<li>
<p><code>dstBufferOffset</code> is the starting offset in bytes from the start of
<code>dstBuffer</code> to write the encoded bitstream to.
<code>dstBufferOffset</code>&#8217;s value <strong>must</strong> be aligned to
<a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>minBitstreamBufferOffsetAlignment</code>,
as reported by the implementation.</p>
</li>
<li>
<p><code>dstBufferRange</code> is the maximum size in bytes of the encoded
bitstream written to <code>dstBuffer</code>, starting from
<code>dstBufferOffset</code>.
<code>dstBufferRange</code>&#8217;s value <strong>must</strong> be aligned to
<a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>minBitstreamBufferSizeAlignment</code>, as
reported by the implementation.</p>
</li>
<li>
<p><code>srcPictureResource</code> is the Picture Resource of the
<a href="#encode-input-picture">Input Picture</a> to be encoded by the operation.</p>
</li>
<li>
<p><code>pSetupReferenceSlot</code> is a pointer to a
<a href="#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structure used for generating a
reconstructed reference slot and Picture Resource.
<code>pSetupReferenceSlot-&gt;slotIndex</code> specifies the slot index number to
use as a target for producing the Reconstructed (DPB) data.
<code>pSetupReferenceSlot</code> <strong>must</strong> be one of the entries provided in
<a href="#VkVideoBeginCodingInfoKHR">VkVideoBeginCodingInfoKHR</a> via the <code>pReferenceSlots</code> within the
<a href="#vkCmdBeginVideoCodingKHR">vkCmdBeginVideoCodingKHR</a> command that established the Vulkan Video
Encode Context for this command.</p>
</li>
<li>
<p><code>referenceSlotCount</code> is the number of Reconstructed Reference
Pictures that will be used when this encoding operation is executing.</p>
</li>
<li>
<p><code>pReferenceSlots</code> is <code>NULL</code> or a pointer to an array of
<a href="#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structures that will be used when this
encoding operation is executing.
Each entry in <code>pReferenceSlots</code> <strong>must</strong> be one of the entries provided
in <a href="#VkVideoBeginCodingInfoKHR">VkVideoBeginCodingInfoKHR</a> via the <code>pReferenceSlots</code> within
the <a href="#vkCmdBeginVideoCodingKHR">vkCmdBeginVideoCodingKHR</a> command that established the Vulkan
Video Encode Context for this command.</p>
</li>
<li>
<p><code>precedingExternallyEncodedBytes</code> is the number of bytes externally
encoded for insertion in the active video encode session overall
bitstream prior to the bitstream that will be generated by the
implementation for this instance of <code>VkVideoEncodeInfoKHR</code>.
The value provided is used to update the implementation&#8217;s rate control
algorithm for the rate control layer this instance of
<code>VkVideoEncodeInfoKHR</code> belongs to, by accounting for the bitrate
budget consumed by these externally encoded bytes.
See <a href="#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a> for additional information
about encode rate control.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The coded size of the encode operation is specified in <code>codedExtent</code> of
<code>srcPictureResource</code>.</p>
</div>
<div class="paragraph">
<p>Multiple <a href="#vkCmdEncodeVideoKHR">vkCmdEncodeVideoKHR</a> commands <strong>may</strong> be recorded within a Vulkan
Video Encode Context.
The execution of each <a href="#vkCmdEncodeVideoKHR">vkCmdEncodeVideoKHR</a> command will result in
generating codec-specific bitstream units.
These bitstream units are generated consecutively into the bitstream buffer
specified in <code>dstBuffer</code> of a <code>VkVideoEncodeInfoKHR</code> structure
within the <a href="#vkCmdBeginVideoCodingKHR">vkCmdBeginVideoCodingKHR</a> command.
The produced bitstream is the sum of all these bitstream units, including
any padding between the bitstream units.
Any bitstream padding <strong>must</strong> be filled with data compliant to the codec
standard so as not to cause any syntax errors during decoding of the
bitstream units with the padding included.
The range of the bitstream buffer written <strong>can</strong> be queried via
<a href="queries.html#queries-video-encode-feedback" class="xref page">video encode feedback queries</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-None-07012" href="#VUID-VkVideoEncodeInfoKHR-None-07012"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-None-07012</span><br>

The bound video session <strong>must</strong> not be in <a href="#video-session-uninitialized">    uninitialized</a> state at the time the command is executed on the device</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-sType-sType" href="#VUID-VkVideoEncodeInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-pNext-pNext" href="#VUID-VkVideoEncodeInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="#VkVideoEncodeH264PictureInfoEXT">VkVideoEncodeH264PictureInfoEXT</a> or <a href="#VkVideoEncodeH265PictureInfoEXT">VkVideoEncodeH265PictureInfoEXT</a></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-sType-unique" href="#VUID-VkVideoEncodeInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-flags-zerobitmask" href="#VUID-VkVideoEncodeInfoKHR-flags-zerobitmask"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-flags-zerobitmask</span><br>
 <code>flags</code> <strong>must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-dstBuffer-parameter" href="#VUID-VkVideoEncodeInfoKHR-dstBuffer-parameter"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-dstBuffer-parameter</span><br>
 <code>dstBuffer</code> <strong>must</strong> be a valid <a href="resources.html#VkBuffer" class="xref page">VkBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-srcPictureResource-parameter" href="#VUID-VkVideoEncodeInfoKHR-srcPictureResource-parameter"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-srcPictureResource-parameter</span><br>
 <code>srcPictureResource</code> <strong>must</strong> be a valid <a href="#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-pSetupReferenceSlot-parameter" href="#VUID-VkVideoEncodeInfoKHR-pSetupReferenceSlot-parameter"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-pSetupReferenceSlot-parameter</span><br>
 If <code>pSetupReferenceSlot</code> is not <code>NULL</code>, <code>pSetupReferenceSlot</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-pReferenceSlots-parameter" href="#VUID-VkVideoEncodeInfoKHR-pReferenceSlots-parameter"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-pReferenceSlots-parameter</span><br>
 If <code>referenceSlotCount</code> is not <code>0</code>, <code>pReferenceSlots</code> <strong>must</strong> be a valid pointer to an array of <code>referenceSlotCount</code> valid <a href="#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structures</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef VkFlags VkVideoEncodeFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#VkVideoEncodeFlagsKHR">VkVideoEncodeFlagsKHR</a> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeRateControlInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeRateControlInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef struct VkVideoEncodeRateControlInfoKHR {
    VkStructureType                                sType;
    const void*                                    pNext;
    VkVideoEncodeRateControlFlagsKHR               flags;
    VkVideoEncodeRateControlModeFlagBitsKHR        rateControlMode;
    uint32_t                                       layerCount;
    const VkVideoEncodeRateControlLayerInfoKHR*    pLayers;
    uint32_t                                       virtualBufferSizeInMs;
    uint32_t                                       initialVirtualBufferSizeInMs;
} VkVideoEncodeRateControlInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>rateControlMode</code> is a <a href="#VkVideoEncodeRateControlModeFlagBitsKHR">VkVideoEncodeRateControlModeFlagBitsKHR</a>
value specifying the encode stream rate control mode.</p>
</li>
<li>
<p><code>layerCount</code> specifies the number of rate control layers in the
video encode stream.</p>
</li>
<li>
<p><code>pLayers</code> is a pointer to an array of
<a href="#VkVideoEncodeRateControlLayerInfoKHR">VkVideoEncodeRateControlLayerInfoKHR</a> structures specifying the
rate control configurations of <code>layerCount</code> rate control layers.</p>
</li>
<li>
<p><code>virtualBufferSizeInMs</code> is the leaky bucket model virtual buffer
size in milliseconds, with respect to peak bitrate.
Valid when rate control mode is
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_CBR_BIT_KHR</code> or
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_VBR_BIT_KHR</code>.
For example, virtual buffer size is (<code>virtualBufferSizeInMs</code> Ã—
<code>maxBitrate</code> / 1000).</p>
</li>
<li>
<p><code>initialVirtualBufferSizeInMs</code> is the initial occupancy in
milliseconds of the virtual buffer in the leaky bucket model.
Valid when rate control mode is
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_CBR_BIT_KHR</code> or
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_VBR_BIT_KHR</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Including this structure in the <code>pNext</code> chain of
<a href="#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a> and including
<code>VK_VIDEO_CODING_CONTROL_ENCODE_RATE_CONTROL_BIT_KHR</code> in
<a href="#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a>::<code>flags</code> will define stream rate
control settings for video encoding.</p>
</div>
<div class="paragraph">
<p>Additional structures providing codec-specific rate control parameters <strong>may</strong>
need to be included in the <code>pNext</code> chain of
<code>VkVideoCodingControlInfoKHR</code> depending on the codec profile the bound
video session was created with and the parameters specified in
<code>VkVideoEncodeRateControlInfoKHR</code> (see <a href="#video-coding-control">Video Coding Control</a>).</p>
</div>
<div class="paragraph">
<p>To ensure that the video session is properly initialized with stream-level
rate control settings, the application <strong>must</strong> call
<a href="#vkCmdControlVideoCodingKHR">vkCmdControlVideoCodingKHR</a> with stream-level rate control settings at
least once in execution order before the first <a href="#vkCmdEncodeVideoKHR">vkCmdEncodeVideoKHR</a>
command that is executed after video session reset.
If not provided, default implementation-specific stream rate control
settings will be used.</p>
</div>
<div class="paragraph">
<p>Stream rate control settings <strong>can</strong> also be re-initialized during an active
video encoding session.
The re-initialization takes effect whenever the
<code>VkVideoEncodeRateControlInfoKHR</code> structure is included in the
<code>pNext</code> chain of the <a href="#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a> structure in the
call to <a href="#vkCmdControlVideoCodingKHR">vkCmdControlVideoCodingKHR</a>, and only impacts
<a href="#vkCmdEncodeVideoKHR">vkCmdEncodeVideoKHR</a> operations that follow in execution order.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeRateControlInfoKHR-sType-sType" href="#VUID-VkVideoEncodeRateControlInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeRateControlInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_RATE_CONTROL_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlInfoKHR-flags-zerobitmask" href="#VUID-VkVideoEncodeRateControlInfoKHR-flags-zerobitmask"></a> <span class="vuid">VUID-VkVideoEncodeRateControlInfoKHR-flags-zerobitmask</span><br>
 <code>flags</code> <strong>must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-parameter" href="#VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-parameter"></a> <span class="vuid">VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-parameter</span><br>
 If <code>rateControlMode</code> is not <code>0</code>, <code>rateControlMode</code> <strong>must</strong> be a valid <a href="#VkVideoEncodeRateControlModeFlagBitsKHR">VkVideoEncodeRateControlModeFlagBitsKHR</a> value</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlInfoKHR-pLayers-parameter" href="#VUID-VkVideoEncodeRateControlInfoKHR-pLayers-parameter"></a> <span class="vuid">VUID-VkVideoEncodeRateControlInfoKHR-pLayers-parameter</span><br>
 If <code>layerCount</code> is not <code>0</code>, <code>pLayers</code> <strong>must</strong> be a valid pointer to an array of <code>layerCount</code> valid <a href="#VkVideoEncodeRateControlLayerInfoKHR">VkVideoEncodeRateControlLayerInfoKHR</a> structures</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeRateControlFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef VkFlags VkVideoEncodeRateControlFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeRateControlFlagsKHR</code> is a bitmask type for setting a mask,
but currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The rate control modes are defined with the following enums:</p>
</div>
<div id="VkVideoEncodeRateControlModeFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef enum VkVideoEncodeRateControlModeFlagBitsKHR {
    VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DEFAULT_KHR = 0,
    VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR = 0x00000001,
    VK_VIDEO_ENCODE_RATE_CONTROL_MODE_CBR_BIT_KHR = 0x00000002,
    VK_VIDEO_ENCODE_RATE_CONTROL_MODE_VBR_BIT_KHR = 0x00000004,
} VkVideoEncodeRateControlModeFlagBitsKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DEFAULT_KHR</code> specifies the use of
implementation-specific rate control.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR</code> specifies that
rate control is disabled and any quality control parameters for the
encoding are provided on a per-picture basis.
In this mode implementations will encode pictures independently of the
output bitrate of prior video encode operations.
When using an H.264 encode profile, implementations will use the QP
values specified in the <a href="#VkVideoEncodeH264RateControlInfoEXT">VkVideoEncodeH264RateControlInfoEXT</a>
structure for the encoded picture.
When using an H.265 encode profile, implementations will use the QP
values specified in the <a href="#VkVideoEncodeH265RateControlInfoEXT">VkVideoEncodeH265RateControlInfoEXT</a>
structure for the encoded picture.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_CBR_BIT_KHR</code> specifies the use of
constant bitrate rate control mode.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_VBR_BIT_KHR</code> specifies the use of
variable bitrate rate control mode.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeRateControlModeFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef VkFlags VkVideoEncodeRateControlModeFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeRateControlModeFlagsKHR</code> is a bitmask type for setting a
mask of zero or more <a href="#VkVideoEncodeRateControlModeFlagBitsKHR">VkVideoEncodeRateControlModeFlagBitsKHR</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeRateControlLayerInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeRateControlLayerInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef struct VkVideoEncodeRateControlLayerInfoKHR {
    VkStructureType    sType;
    const void*        pNext;
    uint64_t           averageBitrate;
    uint64_t           maxBitrate;
    uint32_t           frameRateNumerator;
    uint32_t           frameRateDenominator;
} VkVideoEncodeRateControlLayerInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is a pointer to a structure extending this structure.</p>
</li>
<li>
<p><code>averageBitrate</code> is the average bitrate in bits/second.
Valid when rate control mode is
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_CBR_BIT_KHR</code> or
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_VBR_BIT_KHR</code>.</p>
</li>
<li>
<p><code>maxBitrate</code> is the peak bitrate in bits/second.
Valid when rate control mode is
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_VBR_BIT_KHR</code>.</p>
</li>
<li>
<p><code>frameRateNumerator</code> is the numerator of the frame rate.
Valid when rate control mode is
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_CBR_BIT_KHR</code> or
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_VBR_BIT_KHR</code>.</p>
</li>
<li>
<p><code>frameRateDenominator</code> is the denominator of the frame rate.
Valid when rate control mode is
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_CBR_BIT_KHR</code> or
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_VBR_BIT_KHR</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A codec-specific structure specifying additional per-layer rate control
settings <strong>must</strong> be chained to <code>VkVideoEncodeRateControlLayerInfoKHR</code>.
If multiple rate control layers are enabled
(<a href="#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a>::<code>layerCount</code> is greater than 1),
then the chained codec-specific extension structure also identifies the
specific video coding layer its parent
<code>VkVideoEncodeRateControlLayerInfoKHR</code> applies to.
If multiple rate control layers are enabled, the number of rate control
layers <strong>must</strong> match the number of video coding layers.
The specification for an encode codec-specific extension would describe how
multiple video coding layers are enabled for the corresponding codec.</p>
</div>
<div class="paragraph">
<p>Per-layer rate control settings for all enabled rate control layers <strong>must</strong> be
initialized or re-initialized whenever stream rate control settings are
provided via <a href="#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a>.
This is done by specifying settings for all enabled rate control layers in
<a href="#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a>::<code>pLayers</code>.</p>
</div>
<div class="paragraph">
<p>It is possible for an application to enable multiple video coding layers
(via codec-specific extensions to encoding operations) while only enabling a
single layer of rate control for the entire video stream.
To achieve this, <code>layerCount</code> in <a href="#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a>
<strong>must</strong> be set to 1, and the single <code>VkVideoEncodeRateControlLayerInfoKHR</code>
provided in <code>pLayers</code> would apply to all encoded segments of the video
stream, regardless of which codec-defined video coding layer they belong to.
In this case, the implementation decides bitrate distribution across video
coding layers (if applicable to the specified stream rate control mode).</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeRateControlLayerInfoKHR-sType-sType" href="#VUID-VkVideoEncodeRateControlLayerInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeRateControlLayerInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_RATE_CONTROL_LAYER_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlLayerInfoKHR-pNext-pNext" href="#VUID-VkVideoEncodeRateControlLayerInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoEncodeRateControlLayerInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="#VkVideoEncodeH264RateControlLayerInfoEXT">VkVideoEncodeH264RateControlLayerInfoEXT</a> or <a href="#VkVideoEncodeH265RateControlLayerInfoEXT">VkVideoEncodeH265RateControlLayerInfoEXT</a></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlLayerInfoKHR-sType-unique" href="#VUID-VkVideoEncodeRateControlLayerInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoEncodeRateControlLayerInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="encode-h264"><a class="anchor" href="#encode-h264"></a>Encode H.264</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code><a href="../appendices/extensions.html#VK_EXT_video_encode_h264" class="xref page">VK_EXT_video_encode_h264</a></code> extension adds H.264 codec specific
structures/types needed to support H.264 encoding.
Unless otherwise noted, all references to the H.264 specification are to the
2010 edition published by the ITU-T, dated March 2010.
This specification is available at <a href="https://www.itu.int/rec/T-REC-H.264" class="bare">https://www.itu.int/rec/T-REC-H.264</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Refer to the <a href="preamble.html#preamble" class="xref page">Preamble</a> for information on how the Khronos
Intellectual Property Rights Policy relates to normative references to
external materials not created by Khronos.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_h_264_encode_profile"><a class="anchor" href="#_h_264_encode_profile"></a>H.264 encode profile</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH264ProfileInfoEXT</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH264ProfileInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef struct VkVideoEncodeH264ProfileInfoEXT {
    VkStructureType           sType;
    const void*               pNext;
    StdVideoH264ProfileIdc    stdProfileIdc;
} VkVideoEncodeH264ProfileInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>stdProfileIdc</code> is a <code>StdVideoH264ProfileIdc</code> value specifying
the H.264 codec profile IDC.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An H.264 encode profile is specified by including a
<code>VkVideoEncodeH264ProfileInfoEXT</code> structure in the <code>pNext</code> chain of
the <a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure when
<a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>::<code>videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_EXT</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264ProfileInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH264ProfileInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264ProfileInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_PROFILE_INFO_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_capabilities_3"><a class="anchor" href="#_capabilities_3"></a>Capabilities</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When calling <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> with
<code>pVideoProfile-&gt;videoCodecOperation</code> specified as
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_EXT</code>, the
<a href="#VkVideoEncodeH264CapabilitiesEXT">VkVideoEncodeH264CapabilitiesEXT</a> structure <strong>must</strong> be included in the
<code>pNext</code> chain of the <a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a> structure to retrieve
more capabilities specific to H.264 video encoding.</p>
</div>
<div class="paragraph">
<p>The <a href="#VkVideoEncodeH264CapabilitiesEXT">VkVideoEncodeH264CapabilitiesEXT</a> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH264CapabilitiesEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef struct VkVideoEncodeH264CapabilitiesEXT {
    VkStructureType                        sType;
    void*                                  pNext;
    VkVideoEncodeH264CapabilityFlagsEXT    flags;
    StdVideoH264LevelIdc                   maxLevelIdc;
    uint32_t                               maxSliceCount;
    uint32_t                               maxPPictureL0ReferenceCount;
    uint32_t                               maxBPictureL0ReferenceCount;
    uint32_t                               maxL1ReferenceCount;
    uint32_t                               maxTemporalLayerCount;
    VkBool32                               expectDyadicTemporalLayerPattern;
    int32_t                                minQp;
    int32_t                                maxQp;
    VkBool32                               prefersGopRemainingFrames;
    VkBool32                               requiresGopRemainingFrames;
    VkVideoEncodeH264StdFlagsEXT           stdSyntaxFlags;
} VkVideoEncodeH264CapabilitiesEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkVideoEncodeH264CapabilityFlagBitsEXT">VkVideoEncodeH264CapabilityFlagBitsEXT</a>
indicating supported H.264 encoding capabilities.</p>
</li>
<li>
<p><code>maxLevelIdc</code> is a <code>StdVideoH264LevelIdc</code> value indicating the
maximum H.264 level supported.</p>
</li>
<li>
<p><code>maxSliceCount</code> indicates the maximum number of slices that <strong>can</strong> be
encoded for a single picture.
Further restrictions <strong>may</strong> apply to the number of slices that <strong>can</strong> be
encoded for a single picture depending on other capabilities and
codec-specific rules.</p>
</li>
<li>
<p><code>maxPPictureL0ReferenceCount</code> indicates the maximum number of
reference pictures the implementation supports in the reference list L0
for P pictures.</p>
</li>
<li>
<p><code>maxBPictureL0ReferenceCount</code> indicates the maximum number of
reference pictures the implementation supports in the reference list L0
for B pictures.
The reported value is <code>0</code> if encoding of B pictures is not supported.</p>
</li>
<li>
<p><code>maxL1ReferenceCount</code> reports the maximum number of reference
pictures the implementation supports in the reference list L1 if
encoding of B pictures is supported.
The reported value is <code>0</code> if encoding of B pictures is not supported.</p>
</li>
<li>
<p><code>maxTemporalLayerCount</code> indicates the maximum number of H.264
temporal layers supported by the implementation.</p>
</li>
<li>
<p><code>expectDyadicTemporalLayerPattern</code> indicates that the
implementation&#8217;s rate control algorithms expect the application to use a
dyadic temporal layer pattern when encoding multiple temporal layers.</p>
</li>
<li>
<p><code>minQp</code> indicates the minimum QP value supported.</p>
</li>
<li>
<p><code>maxQp</code> indicates the maximum QP value supported.</p>
</li>
<li>
<p><code>prefersGopRemainingFrames</code> indicates that the implementation&#8217;s rate
control algorithm prefers the application to specify the number of
frames of each type remaining in the current group of pictures.</p>
</li>
<li>
<p><code>requiresGopRemainingFrames</code> indicates that the implementation&#8217;s
rate control algorithm requires the application to specify the number of
frames of each type remaining in the current group of pictures.</p>
</li>
<li>
<p><code>stdSyntaxFlags</code> is a bitmask of
<a href="#VkVideoEncodeH264StdFlagBitsEXT">VkVideoEncodeH264StdFlagBitsEXT</a> indicating capabilities related to
H.264 syntax elements.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> is called to query the
capabilities with parameter <code>videoCodecOperation</code> specified as
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_EXT</code>, a
<code>VkVideoEncodeH264CapabilitiesEXT</code> structure <strong>can</strong> be chained to
<a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a> to retrieve H.264 extension specific
capabilities.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264CapabilitiesEXT-sType-sType" href="#VUID-VkVideoEncodeH264CapabilitiesEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264CapabilitiesEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_CAPABILITIES_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>may</strong> be set in
<a href="#VkVideoEncodeH264CapabilitiesEXT">VkVideoEncodeH264CapabilitiesEXT</a>::<code>flags</code>, indicating the
supported H.264 encoding capabilities, are:</p>
</div>
<div id="VkVideoEncodeH264CapabilityFlagBitsEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef enum VkVideoEncodeH264CapabilityFlagBitsEXT {
    VK_VIDEO_ENCODE_H264_CAPABILITY_HRD_COMPLIANCE_BIT_EXT = 0x00000001,
    VK_VIDEO_ENCODE_H264_CAPABILITY_PREDICTION_WEIGHT_TABLE_GENERATED_BIT_EXT = 0x00000002,
    VK_VIDEO_ENCODE_H264_CAPABILITY_ROW_UNALIGNED_SLICE_BIT_EXT = 0x00000004,
    VK_VIDEO_ENCODE_H264_CAPABILITY_DIFFERENT_SLICE_TYPE_BIT_EXT = 0x00000008,
    VK_VIDEO_ENCODE_H264_CAPABILITY_B_FRAME_IN_L0_LIST_BIT_EXT = 0x00000010,
    VK_VIDEO_ENCODE_H264_CAPABILITY_B_FRAME_IN_L1_LIST_BIT_EXT = 0x00000020,
    VK_VIDEO_ENCODE_H264_CAPABILITY_PER_PICTURE_TYPE_MIN_MAX_QP_BIT_EXT = 0x00000040,
    VK_VIDEO_ENCODE_H264_CAPABILITY_PER_SLICE_CONSTANT_QP_BIT_EXT = 0x00000080,
    VK_VIDEO_ENCODE_H264_CAPABILITY_GENERATE_PREFIX_NALU_BIT_EXT = 0x00000100,
} VkVideoEncodeH264CapabilityFlagBitsEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_H264_CAPABILITY_HRD_COMPLIANCE_BIT_EXT</code> indicates
if the implementation guarantees generating a HRD compliant bitstream if
<code>nal_hrd_parameters_present_flag</code> or
<code>vcl_hrd_parameters_present_flag</code> are enabled in
<code>StdVideoH264SpsVuiFlags</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_CAPABILITY_PREDICTION_WEIGHT_TABLE_GENERATED_BIT_EXT</code>
indicates that when <code>weighted_pred_flag</code> is enabled or
<code>STD_VIDEO_H264_WEIGHTED_BIPRED_IDC_EXPLICIT</code> from
<code>StdVideoH264WeightedBipredIdc</code> is used, the implementation is able
to internally decide syntax for <code>pred_weight_table</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_CAPABILITY_ROW_UNALIGNED_SLICE_BIT_EXT</code>
indicates that each slice in a frame with multiple slices may begin or
finish at any offset in a macroblock row.
If not supported, all slices in the frame <strong>must</strong> begin at the start of a
macroblock row (and hence each slice <strong>must</strong> finish at the end of a
macroblock row).</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_CAPABILITY_DIFFERENT_SLICE_TYPE_BIT_EXT</code>
indicates that when a frame is encoded with multiple slices, the
implementation allows encoding each slice with a different
<code>StdVideoEncodeH264SliceHeader</code>::<code>slice_type</code>.
If not supported, all slices of the frame <strong>must</strong> be encoded with the same
<code>slice_type</code> which corresponds to the picture type of the frame.
For example, all slices of a P-frame would be encoded as P-slices.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_CAPABILITY_B_FRAME_IN_L0_LIST_BIT_EXT</code>
indicates support for using a B frame as L0 reference.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_CAPABILITY_B_FRAME_IN_L1_LIST_BIT_EXT</code>
indicates support for using a B frame as L1 reference.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_CAPABILITY_PER_PICTURE_TYPE_MIN_MAX_QP_BIT_EXT</code>
indicates support for specifying different QP values in the members of
<a href="#VkVideoEncodeH264QpEXT">VkVideoEncodeH264QpEXT</a>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_CAPABILITY_PER_SLICE_CONSTANT_QP_BIT_EXT</code>
indicates support for specifying different constant QP values for each
slice.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_CAPABILITY_GENERATE_PREFIX_NALU_BIT_EXT</code>
indicates support for generating prefix NALUs by setting
<a href="#VkVideoEncodeH264PictureInfoEXT">VkVideoEncodeH264PictureInfoEXT</a>::<code>generatePrefixNalu</code> to
<code>VK_TRUE</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeH264CapabilityFlagsEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef VkFlags VkVideoEncodeH264CapabilityFlagsEXT;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeH264CapabilityFlagsEXT</code> is a bitmask type for setting a
mask of zero or more <a href="#VkVideoEncodeH264CapabilityFlagBitsEXT">VkVideoEncodeH264CapabilityFlagBitsEXT</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>may</strong> be set in
<a href="#VkVideoEncodeH264CapabilitiesEXT">VkVideoEncodeH264CapabilitiesEXT</a>::<code>stdSyntaxFlags</code>, indicating the
capabilities related to the H.264 syntax elements, are:</p>
</div>
<div id="VkVideoEncodeH264StdFlagBitsEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef enum VkVideoEncodeH264StdFlagBitsEXT {
    VK_VIDEO_ENCODE_H264_STD_SEPARATE_COLOR_PLANE_FLAG_SET_BIT_EXT = 0x00000001,
    VK_VIDEO_ENCODE_H264_STD_QPPRIME_Y_ZERO_TRANSFORM_BYPASS_FLAG_SET_BIT_EXT = 0x00000002,
    VK_VIDEO_ENCODE_H264_STD_SCALING_MATRIX_PRESENT_FLAG_SET_BIT_EXT = 0x00000004,
    VK_VIDEO_ENCODE_H264_STD_CHROMA_QP_INDEX_OFFSET_BIT_EXT = 0x00000008,
    VK_VIDEO_ENCODE_H264_STD_SECOND_CHROMA_QP_INDEX_OFFSET_BIT_EXT = 0x00000010,
    VK_VIDEO_ENCODE_H264_STD_PIC_INIT_QP_MINUS26_BIT_EXT = 0x00000020,
    VK_VIDEO_ENCODE_H264_STD_WEIGHTED_PRED_FLAG_SET_BIT_EXT = 0x00000040,
    VK_VIDEO_ENCODE_H264_STD_WEIGHTED_BIPRED_IDC_EXPLICIT_BIT_EXT = 0x00000080,
    VK_VIDEO_ENCODE_H264_STD_WEIGHTED_BIPRED_IDC_IMPLICIT_BIT_EXT = 0x00000100,
    VK_VIDEO_ENCODE_H264_STD_TRANSFORM_8X8_MODE_FLAG_SET_BIT_EXT = 0x00000200,
    VK_VIDEO_ENCODE_H264_STD_DIRECT_SPATIAL_MV_PRED_FLAG_UNSET_BIT_EXT = 0x00000400,
    VK_VIDEO_ENCODE_H264_STD_ENTROPY_CODING_MODE_FLAG_UNSET_BIT_EXT = 0x00000800,
    VK_VIDEO_ENCODE_H264_STD_ENTROPY_CODING_MODE_FLAG_SET_BIT_EXT = 0x00001000,
    VK_VIDEO_ENCODE_H264_STD_DIRECT_8X8_INFERENCE_FLAG_UNSET_BIT_EXT = 0x00002000,
    VK_VIDEO_ENCODE_H264_STD_CONSTRAINED_INTRA_PRED_FLAG_SET_BIT_EXT = 0x00004000,
    VK_VIDEO_ENCODE_H264_STD_DEBLOCKING_FILTER_DISABLED_BIT_EXT = 0x00008000,
    VK_VIDEO_ENCODE_H264_STD_DEBLOCKING_FILTER_ENABLED_BIT_EXT = 0x00010000,
    VK_VIDEO_ENCODE_H264_STD_DEBLOCKING_FILTER_PARTIAL_BIT_EXT = 0x00020000,
    VK_VIDEO_ENCODE_H264_STD_SLICE_QP_DELTA_BIT_EXT = 0x00080000,
    VK_VIDEO_ENCODE_H264_STD_DIFFERENT_SLICE_QP_DELTA_BIT_EXT = 0x00100000,
} VkVideoEncodeH264StdFlagBitsEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_SEPARATE_COLOR_PLANE_FLAG_SET_BIT_EXT</code>
indicates if enabling <code>separate_colour_plane_flag</code> in
<code>StdVideoH264SpsFlags</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_QPPRIME_Y_ZERO_TRANSFORM_BYPASS_FLAG_SET_BIT_EXT</code>
indicates if enabling <code>qpprime_y_zero_transform_bypass_flag</code> in
<code>StdVideoH264SpsFlags</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_SCALING_MATRIX_PRESENT_FLAG_SET_BIT_EXT</code>
indicates if enabling <code>seq_scaling_matrix_present_flag</code> in
<code>StdVideoH264SpsFlags</code> or <code>pic_scaling_matrix_present_flag</code> in
<code>StdVideoH264PpsFlags</code> are supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_CHROMA_QP_INDEX_OFFSET_BIT_EXT</code> indicates
if setting non-zero <code>chroma_qp_index_offset</code> in
<code>StdVideoH264PictureParameterSet</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_SECOND_CHROMA_QP_INDEX_OFFSET_BIT_EXT</code>
indicates if setting non-zero <code>second_chroma_qp_index_offset</code> in
<code>StdVideoH264PictureParameterSet</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_PIC_INIT_QP_MINUS26_BIT_EXT</code> indicates if
setting non-zero <code>pic_init_qp_minus26</code> in
<code>StdVideoH264PictureParameterSet</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_WEIGHTED_PRED_FLAG_SET_BIT_EXT</code> indicates
if enabling <code>weighted_pred_flag</code> in <code>StdVideoH264PpsFlags</code> is
supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_WEIGHTED_BIPRED_IDC_EXPLICIT_BIT_EXT</code>
indicates if using <code>STD_VIDEO_H264_WEIGHTED_BIPRED_IDC_EXPLICIT</code> from
<code>StdVideoH264WeightedBipredIdc</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_WEIGHTED_BIPRED_IDC_IMPLICIT_BIT_EXT</code>
indicates if using <code>STD_VIDEO_H264_WEIGHTED_BIPRED_IDC_IMPLICIT</code> from
<code>StdVideoH264WeightedBipredIdc</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_TRANSFORM_8X8_MODE_FLAG_SET_BIT_EXT</code>
indicates if enabling <code>transform_8x8_mode_flag</code> in
<code>StdVideoH264PpsFlags</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_DIRECT_SPATIAL_MV_PRED_FLAG_UNSET_BIT_EXT</code>
indicates if disabling
<code>StdVideoEncodeH264SliceHeaderFlags</code>::<code>direct_spatial_mv_pred_flag</code>
is supported when it is present in the slice header.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_ENTROPY_CODING_MODE_FLAG_UNSET_BIT_EXT</code>
indicates if CAVLC entropy coding is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_ENTROPY_CODING_MODE_FLAG_SET_BIT_EXT</code>
indicates if CABAC entropy coding is supported.
An implementation <strong>must</strong> support at least one entropy coding mode.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_DIRECT_8X8_INFERENCE_FLAG_UNSET_BIT_EXT</code>
indicates if disabling <code>direct_8x8_inference_flag</code> in
<code>StdVideoH264SpsFlags</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_CONSTRAINED_INTRA_PRED_FLAG_SET_BIT_EXT</code>
indicates if enabling <code>constrained_intra_pred_flag</code> in
<code>StdVideoH264PpsFlags</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_DEBLOCKING_FILTER_DISABLED_BIT_EXT</code>
indicates if using
<code>STD_VIDEO_H264_DISABLE_DEBLOCKING_FILTER_IDC_DISABLED</code> from
StdVideoH264DisableDeblockingFilterIdc is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_DEBLOCKING_FILTER_ENABLED_BIT_EXT</code>
indicates if using
<code>STD_VIDEO_H264_DISABLE_DEBLOCKING_FILTER_IDC_ENABLED</code> from
StdVideoH264DisableDeblockingFilterIdc is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_DEBLOCKING_FILTER_PARTIAL_BIT_EXT</code>
indicates if using
<code>STD_VIDEO_H264_DISABLE_DEBLOCKING_FILTER_IDC_PARTIAL</code> from
StdVideoH264DisableDeblockingFilterIdc is supported.
An implementation <strong>must</strong> support at least one deblocking filter mode.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_SLICE_QP_DELTA_BIT_EXT</code> indicates whether
the implementation supports using the application-provided value for
<code>StdVideoEncodeH264SliceHeader</code>::<code>slice_qp_delta</code> when that value
is identical across the slices of the encoded frame.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_DIFFERENT_SLICE_QP_DELTA_BIT_EXT</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoEncodeH264SliceHeader</code>::<code>slice_qp_delta</code> when that value
is different across the slices of the encoded frame.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeH264StdFlagsEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef VkFlags VkVideoEncodeH264StdFlagsEXT;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeH264StdFlagsEXT</code> is a bitmask type for setting a mask of
zero or more <a href="#VkVideoEncodeH264StdFlagBitsEXT">VkVideoEncodeH264StdFlagBitsEXT</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_h_264_encode_quality_level_properties"><a class="anchor" href="#_h_264_encode_quality_level_properties"></a>H.264 Encode Quality Level Properties</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When calling <a href="#vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR">vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR</a>
with <code>pVideoProfile-&gt;videoCodecOperation</code> specified as
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_EXT</code>, the
<a href="#VkVideoEncodeH264QualityLevelPropertiesEXT">VkVideoEncodeH264QualityLevelPropertiesEXT</a> structure <strong>can</strong> be included
in the <code>pNext</code> chain of the <a href="#VkVideoEncodeQualityLevelPropertiesKHR">VkVideoEncodeQualityLevelPropertiesKHR</a>
structure to retrieve additional video encode quality level properties
specific to H.264 encoding.</p>
</div>
<div class="paragraph">
<p>The <a href="#VkVideoEncodeH264QualityLevelPropertiesEXT">VkVideoEncodeH264QualityLevelPropertiesEXT</a> structure is defined
as:</p>
</div>
<div id="VkVideoEncodeH264QualityLevelPropertiesEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef struct VkVideoEncodeH264QualityLevelPropertiesEXT {
    VkStructureType                         sType;
    void*                                   pNext;
    VkVideoEncodeH264RateControlFlagsEXT    preferredRateControlFlags;
    uint32_t                                preferredGopFrameCount;
    uint32_t                                preferredIdrPeriod;
    uint32_t                                preferredConsecutiveBFrameCount;
    uint32_t                                preferredTemporalLayerCount;
    VkVideoEncodeH264QpEXT                  preferredConstantQp;
    uint32_t                                preferredMaxL0ReferenceCount;
    uint32_t                                preferredMaxL1ReferenceCount;
    VkBool32                                preferredStdEntropyCodingModeFlag;
} VkVideoEncodeH264QualityLevelPropertiesEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>preferredRateControlFlags</code> is a bitmask of
<a href="#VkVideoEncodeH264RateControlFlagBitsEXT">VkVideoEncodeH264RateControlFlagBitsEXT</a> values indicating the
preferred flags to use for
<a href="#VkVideoEncodeH264RateControlInfoEXT">VkVideoEncodeH264RateControlInfoEXT</a>::<code>flags</code>.</p>
</li>
<li>
<p><code>preferredGopFrameCount</code> indicates the preferred value to use for
<a href="#VkVideoEncodeH264RateControlInfoEXT">VkVideoEncodeH264RateControlInfoEXT</a>::<code>gopFrameCount</code>.</p>
</li>
<li>
<p><code>preferredIdrPeriod</code> indicates the preferred value to use for
<a href="#VkVideoEncodeH264RateControlInfoEXT">VkVideoEncodeH264RateControlInfoEXT</a>::<code>idrPeriod</code>.</p>
</li>
<li>
<p><code>preferredConsecutiveBFrameCount</code> indicates the preferred value to
use for
<a href="#VkVideoEncodeH264RateControlInfoEXT">VkVideoEncodeH264RateControlInfoEXT</a>::<code>consecutiveBFrameCount</code>.</p>
</li>
<li>
<p><code>preferredTemporalLayerCount</code> indicates the preferred value to use
for <a href="#VkVideoEncodeH264RateControlInfoEXT">VkVideoEncodeH264RateControlInfoEXT</a>::<code>temporalLayerCount</code>.</p>
</li>
<li>
<p><code>preferredConstantQp</code> indicates the preferred values to use for
<a href="#VkVideoEncodeH264NaluSliceInfoEXT">VkVideoEncodeH264NaluSliceInfoEXT</a>::<code>constantQp</code> for each
picture type when using rate control mode
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR</code>.</p>
</li>
<li>
<p><code>preferredMaxL0ReferenceCount</code> indicates the preferred maximum
number of reference pictures to use in the reference list L0.</p>
</li>
<li>
<p><code>preferredMaxL1ReferenceCount</code> indicates the preferred maximum
number of reference pictures to use in the reference list L1.</p>
</li>
<li>
<p><code>preferredStdEntropyCodingModeFlag</code> indicates the preferred value to
use for <code>entropy_coding_mode_flag</code> in <code>StdVideoH264PpsFlags</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264QualityLevelPropertiesEXT-sType-sType" href="#VUID-VkVideoEncodeH264QualityLevelPropertiesEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264QualityLevelPropertiesEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_QUALITY_LEVEL_PROPERTIES_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_h_264_encode_session"><a class="anchor" href="#_h_264_encode_session"></a>H.264 Encode Session</h3>
<div class="paragraph">
<p>Additional parameters can be specified when creating a video session with an
H.264 encode profile by including an instance of the
<a href="#VkVideoEncodeH264SessionCreateInfoEXT">VkVideoEncodeH264SessionCreateInfoEXT</a> structure in the <code>pNext</code>
chain of <a href="#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH264SessionCreateInfoEXT</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH264SessionCreateInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef struct VkVideoEncodeH264SessionCreateInfoEXT {
    VkStructureType         sType;
    const void*             pNext;
    VkBool32                useMaxLevelIdc;
    StdVideoH264LevelIdc    maxLevelIdc;
} VkVideoEncodeH264SessionCreateInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>useMaxLevelIdc</code> indicates whether the value of <code>maxLevelIdc</code>
should be used by the implementation.
When it is set to <code>VK_FALSE</code>, the implementation ignores the value
of <code>maxLevelIdc</code> and uses the value of
<a href="#VkVideoEncodeH264CapabilitiesEXT">VkVideoEncodeH264CapabilitiesEXT</a>::<code>maxLevelIdc</code>, as reported
by <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile.</p>
</li>
<li>
<p><code>maxLevelIdc</code> provides the upper bound on the H.264 level for the
video bitstreams produced by the created video session.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionCreateInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH264SessionCreateInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionCreateInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_SESSION_CREATE_INFO_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_encoder_parameter_sets"><a class="anchor" href="#_encoder_parameter_sets"></a>Encoder Parameter Sets</h3>
<div class="paragraph">
<p>To reduce parameter traffic during encoding, the encoder parameter set
object supports storing H.264 SPS/PPS parameter sets that <strong>may</strong> be later
referenced during encoding.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <a href="#VkVideoEncodeH264SessionParametersCreateInfoEXT">VkVideoEncodeH264SessionParametersCreateInfoEXT</a> structure is
defined as:</p>
</div>
<div id="VkVideoEncodeH264SessionParametersCreateInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef struct VkVideoEncodeH264SessionParametersCreateInfoEXT {
    VkStructureType                                        sType;
    const void*                                            pNext;
    uint32_t                                               maxStdSPSCount;
    uint32_t                                               maxStdPPSCount;
    const VkVideoEncodeH264SessionParametersAddInfoEXT*    pParametersAddInfo;
} VkVideoEncodeH264SessionParametersCreateInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>maxStdSPSCount</code> is the maximum number of SPS parameters that the
<code>VkVideoSessionParametersKHR</code> can contain.</p>
</li>
<li>
<p><code>maxStdPPSCount</code> is the maximum number of PPS parameters that the
<code>VkVideoSessionParametersKHR</code> can contain.</p>
</li>
<li>
<p><code>pParametersAddInfo</code> is <code>NULL</code> or a pointer to a
<code>VkVideoEncodeH264SessionParametersAddInfoEXT</code> structure specifying
H.264 parameters to add upon object creation.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersCreateInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH264SessionParametersCreateInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersCreateInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_SESSION_PARAMETERS_CREATE_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersCreateInfoEXT-pParametersAddInfo-parameter" href="#VUID-VkVideoEncodeH264SessionParametersCreateInfoEXT-pParametersAddInfo-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersCreateInfoEXT-pParametersAddInfo-parameter</span><br>
 If <code>pParametersAddInfo</code> is not <code>NULL</code>, <code>pParametersAddInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkVideoEncodeH264SessionParametersAddInfoEXT">VkVideoEncodeH264SessionParametersAddInfoEXT</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH264SessionParametersAddInfoEXT</code> structure is defined
as:</p>
</div>
<div id="VkVideoEncodeH264SessionParametersAddInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef struct VkVideoEncodeH264SessionParametersAddInfoEXT {
    VkStructureType                            sType;
    const void*                                pNext;
    uint32_t                                   stdSPSCount;
    const StdVideoH264SequenceParameterSet*    pStdSPSs;
    uint32_t                                   stdPPSCount;
    const StdVideoH264PictureParameterSet*     pStdPPSs;
} VkVideoEncodeH264SessionParametersAddInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>stdSPSCount</code> is the number of SPS elements in the <code>pStdSPSs</code>.
Its value <strong>must</strong> be less than or equal to the value of
<code>maxStdSPSCount</code>.</p>
</li>
<li>
<p><code>pStdSPSs</code> is a pointer to an array of
<code>StdVideoH264SequenceParameterSet</code> structures representing H.264
sequence parameter sets.
Each element of the array <strong>must</strong> have a unique H.264 SPS ID.</p>
</li>
<li>
<p><code>stdPPSCount</code> is the number of PPS provided in <code>pStdPPSs</code>.
Its value <strong>must</strong> be less than or equal to the value of
<code>maxStdPPSCount</code>.</p>
</li>
<li>
<p><code>pStdPPSs</code> is a pointer to an array of
<code>StdVideoH264PictureParameterSet</code> structures representing H.264
picture parameter sets.
Each element of the array <strong>must</strong> have a unique H.264 SPS-PPS ID pair.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-stdSPSCount-04837" href="#VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-stdSPSCount-04837"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-stdSPSCount-04837</span><br>

The values of <code>stdSPSCount</code> and <code>stdPPSCount</code> <strong>must</strong> be less than
or equal to the values of <code>maxStdSPSCount</code> and <code>maxStdPPSCount</code>,
respectively</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-maxStdSPSCount-04838" href="#VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-maxStdSPSCount-04838"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-maxStdSPSCount-04838</span><br>

When the <code>maxStdSPSCount</code> number of parameters of type
StdVideoH264SequenceParameterSet in the Video Session Parameters object
is reached, no additional parameters of that type can be added to the
object.
<code>VK_ERROR_TOO_MANY_OBJECTS</code> will be returned if an attempt is made
to add additional data to this object at this point</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-maxStdPPSCount-04839" href="#VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-maxStdPPSCount-04839"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-maxStdPPSCount-04839</span><br>

When the <code>maxStdPPSCount</code> number of parameters of type
StdVideoH264PictureParameterSet in the Video Session Parameters object
is reached, no additional parameters of that type can be added to the
object.
<code>VK_ERROR_TOO_MANY_OBJECTS</code> will be returned if an attempt is made
to add additional data to this object at this point</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-None-04840" href="#VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-None-04840"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-None-04840</span><br>

Each entry to be added <strong>must</strong> have a unique, to the rest of the parameter
array entries and the existing parameters in the Video Session
Parameters Object that is being updated, SPS-PPS IDs</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-None-04841" href="#VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-None-04841"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-None-04841</span><br>

Parameter entries that already exist in Video Session Parameters object
with a particular SPS-PPS IDs <strong>cannot</strong> be replaced nor updated</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-None-04842" href="#VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-None-04842"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-None-04842</span><br>

When creating a new object using a Video Session Parameters as a
template, the array&#8217;s parameters with the same SPS-PPS IDs as the ones
from the template take precedence</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-None-04843" href="#VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-None-04843"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-None-04843</span><br>

SPS/PPS parameters <strong>must</strong> comply with the limits specified in
<a href="#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a> during Video Session creation</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_SESSION_PARAMETERS_ADD_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-pStdSPSs-parameter" href="#VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-pStdSPSs-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-pStdSPSs-parameter</span><br>
 If <code>stdSPSCount</code> is not <code>0</code>, and <code>pStdSPSs</code> is not <code>NULL</code>, <code>pStdSPSs</code> <strong>must</strong> be a valid pointer to an array of <code>stdSPSCount</code> <code>StdVideoH264SequenceParameterSet</code> values</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-pStdPPSs-parameter" href="#VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-pStdPPSs-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersAddInfoEXT-pStdPPSs-parameter</span><br>
 If <code>stdPPSCount</code> is not <code>0</code>, and <code>pStdPPSs</code> is not <code>NULL</code>, <code>pStdPPSs</code> <strong>must</strong> be a valid pointer to an array of <code>stdPPSCount</code> <code>StdVideoH264PictureParameterSet</code> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH264SessionParametersGetInfoEXT</code> structure is defined
as:</p>
</div>
<div id="VkVideoEncodeH264SessionParametersGetInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef struct VkVideoEncodeH264SessionParametersGetInfoEXT {
    VkStructureType    sType;
    const void*        pNext;
    VkBool32           writeStdSPS;
    VkBool32           writeStdPPS;
    uint32_t           stdSPSId;
    uint32_t           stdPPSId;
} VkVideoEncodeH264SessionParametersGetInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>writeStdSPS</code> indicates whether the encoded H.264 sequence parameter
set identified by <code>stdSPSId</code> is requested to be retrieved.</p>
</li>
<li>
<p><code>writeStdPPS</code> indicates whether the encoded H.264 picture parameter
set identified by the pair constructed from <code>stdSPSId</code> and
<code>stdPPSId</code> is requested to be retrieved.</p>
</li>
<li>
<p><code>stdSPSId</code> specifies the H.264 sequence parameter set ID used to
identify the retrieved H.264 sequence and/or picture parameter set(s).</p>
</li>
<li>
<p><code>stdPPSId</code> specifies the H.264 picture parameter set ID used to
identify the retrieved H.264 picture parameter set when
<code>writeStdPPS</code> is set to <code>VK_TRUE</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When this structure is specified in the <code>pNext</code> chain of the
<a href="#VkVideoEncodeSessionParametersGetInfoKHR">VkVideoEncodeSessionParametersGetInfoKHR</a> structure passed to
<a href="#vkGetEncodedVideoSessionParametersKHR">vkGetEncodedVideoSessionParametersKHR</a>, the command will write encoded
parameter data to the output buffer in the following order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The H.264 sequence parameter set identified by <code>stdSPSId</code>, if
<code>writeStdSPS</code> is set to <code>VK_TRUE</code>.</p>
</li>
<li>
<p>The H.264 picture parameter set identified by the pair constructed from
<code>stdSPSId</code> and <code>stdPPSId</code>, if <code>writeStdPPS</code> is set to
<code>VK_TRUE</code>.</p>
</li>
</ol>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersGetInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH264SessionParametersGetInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersGetInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_SESSION_PARAMETERS_GET_INFO_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH264SessionParametersFeedbackInfoEXT</code> structure is
defined as:</p>
</div>
<div id="VkVideoEncodeH264SessionParametersFeedbackInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef struct VkVideoEncodeH264SessionParametersFeedbackInfoEXT {
    VkStructureType    sType;
    void*              pNext;
    VkBool32           hasStdSPSOverrides;
    VkBool32           hasStdPPSOverrides;
} VkVideoEncodeH264SessionParametersFeedbackInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>hasStdSPSOverrides</code> indicates whether any of the parameters of the
requested H.264 sequence parameter set, if one was requested via
<a href="#VkVideoEncodeH264SessionParametersGetInfoEXT">VkVideoEncodeH264SessionParametersGetInfoEXT</a>::<code>writeStdSPS</code>,
were overridden by the implementation.</p>
</li>
<li>
<p><code>hasStdPPSOverrides</code> indicates whether any of the parameters of the
requested H.264 picture parameter set, if one was requested via
<a href="#VkVideoEncodeH264SessionParametersGetInfoEXT">VkVideoEncodeH264SessionParametersGetInfoEXT</a>::<code>writeStdPPS</code>,
were overridden by the implementation.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersFeedbackInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH264SessionParametersFeedbackInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersFeedbackInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_SESSION_PARAMETERS_FEEDBACK_INFO_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_frame_encoding"><a class="anchor" href="#_frame_encoding"></a>Frame Encoding</h3>
<div class="paragraph">
<p>In order to encode a frame, add a <a href="#VkVideoEncodeH264PictureInfoEXT">VkVideoEncodeH264PictureInfoEXT</a>
structure to the <code>pNext</code> chain of the <a href="#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>
structure passed to the <a href="#vkCmdEncodeVideoKHR">vkCmdEncodeVideoKHR</a> command.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <a href="#VkVideoEncodeH264PictureInfoEXT">VkVideoEncodeH264PictureInfoEXT</a> structure representing a frame
encode operation is defined as:</p>
</div>
<div id="VkVideoEncodeH264PictureInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef struct VkVideoEncodeH264PictureInfoEXT {
    VkStructureType                             sType;
    const void*                                 pNext;
    uint32_t                                    naluSliceEntryCount;
    const VkVideoEncodeH264NaluSliceInfoEXT*    pNaluSliceEntries;
    const StdVideoEncodeH264PictureInfo*        pStdPictureInfo;
    VkBool32                                    generatePrefixNalu;
} VkVideoEncodeH264PictureInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>naluSliceEntryCount</code> is the number of slice NALUs in the frame.</p>
</li>
<li>
<p><code>pNaluSliceEntries</code> is a pointer to an array of
<code>naluSliceEntryCount</code> <a href="#VkVideoEncodeH264NaluSliceInfoEXT">VkVideoEncodeH264NaluSliceInfoEXT</a>
structures specifying the division of the current picture into slices
and the properties of these slices.
This is an ordered sequence; the NALUs are generated consecutively in
<a href="#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>::<code>dstBuffer</code> in the same order as in this
array.</p>
</li>
<li>
<p><code>pStdPictureInfo</code> is a pointer to a
<code>StdVideoEncodeH264PictureInfo</code> structure specifying the syntax and
other codec-specific information from the H.264 specification associated
with this picture.
The information provided <strong>must</strong> reflect the decoded picture marking
operations that are applicable to this frame.</p>
</li>
<li>
<p><code>generatePrefixNalu</code> controls whether prefix NALUs are generated
before slice NALUs into the target bitstream.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264PictureInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH264PictureInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264PictureInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_PICTURE_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264PictureInfoEXT-pNaluSliceEntries-parameter" href="#VUID-VkVideoEncodeH264PictureInfoEXT-pNaluSliceEntries-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264PictureInfoEXT-pNaluSliceEntries-parameter</span><br>
 <code>pNaluSliceEntries</code> <strong>must</strong> be a valid pointer to an array of <code>naluSliceEntryCount</code> valid <a href="#VkVideoEncodeH264NaluSliceInfoEXT">VkVideoEncodeH264NaluSliceInfoEXT</a> structures</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264PictureInfoEXT-pStdPictureInfo-parameter" href="#VUID-VkVideoEncodeH264PictureInfoEXT-pStdPictureInfo-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264PictureInfoEXT-pStdPictureInfo-parameter</span><br>
 <code>pStdPictureInfo</code> <strong>must</strong> be a valid pointer to a valid <code>StdVideoEncodeH264PictureInfo</code> value</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264PictureInfoEXT-naluSliceEntryCount-arraylength" href="#VUID-VkVideoEncodeH264PictureInfoEXT-naluSliceEntryCount-arraylength"></a> <span class="vuid">VUID-VkVideoEncodeH264PictureInfoEXT-naluSliceEntryCount-arraylength</span><br>
 <code>naluSliceEntryCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <a href="#VkVideoEncodeH264NaluSliceInfoEXT">VkVideoEncodeH264NaluSliceInfoEXT</a> structure representing a slice
is defined as:</p>
</div>
<div id="VkVideoEncodeH264NaluSliceInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef struct VkVideoEncodeH264NaluSliceInfoEXT {
    VkStructureType                         sType;
    const void*                             pNext;
    int32_t                                 constantQp;
    const StdVideoEncodeH264SliceHeader*    pStdSliceHeader;
} VkVideoEncodeH264NaluSliceInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>constantQp</code> is the QP to use for the slice if the current rate
control mode configured for the video session is
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR</code>.</p>
</li>
<li>
<p><code>pStdSliceHeader</code> is a pointer to a
<code>StdVideoEncodeH264SliceHeader</code> structure specifying the slice header
for the current slice.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264NaluSliceInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH264NaluSliceInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264NaluSliceInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_NALU_SLICE_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264NaluSliceInfoEXT-pNext-pNext" href="#VUID-VkVideoEncodeH264NaluSliceInfoEXT-pNext-pNext"></a> <span class="vuid">VUID-VkVideoEncodeH264NaluSliceInfoEXT-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264NaluSliceInfoEXT-pStdSliceHeader-parameter" href="#VUID-VkVideoEncodeH264NaluSliceInfoEXT-pStdSliceHeader-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264NaluSliceInfoEXT-pStdSliceHeader-parameter</span><br>
 <code>pStdSliceHeader</code> <strong>must</strong> be a valid pointer to a valid <code>StdVideoEncodeH264SliceHeader</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <a href="#VkVideoEncodeH264DpbSlotInfoEXT">VkVideoEncodeH264DpbSlotInfoEXT</a> structure, representing a
reconstructed picture that is being used as a reference picture, is defined
as:</p>
</div>
<div id="VkVideoEncodeH264DpbSlotInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef struct VkVideoEncodeH264DpbSlotInfoEXT {
    VkStructureType                           sType;
    const void*                               pNext;
    const StdVideoEncodeH264ReferenceInfo*    pStdReferenceInfo;
} VkVideoEncodeH264DpbSlotInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pStdReferenceInfo</code> is a pointer to a
<code>StdVideoEncodeH264ReferenceInfo</code> structure specifying the syntax and
other codec-specific information from the H.264 specification associated
with this reference picture.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264DpbSlotInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH264DpbSlotInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264DpbSlotInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_DPB_SLOT_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264DpbSlotInfoEXT-pStdReferenceInfo-parameter" href="#VUID-VkVideoEncodeH264DpbSlotInfoEXT-pStdReferenceInfo-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264DpbSlotInfoEXT-pStdReferenceInfo-parameter</span><br>
 <code>pStdReferenceInfo</code> <strong>must</strong> be a valid pointer to a valid <code>StdVideoEncodeH264ReferenceInfo</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rate_control"><a class="anchor" href="#_rate_control"></a>Rate control</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH264RateControlInfoEXT</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH264RateControlInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef struct VkVideoEncodeH264RateControlInfoEXT {
    VkStructureType                         sType;
    const void*                             pNext;
    VkVideoEncodeH264RateControlFlagsEXT    flags;
    uint32_t                                gopFrameCount;
    uint32_t                                idrPeriod;
    uint32_t                                consecutiveBFrameCount;
    uint32_t                                temporalLayerCount;
} VkVideoEncodeH264RateControlInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of
<a href="#VkVideoEncodeH264RateControlFlagBitsEXT">VkVideoEncodeH264RateControlFlagBitsEXT</a> specifying H.264 rate
control flags.</p>
</li>
<li>
<p><code>gopFrameCount</code> is the number of frames contained within the group
of pictures (GOP), starting from an intra frame and until the next intra
frame.
If it is set to 0, the implementation chooses a suitable value.
If it is set to <code>UINT32_MAX</code>, the GOP length is treated as infinite.</p>
</li>
<li>
<p><code>idrPeriod</code> is the interval, in terms of number of frames, between
two IDR frames.
If it is set to 0, the implementation chooses a suitable value.
If it is set to <code>UINT32_MAX</code>, the IDR period is treated as infinite.</p>
</li>
<li>
<p><code>consecutiveBFrameCount</code> is the number of consecutive B-frames
between I- and/or P-frames within the GOP.</p>
</li>
<li>
<p><code>temporalLayerCount</code> specifies the number of temporal layers enabled
in the stream.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In order to provide H.264-specific stream rate control parameters, add a
<code>VkVideoEncodeH264RateControlInfoEXT</code> structure to the <code>pNext</code> chain
of the <a href="#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a> structure in the <code>pNext</code>
chain of the <a href="#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a> structure passed to the
<a href="#vkCmdControlVideoCodingKHR">vkCmdControlVideoCodingKHR</a> command.</p>
</div>
<div class="paragraph">
<p>The parameters from this structure act as a guidance for implementations to
apply various rate control heuristics.</p>
</div>
<div class="paragraph">
<p>It is possible to infer the picture type to be used when encoding a frame,
on the basis of the values provided for <code>consecutiveBFrameCount</code>,
<code>idrPeriod</code>, and <code>gopFrameCount</code>, but this inferred picture type
will not be used by implementations to override the picture type provided in
<a href="#vkCmdEncodeVideoKHR">vkCmdEncodeVideoKHR</a>.
Additionally, it is not required for the video session to be reset if the
inferred picture type does not match the actual picture type.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH264RateControlInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_RATE_CONTROL_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlInfoEXT-flags-parameter" href="#VUID-VkVideoEncodeH264RateControlInfoEXT-flags-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlInfoEXT-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkVideoEncodeH264RateControlFlagBitsEXT">VkVideoEncodeH264RateControlFlagBitsEXT</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in
<a href="#VkVideoEncodeH264RateControlInfoEXT">VkVideoEncodeH264RateControlInfoEXT</a>::<code>flags</code>, specifying H.264
rate control flags, are:</p>
</div>
<div id="VkVideoEncodeH264RateControlFlagBitsEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef enum VkVideoEncodeH264RateControlFlagBitsEXT {
    VK_VIDEO_ENCODE_H264_RATE_CONTROL_ATTEMPT_HRD_COMPLIANCE_BIT_EXT = 0x00000001,
    VK_VIDEO_ENCODE_H264_RATE_CONTROL_REGULAR_GOP_BIT_EXT = 0x00000002,
    VK_VIDEO_ENCODE_H264_RATE_CONTROL_REFERENCE_PATTERN_FLAT_BIT_EXT = 0x00000004,
    VK_VIDEO_ENCODE_H264_RATE_CONTROL_REFERENCE_PATTERN_DYADIC_BIT_EXT = 0x00000008,
    VK_VIDEO_ENCODE_H264_RATE_CONTROL_TEMPORAL_LAYER_PATTERN_DYADIC_BIT_EXT = 0x00000010,
} VkVideoEncodeH264RateControlFlagBitsEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_H264_RATE_CONTROL_ATTEMPT_HRD_COMPLIANCE_BIT_EXT</code>
specifies that rate control <strong>should</strong> attempt to produce an HRD compliant
bitstream.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_RATE_CONTROL_REGULAR_GOP_BIT_EXT</code> specifies
that the application intends to use a regular GOP structure according to
the parameters specified in the <code>gopFrameCount</code>, <code>idrPeriod</code>,
and <code>consecutiveBFrameCount</code> members of the
<a href="#VkVideoEncodeH264RateControlInfoEXT">VkVideoEncodeH264RateControlInfoEXT</a> structure.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_RATE_CONTROL_REFERENCE_PATTERN_FLAT_BIT_EXT</code>
specifies that the application intends to follow a flat reference
pattern.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_RATE_CONTROL_REFERENCE_PATTERN_DYADIC_BIT_EXT</code>
specifies that the application intends to follow a dyadic reference
pattern.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_RATE_CONTROL_TEMPORAL_LAYER_PATTERN_DYADIC_BIT_EXT</code>
specifies that the application intends to follow a dyadic temporal layer
pattern.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeH264RateControlFlagsEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef VkFlags VkVideoEncodeH264RateControlFlagsEXT;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeH264RateControlFlagsEXT</code> is a bitmask type for setting a
mask of zero or more <a href="#VkVideoEncodeH264RateControlFlagBitsEXT">VkVideoEncodeH264RateControlFlagBitsEXT</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH264RateControlLayerInfoEXT</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH264RateControlLayerInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef struct VkVideoEncodeH264RateControlLayerInfoEXT {
    VkStructureType                  sType;
    const void*                      pNext;
    VkBool32                         useMinQp;
    VkVideoEncodeH264QpEXT           minQp;
    VkBool32                         useMaxQp;
    VkVideoEncodeH264QpEXT           maxQp;
    VkBool32                         useMaxFrameSize;
    VkVideoEncodeH264FrameSizeEXT    maxFrameSize;
} VkVideoEncodeH264RateControlLayerInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>useMinQp</code> indicates whether the values within <code>minQp</code> should be
used by the implementation.
When it is set to <code>VK_FALSE</code>, the implementation ignores the values
in <code>minQp</code> and chooses suitable values.</p>
</li>
<li>
<p><code>minQp</code> provides the lower bound on the QP values for each picture
type, to be used in rate control calculations.</p>
</li>
<li>
<p><code>useMaxQp</code> indicates whether the values within <code>maxQp</code> should be
used by the implementation.
When it is set to <code>VK_FALSE</code>, the implementation ignores the values
in <code>maxQp</code> and chooses suitable values.</p>
</li>
<li>
<p><code>maxQp</code> provides the upper bound on the QP values for each picture
type, to be used in rate control calculations.</p>
</li>
<li>
<p><code>useMaxFrameSize</code> indicates whether the values within
<code>maxFrameSize</code> should be used by the implementation.</p>
</li>
<li>
<p><code>maxFrameSize</code> provides the upper bound on the encoded frame size
for each picture type.
The implementation does not guarantee the encoded frame sizes will be
within the specified limits, however these limits <strong>may</strong> be used as a
guide in rate control calculations.
If enabled and not set properly, the <code>maxQp</code> limit may prevent the
implementation from respecting the <code>maxFrameSize</code> limit.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>H.264-specific per-layer rate control parameters <strong>must</strong> be specified by
adding a <code>VkVideoEncodeH264RateControlLayerInfoEXT</code> structure to the
<code>pNext</code> chain of each <a href="#VkVideoEncodeRateControlLayerInfoKHR">VkVideoEncodeRateControlLayerInfoKHR</a>
structure in a call to <a href="#vkCmdControlVideoCodingKHR">vkCmdControlVideoCodingKHR</a> command, when the
command buffer context has an active video encode H.264 session.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlLayerInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH264RateControlLayerInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlLayerInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_RATE_CONTROL_LAYER_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlLayerInfoEXT-minQp-parameter" href="#VUID-VkVideoEncodeH264RateControlLayerInfoEXT-minQp-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlLayerInfoEXT-minQp-parameter</span><br>
 <code>minQp</code> <strong>must</strong> be a valid <a href="#VkVideoEncodeH264QpEXT">VkVideoEncodeH264QpEXT</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlLayerInfoEXT-maxQp-parameter" href="#VUID-VkVideoEncodeH264RateControlLayerInfoEXT-maxQp-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlLayerInfoEXT-maxQp-parameter</span><br>
 <code>maxQp</code> <strong>must</strong> be a valid <a href="#VkVideoEncodeH264QpEXT">VkVideoEncodeH264QpEXT</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlLayerInfoEXT-maxFrameSize-parameter" href="#VUID-VkVideoEncodeH264RateControlLayerInfoEXT-maxFrameSize-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlLayerInfoEXT-maxFrameSize-parameter</span><br>
 <code>maxFrameSize</code> <strong>must</strong> be a valid <a href="#VkVideoEncodeH264FrameSizeEXT">VkVideoEncodeH264FrameSizeEXT</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH264QpEXT</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH264QpEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef struct VkVideoEncodeH264QpEXT {
    int32_t    qpI;
    int32_t    qpP;
    int32_t    qpB;
} VkVideoEncodeH264QpEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>qpI</code> is the QP to be used for I-frames.</p>
</li>
<li>
<p><code>qpP</code> is the QP to be used for P-frames.</p>
</li>
<li>
<p><code>qpB</code> is the QP to be used for B-frames.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH264FrameSizeEXT</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH264FrameSizeEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef struct VkVideoEncodeH264FrameSizeEXT {
    uint32_t    frameISize;
    uint32_t    framePSize;
    uint32_t    frameBSize;
} VkVideoEncodeH264FrameSizeEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>frameISize</code> is the size in bytes to be used for I-frames.</p>
</li>
<li>
<p><code>framePSize</code> is the size in bytes to be used for P-frames.</p>
</li>
<li>
<p><code>frameBSize</code> is the size in bytes to be used for B-frames.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH264GopRemainingFrameInfoEXT</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH264GopRemainingFrameInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h264
typedef struct VkVideoEncodeH264GopRemainingFrameInfoEXT {
    VkStructureType    sType;
    const void*        pNext;
    VkBool32           useGopRemainingFrames;
    uint32_t           gopRemainingI;
    uint32_t           gopRemainingP;
    uint32_t           gopRemainingB;
} VkVideoEncodeH264GopRemainingFrameInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>useGopRemainingFrames</code> indicates whether the implementation&#8217;s rate
control algorithm <strong>should</strong> use the values specified in
<code>gopRemainingI</code>, <code>gopRemainingP</code>, and <code>gopRemainingB</code>.
If <code>useGopRemainingFrames</code> is <code>VK_FALSE</code>, then the values of
<code>gopRemainingI</code>, <code>gopRemainingP</code>, and <code>gopRemainingB</code> are
ignored.</p>
</li>
<li>
<p><code>gopRemainingI</code> specifies the number of I-frames the
implementation&#8217;s rate control algorithm <strong>should</strong> assume to be remaining
in the GOP prior to executing the video encode operation.</p>
</li>
<li>
<p><code>gopRemainingP</code> specifies the number of P-frames the
implementation&#8217;s rate control algorithm <strong>should</strong> assume to be remaining
in the GOP prior to executing the video encode operation.</p>
</li>
<li>
<p><code>gopRemainingB</code> specifies the number of B-frames the
implementation&#8217;s rate control algorithm <strong>should</strong> assume to be remaining
in the GOP prior to executing the video encode operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Setting <code>useGopRemainingFrames</code> to <code>VK_TRUE</code> and including this
structure in the <code>pNext</code> chain of <a href="#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a> is only
mandatory if the
<a href="#VkVideoEncodeH264CapabilitiesEXT">VkVideoEncodeH264CapabilitiesEXT</a>::<code>requiresGopRemainingFrames</code>
reported for the used <a href="#video-profiles">video profile</a> is <code>VK_TRUE</code>.
However, implementations <strong>may</strong> use these remaining frame counts, when
specified, even when it is not required.
In particular, when the application does not use a regular GOP structure,
these values <strong>may</strong> provide additional guidance for the implementation&#8217;s rate
control algorithm.</p>
</div>
<div class="paragraph">
<p>The <a href="#VkVideoEncodeH264CapabilitiesEXT">VkVideoEncodeH264CapabilitiesEXT</a>::<code>prefersGopRemainingFrames</code>
capability is also used to indicate that the implementation&#8217;s rate control
algorithm <strong>may</strong> operate more accurately if the application specifies the
remaining frame counts using this structure.</p>
</div>
<div class="paragraph">
<p>As with other rate control guidance values, if the effective order and
number of frames encoded by the application are not in line with the
remaining frame counts specified in this structure at any given point, then
the behavior of the implementation&#8217;s rate control algorithm <strong>may</strong> deviate
from the one expected by the application.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264GopRemainingFrameInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH264GopRemainingFrameInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264GopRemainingFrameInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_GOP_REMAINING_FRAME_INFO_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="encode-h265"><a class="anchor" href="#encode-h265"></a>Encode H.265</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code><a href="../appendices/extensions.html#VK_EXT_video_encode_h265" class="xref page">VK_EXT_video_encode_h265</a></code> extension adds H.265 codec-specific
structures/types needed to support H.265 video encoding.
Unless otherwise noted, all references to the H.265 specification are to the
2013 edition published by the ITU-T, dated April 2013.
This specification is available at <a href="https://www.itu.int/rec/T-REC-H.265" class="bare">https://www.itu.int/rec/T-REC-H.265</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Refer to the <a href="preamble.html#preamble" class="xref page">Preamble</a> for information on how the Khronos
Intellectual Property Rights Policy relates to normative references to
external materials not created by Khronos.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_h_265_encode_profile"><a class="anchor" href="#_h_265_encode_profile"></a>H.265 encode profile</h3>
<div class="paragraph">
<p>An H.265 encode profile is specified by including the
<a href="#VkVideoEncodeH265ProfileInfoEXT">VkVideoEncodeH265ProfileInfoEXT</a> structure in the <code>pNext</code> chain of
the <a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure when
<a href="#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>::<code>videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_EXT</code>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH265ProfileInfoEXT</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH265ProfileInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef struct VkVideoEncodeH265ProfileInfoEXT {
    VkStructureType           sType;
    const void*               pNext;
    StdVideoH265ProfileIdc    stdProfileIdc;
} VkVideoEncodeH265ProfileInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>stdProfileIdc</code> is a <code>StdVideoH265ProfileIdc</code> value specifying
the H.265 codec profile IDC.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265ProfileInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH265ProfileInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265ProfileInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_PROFILE_INFO_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_capabilities_4"><a class="anchor" href="#_capabilities_4"></a>Capabilities</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When calling <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> with
<code>pVideoProfile-&gt;videoCodecOperation</code> specified as
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_EXT</code>, the
<a href="#VkVideoEncodeH265CapabilitiesEXT">VkVideoEncodeH265CapabilitiesEXT</a> structure <strong>must</strong> be included in the
<code>pNext</code> chain of the <a href="#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a> structure to retrieve
more capabilities specific to H.265 video encoding.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoEncodeH265CapabilitiesEXT</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH265CapabilitiesEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef struct VkVideoEncodeH265CapabilitiesEXT {
    VkStructureType                                sType;
    void*                                          pNext;
    VkVideoEncodeH265CapabilityFlagsEXT            flags;
    StdVideoH265LevelIdc                           maxLevelIdc;
    uint32_t                                       maxSliceSegmentCount;
    VkExtent2D                                     maxTiles;
    VkVideoEncodeH265CtbSizeFlagsEXT               ctbSizes;
    VkVideoEncodeH265TransformBlockSizeFlagsEXT    transformBlockSizes;
    uint32_t                                       maxPPictureL0ReferenceCount;
    uint32_t                                       maxBPictureL0ReferenceCount;
    uint32_t                                       maxL1ReferenceCount;
    uint32_t                                       maxSubLayerCount;
    VkBool32                                       expectDyadicTemporalSubLayerPattern;
    int32_t                                        minQp;
    int32_t                                        maxQp;
    VkBool32                                       prefersGopRemainingFrames;
    VkBool32                                       requiresGopRemainingFrames;
    VkVideoEncodeH265StdFlagsEXT                   stdSyntaxFlags;
} VkVideoEncodeH265CapabilitiesEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkVideoEncodeH265CapabilityFlagBitsEXT">VkVideoEncodeH265CapabilityFlagBitsEXT</a>
indicating supported H.265 encoding capabilities.</p>
</li>
<li>
<p><code>maxLevelIdc</code> is a <code>StdVideoH265LevelIdc</code> value indicating the
maximum H.265 level supported.</p>
</li>
<li>
<p><code>maxSliceSegmentCount</code> indicates the maximum number of slice
segments that <strong>can</strong> be encoded for a single picture.
Further restrictions <strong>may</strong> apply to the number of slice segments that
<strong>can</strong> be encoded for a single picture depending on other capabilities and
codec-specific rules.</p>
</li>
<li>
<p><code>maxTiles</code> indicates the maximum number of H.265 tile columns and
rows that <strong>can</strong> be encoded for a single picture.
Further restrictions <strong>may</strong> apply to the number of H.265 tiles that <strong>can</strong>
be encoded for a single picture depending on other capabilities and
codec-specific rules.</p>
</li>
<li>
<p><code>ctbSizes</code> is a bitmask of <a href="#VkVideoEncodeH265CtbSizeFlagBitsEXT">VkVideoEncodeH265CtbSizeFlagBitsEXT</a>
describing the supported CTB sizes.</p>
</li>
<li>
<p><code>transformBlockSizes</code> is a bitmask of
<a href="#VkVideoEncodeH265TransformBlockSizeFlagBitsEXT">VkVideoEncodeH265TransformBlockSizeFlagBitsEXT</a> describing the
supported transform block sizes.</p>
</li>
<li>
<p><code>maxPPictureL0ReferenceCount</code> indicates the maximum number of
reference pictures the implementation supports in the reference list L0
for P pictures.</p>
</li>
<li>
<p><code>maxBPictureL0ReferenceCount</code> indicates the maximum number of
reference pictures the implementation supports in the reference list L0
for B pictures.
The reported value is <code>0</code> if encoding of B pictures is not supported.</p>
</li>
<li>
<p><code>maxL1ReferenceCount</code> indicates the maximum number of reference
pictures the implementation supports in the reference list L1 if
encoding of B pictures is supported.
The reported value is <code>0</code> if encoding of B pictures is not supported.</p>
</li>
<li>
<p><code>maxSubLayerCount</code> indicates the maximum number of H.265 sub-layers
supported by the implementation.</p>
</li>
<li>
<p><code>expectDyadicTemporalSubLayerPattern</code> indicates that the
implementation&#8217;s rate control algorithms expect the application to use a
dyadic temporal sub-layer pattern when encoding multiple temporal
sub-layers.</p>
</li>
<li>
<p><code>minQp</code> indicates the minimum QP value supported.</p>
</li>
<li>
<p><code>maxQp</code> indicates the maximum QP value supported.</p>
</li>
<li>
<p><code>prefersGopRemainingFrames</code> indicates that the implementation&#8217;s rate
control algorithm prefers the application to specify the number of
frames of each type remaining in the current group of pictures.</p>
</li>
<li>
<p><code>requiresGopRemainingFrames</code> indicates that the implementation&#8217;s
rate control algorithm requires the application to specify the number of
frames of each type remaining in the current group of pictures.</p>
</li>
<li>
<p><code>stdSyntaxFlags</code> is a bitmask of
<a href="#VkVideoEncodeH265StdFlagBitsEXT">VkVideoEncodeH265StdFlagBitsEXT</a> indicating capabilities related to
H.265 syntax elements.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265CapabilitiesEXT-sType-sType" href="#VUID-VkVideoEncodeH265CapabilitiesEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265CapabilitiesEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_CAPABILITIES_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>may</strong> be set in
<a href="#VkVideoEncodeH265CapabilitiesEXT">VkVideoEncodeH265CapabilitiesEXT</a>::<code>flags</code> indicating the supported
H.265 encoding capabilities, are:</p>
</div>
<div id="VkVideoEncodeH265CapabilityFlagBitsEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef enum VkVideoEncodeH265CapabilityFlagBitsEXT {
    VK_VIDEO_ENCODE_H265_CAPABILITY_HRD_COMPLIANCE_BIT_EXT = 0x00000001,
    VK_VIDEO_ENCODE_H265_CAPABILITY_PREDICTION_WEIGHT_TABLE_GENERATED_BIT_EXT = 0x00000002,
    VK_VIDEO_ENCODE_H265_CAPABILITY_ROW_UNALIGNED_SLICE_SEGMENT_BIT_EXT = 0x00000004,
    VK_VIDEO_ENCODE_H265_CAPABILITY_DIFFERENT_SLICE_SEGMENT_TYPE_BIT_EXT = 0x00000008,
    VK_VIDEO_ENCODE_H265_CAPABILITY_B_FRAME_IN_L0_LIST_BIT_EXT = 0x00000010,
    VK_VIDEO_ENCODE_H265_CAPABILITY_B_FRAME_IN_L1_LIST_BIT_EXT = 0x00000020,
    VK_VIDEO_ENCODE_H265_CAPABILITY_PER_PICTURE_TYPE_MIN_MAX_QP_BIT_EXT = 0x00000040,
    VK_VIDEO_ENCODE_H265_CAPABILITY_PER_SLICE_SEGMENT_CONSTANT_QP_BIT_EXT = 0x00000080,
    VK_VIDEO_ENCODE_H265_CAPABILITY_MULTIPLE_TILES_PER_SLICE_SEGMENT_BIT_EXT = 0x00000100,
    VK_VIDEO_ENCODE_H265_CAPABILITY_MULTIPLE_SLICE_SEGMENTS_PER_TILE_BIT_EXT = 0x00000200,
} VkVideoEncodeH265CapabilityFlagBitsEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CAPABILITY_HRD_COMPLIANCE_BIT_EXT</code> indicates
if the implementation guarantees generating a HRD compliant bitstream if
<code>nal_hrd_parameters_present_flag</code>,
<code>vcl_hrd_parameters_present_flag</code>, or
<code>sub_pic_hrd_params_present_flag</code> are enabled in
<code>StdVideoH265HrdFlags</code>, or <code>vui_hrd_parameters_present_flag</code> is
enabled in <code>StdVideoH265SpsVuiFlags</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CAPABILITY_PREDICTION_WEIGHT_TABLE_GENERATED_BIT_EXT</code>
indicates that when <code>weighted_pred_flag</code> or <code>weighted_bipred_flag</code>
in <code>StdVideoH265PpsFlags</code> are enabled, the implementation is able to
internally decide syntax for <code>pred_weight_table</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CAPABILITY_ROW_UNALIGNED_SLICE_SEGMENT_BIT_EXT</code>
indicates that each slice segment in a frame with a single or multiple
tiles per slice may begin or finish at any offset in a CTB row.
If not supported, all slice segments in such a frame <strong>must</strong> begin at the
start of a CTB row (and hence each slice segment <strong>must</strong> finish at the end
of a CTB row).
Also indicates that each slice segment in a frame with multiple slices
per tile may begin or finish at any offset within the enclosing tile&#8217;s
CTB row.
If not supported, slice segments in such a frame <strong>must</strong> begin at the
start of the enclosing tile&#8217;s CTB row (and hence each slice segment
<strong>must</strong> finish at the end of the enclosing tile&#8217;s CTB row).</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CAPABILITY_DIFFERENT_SLICE_SEGMENT_TYPE_BIT_EXT</code>
indicates that when a frame is encoded with multiple slice segments, the
implementation allows encoding each slice segment with a different
<code>StdVideoEncodeH265SliceSegmentHeader</code>::<code>slice_type</code>.
If not supported, all slice segments of the frame <strong>must</strong> be encoded with
the same <code>slice_type</code> which corresponds to the picture type of the
frame.
For example, all slice segments of a P-frame would be encoded as
P-slices.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CAPABILITY_B_FRAME_IN_L0_LIST_BIT_EXT</code>
indicates support for using a B frame as L0 reference.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CAPABILITY_B_FRAME_IN_L1_LIST_BIT_EXT</code>
indicates support for using a B frame as L1 reference.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CAPABILITY_PER_PICTURE_TYPE_MIN_MAX_QP_BIT_EXT</code>
indicates support for specifying different QP values in the members of
<a href="#VkVideoEncodeH265QpEXT">VkVideoEncodeH265QpEXT</a>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CAPABILITY_PER_SLICE_SEGMENT_CONSTANT_QP_BIT_EXT</code>
indicates support for specifying different constant QP values for each
slice segment.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CAPABILITY_MULTIPLE_TILES_PER_SLICE_SEGMENT_BIT_EXT</code>
indicates if encoding multiple tiles per slice segment is supported.
If not set, the implementation is only able to encode a single tile for
each slice segment.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CAPABILITY_MULTIPLE_SLICE_SEGMENTS_PER_TILE_BIT_EXT</code>
indicates if encoding multiple slice segments per tile is supported.
If not set, the implementation is only able to encode a single slice
segment for each tile.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeH265CapabilityFlagsEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef VkFlags VkVideoEncodeH265CapabilityFlagsEXT;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeH265CapabilityFlagsEXT</code> is a bitmask type for setting a
mask of zero or more <a href="#VkVideoEncodeH265CapabilityFlagBitsEXT">VkVideoEncodeH265CapabilityFlagBitsEXT</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>may</strong> be set in
<a href="#VkVideoEncodeH265CapabilitiesEXT">VkVideoEncodeH265CapabilitiesEXT</a>::<code>stdSyntaxFlags</code>, indicating the
capabilities related to the H.265 syntax elements, are:</p>
</div>
<div id="VkVideoEncodeH265StdFlagBitsEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef enum VkVideoEncodeH265StdFlagBitsEXT {
    VK_VIDEO_ENCODE_H265_STD_SEPARATE_COLOR_PLANE_FLAG_SET_BIT_EXT = 0x00000001,
    VK_VIDEO_ENCODE_H265_STD_SAMPLE_ADAPTIVE_OFFSET_ENABLED_FLAG_SET_BIT_EXT = 0x00000002,
    VK_VIDEO_ENCODE_H265_STD_SCALING_LIST_DATA_PRESENT_FLAG_SET_BIT_EXT = 0x00000004,
    VK_VIDEO_ENCODE_H265_STD_PCM_ENABLED_FLAG_SET_BIT_EXT = 0x00000008,
    VK_VIDEO_ENCODE_H265_STD_SPS_TEMPORAL_MVP_ENABLED_FLAG_SET_BIT_EXT = 0x00000010,
    VK_VIDEO_ENCODE_H265_STD_INIT_QP_MINUS26_BIT_EXT = 0x00000020,
    VK_VIDEO_ENCODE_H265_STD_WEIGHTED_PRED_FLAG_SET_BIT_EXT = 0x00000040,
    VK_VIDEO_ENCODE_H265_STD_WEIGHTED_BIPRED_FLAG_SET_BIT_EXT = 0x00000080,
    VK_VIDEO_ENCODE_H265_STD_LOG2_PARALLEL_MERGE_LEVEL_MINUS2_BIT_EXT = 0x00000100,
    VK_VIDEO_ENCODE_H265_STD_SIGN_DATA_HIDING_ENABLED_FLAG_SET_BIT_EXT = 0x00000200,
    VK_VIDEO_ENCODE_H265_STD_TRANSFORM_SKIP_ENABLED_FLAG_SET_BIT_EXT = 0x00000400,
    VK_VIDEO_ENCODE_H265_STD_TRANSFORM_SKIP_ENABLED_FLAG_UNSET_BIT_EXT = 0x00000800,
    VK_VIDEO_ENCODE_H265_STD_PPS_SLICE_CHROMA_QP_OFFSETS_PRESENT_FLAG_SET_BIT_EXT = 0x00001000,
    VK_VIDEO_ENCODE_H265_STD_TRANSQUANT_BYPASS_ENABLED_FLAG_SET_BIT_EXT = 0x00002000,
    VK_VIDEO_ENCODE_H265_STD_CONSTRAINED_INTRA_PRED_FLAG_SET_BIT_EXT = 0x00004000,
    VK_VIDEO_ENCODE_H265_STD_ENTROPY_CODING_SYNC_ENABLED_FLAG_SET_BIT_EXT = 0x00008000,
    VK_VIDEO_ENCODE_H265_STD_DEBLOCKING_FILTER_OVERRIDE_ENABLED_FLAG_SET_BIT_EXT = 0x00010000,
    VK_VIDEO_ENCODE_H265_STD_DEPENDENT_SLICE_SEGMENTS_ENABLED_FLAG_SET_BIT_EXT = 0x00020000,
    VK_VIDEO_ENCODE_H265_STD_DEPENDENT_SLICE_SEGMENT_FLAG_SET_BIT_EXT = 0x00040000,
    VK_VIDEO_ENCODE_H265_STD_SLICE_QP_DELTA_BIT_EXT = 0x00080000,
    VK_VIDEO_ENCODE_H265_STD_DIFFERENT_SLICE_QP_DELTA_BIT_EXT = 0x00100000,
} VkVideoEncodeH265StdFlagBitsEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_SEPARATE_COLOR_PLANE_FLAG_SET_BIT_EXT</code>
indicates if enabling <code>separate_colour_plane_flag</code> in
<code>StdVideoH265SpsFlags</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_SAMPLE_ADAPTIVE_OFFSET_ENABLED_FLAG_SET_BIT_EXT</code>
indicates if enabling <code>sample_adaptive_offset_enabled_flag</code> in
<code>StdVideoH265SpsFlags</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_SCALING_LIST_DATA_PRESENT_FLAG_SET_BIT_EXT</code>
indicates if enabling <code>scaling_list_enabled_flag</code> and
<code>sps_scaling_list_data_present_flag</code> in <code>StdVideoH265SpsFlags</code>, or
enabling <code>pps_scaling_list_data_present_flag</code> in
<code>StdVideoH265PpsFlags</code> are supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_PCM_ENABLED_FLAG_SET_BIT_EXT</code> indicates if
enabling <code>pcm_enable_flag</code> in <code>StdVideoH265SpsFlags</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_SPS_TEMPORAL_MVP_ENABLED_FLAG_SET_BIT_EXT</code>
indicates if enabling <code>sps_temporal_mvp_enabled_flag</code> in
<code>StdVideoH265SpsFlags</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_INIT_QP_MINUS26_BIT_EXT</code> indicates if
setting non-zero <code>init_qp_minus26</code> in
<code>StdVideoH265PictureParameterSet</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_WEIGHTED_PRED_FLAG_SET_BIT_EXT</code> indicates
if enabling <code>weighted_pred_flag</code> in <code>StdVideoH265PpsFlags</code> is
supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_WEIGHTED_BIPRED_FLAG_SET_BIT_EXT</code>
indicates if enabling <code>weighted_bipred_flag</code> in
<code>StdVideoH265PpsFlags</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_LOG2_PARALLEL_MERGE_LEVEL_MINUS2_BIT_EXT</code>
indicates if setting non-zero value for
<code>log2_parallel_merge_level_minus2</code> in
<code>StdVideoH265PictureParameterSet</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_SIGN_DATA_HIDING_ENABLED_FLAG_SET_BIT_EXT</code>
indicates if enabling <code>sign_data_hiding_enabled_flag</code> in
<code>StdVideoH265PpsFlags</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_TRANSFORM_SKIP_ENABLED_FLAG_SET_BIT_EXT</code>
indicates if enabling <code>transform_skip_enabled_flag</code> in
<code>StdVideoH265PpsFlags</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_TRANSFORM_SKIP_ENABLED_FLAG_UNSET_BIT_EXT</code>
indicates if disabling <code>transform_skip_enabled_flag</code> in
<code>StdVideoH265PpsFlags</code> is supported.
Implementations <strong>must</strong> report at least one of
<code>VK_VIDEO_ENCODE_H265_STD_TRANSFORM_SKIP_ENABLED_FLAG_SET_BIT_EXT</code>
and
<code>VK_VIDEO_ENCODE_H265_STD_TRANSFORM_SKIP_ENABLED_FLAG_UNSET_BIT_EXT</code>
as supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_PPS_SLICE_CHROMA_QP_OFFSETS_PRESENT_FLAG_SET_BIT_EXT</code>
indicates if enabling <code>pps_slice_chroma_qp_offsets_present_flag</code> in
<code>StdVideoH265PpsFlags</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_TRANSQUANT_BYPASS_ENABLED_FLAG_SET_BIT_EXT</code>
indicates if enabling <code>transquant_bypass_enabled_flag</code> in
<code>StdVideoH265PpsFlags</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_CONSTRAINED_INTRA_PRED_FLAG_SET_BIT_EXT</code>
indicates if enabling <code>constrained_intra_pred_flag</code> in
<code>StdVideoH265PpsFlags</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_ENTROPY_CODING_SYNC_ENABLED_FLAG_SET_BIT_EXT</code>
indicates if enabling <code>entropy_coding_sync_enabled_flag</code> in
<code>StdVideoH265PpsFlags</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_DEBLOCKING_FILTER_OVERRIDE_ENABLED_FLAG_SET_BIT_EXT</code>
indicates if enabling <code>deblocking_filter_override_enabled_flag</code> in
<code>StdVideoH265PpsFlags</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_DEPENDENT_SLICE_SEGMENTS_ENABLED_FLAG_SET_BIT_EXT</code>
indicates if enabling <code>dependent_slice_segments_enabled_flag</code> in
<code>StdVideoH265PpsFlags</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_DEPENDENT_SLICE_SEGMENT_FLAG_SET_BIT_EXT</code>
indicates if enabling <code>dependent_slice_segment_flag</code> in
<code>StdVideoEncodeH265SliceHeaderFlags</code> is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_SLICE_QP_DELTA_BIT_EXT</code> indicates whether
the implementation supports using the application-provided value for
<code>StdVideoEncodeH265SliceSegmentHeader</code>::<code>slice_qp_delta</code> when that
value is identical across the slice segments of the encoded frame.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_DIFFERENT_SLICE_QP_DELTA_BIT_EXT</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoEncodeH265SliceSegmentHeader</code>::<code>slice_qp_delta</code> when that
value is different across the slice segments of the encoded frame.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeH265StdFlagsEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef VkFlags VkVideoEncodeH265StdFlagsEXT;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeH265StdFlagsEXT</code> is a bitmask type for setting a mask of
zero or more <a href="#VkVideoEncodeH265StdFlagBitsEXT">VkVideoEncodeH265StdFlagBitsEXT</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeH265CtbSizeFlagsEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef VkFlags VkVideoEncodeH265CtbSizeFlagsEXT;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeH265CtbSizeFlagsEXT</code> is a bitmask type for setting a mask
of zero or more <a href="#VkVideoEncodeH265CtbSizeFlagBitsEXT">VkVideoEncodeH265CtbSizeFlagBitsEXT</a>.
Implementations <strong>must</strong> set at least one of
<code>VkVideoEncodeH265CtbSizeFlagBitsEXT</code>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>may</strong> be set in
<a href="#VkVideoEncodeH265CapabilitiesEXT">VkVideoEncodeH265CapabilitiesEXT</a>::<code>ctbSizes</code>, indicating the CTB
sizes supported by the implementation, are:</p>
</div>
<div id="VkVideoEncodeH265CtbSizeFlagBitsEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef enum VkVideoEncodeH265CtbSizeFlagBitsEXT {
    VK_VIDEO_ENCODE_H265_CTB_SIZE_16_BIT_EXT = 0x00000001,
    VK_VIDEO_ENCODE_H265_CTB_SIZE_32_BIT_EXT = 0x00000002,
    VK_VIDEO_ENCODE_H265_CTB_SIZE_64_BIT_EXT = 0x00000004,
} VkVideoEncodeH265CtbSizeFlagBitsEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CTB_SIZE_16_BIT_EXT</code> specifies that a CTB size
of 16x16 is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CTB_SIZE_32_BIT_EXT</code> specifies that a CTB size
of 32x32 is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CTB_SIZE_64_BIT_EXT</code> specifies that a CTB size
of 64x64 is supported.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeH265TransformBlockSizeFlagsEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef VkFlags VkVideoEncodeH265TransformBlockSizeFlagsEXT;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeH265TransformBlockSizeFlagsEXT</code> is a bitmask type for
setting a mask of zero or more
<a href="#VkVideoEncodeH265TransformBlockSizeFlagBitsEXT">VkVideoEncodeH265TransformBlockSizeFlagBitsEXT</a>.
Implementations <strong>must</strong> set at least one of
<code>VkVideoEncodeH265TransformBlockSizeFlagBitsEXT</code>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>may</strong> be set in
<a href="#VkVideoEncodeH265CapabilitiesEXT">VkVideoEncodeH265CapabilitiesEXT</a>::<code>transformBlockSizes</code>,
indicating the transform block sizes supported by the implementation, are:</p>
</div>
<div id="VkVideoEncodeH265TransformBlockSizeFlagBitsEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef enum VkVideoEncodeH265TransformBlockSizeFlagBitsEXT {
    VK_VIDEO_ENCODE_H265_TRANSFORM_BLOCK_SIZE_4_BIT_EXT = 0x00000001,
    VK_VIDEO_ENCODE_H265_TRANSFORM_BLOCK_SIZE_8_BIT_EXT = 0x00000002,
    VK_VIDEO_ENCODE_H265_TRANSFORM_BLOCK_SIZE_16_BIT_EXT = 0x00000004,
    VK_VIDEO_ENCODE_H265_TRANSFORM_BLOCK_SIZE_32_BIT_EXT = 0x00000008,
} VkVideoEncodeH265TransformBlockSizeFlagBitsEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_H265_TRANSFORM_BLOCK_SIZE_4_BIT_EXT</code> specifies that
a transform block size of 4x4 is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_TRANSFORM_BLOCK_SIZE_8_BIT_EXT</code> specifies that
a transform block size of 8x8 is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_TRANSFORM_BLOCK_SIZE_16_BIT_EXT</code> specifies
that a transform block size of 16x16 is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_TRANSFORM_BLOCK_SIZE_32_BIT_EXT</code> specifies
that a transform block size of 32x32 is supported.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_h_265_encode_quality_level_properties"><a class="anchor" href="#_h_265_encode_quality_level_properties"></a>H.265 Encode Quality Level Properties</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When calling <a href="#vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR">vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR</a>
with <code>pVideoProfile-&gt;videoCodecOperation</code> specified as
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_EXT</code>, the
<a href="#VkVideoEncodeH265QualityLevelPropertiesEXT">VkVideoEncodeH265QualityLevelPropertiesEXT</a> structure <strong>can</strong> be included
in the <code>pNext</code> chain of the <a href="#VkVideoEncodeQualityLevelPropertiesKHR">VkVideoEncodeQualityLevelPropertiesKHR</a>
structure to retrieve additional video encode quality level properties
specific to H.265 encoding.</p>
</div>
<div class="paragraph">
<p>The <a href="#VkVideoEncodeH265QualityLevelPropertiesEXT">VkVideoEncodeH265QualityLevelPropertiesEXT</a> structure is defined
as:</p>
</div>
<div id="VkVideoEncodeH265QualityLevelPropertiesEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef struct VkVideoEncodeH265QualityLevelPropertiesEXT {
    VkStructureType                         sType;
    void*                                   pNext;
    VkVideoEncodeH265RateControlFlagsEXT    preferredRateControlFlags;
    uint32_t                                preferredGopFrameCount;
    uint32_t                                preferredIdrPeriod;
    uint32_t                                preferredConsecutiveBFrameCount;
    uint32_t                                preferredSubLayerCount;
    VkVideoEncodeH265QpEXT                  preferredConstantQp;
    uint32_t                                preferredMaxL0ReferenceCount;
    uint32_t                                preferredMaxL1ReferenceCount;
} VkVideoEncodeH265QualityLevelPropertiesEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>preferredRateControlFlags</code> is a bitmask of
<a href="#VkVideoEncodeH265RateControlFlagBitsEXT">VkVideoEncodeH265RateControlFlagBitsEXT</a> values indicating the
preferred flags to use for
<a href="#VkVideoEncodeH265RateControlInfoEXT">VkVideoEncodeH265RateControlInfoEXT</a>::<code>flags</code>.</p>
</li>
<li>
<p><code>preferredGopFrameCount</code> indicates the preferred value to use for
<a href="#VkVideoEncodeH265RateControlInfoEXT">VkVideoEncodeH265RateControlInfoEXT</a>::<code>gopFrameCount</code>.</p>
</li>
<li>
<p><code>preferredIdrPeriod</code> indicates the preferred value to use for
<a href="#VkVideoEncodeH265RateControlInfoEXT">VkVideoEncodeH265RateControlInfoEXT</a>::<code>idrPeriod</code>.</p>
</li>
<li>
<p><code>preferredConsecutiveBFrameCount</code> indicates the preferred value to
use for
<a href="#VkVideoEncodeH265RateControlInfoEXT">VkVideoEncodeH265RateControlInfoEXT</a>::<code>consecutiveBFrameCount</code>.</p>
</li>
<li>
<p><code>preferredSubLayerCount</code> indicates the preferred value to use for
<a href="#VkVideoEncodeH265RateControlInfoEXT">VkVideoEncodeH265RateControlInfoEXT</a>::<code>subLayerCount</code>.</p>
</li>
<li>
<p><code>preferredConstantQp</code> indicates the preferred values to use for
<a href="#VkVideoEncodeH265NaluSliceSegmentInfoEXT">VkVideoEncodeH265NaluSliceSegmentInfoEXT</a>::<code>constantQp</code> for
each picture type when using rate control mode
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR</code>.</p>
</li>
<li>
<p><code>preferredMaxL0ReferenceCount</code> indicates the preferred maximum
number of reference pictures to use in the reference list L0.</p>
</li>
<li>
<p><code>preferredMaxL1ReferenceCount</code> indicates the preferred maximum
number of reference pictures to use in the reference list L1.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265QualityLevelPropertiesEXT-sType-sType" href="#VUID-VkVideoEncodeH265QualityLevelPropertiesEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265QualityLevelPropertiesEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_QUALITY_LEVEL_PROPERTIES_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_h_265_encode_session"><a class="anchor" href="#_h_265_encode_session"></a>H.265 Encode Session</h3>
<div class="paragraph">
<p>Additional parameters can be specified when creating a video session with an
H.265 encode profile by including an instance of the
<a href="#VkVideoEncodeH265SessionCreateInfoEXT">VkVideoEncodeH265SessionCreateInfoEXT</a> structure in the <code>pNext</code>
chain of <a href="#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH265SessionCreateInfoEXT</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH265SessionCreateInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef struct VkVideoEncodeH265SessionCreateInfoEXT {
    VkStructureType         sType;
    const void*             pNext;
    VkBool32                useMaxLevelIdc;
    StdVideoH265LevelIdc    maxLevelIdc;
} VkVideoEncodeH265SessionCreateInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>useMaxLevelIdc</code> indicates whether the value of <code>maxLevelIdc</code>
should be used by the implementation.
When it is set to <code>VK_FALSE</code>, the implementation ignores the value
of <code>maxLevelIdc</code> and uses the value of
<a href="#VkVideoEncodeH265CapabilitiesEXT">VkVideoEncodeH265CapabilitiesEXT</a>::<code>maxLevelIdc</code>, as reported
by <a href="#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile.</p>
</li>
<li>
<p><code>maxLevelIdc</code> provides the upper bound on the H.265 level for the
video bitstreams produced by the created video session.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionCreateInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH265SessionCreateInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionCreateInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_SESSION_CREATE_INFO_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_encoder_h_265_video_session_parameters_object"><a class="anchor" href="#_encoder_h_265_video_session_parameters_object"></a>Encoder H.265 Video Session Parameters Object</h3>
<div class="paragraph">
<p>When creating a Video Session Parameters object, add a
<a href="#VkVideoEncodeH265SessionParametersCreateInfoEXT">VkVideoEncodeH265SessionParametersCreateInfoEXT</a> structure to the
<code>pNext</code> chain of the <a href="#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a>
structure passed to <a href="#vkCreateVideoSessionParametersKHR">vkCreateVideoSessionParametersKHR</a> in order to
specify the H.265-specific video encoder session parameters.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH265SessionParametersCreateInfoEXT</code> structure is
defined as:</p>
</div>
<div id="VkVideoEncodeH265SessionParametersCreateInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef struct VkVideoEncodeH265SessionParametersCreateInfoEXT {
    VkStructureType                                        sType;
    const void*                                            pNext;
    uint32_t                                               maxStdVPSCount;
    uint32_t                                               maxStdSPSCount;
    uint32_t                                               maxStdPPSCount;
    const VkVideoEncodeH265SessionParametersAddInfoEXT*    pParametersAddInfo;
} VkVideoEncodeH265SessionParametersCreateInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>maxStdVPSCount</code> is the maximum number of entries of type
<code>StdVideoH265VideoParameterSet</code> within
<code>VkVideoSessionParametersKHR</code>.</p>
</li>
<li>
<p><code>maxStdSPSCount</code> is the maximum number of entries of type
<code>StdVideoH265SequenceParameterSet</code> within
<code>VkVideoSessionParametersKHR</code>.</p>
</li>
<li>
<p><code>maxStdPPSCount</code> is the maximum number of entries of type
<code>StdVideoH265PictureParameterSet</code> within
<code>VkVideoSessionParametersKHR</code>.</p>
</li>
<li>
<p><code>pParametersAddInfo</code> is <code>NULL</code> or a pointer to a
<a href="#VkVideoEncodeH265SessionParametersAddInfoEXT">VkVideoEncodeH265SessionParametersAddInfoEXT</a> structure specifying
the video session parameters to add upon creation of this object.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When a <a href="#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> object contains
<code>maxStdVPSCount</code> <code>StdVideoH265VideoParameterSet</code> entries, no
additional <code>StdVideoH265VideoParameterSet</code> entries can be added to it,
and <code>VK_ERROR_TOO_MANY_OBJECTS</code> will be returned if an attempt is made
to add these entries.
When a <a href="#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> object contains
<code>maxStdSPSCount</code> <code>StdVideoH265SequenceParameterSet</code> entries, no
additional <code>StdVideoH265SequenceParameterSet</code> entries can be added to it,
and <code>VK_ERROR_TOO_MANY_OBJECTS</code> will be returned if an attempt is made
to add these entries.
When a <a href="#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> object contains
<code>maxStdPPSCount</code> <code>StdVideoH265PictureParameterSet</code> entries, no
additional <code>StdVideoH265PictureParameterSet</code> entries can be added to it,
and <code>VK_ERROR_TOO_MANY_OBJECTS</code> will be returned if an attempt is made
to add these entries.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersCreateInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH265SessionParametersCreateInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersCreateInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_SESSION_PARAMETERS_CREATE_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersCreateInfoEXT-pParametersAddInfo-parameter" href="#VUID-VkVideoEncodeH265SessionParametersCreateInfoEXT-pParametersAddInfo-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersCreateInfoEXT-pParametersAddInfo-parameter</span><br>
 If <code>pParametersAddInfo</code> is not <code>NULL</code>, <code>pParametersAddInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkVideoEncodeH265SessionParametersAddInfoEXT">VkVideoEncodeH265SessionParametersAddInfoEXT</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH265SessionParametersAddInfoEXT</code> structure is defined
as:</p>
</div>
<div id="VkVideoEncodeH265SessionParametersAddInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef struct VkVideoEncodeH265SessionParametersAddInfoEXT {
    VkStructureType                            sType;
    const void*                                pNext;
    uint32_t                                   stdVPSCount;
    const StdVideoH265VideoParameterSet*       pStdVPSs;
    uint32_t                                   stdSPSCount;
    const StdVideoH265SequenceParameterSet*    pStdSPSs;
    uint32_t                                   stdPPSCount;
    const StdVideoH265PictureParameterSet*     pStdPPSs;
} VkVideoEncodeH265SessionParametersAddInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>stdVPSCount</code> is the number of VPS elements in <code>pStdVPSs</code>.</p>
</li>
<li>
<p><code>pStdVPSs</code> is a pointer to an array of <code>stdVPSCount</code>
<code>StdVideoH265VideoParameterSet</code> structures representing H.265 video
parameter sets.</p>
</li>
<li>
<p><code>stdSPSCount</code> is the number of SPS elements in <code>pStdSPSs</code>.</p>
</li>
<li>
<p><code>pStdSPSs</code> is a pointer to an array of <code>stdSPSCount</code>
<code>StdVideoH265SequenceParameterSet</code> structures representing H.265
sequence parameter sets.</p>
</li>
<li>
<p><code>stdPPSCount</code> is the number of PPS elements in <code>pStdPPSs</code>.</p>
</li>
<li>
<p><code>pStdPPSs</code> is a pointer to an array of <code>stdPPSCount</code>
<code>StdVideoH265PictureParameterSet</code> structures representing H.265
picture parameter sets.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_SESSION_PARAMETERS_ADD_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-pStdVPSs-parameter" href="#VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-pStdVPSs-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-pStdVPSs-parameter</span><br>
 If <code>stdVPSCount</code> is not <code>0</code>, and <code>pStdVPSs</code> is not <code>NULL</code>, <code>pStdVPSs</code> <strong>must</strong> be a valid pointer to an array of <code>stdVPSCount</code> <code>StdVideoH265VideoParameterSet</code> values</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-pStdSPSs-parameter" href="#VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-pStdSPSs-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-pStdSPSs-parameter</span><br>
 If <code>stdSPSCount</code> is not <code>0</code>, and <code>pStdSPSs</code> is not <code>NULL</code>, <code>pStdSPSs</code> <strong>must</strong> be a valid pointer to an array of <code>stdSPSCount</code> <code>StdVideoH265SequenceParameterSet</code> values</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-pStdPPSs-parameter" href="#VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-pStdPPSs-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-pStdPPSs-parameter</span><br>
 If <code>stdPPSCount</code> is not <code>0</code>, and <code>pStdPPSs</code> is not <code>NULL</code>, <code>pStdPPSs</code> <strong>must</strong> be a valid pointer to an array of <code>stdPPSCount</code> <code>StdVideoH265PictureParameterSet</code> values</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-stdVPSCount-06438" href="#VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-stdVPSCount-06438"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-stdVPSCount-06438</span><br>

The values of <code>stdVPSCount</code>, <code>stdSPSCount</code> and <code>stdPPSCount</code>
<strong>must</strong> be less than or equal to the values of
<a href="#VkVideoEncodeH265SessionParametersCreateInfoEXT">VkVideoEncodeH265SessionParametersCreateInfoEXT</a>::<code>maxStdVPSCount</code>,
<a href="#VkVideoEncodeH265SessionParametersCreateInfoEXT">VkVideoEncodeH265SessionParametersCreateInfoEXT</a>:<code>maxStdSPSCount</code>,
and
<a href="#VkVideoEncodeH265SessionParametersCreateInfoEXT">VkVideoEncodeH265SessionParametersCreateInfoEXT</a>:<code>maxStdPPSCount</code>,
respectively</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-pStdVPSs-06439" href="#VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-pStdVPSs-06439"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-pStdVPSs-06439</span><br>

Each <code>StdVideoH265VideoParameterSet</code> entry in <code>pStdVPSs</code> <strong>must</strong>
have a unique H.265 VPS ID</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-pStdSPSs-06440" href="#VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-pStdSPSs-06440"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-pStdSPSs-06440</span><br>

Each <code>StdVideoH265SequenceParameterSet</code> entry in <code>pStdSPSs</code> <strong>must</strong>
have a unique H.265 VPS-SPS ID pair</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-pStdPPSs-06441" href="#VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-pStdPPSs-06441"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-pStdPPSs-06441</span><br>

Each <code>StdVideoH265PictureParameterSet</code> entry in <code>pStdPPSs</code> <strong>must</strong>
have a unique H.265 VPS-SPS-PPS ID tuple</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-None-06442" href="#VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-None-06442"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-None-06442</span><br>

Each entry to be added <strong>must</strong> have a unique, to the rest of the parameter
array entries and the existing parameters in the Video Session
Parameters Object that is being updated, VPS-SPS-PPS IDs</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-None-06443" href="#VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-None-06443"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-None-06443</span><br>

Parameter entries that already exist in Video Session Parameters object
with a particular VPS-SPS-PPS IDs <strong>must</strong> not be replaced nor updated</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-None-06444" href="#VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-None-06444"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-None-06444</span><br>

When creating a new object using a Video Session Parameters as a
template, the array&#8217;s parameters with the same VPS-SPS-PPS IDs as the
ones from the template take precedence</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-None-06445" href="#VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-None-06445"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersAddInfoEXT-None-06445</span><br>

VPS/SPS/PPS parameters <strong>must</strong> comply with the limits specified in
<a href="#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a> during Video Session creation</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH265SessionParametersGetInfoEXT</code> structure is defined
as:</p>
</div>
<div id="VkVideoEncodeH265SessionParametersGetInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef struct VkVideoEncodeH265SessionParametersGetInfoEXT {
    VkStructureType    sType;
    const void*        pNext;
    VkBool32           writeStdVPS;
    VkBool32           writeStdSPS;
    VkBool32           writeStdPPS;
    uint32_t           stdVPSId;
    uint32_t           stdSPSId;
    uint32_t           stdPPSId;
} VkVideoEncodeH265SessionParametersGetInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>writeStdVPS</code> indicates whether the encoded H.265 video parameter
set identified by <code>stdVPSId</code> is requested to be retrieved.</p>
</li>
<li>
<p><code>writeStdSPS</code> indicates whether the encoded H.265 sequence parameter
set identified by the pair constructed from <code>stdVPSId</code> and
<code>stdSPSId</code> is requested to be retrieved.</p>
</li>
<li>
<p><code>writeStdPPS</code> indicates whether the encoded H.265 picture parameter
set identified by the triplet constructed from <code>stdVPSId</code>,
<code>stdSPSId</code>, and <code>stdPPSId</code> is requested to be retrieved.</p>
</li>
<li>
<p><code>stdVPSId</code> specifies the H.265 video parameter set ID used to
identify the retrieved H.265 video, sequence, and/or picture parameter
set(s).</p>
</li>
<li>
<p><code>stdSPSId</code> specifies the H.265 sequence parameter set ID used to
identify the retrieved H.265 sequence and/or picture parameter set(s)
when <code>writeStdSPS</code> and/or <code>writeStdPPS</code> is set to <code>VK_TRUE</code>.</p>
</li>
<li>
<p><code>stdPPSId</code> specifies the H.265 picture parameter set ID used to
identify the retrieved H.265 picture parameter set when
<code>writeStdPPS</code> is set to <code>VK_TRUE</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When this structure is specified in the <code>pNext</code> chain of the
<a href="#VkVideoEncodeSessionParametersGetInfoKHR">VkVideoEncodeSessionParametersGetInfoKHR</a> structure passed to
<a href="#vkGetEncodedVideoSessionParametersKHR">vkGetEncodedVideoSessionParametersKHR</a>, the command will write encoded
parameter data to the output buffer in the following order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The H.265 video parameter set identified by <code>stdVPSId</code>, if
<code>writeStdVPS</code> is set to <code>VK_TRUE</code>.</p>
</li>
<li>
<p>The H.265 sequence parameter set identified by the pair constructed from
<code>stdVPSId</code> and <code>stdSPSId</code>, if <code>writeStdSPS</code> is set to
<code>VK_TRUE</code>.</p>
</li>
<li>
<p>The H.265 picture parameter set identified by the triplet constructed
from <code>stdVPSId</code>, <code>stdSPSId</code>, and <code>stdPPSId</code>, if
<code>writeStdPPS</code> is set to <code>VK_TRUE</code>.</p>
</li>
</ol>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersGetInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH265SessionParametersGetInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersGetInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_SESSION_PARAMETERS_GET_INFO_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH265SessionParametersFeedbackInfoEXT</code> structure is
defined as:</p>
</div>
<div id="VkVideoEncodeH265SessionParametersFeedbackInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef struct VkVideoEncodeH265SessionParametersFeedbackInfoEXT {
    VkStructureType    sType;
    void*              pNext;
    VkBool32           hasStdVPSOverrides;
    VkBool32           hasStdSPSOverrides;
    VkBool32           hasStdPPSOverrides;
} VkVideoEncodeH265SessionParametersFeedbackInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>hasStdVPSOverrides</code> indicates whether any of the parameters of the
requested H.265 video parameter set, if one was requested via
<a href="#VkVideoEncodeH265SessionParametersGetInfoEXT">VkVideoEncodeH265SessionParametersGetInfoEXT</a>::<code>writeStdVPS</code>,
were overridden by the implementation.</p>
</li>
<li>
<p><code>hasStdSPSOverrides</code> indicates whether any of the parameters of the
requested H.265 sequence parameter set, if one was requested via
<a href="#VkVideoEncodeH265SessionParametersGetInfoEXT">VkVideoEncodeH265SessionParametersGetInfoEXT</a>::<code>writeStdSPS</code>,
were overridden by the implementation.</p>
</li>
<li>
<p><code>hasStdPPSOverrides</code> indicates whether any of the parameters of the
requested H.265 picture parameter set, if one was requested via
<a href="#VkVideoEncodeH265SessionParametersGetInfoEXT">VkVideoEncodeH265SessionParametersGetInfoEXT</a>::<code>writeStdPPS</code>,
were overridden by the implementation.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersFeedbackInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH265SessionParametersFeedbackInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersFeedbackInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_SESSION_PARAMETERS_FEEDBACK_INFO_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_frame_encoding_2"><a class="anchor" href="#_frame_encoding_2"></a>Frame Encoding</h3>
<div class="paragraph">
<p>In order to encode a frame, add a <a href="#VkVideoEncodeH265PictureInfoEXT">VkVideoEncodeH265PictureInfoEXT</a>
structure to the <code>pNext</code> chain of the <a href="#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>
structure passed to the <a href="#vkCmdEncodeVideoKHR">vkCmdEncodeVideoKHR</a> command.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <a href="#VkVideoEncodeH265PictureInfoEXT">VkVideoEncodeH265PictureInfoEXT</a> structure representing a frame
encode operation is defined as:</p>
</div>
<div id="VkVideoEncodeH265PictureInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef struct VkVideoEncodeH265PictureInfoEXT {
    VkStructureType                                    sType;
    const void*                                        pNext;
    uint32_t                                           naluSliceSegmentEntryCount;
    const VkVideoEncodeH265NaluSliceSegmentInfoEXT*    pNaluSliceSegmentEntries;
    const StdVideoEncodeH265PictureInfo*               pStdPictureInfo;
} VkVideoEncodeH265PictureInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>naluSliceSegmentEntryCount</code> is the number of slice segment NALUs in
the frame.</p>
</li>
<li>
<p><code>pNaluSliceSegmentEntries</code> is a pointer to an array of
<a href="#VkVideoEncodeH265NaluSliceSegmentInfoEXT">VkVideoEncodeH265NaluSliceSegmentInfoEXT</a> structures specifying the
division of the current picture into slice segments and the properties
of these slice segments.</p>
</li>
<li>
<p><code>pStdPictureInfo</code> is a pointer to a
<code>StdVideoEncodeH265PictureInfo</code> structure specifying the syntax and
other codec-specific information from the H.265 specification,
associated with this picture.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265PictureInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH265PictureInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265PictureInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_PICTURE_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265PictureInfoEXT-pNaluSliceSegmentEntries-parameter" href="#VUID-VkVideoEncodeH265PictureInfoEXT-pNaluSliceSegmentEntries-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265PictureInfoEXT-pNaluSliceSegmentEntries-parameter</span><br>
 <code>pNaluSliceSegmentEntries</code> <strong>must</strong> be a valid pointer to an array of <code>naluSliceSegmentEntryCount</code> valid <a href="#VkVideoEncodeH265NaluSliceSegmentInfoEXT">VkVideoEncodeH265NaluSliceSegmentInfoEXT</a> structures</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265PictureInfoEXT-pStdPictureInfo-parameter" href="#VUID-VkVideoEncodeH265PictureInfoEXT-pStdPictureInfo-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265PictureInfoEXT-pStdPictureInfo-parameter</span><br>
 <code>pStdPictureInfo</code> <strong>must</strong> be a valid pointer to a valid <code>StdVideoEncodeH265PictureInfo</code> value</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265PictureInfoEXT-naluSliceSegmentEntryCount-arraylength" href="#VUID-VkVideoEncodeH265PictureInfoEXT-naluSliceSegmentEntryCount-arraylength"></a> <span class="vuid">VUID-VkVideoEncodeH265PictureInfoEXT-naluSliceSegmentEntryCount-arraylength</span><br>
 <code>naluSliceSegmentEntryCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <a href="#VkVideoEncodeH265NaluSliceSegmentInfoEXT">VkVideoEncodeH265NaluSliceSegmentInfoEXT</a> structure representing a
slice segment is defined as:</p>
</div>
<div id="VkVideoEncodeH265NaluSliceSegmentInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef struct VkVideoEncodeH265NaluSliceSegmentInfoEXT {
    VkStructureType                                sType;
    const void*                                    pNext;
    int32_t                                        constantQp;
    const StdVideoEncodeH265SliceSegmentHeader*    pStdSliceSegmentHeader;
} VkVideoEncodeH265NaluSliceSegmentInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>constantQp</code> is the QP to use for the slice segment if the current
rate control mode configured for the video session is
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR</code>.</p>
</li>
<li>
<p><code>pStdSliceSegmentHeader</code> is a pointer to a
<code>StdVideoEncodeH265SliceSegmentHeader</code> structure specifying the slice
segment header for the current slice segment.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265NaluSliceSegmentInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH265NaluSliceSegmentInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265NaluSliceSegmentInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_NALU_SLICE_SEGMENT_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265NaluSliceSegmentInfoEXT-pNext-pNext" href="#VUID-VkVideoEncodeH265NaluSliceSegmentInfoEXT-pNext-pNext"></a> <span class="vuid">VUID-VkVideoEncodeH265NaluSliceSegmentInfoEXT-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265NaluSliceSegmentInfoEXT-pStdSliceSegmentHeader-parameter" href="#VUID-VkVideoEncodeH265NaluSliceSegmentInfoEXT-pStdSliceSegmentHeader-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265NaluSliceSegmentInfoEXT-pStdSliceSegmentHeader-parameter</span><br>
 <code>pStdSliceSegmentHeader</code> <strong>must</strong> be a valid pointer to a valid <code>StdVideoEncodeH265SliceSegmentHeader</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <a href="#VkVideoEncodeH265DpbSlotInfoEXT">VkVideoEncodeH265DpbSlotInfoEXT</a> structure, representing a
reconstructed picture that is being used as a reference picture, is defined
as:</p>
</div>
<div id="VkVideoEncodeH265DpbSlotInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef struct VkVideoEncodeH265DpbSlotInfoEXT {
    VkStructureType                           sType;
    const void*                               pNext;
    const StdVideoEncodeH265ReferenceInfo*    pStdReferenceInfo;
} VkVideoEncodeH265DpbSlotInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pStdReferenceInfo</code> is a pointer to a
<code>StdVideoEncodeH265ReferenceInfo</code> structure specifying the syntax and
other codec-specific information from the H.265 specification,
associated with this reference picture.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265DpbSlotInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH265DpbSlotInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265DpbSlotInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_DPB_SLOT_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265DpbSlotInfoEXT-pStdReferenceInfo-parameter" href="#VUID-VkVideoEncodeH265DpbSlotInfoEXT-pStdReferenceInfo-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265DpbSlotInfoEXT-pStdReferenceInfo-parameter</span><br>
 <code>pStdReferenceInfo</code> <strong>must</strong> be a valid pointer to a valid <code>StdVideoEncodeH265ReferenceInfo</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rate_control_2"><a class="anchor" href="#_rate_control_2"></a>Rate control</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH265RateControlInfoEXT</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH265RateControlInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef struct VkVideoEncodeH265RateControlInfoEXT {
    VkStructureType                         sType;
    const void*                             pNext;
    VkVideoEncodeH265RateControlFlagsEXT    flags;
    uint32_t                                gopFrameCount;
    uint32_t                                idrPeriod;
    uint32_t                                consecutiveBFrameCount;
    uint32_t                                subLayerCount;
} VkVideoEncodeH265RateControlInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of
<a href="#VkVideoEncodeH265RateControlFlagBitsEXT">VkVideoEncodeH265RateControlFlagBitsEXT</a> specifying H.265 rate
control flags.</p>
</li>
<li>
<p><code>gopFrameCount</code> is the number of frames contained within the group
of pictures (GOP), starting from an intra frame and until the next intra
frame.
If it is set to 0, the implementation chooses a suitable value.
If it is set to <code>UINT32_MAX</code>, the GOP length is treated as infinite.</p>
</li>
<li>
<p><code>idrPeriod</code> is the interval, in terms of number of frames, between
two IDR frames.
If it is set to 0, the implementation chooses a suitable value.
If it is set to <code>UINT32_MAX</code>, the IDR period is treated as infinite.</p>
</li>
<li>
<p><code>consecutiveBFrameCount</code> is the number of consecutive B-frames
between I- and/or P-frames within the GOP.</p>
</li>
<li>
<p><code>subLayerCount</code> specifies the number of sub layers enabled in the
stream.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In order to provide H.265-specific stream rate control parameters, add a
<code>VkVideoEncodeH265RateControlInfoEXT</code> structure to the <code>pNext</code> chain
of the <a href="#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a> structure in the <code>pNext</code>
chain of the <a href="#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a> structure passed to the
<a href="#vkCmdControlVideoCodingKHR">vkCmdControlVideoCodingKHR</a> command.</p>
</div>
<div class="paragraph">
<p>The parameters from this structure act as a guidance for implementations to
apply various rate control heuristics.</p>
</div>
<div class="paragraph">
<p>It is possible to infer the picture type to be used when encoding a frame,
on the basis of the values provided for <code>consecutiveBFrameCount</code>,
<code>idrPeriod</code>, and <code>gopFrameCount</code>, but this inferred picture type
will not be used by implementations to override the picture type provided in
<a href="#vkCmdEncodeVideoKHR">vkCmdEncodeVideoKHR</a>.
Additionally, it is not required for the video session to be reset if the
inferred picture type does not match the actual picture type.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH265RateControlInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_RATE_CONTROL_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlInfoEXT-flags-parameter" href="#VUID-VkVideoEncodeH265RateControlInfoEXT-flags-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlInfoEXT-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkVideoEncodeH265RateControlFlagBitsEXT">VkVideoEncodeH265RateControlFlagBitsEXT</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in
<a href="#VkVideoEncodeH265RateControlInfoEXT">VkVideoEncodeH265RateControlInfoEXT</a>::<code>flags</code>, specifying H.265
rate control flags, are:</p>
</div>
<div id="VkVideoEncodeH265RateControlFlagBitsEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef enum VkVideoEncodeH265RateControlFlagBitsEXT {
    VK_VIDEO_ENCODE_H265_RATE_CONTROL_ATTEMPT_HRD_COMPLIANCE_BIT_EXT = 0x00000001,
    VK_VIDEO_ENCODE_H265_RATE_CONTROL_REGULAR_GOP_BIT_EXT = 0x00000002,
    VK_VIDEO_ENCODE_H265_RATE_CONTROL_REFERENCE_PATTERN_FLAT_BIT_EXT = 0x00000004,
    VK_VIDEO_ENCODE_H265_RATE_CONTROL_REFERENCE_PATTERN_DYADIC_BIT_EXT = 0x00000008,
    VK_VIDEO_ENCODE_H265_RATE_CONTROL_TEMPORAL_SUB_LAYER_PATTERN_DYADIC_BIT_EXT = 0x00000010,
} VkVideoEncodeH265RateControlFlagBitsEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_H265_RATE_CONTROL_ATTEMPT_HRD_COMPLIANCE_BIT_EXT</code>
specifies that rate control <strong>should</strong> attempt to produce an HRD compliant
bitstream.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_RATE_CONTROL_REGULAR_GOP_BIT_EXT</code> specifies
that the application intends to use a regular GOP structure according to
the parameters specified in the <code>gopFrameCount</code>, <code>idrPeriod</code>,
and <code>consecutiveBFrameCount</code> members of the
<a href="#VkVideoEncodeH265RateControlInfoEXT">VkVideoEncodeH265RateControlInfoEXT</a> structure.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_RATE_CONTROL_REFERENCE_PATTERN_FLAT_BIT_EXT</code>
specifies that the application intends to follow a flat reference
pattern.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_RATE_CONTROL_REFERENCE_PATTERN_DYADIC_BIT_EXT</code>
specifies that the application intends to follow a dyadic reference
pattern.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_RATE_CONTROL_TEMPORAL_SUB_LAYER_PATTERN_DYADIC_BIT_EXT</code>
specifies that the application intends to follow a dyadic temporal
sub-layer pattern.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeH265RateControlFlagsEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef VkFlags VkVideoEncodeH265RateControlFlagsEXT;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeH265RateControlFlagsEXT</code> is a bitmask type for setting a
mask of zero or more <a href="#VkVideoEncodeH265RateControlFlagBitsEXT">VkVideoEncodeH265RateControlFlagBitsEXT</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH265RateControlLayerInfoEXT</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH265RateControlLayerInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef struct VkVideoEncodeH265RateControlLayerInfoEXT {
    VkStructureType                  sType;
    const void*                      pNext;
    VkBool32                         useMinQp;
    VkVideoEncodeH265QpEXT           minQp;
    VkBool32                         useMaxQp;
    VkVideoEncodeH265QpEXT           maxQp;
    VkBool32                         useMaxFrameSize;
    VkVideoEncodeH265FrameSizeEXT    maxFrameSize;
} VkVideoEncodeH265RateControlLayerInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>useMinQp</code> indicates whether the values within <code>minQp</code> should be
used by the implementation.
When it is set to <code>VK_FALSE</code>, the implementation ignores the values
in <code>minQp</code> and chooses suitable values.</p>
</li>
<li>
<p><code>minQp</code> provides the lower bound on the QP values for each picture
type, to be used in rate control calculations.</p>
</li>
<li>
<p><code>useMaxQp</code> indicates whether the values within <code>maxQp</code> should be
used by the implementation.
When it is set to <code>VK_FALSE</code>, the implementation ignores the values
in <code>maxQp</code> and chooses suitable values.</p>
</li>
<li>
<p><code>maxQp</code> provides the upper bound on the QP values for each picture
type, to be used in rate control calculations.</p>
</li>
<li>
<p><code>useMaxFrameSize</code> indicates whether the values within
<code>maxFrameSize</code> should be used by the implementation.</p>
</li>
<li>
<p><code>maxFrameSize</code> provides the upper bound on the encoded frame size
for each picture type.
The implementation does not guarantee the encoded frame sizes will be
within the specified limits, however these limits <strong>may</strong> be used as a
guide in rate control calculations.
If enabled and not set properly, the <code>maxQp</code> limit may prevent the
implementation from respecting the <code>maxFrameSize</code> limit.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>H.265-specific per-layer rate control parameters <strong>must</strong> be specified by
adding a <code>VkVideoEncodeH265RateControlLayerInfoEXT</code> structure to the
<code>pNext</code> chain of each <a href="#VkVideoEncodeRateControlLayerInfoKHR">VkVideoEncodeRateControlLayerInfoKHR</a>
structure in a call to <a href="#vkCmdControlVideoCodingKHR">vkCmdControlVideoCodingKHR</a> command, when the
command buffer context has an active video encode H.265 session.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlLayerInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH265RateControlLayerInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlLayerInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_RATE_CONTROL_LAYER_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlLayerInfoEXT-minQp-parameter" href="#VUID-VkVideoEncodeH265RateControlLayerInfoEXT-minQp-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlLayerInfoEXT-minQp-parameter</span><br>
 <code>minQp</code> <strong>must</strong> be a valid <a href="#VkVideoEncodeH265QpEXT">VkVideoEncodeH265QpEXT</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlLayerInfoEXT-maxQp-parameter" href="#VUID-VkVideoEncodeH265RateControlLayerInfoEXT-maxQp-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlLayerInfoEXT-maxQp-parameter</span><br>
 <code>maxQp</code> <strong>must</strong> be a valid <a href="#VkVideoEncodeH265QpEXT">VkVideoEncodeH265QpEXT</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlLayerInfoEXT-maxFrameSize-parameter" href="#VUID-VkVideoEncodeH265RateControlLayerInfoEXT-maxFrameSize-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlLayerInfoEXT-maxFrameSize-parameter</span><br>
 <code>maxFrameSize</code> <strong>must</strong> be a valid <a href="#VkVideoEncodeH265FrameSizeEXT">VkVideoEncodeH265FrameSizeEXT</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH265QpEXT</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH265QpEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef struct VkVideoEncodeH265QpEXT {
    int32_t    qpI;
    int32_t    qpP;
    int32_t    qpB;
} VkVideoEncodeH265QpEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>qpI</code> is the QP to be used for I-frames.</p>
</li>
<li>
<p><code>qpP</code> is the QP to be used for P-frames.</p>
</li>
<li>
<p><code>qpB</code> is the QP to be used for B-frames.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH265FrameSizeEXT</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH265FrameSizeEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef struct VkVideoEncodeH265FrameSizeEXT {
    uint32_t    frameISize;
    uint32_t    framePSize;
    uint32_t    frameBSize;
} VkVideoEncodeH265FrameSizeEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>frameISize</code> is the size in bytes to be used for I-frames.</p>
</li>
<li>
<p><code>framePSize</code> is the size in bytes to be used for P-frames.</p>
</li>
<li>
<p><code>frameBSize</code> is the size in bytes to be used for B-frames.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH265GopRemainingFrameInfoEXT</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH265GopRemainingFrameInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_video_encode_h265
typedef struct VkVideoEncodeH265GopRemainingFrameInfoEXT {
    VkStructureType    sType;
    const void*        pNext;
    VkBool32           useGopRemainingFrames;
    uint32_t           gopRemainingI;
    uint32_t           gopRemainingP;
    uint32_t           gopRemainingB;
} VkVideoEncodeH265GopRemainingFrameInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>useGopRemainingFrames</code> indicates whether the implementation&#8217;s rate
control algorithm <strong>should</strong> use the values specified in
<code>gopRemainingI</code>, <code>gopRemainingP</code>, and <code>gopRemainingB</code>.
If <code>useGopRemainingFrames</code> is <code>VK_FALSE</code>, then the values of
<code>gopRemainingI</code>, <code>gopRemainingP</code>, and <code>gopRemainingB</code> are
ignored.</p>
</li>
<li>
<p><code>gopRemainingI</code> specifies the number of I-frames the
implementation&#8217;s rate control algorithm <strong>should</strong> assume to be remaining
in the GOP prior to executing the video encode operation.</p>
</li>
<li>
<p><code>gopRemainingP</code> specifies the number of P-frames the
implementation&#8217;s rate control algorithm <strong>should</strong> assume to be remaining
in the GOP prior to executing the video encode operation.</p>
</li>
<li>
<p><code>gopRemainingB</code> specifies the number of B-frames the
implementation&#8217;s rate control algorithm <strong>should</strong> assume to be remaining
in the GOP prior to executing the video encode operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Setting <code>useGopRemainingFrames</code> to <code>VK_TRUE</code> and including this
structure in the <code>pNext</code> chain of <a href="#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a> is only
mandatory if the
<a href="#VkVideoEncodeH265CapabilitiesEXT">VkVideoEncodeH265CapabilitiesEXT</a>::<code>requiresGopRemainingFrames</code>
reported for the used <a href="#video-profiles">video profile</a> is <code>VK_TRUE</code>.
However, implementations <strong>may</strong> use these remaining frame counts, when
specified, even when it is not required.
In particular, when the application does not use a regular GOP structure,
these values <strong>may</strong> provide additional guidance for the implementation&#8217;s rate
control algorithm.</p>
</div>
<div class="paragraph">
<p>The <a href="#VkVideoEncodeH265CapabilitiesEXT">VkVideoEncodeH265CapabilitiesEXT</a>::<code>prefersGopRemainingFrames</code>
capability is also used to indicate that the implementation&#8217;s rate control
algorithm <strong>may</strong> operate more accurately if the application specifies the
remaining frame counts using this structure.</p>
</div>
<div class="paragraph">
<p>As with other rate control guidance values, if the effective order and
number of frames encoded by the application are not in line with the
remaining frame counts specified in this structure at any given point, then
the behavior of the implementation&#8217;s rate control algorithm <strong>may</strong> deviate
from the one expected by the application.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265GopRemainingFrameInfoEXT-sType-sType" href="#VUID-VkVideoEncodeH265GopRemainingFrameInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265GopRemainingFrameInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_GOP_REMAINING_FRAME_INFO_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
    <!--
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
    -->
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Synchronization and Cache Control :: Vulkan Documentation Project</title>
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="apple-touch-icon" sizes="180x180" href="../../../_/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../_/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../_/img/favicon-16x16.png">
    <link rel="manifest" href="../../../_/static/site.webmanifest">
    <link rel="mask-icon" href="../../../_/img/safari-pinned-tab.svg" color="#a41e22">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../.."><img class="navbar-item" alt="Vulkan White Label" src="../../../_/Vulkan_Docs.svg" /></a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <label for="search-input"></label><input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <!-- <a class="navbar-item" href="#">Home</a> -->
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Specs</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../spec/latest/chapters/introduction.html">Vulkan 1.3</a>
            <a class="navbar-item" href="https://registry.khronos.org/OpenGL/specs/gl/GLSLangSpec.4.60.html">GLSL</a>
            <a class="navbar-item" href="../../../guide/latest/hlsl.html">HLSL</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Education</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../guide/latest/index.html">Vulkan Guide</a>
            <a class="navbar-item" href="../../../tutorial/latest/index.html">Vulkan Tutorial</a>
            <a class="navbar-item" href="../../../samples/latest/README.html">Vulkan Samples</a>
            <a class="navbar-item" href="https://www.youtube.com/c/vulkan">YouTube</a>
            <a class="navbar-item" href="https://vulkan.org">More Info at Vulkan.org</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Community</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="https://discord.gg/vulkan">Vulkan Discord</a>
            <a class="navbar-item" href="https://reddit.com/r/vulkan">Reddit</a>
            <a class="navbar-item" href="https://stackoverflow.com/questions/tagged/vulkan">Stack Overflow</a>
            <a class="navbar-item" href="https://fosstodon.org/@vulkan">Mastodon</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="spec" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Vulkan Specification and Proposals</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fundamentals.html">Fundamentals</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="initialization.html">Initialization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="devsandqueues.html">Devices and Queues</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cmdbuffers.html">Command Buffers</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="synchronization.html">Synchronization and Cache Control</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="renderpass.html">Render Pass</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="shaders.html">Shaders</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="pipelines.html">Pipelines</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="memory.html">Memory Allocation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="resources.html">Resource Creation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="samplers.html">Samplers</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="descriptorsets.html">Resource Descriptors</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="interfaces.html">Shader Interfaces</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="textures.html">Image Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fragmentdensitymapops.html">Fragment Density Map Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="queries.html">Queries</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="clears.html">Clear Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="copies.html">Copy Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="drawing.html">Drawing Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fxvertex.html">Fixed-Function Vertex Processing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="tessellation.html">Tessellation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="geometry.html">Geometry Shading</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_mesh_shader/mesh.html">Mesh Shading</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_HUAWEI_cluster_culling_shader/clusterculling.html">Cluster Culling Shading</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="vertexpostproc.html">Fixed-Function Vertex Post-Processing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="primsrast.html">Rasterization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fragops.html">Fragment Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="framebuffer.html">The Framebuffer</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dispatch.html">Dispatching Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_device_generated_commands/generatedcommands.html">Device-Generated Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="sparsemem.html">Sparse Resources</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_KHR_surface/wsi.html">Window System Integration (WSI)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_KHR_deferred_host_operations/deferred_host_operations.html">Deferred Host Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_EXT_private_data.html">Private Data</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="accelstructures.html">Acceleration Structures</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_EXT_opacity_micromap/micromaps.html">Micromap</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="raytraversal.html">Ray Traversal</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="raytracing.html">Ray Tracing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_memory_decompression.html">Memory Decompression</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="video_extensions.html">Video Coding</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_optical_flow/optical_flow.html">Optical Flow</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="executiongraphs.html">Execution Graphs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_low_latency2/low_latency2.html">Low Latency 2</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="extensions.html">Extending Vulkan</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="features.html">Features</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="limits.html">Limits</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="formats.html">Formats</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="capabilities.html">Additional Capabilities</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="debugging.html">Debugging</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/spirvenv.html">Vulkan Environment for SPIR-V</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/memorymodel.html">Memory Model</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/compressedtex.html">Compressed Image Formats</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/versions.html">Core Revisions (Informative)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/extensions.html">Layers &amp; Extensions (Informative)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/roadmap.html">Vulkan Roadmap Milestones</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/boilerplate.html">API Boilerplate</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/invariance.html">Invariance</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/glossary.html">Lexicon</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/credits.html">Credits (Informative)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../proposals/index.html">Vulkan Proposals</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Vulkan Roadmap</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/Roadmap.html">Vulkan Roadmap</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Extension Proposals</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_AMD_shader_early_and_late_fragment_tests.html">VK_AMD_shader_early_and_late_fragment_tests</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_attachment_feedback_loop_layout.html">VK_EXT_attachment_feedback_loop_layout</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_graphics_pipeline_library.html">VK_EXT_graphics_pipeline_library</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_image_2d_array_of_3d.html">VK_EXT_image_2d_array_of_3d</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_image_compression_control.html">VK_EXT_image_compression_control</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_metal_objects.html">VK_EXT_metal_objects</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_multisampled_render_to_single_sampled.html">VK_EXT_multisampled_render_to_single_sampled</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_non_seamless_cube_map.html">VK_EXT_non_seamless_cube_map</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_primitives_generated_query.html">VK_EXT_primitives_generated_query</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_rasterization_order_attachment_access.html">VK_EXT_rasterization_order_attachment_access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_shader_module_identifier.html">VK_EXT_shader_module_identifier</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_subpass_merge_feedback.html">VK_EXT_subpass_merge_feedback</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_GOOGLE_surfaceless_query.html">VK_GOOGLE_surfaceless_query</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_HUAWEI_invocation_mask.html">VK_HUAWEI_invocation_mask</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_KHR_dynamic_rendering.html">VK_KHR_dynamic_rendering</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_KHR_fragment_shader_barycentric.html">VK_KHR_fragment_shader_barycentric</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_KHR_fragment_shading_rate.html">VK_KHR_fragment_shading_rate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_KHR_shader_integer_dot_product.html">VK_KHR_shader_integer_dot_product</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_QCOM_image_processing.html">VK_QCOM_image_processing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_QCOM_tile_properties.html">VK_QCOM_tile_properties</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Extension Proposal Template</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/template.html">Proposal Template</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Vulkan Specification and Proposals</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../tutorial/latest/00_Introduction.html">Khronos Vulkan Tutorial</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../tutorial/latest/00_Introduction.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../guide/latest/index.html">Vulkan Guide</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../guide/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../samples/latest/README.html">Vulkan Samples</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../samples/latest/README.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../index.html">Vulkan Specification and Proposals</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Vulkan Specification and Proposals</a></li>
    <li><a href="synchronization.html">Synchronization and Cache Control</a></li>
  </ul>
</nav>
    <!--
  <div class="edit-this-page"><a href="https://github.com/KhronosGroup/Vulkan-Docs/edit/main/antora/modules/ROOT/pages/chapters/synchronization.adoc">Edit this Page</a></div>
      -->
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Synchronization and Cache Control</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Synchronization of access to resources is primarily the responsibility of
the application in Vulkan.
The order of execution of commands with respect to the host and other
commands on the device has few implicit guarantees, and needs to be
explicitly specified.
Memory caches and other optimizations are also explicitly managed, requiring
that the flow of data through the system is largely under application
control.</p>
</div>
<div class="paragraph">
<p>Whilst some implicit guarantees exist between commands, five explicit
synchronization mechanisms are exposed by Vulkan:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#synchronization-fences">Fences</a></dt>
<dd>
<p>Fences <strong>can</strong> be used to communicate to the host that execution of some
task on the device has completed, controlling resource access between
host and device.</p>
</dd>
<dt class="hdlist1"><a href="#synchronization-semaphores">Semaphores</a></dt>
<dd>
<p>Semaphores <strong>can</strong> be used to control resource access across multiple
queues.</p>
</dd>
<dt class="hdlist1"><a href="#synchronization-events">Events</a></dt>
<dd>
<p>Events provide a fine-grained synchronization primitive which <strong>can</strong> be
signaled either within a command buffer or by the host, and <strong>can</strong> be
waited upon within a command buffer or queried on the host.
Events <strong>can</strong> be used to control resource access within a single queue.</p>
</dd>
<dt class="hdlist1"><a href="#synchronization-pipeline-barriers">Pipeline Barriers</a></dt>
<dd>
<p>Pipeline barriers also provide synchronization control within a command
buffer, but at a single point, rather than with separate signal and wait
operations.
Pipeline barriers <strong>can</strong> be used to control resource access within a
single queue.</p>
</dd>
<dt class="hdlist1"><a href="renderpass.html#renderpass" class="xref page">Render Passes</a></dt>
<dd>
<p>Render passes provide a useful synchronization framework for most
rendering tasks, built upon the concepts in this chapter.
Many cases that would otherwise need an application to use other
synchronization primitives <strong>can</strong> be expressed more efficiently as part of
a render pass.
Render pass objects <strong>can</strong> be used to control resource access within a
single queue.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="synchronization-dependencies"><a class="anchor" href="#synchronization-dependencies"></a>Execution and Memory Dependencies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An <em>operation</em> is an arbitrary amount of work to be executed on the host, a
device, or an external entity such as a presentation engine.
Synchronization commands introduce explicit <em>execution dependencies</em>, and
<em>memory dependencies</em> between two sets of operations defined by the
command&#8217;s two <em>synchronization scopes</em>.</p>
</div>
<div id="synchronization-dependencies-scopes" class="paragraph">
<p>The synchronization scopes define which other operations a synchronization
command is able to create execution dependencies with.
Any type of operation that is not in a synchronization command&#8217;s
synchronization scopes will not be included in the resulting dependency.
For example, for many synchronization commands, the synchronization scopes
<strong>can</strong> be limited to just operations executing in specific
<a href="#synchronization-pipeline-stages">pipeline stages</a>, which allows other
pipeline stages to be excluded from a dependency.
Other scoping options are possible, depending on the particular command.</p>
</div>
<div id="synchronization-dependencies-execution" class="paragraph">
<p>An <em>execution dependency</em> is a guarantee that for two sets of operations,
the first set <strong>must</strong> <em>happen-before</em> the second set.
If an operation happens-before another operation, then the first operation
<strong>must</strong> complete before the second operation is initiated.
More precisely:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Let <strong>Ops<sub>1</sub></strong> and <strong>Ops<sub>2</sub></strong> be separate sets of operations.</p>
</li>
<li>
<p>Let <strong>Sync</strong> be a synchronization command.</p>
</li>
<li>
<p>Let <strong>Scope<sub>1st</sub></strong> and <strong>Scope<sub>2nd</sub></strong> be the synchronization scopes of
<strong>Sync</strong>.</p>
</li>
<li>
<p>Let <strong>ScopedOps<sub>1</sub></strong> be the intersection of sets <strong>Ops<sub>1</sub></strong> and
<strong>Scope<sub>1st</sub></strong>.</p>
</li>
<li>
<p>Let <strong>ScopedOps<sub>2</sub></strong> be the intersection of sets <strong>Ops<sub>2</sub></strong> and
<strong>Scope<sub>2nd</sub></strong>.</p>
</li>
<li>
<p>Submitting <strong>Ops<sub>1</sub></strong>, <strong>Sync</strong> and <strong>Ops<sub>2</sub></strong> for execution, in that order,
will result in execution dependency <strong>ExeDep</strong> between <strong>ScopedOps<sub>1</sub></strong> and
<strong>ScopedOps<sub>2</sub></strong>.</p>
</li>
<li>
<p>Execution dependency <strong>ExeDep</strong> guarantees that <strong>ScopedOps<sub>1</sub></strong>
happen-before <strong>ScopedOps<sub>2</sub></strong>.</p>
</li>
</ul>
</div>
<div id="synchronization-dependencies-chains" class="paragraph">
<p>An <em>execution dependency chain</em> is a sequence of execution dependencies that
form a happens-before relation between the first dependency&#8217;s <strong>ScopedOps<sub>1</sub></strong>
and the final dependency&#8217;s <strong>ScopedOps<sub>2</sub></strong>.
For each consecutive pair of execution dependencies, a chain exists if the
intersection of <strong>Scope<sub>2nd</sub></strong> in the first dependency and <strong>Scope<sub>1st</sub></strong> in the
second dependency is not an empty set.
The formation of a single execution dependency from an execution dependency
chain can be described by substituting the following in the description of
execution dependencies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Let <strong>Sync</strong> be a set of synchronization commands that generate an
execution dependency chain.</p>
</li>
<li>
<p>Let <strong>Scope<sub>1st</sub></strong> be the first synchronization scope of the first command
in <strong>Sync</strong>.</p>
</li>
<li>
<p>Let <strong>Scope<sub>2nd</sub></strong> be the second synchronization scope of the last command
in <strong>Sync</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Execution dependencies alone are not sufficient to guarantee that values
resulting from writes in one set of operations <strong>can</strong> be read from another set
of operations.</p>
</div>
<div id="synchronization-dependencies-available-and-visible" class="paragraph">
<p>Three additional types of operations are used to control memory access.
<em>Availability operations</em> cause the values generated by specified memory
write accesses to become <em>available</em> to a memory domain for future access.
Any available value remains available until a subsequent write to the same
memory location occurs (whether it is made available or not) or the memory
is freed.
<em>Memory domain operations</em> cause writes that are available to a source
memory domain to become available to a destination memory domain (an example
of this is making writes available to the host domain available to the
device domain).
<em>Visibility operations</em> cause values available to a memory domain to become
<em>visible</em> to specified memory accesses.</p>
</div>
<div class="paragraph">
<p>Availability, visibility, memory domains, and memory domain operations are
formally defined in the <a href="../appendices/memorymodel.html#memory-model-availability-visibility" class="xref page">Availability and Visibility</a> section of the <a href="../appendices/memorymodel.html#memory-model" class="xref page">Memory Model</a> chapter.
Which API operations perform each of these operations is defined in
<a href="../appendices/memorymodel.html#memory-model-vulkan-availability-visibility" class="xref page">Availability, Visibility, and Domain Operations</a>.</p>
</div>
<div id="synchronization-dependencies-memory" class="paragraph">
<p>A <em>memory dependency</em> is an execution dependency which includes availability
and visibility operations such that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first set of operations happens-before the availability operation.</p>
</li>
<li>
<p>The availability operation happens-before the visibility operation.</p>
</li>
<li>
<p>The visibility operation happens-before the second set of operations.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once written values are made visible to a particular type of memory access,
they <strong>can</strong> be read or written by that type of memory access.
Most synchronization commands in Vulkan define a memory dependency.</p>
</div>
<div id="synchronization-dependencies-access-scopes" class="paragraph">
<p>The specific memory accesses that are made available and visible are defined
by the <em>access scopes</em> of a memory dependency.
Any type of access that is in a memory dependency&#8217;s first access scope and
occurs in <strong>ScopedOps<sub>1</sub></strong> is made available.
Any type of access that is in a memory dependency&#8217;s second access scope and
occurs in <strong>ScopedOps<sub>2</sub></strong> has any available writes made visible to it.
Any type of operation that is not in a synchronization command&#8217;s access
scopes will not be included in the resulting dependency.</p>
</div>
<div class="paragraph">
<p>A memory dependency enforces availability and visibility of memory accesses
and execution order between two sets of operations.
Adding to the description of <a href="#synchronization-dependencies-chains">execution dependency chains</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Let <strong>MemOps<sub>1</sub></strong> be the set of memory accesses performed by
<strong>ScopedOps<sub>1</sub></strong>.</p>
</li>
<li>
<p>Let <strong>MemOps<sub>2</sub></strong> be the set of memory accesses performed by
<strong>ScopedOps<sub>2</sub></strong>.</p>
</li>
<li>
<p>Let <strong>AccessScope<sub>1st</sub></strong> be the first access scope of the first command in
the <strong>Sync</strong> chain.</p>
</li>
<li>
<p>Let <strong>AccessScope<sub>2nd</sub></strong> be the second access scope of the last command in
the <strong>Sync</strong> chain.</p>
</li>
<li>
<p>Let <strong>ScopedMemOps<sub>1</sub></strong> be the intersection of sets <strong>MemOps<sub>1</sub></strong> and
<strong>AccessScope<sub>1st</sub></strong>.</p>
</li>
<li>
<p>Let <strong>ScopedMemOps<sub>2</sub></strong> be the intersection of sets <strong>MemOps<sub>2</sub></strong> and
<strong>AccessScope<sub>2nd</sub></strong>.</p>
</li>
<li>
<p>Submitting <strong>Ops<sub>1</sub></strong>, <strong>Sync</strong>, and <strong>Ops<sub>2</sub></strong> for execution, in that order,
will result in a memory dependency <strong>MemDep</strong> between <strong>ScopedOps<sub>1</sub></strong> and
<strong>ScopedOps<sub>2</sub></strong>.</p>
</li>
<li>
<p>Memory dependency <strong>MemDep</strong> guarantees that:</p>
<div class="ulist">
<ul>
<li>
<p>Memory writes in <strong>ScopedMemOps<sub>1</sub></strong> are made available.</p>
</li>
<li>
<p>Available memory writes, including those from <strong>ScopedMemOps<sub>1</sub></strong>, are
made visible to <strong>ScopedMemOps<sub>2</sub></strong>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Execution and memory dependencies are used to solve data hazards, i.e. to
ensure that read and write operations occur in a well-defined order.
Write-after-read hazards can be solved with just an execution dependency,
but read-after-write and write-after-write hazards need appropriate memory
dependencies to be included between them.
If an application does not include dependencies to solve these hazards, the
results and execution orders of memory accesses are <strong>undefined</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="synchronization-image-layout-transitions"><a class="anchor" href="#synchronization-image-layout-transitions"></a>Image Layout Transitions</h3>
<div class="paragraph">
<p>Image subresources <strong>can</strong> be transitioned from one <a href="resources.html#resources-image-layouts" class="xref page">layout</a> to another as part of a <a href="#synchronization-dependencies-memory">memory dependency</a> (e.g. by using an
<a href="#synchronization-image-memory-barriers">image memory barrier</a>).
When a layout transition is specified in a memory dependency, it
happens-after the availability operations in the memory dependency, and
happens-before the visibility operations.
Image layout transitions <strong>may</strong> perform read and write accesses on all memory
bound to the image subresource range, so applications <strong>must</strong> ensure that all
memory writes have been made
<a href="#synchronization-dependencies-available-and-visible">available</a> before a
layout transition is executed.
Available memory is automatically made visible to a layout transition, and
writes performed by a layout transition are automatically made available.</p>
</div>
<div class="paragraph">
<p>Layout transitions always apply to a particular image subresource range, and
specify both an old layout and new layout.
The old layout <strong>must</strong> either be <code>VK_IMAGE_LAYOUT_UNDEFINED</code>, or match the
current layout of the image subresource range.
If the old layout matches the current layout of the image subresource range,
the transition preserves the contents of that range.
If the old layout is <code>VK_IMAGE_LAYOUT_UNDEFINED</code>, the contents of that
range <strong>may</strong> be discarded.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Image layout transitions with <code>VK_IMAGE_LAYOUT_UNDEFINED</code> allow the
implementation to discard the image subresource range, which can provide
performance or power benefits.
Tile-based architectures may be able to avoid flushing tile data to memory,
and immediate style renderers may be able to achieve fast metadata clears to
reinitialize frame buffer compression state, or similar.</p>
</div>
<div class="paragraph">
<p>If the contents of an attachment are not needed after a render pass
completes, then applications <strong>should</strong> use
<code>VK_ATTACHMENT_STORE_OP_DONT_CARE</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As image layout transitions <strong>may</strong> perform read and write accesses on the
memory bound to the image, if the image subresource affected by the layout
transition is bound to peer memory for any device in the current device mask
then the memory heap the bound memory comes from <strong>must</strong> support the
<code>VK_PEER_MEMORY_FEATURE_GENERIC_SRC_BIT</code> and
<code>VK_PEER_MEMORY_FEATURE_GENERIC_DST_BIT</code> capabilities as returned by
<a href="memory.html#vkGetDeviceGroupPeerMemoryFeatures" class="xref page">vkGetDeviceGroupPeerMemoryFeatures</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications <strong>must</strong> ensure that layout transitions happen-after all
operations accessing the image with the old layout, and happen-before any
operations that will access the image with the new layout.
Layout transitions are potentially read/write operations, so not defining
appropriate memory dependencies to guarantee this will result in a data
race.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Image layout transitions interact with <a href="resources.html#resources-memory-aliasing" class="xref page">memory aliasing</a>.</p>
</div>
<div id="synchronization-image-barrier-layout-transition-order" class="paragraph">
<p>Layout transitions that are performed via image memory barriers execute in
their entirety in <a href="#synchronization-submission-order">submission order</a>,
relative to other image layout transitions submitted to the same queue,
including those performed by <a href="renderpass.html#renderpass" class="xref page">render passes</a>.
In effect there is an implicit execution dependency from each such layout
transition to all layout transitions previously submitted to the same queue.</p>
</div>
<div class="paragraph">
<p>The image layout of each image subresource of a depth/stencil image created
with <code>VK_IMAGE_CREATE_SAMPLE_LOCATIONS_COMPATIBLE_DEPTH_BIT_EXT</code> is
dependent on the last sample locations used to render to the image
subresource as a depth/stencil attachment, thus when the <code>image</code> member
of an <a href="#synchronization-image-memory-barriers">image memory barrier</a> is an
image created with this flag the application <strong>can</strong> chain a
<a href="primsrast.html#VkSampleLocationsInfoEXT" class="xref page">VkSampleLocationsInfoEXT</a> structure to the <code>pNext</code> chain of
<a href="#VkImageMemoryBarrier2">VkImageMemoryBarrier2</a> or
<a href="#VkImageMemoryBarrier">VkImageMemoryBarrier</a> to specify the sample locations to use during any
image layout transition.</p>
</div>
<div class="paragraph">
<p>If the <code>VkSampleLocationsInfoEXT</code> structure does not match the sample
location state last used to render to the image subresource range specified
by <code>subresourceRange</code>, or if no <code>VkSampleLocationsInfoEXT</code> structure
is present, then the contents of the given image subresource range becomes
<strong>undefined</strong> as if <code>oldLayout</code> would equal
<code>VK_IMAGE_LAYOUT_UNDEFINED</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-pipeline-stages"><a class="anchor" href="#synchronization-pipeline-stages"></a>Pipeline Stages</h3>
<div class="paragraph">
<p>The work performed by an <a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">action command</a> consists of multiple operations, which are performed as a sequence
of logically independent steps known as <em>pipeline stages</em>.
The exact pipeline stages executed depend on the particular command that is
used, and current command buffer state when the command was recorded.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Operations performed by synchronization commands (e.g.
<a href="#synchronization-dependencies-available-and-visible">availability and visibility operations</a>) are not executed by a defined pipeline stage.
However other commands can still synchronize with them by using the
<a href="#synchronization-dependencies-scopes">synchronization scopes</a> to create a
<a href="#synchronization-dependencies-chains">dependency chain</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Execution of operations across pipeline stages <strong>must</strong> adhere to
<a href="#synchronization-implicit">implicit ordering guarantees</a>, particularly
including <a href="#synchronization-pipeline-stages-order">pipeline stage order</a>.
Otherwise, execution across pipeline stages <strong>may</strong> overlap or execute out of
order with regards to other stages, unless otherwise enforced by an
execution dependency.</p>
</div>
<div class="paragraph">
<p>Several of the synchronization commands include pipeline stage parameters,
restricting the <a href="#synchronization-dependencies-scopes">synchronization scopes</a> for that command to just those stages.
This allows fine grained control over the exact execution dependencies and
accesses performed by action commands.
Implementations <strong>should</strong> use these pipeline stages to avoid unnecessary
stalls or cache flushing.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in a <a href="#VkPipelineStageFlags2">VkPipelineStageFlags2</a> mask, specifying
stages of execution, are:</p>
</div>
<div id="VkPipelineStageFlagBits2" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
// Flag bits for VkPipelineStageFlagBits2
typedef VkFlags64 VkPipelineStageFlagBits2;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_NONE = 0ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_NONE_KHR = 0ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_TOP_OF_PIPE_BIT = 0x00000001ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_TOP_OF_PIPE_BIT_KHR = 0x00000001ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT = 0x00000002ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT_KHR = 0x00000002ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_VERTEX_INPUT_BIT = 0x00000004ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_VERTEX_INPUT_BIT_KHR = 0x00000004ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_VERTEX_SHADER_BIT = 0x00000008ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_VERTEX_SHADER_BIT_KHR = 0x00000008ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT = 0x00000010ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT_KHR = 0x00000010ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT = 0x00000020ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT_KHR = 0x00000020ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT = 0x00000040ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT_KHR = 0x00000040ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT = 0x00000080ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT_KHR = 0x00000080ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT = 0x00000100ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT_KHR = 0x00000100ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT = 0x00000200ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT_KHR = 0x00000200ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT = 0x00000400ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT_KHR = 0x00000400ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_COMPUTE_SHADER_BIT = 0x00000800ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_COMPUTE_SHADER_BIT_KHR = 0x00000800ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_ALL_TRANSFER_BIT = 0x00001000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_ALL_TRANSFER_BIT_KHR = 0x00001000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_TRANSFER_BIT = 0x00001000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_TRANSFER_BIT_KHR = 0x00001000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_BOTTOM_OF_PIPE_BIT = 0x00002000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_BOTTOM_OF_PIPE_BIT_KHR = 0x00002000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_HOST_BIT = 0x00004000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_HOST_BIT_KHR = 0x00004000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT = 0x00008000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT_KHR = 0x00008000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT = 0x00010000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT_KHR = 0x00010000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_COPY_BIT = 0x100000000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_COPY_BIT_KHR = 0x100000000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_RESOLVE_BIT = 0x200000000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_RESOLVE_BIT_KHR = 0x200000000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_BLIT_BIT = 0x400000000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_BLIT_BIT_KHR = 0x400000000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_CLEAR_BIT = 0x800000000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_CLEAR_BIT_KHR = 0x800000000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_INDEX_INPUT_BIT = 0x1000000000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_INDEX_INPUT_BIT_KHR = 0x1000000000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_VERTEX_ATTRIBUTE_INPUT_BIT = 0x2000000000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_VERTEX_ATTRIBUTE_INPUT_BIT_KHR = 0x2000000000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_PRE_RASTERIZATION_SHADERS_BIT = 0x4000000000ULL;
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_PRE_RASTERIZATION_SHADERS_BIT_KHR = 0x4000000000ULL;
// Provided by VK_KHR_video_decode_queue
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR = 0x04000000ULL;
#ifdef VK_ENABLE_BETA_EXTENSIONS
// Provided by VK_KHR_video_encode_queue
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR = 0x08000000ULL;
#endif
// Provided by VK_KHR_synchronization2 with VK_EXT_transform_feedback
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT = 0x01000000ULL;
// Provided by VK_KHR_synchronization2 with VK_EXT_conditional_rendering
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT = 0x00040000ULL;
// Provided by VK_KHR_synchronization2 with VK_NV_device_generated_commands
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_COMMAND_PREPROCESS_BIT_NV = 0x00020000ULL;
// Provided by VK_KHR_fragment_shading_rate with VK_KHR_synchronization2
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR = 0x00400000ULL;
// Provided by VK_KHR_synchronization2 with VK_NV_shading_rate_image
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_SHADING_RATE_IMAGE_BIT_NV = 0x00400000ULL;
// Provided by VK_KHR_acceleration_structure with VK_KHR_synchronization2
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR = 0x02000000ULL;
// Provided by VK_KHR_ray_tracing_pipeline with VK_KHR_synchronization2
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR = 0x00200000ULL;
// Provided by VK_KHR_synchronization2 with VK_NV_ray_tracing
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_NV = 0x00200000ULL;
// Provided by VK_KHR_synchronization2 with VK_NV_ray_tracing
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_NV = 0x02000000ULL;
// Provided by VK_KHR_synchronization2 with VK_EXT_fragment_density_map
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT = 0x00800000ULL;
// Provided by VK_KHR_synchronization2 with VK_NV_mesh_shader
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_NV = 0x00080000ULL;
// Provided by VK_KHR_synchronization2 with VK_NV_mesh_shader
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_NV = 0x00100000ULL;
// Provided by VK_KHR_synchronization2 with VK_EXT_mesh_shader
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT = 0x00080000ULL;
// Provided by VK_KHR_synchronization2 with VK_EXT_mesh_shader
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT = 0x00100000ULL;
// Provided by VK_HUAWEI_subpass_shading
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI = 0x8000000000ULL;
// Provided by VK_HUAWEI_subpass_shading
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_SUBPASS_SHADING_BIT_HUAWEI = 0x8000000000ULL;
// Provided by VK_HUAWEI_invocation_mask
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI = 0x10000000000ULL;
// Provided by VK_KHR_ray_tracing_maintenance1 with VK_KHR_synchronization2
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR = 0x10000000ULL;
// Provided by VK_EXT_opacity_micromap
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT = 0x40000000ULL;
// Provided by VK_HUAWEI_cluster_culling_shader
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_CLUSTER_CULLING_SHADER_BIT_HUAWEI = 0x20000000000ULL;
// Provided by VK_NV_optical_flow
static const VkPipelineStageFlagBits2 VK_PIPELINE_STAGE_2_OPTICAL_FLOW_BIT_NV = 0x20000000ULL;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkPipelineStageFlagBits2KHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_synchronization2
typedef VkPipelineStageFlagBits2 VkPipelineStageFlagBits2KHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_2_NONE</code> specifies no stages of execution.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code> specifies the stage of the
pipeline where indirect command parameters are consumed.
This stage also includes reading commands written by
<a href="VK_NV_device_generated_commands/generatedcommands.html#vkCmdPreprocessGeneratedCommandsNV" class="xref page">vkCmdPreprocessGeneratedCommandsNV</a>.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code> specifies the task shader
stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code> specifies the mesh shader
stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_INDEX_INPUT_BIT</code> specifies the stage of the
pipeline where index buffers are consumed.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_VERTEX_ATTRIBUTE_INPUT_BIT</code> specifies the stage
of the pipeline where vertex buffers are consumed.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_VERTEX_INPUT_BIT</code> is equivalent to the logical
OR of:</p>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_2_INDEX_INPUT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_VERTEX_ATTRIBUTE_INPUT_BIT</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_VERTEX_SHADER_BIT</code> specifies the vertex shader
stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code> specifies the
tessellation control shader stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code> specifies
the tessellation evaluation shader stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code> specifies the geometry
shader stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_PRE_RASTERIZATION_SHADERS_BIT</code> is equivalent to
specifying all supported
<a href="pipelines.html#pipelines-graphics-subsets-pre-rasterization" class="xref page">pre-rasterization shader    stages</a>:</p>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_2_VERTEX_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_CLUSTER_CULLING_SHADER_BIT_HUAWEI</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code> specifies the fragment
shader stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code> specifies the stage
of the pipeline where early fragment tests (depth and stencil tests
before fragment shading) are performed.
This stage also includes <a href="renderpass.html#renderpass-load-operations" class="xref page">render pass load    operations</a> for framebuffer attachments with a depth/stencil format.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code> specifies the stage of
the pipeline where late fragment tests (depth and stencil tests after
fragment shading) are performed.
This stage also includes <a href="renderpass.html#renderpass-store-operations" class="xref page">render pass    store operations</a> for framebuffer attachments with a depth/stencil
format.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code> specifies the
stage of the pipeline where final color values are output from the
pipeline.
This stage includes <a href="framebuffer.html#framebuffer-blending" class="xref page">blending</a>,
<a href="framebuffer.html#framebuffer-logicop" class="xref page">logic operations</a>, render pass
<a href="renderpass.html#renderpass-load-operations" class="xref page">load</a> and <a href="renderpass.html#renderpass-store-operations" class="xref page">    store</a> operations for color attachments,
<a href="renderpass.html#renderpass-resolve-operations" class="xref page">render pass multisample resolve    operations</a>, and <a href="clears.html#vkCmdClearAttachments" class="xref page">vkCmdClearAttachments</a>.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_COMPUTE_SHADER_BIT</code> specifies the compute
shader stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_HOST_BIT</code> specifies a pseudo-stage indicating
execution on the host of reads/writes of device memory.
This stage is not invoked by any commands recorded in a command buffer.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_COPY_BIT</code> specifies the execution of all
<a href="copies.html#copies" class="xref page">copy commands</a>, including <a href="queries.html#vkCmdCopyQueryPoolResults" class="xref page">vkCmdCopyQueryPoolResults</a>.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_BLIT_BIT</code> specifies the execution of
<a href="copies.html#vkCmdBlitImage" class="xref page">vkCmdBlitImage</a>.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_RESOLVE_BIT</code> specifies the execution of
<a href="copies.html#vkCmdResolveImage" class="xref page">vkCmdResolveImage</a>.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_CLEAR_BIT</code> specifies the execution of
<a href="clears.html#clears" class="xref page">clear commands</a>, with the exception of
<a href="clears.html#vkCmdClearAttachments" class="xref page">vkCmdClearAttachments</a>.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_ALL_TRANSFER_BIT</code> is equivalent to specifying
all of:</p>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_2_COPY_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_BLIT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_RESOLVE_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_CLEAR_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code> specifies the
execution of the ray tracing shader stages.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code> specifies
the execution of <a href="accelstructures.html#acceleration-structure" class="xref page">acceleration structure    commands</a> or <a href="accelstructures.html#acceleration-structure-copying" class="xref page">acceleration structure    copy commands</a>.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code> specifies
the execution of <a href="accelstructures.html#acceleration-structure-copying" class="xref page">acceleration    structure copy commands</a>.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code> specifies the execution of
all graphics pipeline stages, and is equivalent to the logical OR of:</p>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_VERTEX_INPUT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_VERTEX_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_CLUSTER_CULLING_SHADER_BIT_HUAWEI</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code> specifies all operations
performed by all commands supported on the queue it is used with.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT</code> specifies the
stage of the pipeline where the predicate of conditional rendering is
consumed.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code> specifies the stage
of the pipeline where vertex attribute output values are written to the
transform feedback buffers.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_COMMAND_PREPROCESS_BIT_NV</code> specifies the stage
of the pipeline where device-side generation of commands via
<a href="VK_NV_device_generated_commands/generatedcommands.html#vkCmdPreprocessGeneratedCommandsNV" class="xref page">vkCmdPreprocessGeneratedCommandsNV</a> is handled.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code>
    specifies the stage of the pipeline where the
    <a href="primsrast.html#primsrast-fragment-shading-rate-attachment" class="xref page">fragment shading rate    attachment</a>
or
    <a href="primsrast.html#primsrast-shading-rate-image" class="xref page">shading rate image</a>
    is read to determine the fragment shading rate for portions of a
    rasterized primitive.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code> specifies the
stage of the pipeline where the fragment density map is read to
<a href="fragmentdensitymapops.html#fragmentdensitymapops" class="xref page">generate the fragment areas</a>.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code> specifies the stage
of the pipeline where the invocation mask image is read by the
implementation to optimize the ray dispatch.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code> specifies the execution
of <a href="video_extensions.html#video-decode-operations" class="xref page">video decode operations</a>.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code> specifies the execution
of <a href="video_extensions.html#video-encode-operations" class="xref page">video encode operations</a>.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_OPTICAL_FLOW_BIT_NV</code> specifies the stage of the
pipeline where <a href="VK_NV_optical_flow/optical_flow.html#opticalflow-operations" class="xref page">optical flow operation</a> are
performed.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code> specifies the
subpass shading shader stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code> specifies the execution
of <a href="VK_EXT_opacity_micromap/micromaps.html#micromap" class="xref page">micromap commands</a>.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_CLUSTER_CULLING_SHADER_BIT_HUAWEI</code> specifies
the cluster culling shader stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_TOP_OF_PIPE_BIT</code> is equivalent to
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code> with <a href="#VkAccessFlags2">VkAccessFlags2</a> set
to <code>0</code> when specified in the second synchronization scope, but
equivalent to <code>VK_PIPELINE_STAGE_2_NONE</code> in the first scope.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_BOTTOM_OF_PIPE_BIT</code> is equivalent to
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code> with <a href="#VkAccessFlags2">VkAccessFlags2</a> set
to <code>0</code> when specified in the first synchronization scope, but equivalent
to <code>VK_PIPELINE_STAGE_2_NONE</code> in the second scope.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The <code>TOP</code> and <code>BOTTOM</code> pipeline stages are deprecated, and
applications should prefer <code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code> and
<code>VK_PIPELINE_STAGE_2_NONE</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The <code>VkPipelineStageFlags2</code> bitmask goes beyond the 31 individual bit
flags allowable within a C99 enum, which is how
<a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> is defined.
The first 31 values are common to both, and are interchangeable.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>VkPipelineStageFlags2</code> is a bitmask type for setting a mask of zero or
more <a href="#VkPipelineStageFlagBits2">VkPipelineStageFlagBits2</a> flags:</p>
</div>
<div id="VkPipelineStageFlags2" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
typedef VkFlags64 VkPipelineStageFlags2;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkPipelineStageFlags2KHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_synchronization2
typedef VkPipelineStageFlags2 VkPipelineStageFlags2KHR;</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in a <a href="#VkPipelineStageFlags">VkPipelineStageFlags</a> mask, specifying
stages of execution, are:</p>
</div>
<div id="VkPipelineStageFlagBits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef enum VkPipelineStageFlagBits {
    VK_PIPELINE_STAGE_TOP_OF_PIPE_BIT = 0x00000001,
    VK_PIPELINE_STAGE_DRAW_INDIRECT_BIT = 0x00000002,
    VK_PIPELINE_STAGE_VERTEX_INPUT_BIT = 0x00000004,
    VK_PIPELINE_STAGE_VERTEX_SHADER_BIT = 0x00000008,
    VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT = 0x00000010,
    VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT = 0x00000020,
    VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT = 0x00000040,
    VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT = 0x00000080,
    VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT = 0x00000100,
    VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT = 0x00000200,
    VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT = 0x00000400,
    VK_PIPELINE_STAGE_COMPUTE_SHADER_BIT = 0x00000800,
    VK_PIPELINE_STAGE_TRANSFER_BIT = 0x00001000,
    VK_PIPELINE_STAGE_BOTTOM_OF_PIPE_BIT = 0x00002000,
    VK_PIPELINE_STAGE_HOST_BIT = 0x00004000,
    VK_PIPELINE_STAGE_ALL_GRAPHICS_BIT = 0x00008000,
    VK_PIPELINE_STAGE_ALL_COMMANDS_BIT = 0x00010000,
  // Provided by VK_VERSION_1_3
    VK_PIPELINE_STAGE_NONE = 0,
  // Provided by VK_EXT_transform_feedback
    VK_PIPELINE_STAGE_TRANSFORM_FEEDBACK_BIT_EXT = 0x01000000,
  // Provided by VK_EXT_conditional_rendering
    VK_PIPELINE_STAGE_CONDITIONAL_RENDERING_BIT_EXT = 0x00040000,
  // Provided by VK_KHR_acceleration_structure
    VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR = 0x02000000,
  // Provided by VK_KHR_ray_tracing_pipeline
    VK_PIPELINE_STAGE_RAY_TRACING_SHADER_BIT_KHR = 0x00200000,
  // Provided by VK_EXT_fragment_density_map
    VK_PIPELINE_STAGE_FRAGMENT_DENSITY_PROCESS_BIT_EXT = 0x00800000,
  // Provided by VK_KHR_fragment_shading_rate
    VK_PIPELINE_STAGE_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR = 0x00400000,
  // Provided by VK_NV_device_generated_commands
    VK_PIPELINE_STAGE_COMMAND_PREPROCESS_BIT_NV = 0x00020000,
  // Provided by VK_EXT_mesh_shader
    VK_PIPELINE_STAGE_TASK_SHADER_BIT_EXT = 0x00080000,
  // Provided by VK_EXT_mesh_shader
    VK_PIPELINE_STAGE_MESH_SHADER_BIT_EXT = 0x00100000,
  // Provided by VK_NV_shading_rate_image
    VK_PIPELINE_STAGE_SHADING_RATE_IMAGE_BIT_NV = VK_PIPELINE_STAGE_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR,
  // Provided by VK_NV_ray_tracing
    VK_PIPELINE_STAGE_RAY_TRACING_SHADER_BIT_NV = VK_PIPELINE_STAGE_RAY_TRACING_SHADER_BIT_KHR,
  // Provided by VK_NV_ray_tracing
    VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_NV = VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR,
  // Provided by VK_NV_mesh_shader
    VK_PIPELINE_STAGE_TASK_SHADER_BIT_NV = VK_PIPELINE_STAGE_TASK_SHADER_BIT_EXT,
  // Provided by VK_NV_mesh_shader
    VK_PIPELINE_STAGE_MESH_SHADER_BIT_NV = VK_PIPELINE_STAGE_MESH_SHADER_BIT_EXT,
  // Provided by VK_KHR_synchronization2
    VK_PIPELINE_STAGE_NONE_KHR = VK_PIPELINE_STAGE_NONE,
} VkPipelineStageFlagBits;</code></pre>
</div>
</div>
<div class="paragraph">
<p>These values all have the same meaning as the equivalently named values for
<a href="#VkPipelineStageFlags2">VkPipelineStageFlags2</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_NONE</code> specifies no stages of execution.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_DRAW_INDIRECT_BIT</code> specifies the stage of the
pipeline where <code>VkDrawIndirect*</code> / <code>VkDispatchIndirect*</code> /
<code>VkTraceRaysIndirect*</code> data structures are consumed.
This stage also includes reading commands written by
<a href="VK_NV_device_generated_commands/generatedcommands.html#vkCmdExecuteGeneratedCommandsNV" class="xref page">vkCmdExecuteGeneratedCommandsNV</a>.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TASK_SHADER_BIT_EXT</code> specifies the task shader
stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_MESH_SHADER_BIT_EXT</code> specifies the mesh shader
stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_VERTEX_INPUT_BIT</code> specifies the stage of the
pipeline where vertex and index buffers are consumed.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_VERTEX_SHADER_BIT</code> specifies the vertex shader
stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> specifies the
tessellation control shader stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code> specifies the
tessellation evaluation shader stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code> specifies the geometry
shader stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code> specifies the fragment
shader stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code> specifies the stage of
the pipeline where early fragment tests (depth and stencil tests before
fragment shading) are performed.
This stage also includes <a href="renderpass.html#renderpass-load-operations" class="xref page">render pass load    operations</a> for framebuffer attachments with a depth/stencil format.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code> specifies the stage of
the pipeline where late fragment tests (depth and stencil tests after
fragment shading) are performed.
This stage also includes <a href="renderpass.html#renderpass-store-operations" class="xref page">render pass    store operations</a> for framebuffer attachments with a depth/stencil
format.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code> specifies the stage
of the pipeline after blending where the final color values are output
from the pipeline.
This stage includes <a href="framebuffer.html#framebuffer-blending" class="xref page">blending</a>,
<a href="framebuffer.html#framebuffer-logicop" class="xref page">logic operations</a>, render pass
<a href="renderpass.html#renderpass-load-operations" class="xref page">load</a> and <a href="renderpass.html#renderpass-store-operations" class="xref page">    store</a> operations for color attachments,
<a href="renderpass.html#renderpass-resolve-operations" class="xref page">render pass multisample resolve    operations</a>, and <a href="clears.html#vkCmdClearAttachments" class="xref page">vkCmdClearAttachments</a>.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_COMPUTE_SHADER_BIT</code> specifies the execution of a
compute shader.</p>
</li>
<li>
<p><a id="synchronization-pipeline-stages-transfer"></a>
<code>VK_PIPELINE_STAGE_TRANSFER_BIT</code> specifies the following commands:</p>
<div class="ulist">
<ul>
<li>
<p>All <a href="copies.html#copies" class="xref page">copy commands</a>, including <a href="queries.html#vkCmdCopyQueryPoolResults" class="xref page">vkCmdCopyQueryPoolResults</a></p>
</li>
<li>
<p><a href="copies.html#vkCmdBlitImage2" class="xref page">vkCmdBlitImage2</a> and <a href="copies.html#vkCmdBlitImage" class="xref page">vkCmdBlitImage</a></p>
</li>
<li>
<p><a href="copies.html#vkCmdResolveImage2" class="xref page">vkCmdResolveImage2</a> and <a href="copies.html#vkCmdResolveImage" class="xref page">vkCmdResolveImage</a></p>
</li>
<li>
<p>All <a href="clears.html#clears" class="xref page">clear commands</a>, with the exception of
<a href="clears.html#vkCmdClearAttachments" class="xref page">vkCmdClearAttachments</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_HOST_BIT</code> specifies a pseudo-stage indicating
execution on the host of reads/writes of device memory.
This stage is not invoked by any commands recorded in a command buffer.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code> specifies
    the execution of
    <a href="accelstructures.html#vkCmdBuildAccelerationStructureNV" class="xref page">vkCmdBuildAccelerationStructureNV</a>,
    <a href="accelstructures.html#vkCmdCopyAccelerationStructureNV" class="xref page">vkCmdCopyAccelerationStructureNV</a>,
    <a href="accelstructures.html#vkCmdWriteAccelerationStructuresPropertiesNV" class="xref page">vkCmdWriteAccelerationStructuresPropertiesNV</a>
,
    <a href="accelstructures.html#vkCmdBuildAccelerationStructuresKHR" class="xref page">vkCmdBuildAccelerationStructuresKHR</a>,
    <a href="accelstructures.html#vkCmdBuildAccelerationStructuresIndirectKHR" class="xref page">vkCmdBuildAccelerationStructuresIndirectKHR</a>,
    <a href="accelstructures.html#vkCmdCopyAccelerationStructureKHR" class="xref page">vkCmdCopyAccelerationStructureKHR</a>,
    <a href="accelstructures.html#vkCmdCopyAccelerationStructureToMemoryKHR" class="xref page">vkCmdCopyAccelerationStructureToMemoryKHR</a>,
    <a href="accelstructures.html#vkCmdCopyMemoryToAccelerationStructureKHR" class="xref page">vkCmdCopyMemoryToAccelerationStructureKHR</a>, and
    <a href="accelstructures.html#vkCmdWriteAccelerationStructuresPropertiesKHR" class="xref page">vkCmdWriteAccelerationStructuresPropertiesKHR</a>.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_RAY_TRACING_SHADER_BIT_KHR</code> specifies the
    execution of the ray tracing shader stages, via
<a href="raytracing.html#vkCmdTraceRaysNV" class="xref page">vkCmdTraceRaysNV</a>
,
<a href="raytracing.html#vkCmdTraceRaysKHR" class="xref page">vkCmdTraceRaysKHR</a>, or <a href="raytracing.html#vkCmdTraceRaysIndirectKHR" class="xref page">vkCmdTraceRaysIndirectKHR</a></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_ALL_GRAPHICS_BIT</code> specifies the execution of all
graphics pipeline stages, and is equivalent to the logical OR of:</p>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_DRAW_INDIRECT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_VERTEX_INPUT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_VERTEX_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_CONDITIONAL_RENDERING_BIT_EXT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TRANSFORM_FEEDBACK_BIT_EXT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_ALL_COMMANDS_BIT</code> specifies all operations
performed by all commands supported on the queue it is used with.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_CONDITIONAL_RENDERING_BIT_EXT</code> specifies the
stage of the pipeline where the predicate of conditional rendering is
consumed.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TRANSFORM_FEEDBACK_BIT_EXT</code> specifies the stage
of the pipeline where vertex attribute output values are written to the
transform feedback buffers.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_COMMAND_PREPROCESS_BIT_NV</code> specifies the stage of
the pipeline where device-side preprocessing for generated commands via
<a href="VK_NV_device_generated_commands/generatedcommands.html#vkCmdPreprocessGeneratedCommandsNV" class="xref page">vkCmdPreprocessGeneratedCommandsNV</a> is handled.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code>
    specifies the stage of the pipeline where the
    <a href="primsrast.html#primsrast-fragment-shading-rate-attachment" class="xref page">fragment shading rate    attachment</a>
or
    <a href="primsrast.html#primsrast-shading-rate-image" class="xref page">shading rate image</a>
    is read to determine the fragment shading rate for portions of a
    rasterized primitive.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code> specifies the
stage of the pipeline where the fragment density map is read to
<a href="fragmentdensitymapops.html#fragmentdensitymapops" class="xref page">generate the fragment areas</a>.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TOP_OF_PIPE_BIT</code> is equivalent to
<code>VK_PIPELINE_STAGE_ALL_COMMANDS_BIT</code> with <a href="#VkAccessFlags">VkAccessFlags</a> set to
<code>0</code> when specified in the second synchronization scope, but specifies no
stage of execution when specified in the first scope.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_BOTTOM_OF_PIPE_BIT</code> is equivalent to
<code>VK_PIPELINE_STAGE_ALL_COMMANDS_BIT</code> with <a href="#VkAccessFlags">VkAccessFlags</a> set to
<code>0</code> when specified in the first synchronization scope, but specifies no
stage of execution when specified in the second scope.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkPipelineStageFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef VkFlags VkPipelineStageFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkPipelineStageFlags</code> is a bitmask type for setting a mask of zero or
more <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a>.</p>
</div>
</div>
</div>
<div id="synchronization-pipeline-stages-masks" class="paragraph">
<p>If a synchronization command includes a source stage mask, its first
<a href="#synchronization-dependencies-scopes">synchronization scope</a> only includes
execution of the pipeline stages specified in that mask and any
<a href="#synchronization-pipeline-stages-order">logically earlier</a> stages.
Its first <a href="#synchronization-dependencies-access-scopes">access scope</a> only
includes memory accesses performed by pipeline stages explicitly specified
in the source stage mask.</p>
</div>
<div class="paragraph">
<p>If a synchronization command includes a destination stage mask, its second
<a href="#synchronization-dependencies-scopes">synchronization scope</a> only includes
execution of the pipeline stages specified in that mask and any
<a href="#synchronization-pipeline-stages-order">logically later</a> stages.
Its second <a href="#synchronization-dependencies-access-scopes">access scope</a> only
includes memory accesses performed by pipeline stages explicitly specified
in the destination stage mask.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Note that <a href="#synchronization-dependencies-access-scopes">access scopes</a> do
not interact with the logically earlier or later stages for either scope -
only the stages the app specifies are considered part of each access scope.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Certain pipeline stages are only available on queues that support a
particular set of operations.
The following table lists, for each pipeline stage flag, which queue
capability flag <strong>must</strong> be supported by the queue.
When multiple flags are enumerated in the second column of the table, it
means that the pipeline stage is supported on the queue if it supports any
of the listed capability flags.
For further details on queue capabilities see
<a href="devsandqueues.html#devsandqueues-physical-device-enumeration" class="xref page">Physical Device Enumeration</a>
and <a href="devsandqueues.html#devsandqueues-queues" class="xref page">Queues</a>.</p>
</div>
<table id="synchronization-pipeline-stages-supported" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Supported pipeline stage flags</caption>
<colgroup>
<col style="width: 70%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Pipeline stage flag</th>
<th class="tableblock halign-left valign-top">Required queue capability flag</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_NONE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_TOP_OF_PIPE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code> or <code>VK_QUEUE_COMPUTE_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_VERTEX_INPUT_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_VERTEX_SHADER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_COMPUTE_SHADER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_COMPUTE_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_ALL_TRANSFER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code> or <code>VK_QUEUE_COMPUTE_BIT</code> or <code>VK_QUEUE_TRANSFER_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_BOTTOM_OF_PIPE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_HOST_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_COPY_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code> or <code>VK_QUEUE_COMPUTE_BIT</code> or <code>VK_QUEUE_TRANSFER_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_RESOLVE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code> or <code>VK_QUEUE_COMPUTE_BIT</code> or <code>VK_QUEUE_TRANSFER_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_BLIT_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code> or <code>VK_QUEUE_COMPUTE_BIT</code> or <code>VK_QUEUE_TRANSFER_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_CLEAR_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code> or <code>VK_QUEUE_COMPUTE_BIT</code> or <code>VK_QUEUE_TRANSFER_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_INDEX_INPUT_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_VERTEX_ATTRIBUTE_INPUT_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_PRE_RASTERIZATION_SHADERS_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_VIDEO_DECODE_BIT_KHR</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_VIDEO_ENCODE_BIT_KHR</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code> or <code>VK_QUEUE_COMPUTE_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_COMMAND_PREPROCESS_BIT_NV</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code> or <code>VK_QUEUE_COMPUTE_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_COMPUTE_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_COMPUTE_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code> or <code>VK_QUEUE_COMPUTE_BIT</code> or <code>VK_QUEUE_TRANSFER_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_COMPUTE_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_CLUSTER_CULLING_SHADER_BIT_HUAWEI</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_OPTICAL_FLOW_BIT_NV</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_OPTICAL_FLOW_BIT_NV</code></p></td>
</tr>
</tbody>
</table>
<div id="synchronization-pipeline-stages-order" class="paragraph">
<p>Pipeline stages that execute as a result of a command logically complete
execution in a specific order, such that completion of a logically later
pipeline stage <strong>must</strong> not happen-before completion of a logically earlier
stage.
This means that including any stage in the source stage mask for a
particular synchronization command also implies that any logically earlier
stages are included in <strong>Scope<sub>1st</sub></strong> for that command.</p>
</div>
<div class="paragraph">
<p>Similarly, initiation of a logically earlier pipeline stage <strong>must</strong> not
happen-after initiation of a logically later pipeline stage.
Including any given stage in the destination stage mask for a particular
synchronization command also implies that any logically later stages are
included in <strong>Scope<sub>2nd</sub></strong> for that command.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Implementations <strong>may</strong> not support synchronization at every pipeline stage for
every synchronization operation.
If a pipeline stage that an implementation does not support synchronization
for appears in a source stage mask, it <strong>may</strong> substitute any logically later
stage in its place for the first synchronization scope.
If a pipeline stage that an implementation does not support synchronization
for appears in a destination stage mask, it <strong>may</strong> substitute any logically
earlier stage in its place for the second synchronization scope.</p>
</div>
<div class="paragraph">
<p>For example, if an implementation is unable to signal an event immediately
after vertex shader execution is complete, it <strong>may</strong> instead signal the event
after color attachment output has completed.</p>
</div>
<div class="paragraph">
<p>If an implementation makes such a substitution, it <strong>must</strong> not affect the
semantics of execution or memory dependencies or image and buffer memory
barriers.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a id="synchronization-pipeline-stages-types"></a><a id="synchronization-pipeline-graphics"></a>
<a href="pipelines.html#pipelines-graphics" class="xref page">Graphics pipelines</a> are executable on queues
supporting <code>VK_QUEUE_GRAPHICS_BIT</code>.
Stages executed by graphics pipelines <strong>can</strong> only be specified in commands
recorded for queues supporting <code>VK_QUEUE_GRAPHICS_BIT</code>.</p>
</div>
<div class="paragraph">
<p>The graphics
primitive
pipeline executes the following stages, with the logical ordering of the
stages matching the order specified here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_INDEX_INPUT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_VERTEX_ATTRIBUTE_INPUT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_VERTEX_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The graphics mesh pipeline executes the following stages, with the logical
ordering of the stages matching the order specified here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the compute pipeline, the following stages occur in this order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_COMPUTE_SHADER_BIT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the subpass shading pipeline, the following stages occur in this order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For graphics pipeline commands executing in a render pass with a fragment
density map attachment, the following pipeline stage where the fragment
density map read happens has no particular order relative to the other
stages, except that it is logically earlier than
<code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The conditional rendering stage is formally part of both the graphics, and
the compute pipeline.
The pipeline stage where the predicate read happens has unspecified order
relative to other stages of these pipelines:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_CONDITIONAL_RENDERING_BIT_EXT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the transfer pipeline, the following stages occur in this order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_2_TRANSFER_BIT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For host operations, only one pipeline stage occurs, so no order is
guaranteed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_2_HOST_BIT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the command preprocessing pipeline, the following stages occur in this
order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_2_COMMAND_PREPROCESS_BIT_NV</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For acceleration structure build operations, only one pipeline stage occurs,
so no order is guaranteed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For acceleration structure copy operations, only one pipeline stage occurs,
so no order is guaranteed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For opacity micromap build operations, only one pipeline stage occurs, so no
order is guaranteed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the ray tracing pipeline, the following stages occur in this order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the video decode pipeline, the following stages occur in this order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the video encode pipeline, the following stages occur in this order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-access-types"><a class="anchor" href="#synchronization-access-types"></a>Access Types</h3>
<div class="paragraph">
<p>Memory in Vulkan <strong>can</strong> be accessed from within shader invocations and via
some fixed-function stages of the pipeline.
The <em>access type</em> is a function of the <a href="descriptorsets.html#descriptorsets" class="xref page">descriptor type</a>
used, or how a fixed-function stage accesses memory.</p>
</div>
<div id="synchronization-access-masks" class="paragraph">
<p>Some synchronization commands take sets of access types as parameters to
define the <a href="#synchronization-dependencies-access-scopes">access scopes</a> of
a memory dependency.
If a synchronization command includes a <em>source access mask</em>, its first
<a href="#synchronization-dependencies-access-scopes">access scope</a> only includes
accesses via the access types specified in that mask.
Similarly, if a synchronization command includes a <em>destination access
mask</em>, its second <a href="#synchronization-dependencies-access-scopes">access scope</a> only includes accesses via the access types specified in that mask.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in the <code>srcAccessMask</code> and <code>dstAccessMask</code>
members of <a href="#VkMemoryBarrier2KHR">VkMemoryBarrier2KHR</a>, <a href="#VkImageMemoryBarrier2KHR">VkImageMemoryBarrier2KHR</a>, and
<a href="#VkBufferMemoryBarrier2KHR">VkBufferMemoryBarrier2KHR</a>, specifying access behavior, are:</p>
</div>
<div id="VkAccessFlagBits2" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
// Flag bits for VkAccessFlagBits2
typedef VkFlags64 VkAccessFlagBits2;
static const VkAccessFlagBits2 VK_ACCESS_2_NONE = 0ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_NONE_KHR = 0ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_INDIRECT_COMMAND_READ_BIT = 0x00000001ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_INDIRECT_COMMAND_READ_BIT_KHR = 0x00000001ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_INDEX_READ_BIT = 0x00000002ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_INDEX_READ_BIT_KHR = 0x00000002ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_VERTEX_ATTRIBUTE_READ_BIT = 0x00000004ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_VERTEX_ATTRIBUTE_READ_BIT_KHR = 0x00000004ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_UNIFORM_READ_BIT = 0x00000008ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_UNIFORM_READ_BIT_KHR = 0x00000008ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_INPUT_ATTACHMENT_READ_BIT = 0x00000010ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_INPUT_ATTACHMENT_READ_BIT_KHR = 0x00000010ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_SHADER_READ_BIT = 0x00000020ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_SHADER_READ_BIT_KHR = 0x00000020ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_SHADER_WRITE_BIT = 0x00000040ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_SHADER_WRITE_BIT_KHR = 0x00000040ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_COLOR_ATTACHMENT_READ_BIT = 0x00000080ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_COLOR_ATTACHMENT_READ_BIT_KHR = 0x00000080ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_COLOR_ATTACHMENT_WRITE_BIT = 0x00000100ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_COLOR_ATTACHMENT_WRITE_BIT_KHR = 0x00000100ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_READ_BIT = 0x00000200ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_READ_BIT_KHR = 0x00000200ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT = 0x00000400ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT_KHR = 0x00000400ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_TRANSFER_READ_BIT = 0x00000800ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_TRANSFER_READ_BIT_KHR = 0x00000800ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_TRANSFER_WRITE_BIT = 0x00001000ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_TRANSFER_WRITE_BIT_KHR = 0x00001000ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_HOST_READ_BIT = 0x00002000ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_HOST_READ_BIT_KHR = 0x00002000ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_HOST_WRITE_BIT = 0x00004000ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_HOST_WRITE_BIT_KHR = 0x00004000ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_MEMORY_READ_BIT = 0x00008000ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_MEMORY_READ_BIT_KHR = 0x00008000ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_MEMORY_WRITE_BIT = 0x00010000ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_MEMORY_WRITE_BIT_KHR = 0x00010000ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_SHADER_SAMPLED_READ_BIT = 0x100000000ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_SHADER_SAMPLED_READ_BIT_KHR = 0x100000000ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_SHADER_STORAGE_READ_BIT = 0x200000000ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_SHADER_STORAGE_READ_BIT_KHR = 0x200000000ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_SHADER_STORAGE_WRITE_BIT = 0x400000000ULL;
static const VkAccessFlagBits2 VK_ACCESS_2_SHADER_STORAGE_WRITE_BIT_KHR = 0x400000000ULL;
// Provided by VK_KHR_video_decode_queue
static const VkAccessFlagBits2 VK_ACCESS_2_VIDEO_DECODE_READ_BIT_KHR = 0x800000000ULL;
// Provided by VK_KHR_video_decode_queue
static const VkAccessFlagBits2 VK_ACCESS_2_VIDEO_DECODE_WRITE_BIT_KHR = 0x1000000000ULL;
#ifdef VK_ENABLE_BETA_EXTENSIONS
// Provided by VK_KHR_video_encode_queue
static const VkAccessFlagBits2 VK_ACCESS_2_VIDEO_ENCODE_READ_BIT_KHR = 0x2000000000ULL;
#endif
#ifdef VK_ENABLE_BETA_EXTENSIONS
// Provided by VK_KHR_video_encode_queue
static const VkAccessFlagBits2 VK_ACCESS_2_VIDEO_ENCODE_WRITE_BIT_KHR = 0x4000000000ULL;
#endif
// Provided by VK_KHR_synchronization2 with VK_EXT_transform_feedback
static const VkAccessFlagBits2 VK_ACCESS_2_TRANSFORM_FEEDBACK_WRITE_BIT_EXT = 0x02000000ULL;
// Provided by VK_KHR_synchronization2 with VK_EXT_transform_feedback
static const VkAccessFlagBits2 VK_ACCESS_2_TRANSFORM_FEEDBACK_COUNTER_READ_BIT_EXT = 0x04000000ULL;
// Provided by VK_KHR_synchronization2 with VK_EXT_transform_feedback
static const VkAccessFlagBits2 VK_ACCESS_2_TRANSFORM_FEEDBACK_COUNTER_WRITE_BIT_EXT = 0x08000000ULL;
// Provided by VK_KHR_synchronization2 with VK_EXT_conditional_rendering
static const VkAccessFlagBits2 VK_ACCESS_2_CONDITIONAL_RENDERING_READ_BIT_EXT = 0x00100000ULL;
// Provided by VK_KHR_synchronization2 with VK_NV_device_generated_commands
static const VkAccessFlagBits2 VK_ACCESS_2_COMMAND_PREPROCESS_READ_BIT_NV = 0x00020000ULL;
// Provided by VK_KHR_synchronization2 with VK_NV_device_generated_commands
static const VkAccessFlagBits2 VK_ACCESS_2_COMMAND_PREPROCESS_WRITE_BIT_NV = 0x00040000ULL;
// Provided by VK_KHR_fragment_shading_rate with VK_KHR_synchronization2
static const VkAccessFlagBits2 VK_ACCESS_2_FRAGMENT_SHADING_RATE_ATTACHMENT_READ_BIT_KHR = 0x00800000ULL;
// Provided by VK_KHR_synchronization2 with VK_NV_shading_rate_image
static const VkAccessFlagBits2 VK_ACCESS_2_SHADING_RATE_IMAGE_READ_BIT_NV = 0x00800000ULL;
// Provided by VK_KHR_acceleration_structure with VK_KHR_synchronization2
static const VkAccessFlagBits2 VK_ACCESS_2_ACCELERATION_STRUCTURE_READ_BIT_KHR = 0x00200000ULL;
// Provided by VK_KHR_acceleration_structure with VK_KHR_synchronization2
static const VkAccessFlagBits2 VK_ACCESS_2_ACCELERATION_STRUCTURE_WRITE_BIT_KHR = 0x00400000ULL;
// Provided by VK_KHR_synchronization2 with VK_NV_ray_tracing
static const VkAccessFlagBits2 VK_ACCESS_2_ACCELERATION_STRUCTURE_READ_BIT_NV = 0x00200000ULL;
// Provided by VK_KHR_synchronization2 with VK_NV_ray_tracing
static const VkAccessFlagBits2 VK_ACCESS_2_ACCELERATION_STRUCTURE_WRITE_BIT_NV = 0x00400000ULL;
// Provided by VK_KHR_synchronization2 with VK_EXT_fragment_density_map
static const VkAccessFlagBits2 VK_ACCESS_2_FRAGMENT_DENSITY_MAP_READ_BIT_EXT = 0x01000000ULL;
// Provided by VK_KHR_synchronization2 with VK_EXT_blend_operation_advanced
static const VkAccessFlagBits2 VK_ACCESS_2_COLOR_ATTACHMENT_READ_NONCOHERENT_BIT_EXT = 0x00080000ULL;
// Provided by VK_EXT_descriptor_buffer
static const VkAccessFlagBits2 VK_ACCESS_2_DESCRIPTOR_BUFFER_READ_BIT_EXT = 0x20000000000ULL;
// Provided by VK_HUAWEI_invocation_mask
static const VkAccessFlagBits2 VK_ACCESS_2_INVOCATION_MASK_READ_BIT_HUAWEI = 0x8000000000ULL;
// Provided by VK_KHR_ray_tracing_maintenance1 with VK_KHR_synchronization2 and VK_KHR_ray_tracing_pipeline
static const VkAccessFlagBits2 VK_ACCESS_2_SHADER_BINDING_TABLE_READ_BIT_KHR = 0x10000000000ULL;
// Provided by VK_EXT_opacity_micromap
static const VkAccessFlagBits2 VK_ACCESS_2_MICROMAP_READ_BIT_EXT = 0x100000000000ULL;
// Provided by VK_EXT_opacity_micromap
static const VkAccessFlagBits2 VK_ACCESS_2_MICROMAP_WRITE_BIT_EXT = 0x200000000000ULL;
// Provided by VK_NV_optical_flow
static const VkAccessFlagBits2 VK_ACCESS_2_OPTICAL_FLOW_READ_BIT_NV = 0x40000000000ULL;
// Provided by VK_NV_optical_flow
static const VkAccessFlagBits2 VK_ACCESS_2_OPTICAL_FLOW_WRITE_BIT_NV = 0x80000000000ULL;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkAccessFlagBits2KHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_synchronization2
typedef VkAccessFlagBits2 VkAccessFlagBits2KHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_ACCESS_2_NONE</code> specifies no accesses.</p>
</li>
<li>
<p><code>VK_ACCESS_2_MEMORY_READ_BIT</code> specifies all read accesses.
It is always valid in any access mask, and is treated as equivalent to
setting all <code>READ</code> access flags that are valid where it is used.</p>
</li>
<li>
<p><code>VK_ACCESS_2_MEMORY_WRITE_BIT</code> specifies all write accesses.
It is always valid in any access mask, and is treated as equivalent to
setting all <code>WRITE</code> access flags that are valid where it is used.</p>
</li>
<li>
<p><code>VK_ACCESS_2_INDIRECT_COMMAND_READ_BIT</code> specifies read access to
    command data read from indirect buffers as part of an indirect
build,
trace,
    drawing or dispatch command.
    Such access occurs in the <code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code>
    pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_INDEX_READ_BIT</code> specifies read access to an index
    buffer as part of an indexed drawing command, bound by
<a href="drawing.html#vkCmdBindIndexBuffer2KHR" class="xref page">vkCmdBindIndexBuffer2KHR</a> and
    <a href="drawing.html#vkCmdBindIndexBuffer" class="xref page">vkCmdBindIndexBuffer</a>.
    Such access occurs in the <code>VK_PIPELINE_STAGE_2_INDEX_INPUT_BIT</code>
    pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_VERTEX_ATTRIBUTE_READ_BIT</code> specifies read access to a
vertex buffer as part of a drawing command, bound by
<a href="fxvertex.html#vkCmdBindVertexBuffers" class="xref page">vkCmdBindVertexBuffers</a>.
Such access occurs in the
<code>VK_PIPELINE_STAGE_2_VERTEX_ATTRIBUTE_INPUT_BIT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_UNIFORM_READ_BIT</code> specifies read access to a
<a href="descriptorsets.html#descriptorsets-uniformbuffer" class="xref page">uniform buffer</a> in any shader pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_INPUT_ATTACHMENT_READ_BIT</code> specifies read access to an
<a href="renderpass.html#renderpass" class="xref page">input attachment</a> within a render pass during
subpass shading or
fragment shading.
Such access occurs in the
<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code> or
<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_SHADER_SAMPLED_READ_BIT</code> specifies read access to a
<a href="descriptorsets.html#descriptorsets-uniformtexelbuffer" class="xref page">uniform texel buffer</a> or
<a href="descriptorsets.html#descriptorsets-sampledimage" class="xref page">sampled image</a> in any shader pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_SHADER_STORAGE_READ_BIT</code> specifies read access to a
<a href="descriptorsets.html#descriptorsets-storagebuffer" class="xref page">storage buffer</a>,
<a href="descriptorsets.html#descriptorsets-physical-storage-buffer" class="xref page">physical storage buffer</a>,
<a href="descriptorsets.html#descriptorsets-storagetexelbuffer" class="xref page">storage texel buffer</a>, or
<a href="descriptorsets.html#descriptorsets-storageimage" class="xref page">storage image</a> in any shader pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_SHADER_BINDING_TABLE_READ_BIT_KHR</code> specifies read
access to a <a href="raytracing.html#shader-binding-table" class="xref page">shader binding table</a> in any shader
pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_SHADER_READ_BIT</code>
is equivalent to the logical OR of:</p>
<div class="ulist">
<ul>
<li>
<p><code>VK_ACCESS_2_SHADER_SAMPLED_READ_BIT</code></p>
</li>
<li>
<p><code>VK_ACCESS_2_SHADER_STORAGE_READ_BIT</code></p>
</li>
<li>
<p><code>VK_ACCESS_2_SHADER_BINDING_TABLE_READ_BIT_KHR</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>VK_ACCESS_2_SHADER_STORAGE_WRITE_BIT</code> specifies write access to a
<a href="descriptorsets.html#descriptorsets-storagebuffer" class="xref page">storage buffer</a>,
<a href="descriptorsets.html#descriptorsets-physical-storage-buffer" class="xref page">physical storage buffer</a>,
<a href="descriptorsets.html#descriptorsets-storagetexelbuffer" class="xref page">storage texel buffer</a>, or
<a href="descriptorsets.html#descriptorsets-storageimage" class="xref page">storage image</a> in any shader pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_SHADER_WRITE_BIT</code> is equivalent to
<code>VK_ACCESS_2_SHADER_STORAGE_WRITE_BIT</code>.</p>
</li>
<li>
<p><code>VK_ACCESS_2_COLOR_ATTACHMENT_READ_BIT</code> specifies read access to a
<a href="renderpass.html#renderpass" class="xref page">color attachment</a>, such as via
<a href="framebuffer.html#framebuffer-blending" class="xref page">blending</a> (other than
<a href="framebuffer.html#framebuffer-blend-advanced" class="xref page">advanced blend operations</a>),
<a href="framebuffer.html#framebuffer-logicop" class="xref page">logic operations</a> or certain
<a href="renderpass.html#renderpass-load-operations" class="xref page">render pass load operations</a> in the
<code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code> pipeline stage or
via <a href="fragops.html#fragops-shader-tileimage-reads" class="xref page">fragment shader tile image reads</a>
in the <code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_COLOR_ATTACHMENT_WRITE_BIT</code> specifies write access to a
<a href="renderpass.html#renderpass" class="xref page">color attachment</a> during a <a href="renderpass.html#renderpass" class="xref page">render pass</a> or
via certain render pass <a href="renderpass.html#renderpass-load-operations" class="xref page">load</a>,
<a href="renderpass.html#renderpass-store-operations" class="xref page">store</a>, and
<a href="renderpass.html#renderpass-resolve-operations" class="xref page">multisample resolve</a> operations.
Such access occurs in the
<code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_READ_BIT</code> specifies read
access to a <a href="renderpass.html#renderpass" class="xref page">depth/stencil attachment</a>, via
<a href="fragops.html#fragops-ds-state" class="xref page">depth or stencil operations</a> or certain
<a href="renderpass.html#renderpass-load-operations" class="xref page">render pass load operations</a> in the
<code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code> or
<code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code> pipeline stages or via
<a href="fragops.html#fragops-shader-tileimage-reads" class="xref page">fragment shader tile image reads</a> in
the <code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT</code> specifies write
access to a <a href="renderpass.html#renderpass" class="xref page">depth/stencil attachment</a>, via
<a href="fragops.html#fragops-ds-state" class="xref page">depth or stencil operations</a> or certain render pass
<a href="renderpass.html#renderpass-load-operations" class="xref page">load</a> and <a href="renderpass.html#renderpass-store-operations" class="xref page">    store</a> operations.
Such access occurs in the
<code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code> or
<code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code> pipeline stages.</p>
</li>
<li>
<p><code>VK_ACCESS_2_TRANSFER_READ_BIT</code> specifies read access to an image or
buffer in a <a href="copies.html#copies" class="xref page">copy</a> operation.
Such access occurs in the <code>VK_PIPELINE_STAGE_2_COPY_BIT</code>,
<code>VK_PIPELINE_STAGE_2_BLIT_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_RESOLVE_BIT</code> pipeline stages.</p>
</li>
<li>
<p><code>VK_ACCESS_2_TRANSFER_WRITE_BIT</code> specifies write access to an image
or buffer in a <a href="clears.html#clears" class="xref page">clear</a> or <a href="copies.html#copies" class="xref page">copy</a> operation.
Such access occurs in the <code>VK_PIPELINE_STAGE_2_COPY_BIT</code>,
<code>VK_PIPELINE_STAGE_2_BLIT_BIT</code>, <code>VK_PIPELINE_STAGE_2_CLEAR_BIT</code>,
or <code>VK_PIPELINE_STAGE_2_RESOLVE_BIT</code> pipeline stages.</p>
</li>
<li>
<p><code>VK_ACCESS_2_HOST_READ_BIT</code> specifies read access by a host
operation.
Accesses of this type are not performed through a resource, but directly
on memory.
Such access occurs in the <code>VK_PIPELINE_STAGE_2_HOST_BIT</code> pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_HOST_WRITE_BIT</code> specifies write access by a host
operation.
Accesses of this type are not performed through a resource, but directly
on memory.
Such access occurs in the <code>VK_PIPELINE_STAGE_2_HOST_BIT</code> pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_CONDITIONAL_RENDERING_READ_BIT_EXT</code> specifies read
access to a predicate as part of conditional rendering.
Such access occurs in the
<code>VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_TRANSFORM_FEEDBACK_WRITE_BIT_EXT</code> specifies write
access to a transform feedback buffer made when transform feedback is
active.
Such access occurs in the
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_TRANSFORM_FEEDBACK_COUNTER_READ_BIT_EXT</code> specifies read
access to a transform feedback counter buffer which is read when
<a href="vertexpostproc.html#vkCmdBeginTransformFeedbackEXT" class="xref page">vkCmdBeginTransformFeedbackEXT</a> executes.
Such access occurs in the
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_TRANSFORM_FEEDBACK_COUNTER_WRITE_BIT_EXT</code> specifies
write access to a transform feedback counter buffer which is written
when <a href="vertexpostproc.html#vkCmdEndTransformFeedbackEXT" class="xref page">vkCmdEndTransformFeedbackEXT</a> executes.
Such access occurs in the
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_COMMAND_PREPROCESS_READ_BIT_NV</code> specifies reads from
buffer inputs to <a href="VK_NV_device_generated_commands/generatedcommands.html#vkCmdPreprocessGeneratedCommandsNV" class="xref page">vkCmdPreprocessGeneratedCommandsNV</a>.
Such access occurs in the
<code>VK_PIPELINE_STAGE_2_COMMAND_PREPROCESS_BIT_NV</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_COMMAND_PREPROCESS_WRITE_BIT_NV</code> specifies writes to
the target command buffer preprocess outputs.
Such access occurs in the
<code>VK_PIPELINE_STAGE_2_COMMAND_PREPROCESS_BIT_NV</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_COLOR_ATTACHMENT_READ_NONCOHERENT_BIT_EXT</code> specifies
read access to <a href="renderpass.html#renderpass" class="xref page">color attachments</a>, including
<a href="framebuffer.html#framebuffer-blend-advanced" class="xref page">advanced blend operations</a>.
Such access occurs in the
<code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_INVOCATION_MASK_READ_BIT_HUAWEI</code> specifies read access
to a invocation mask image in the
<code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_ACCELERATION_STRUCTURE_READ_BIT_KHR</code> specifies read
access to an acceleration structure as part of a trace, build, or copy
command, or to an <a href="accelstructures.html#acceleration-structure-scratch" class="xref page">acceleration    structure scratch buffer</a> as part of a build command.
Such access occurs in the
<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code> pipeline stage or
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code> pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_ACCELERATION_STRUCTURE_WRITE_BIT_KHR</code> specifies write
access to an acceleration structure or <a href="accelstructures.html#acceleration-structure-scratch" class="xref page">    acceleration structure scratch buffer</a> as part of a build or copy
command.
Such access occurs in the
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code> pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_FRAGMENT_DENSITY_MAP_READ_BIT_EXT</code> specifies read
access to a <a href="renderpass.html#renderpass-fragmentdensitymapattachment" class="xref page">fragment density    map attachment</a> during dynamic <a href="fragmentdensitymapops.html#fragmentdensitymapops" class="xref page">fragment    density map operations</a>.
Such access occurs in the
<code>VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code> pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_FRAGMENT_SHADING_RATE_ATTACHMENT_READ_BIT_KHR</code>
specifies read access to a fragment shading rate attachment during
rasterization.
Such access occurs in the
<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code>
pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_SHADING_RATE_IMAGE_READ_BIT_NV</code> specifies read access
to a shading rate image during rasterization.
Such access occurs in the
<code>VK_PIPELINE_STAGE_2_SHADING_RATE_IMAGE_BIT_NV</code> pipeline stage.
It is equivalent to
<code>VK_ACCESS_2_FRAGMENT_SHADING_RATE_ATTACHMENT_READ_BIT_KHR</code>.</p>
</li>
<li>
<p><code>VK_ACCESS_2_VIDEO_DECODE_READ_BIT_KHR</code> specifies read access to an
image or buffer resource in a <a href="video_extensions.html#video-decode-operations" class="xref page">video decode    operation</a>.
Such access occurs in the <code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code>
pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_VIDEO_DECODE_WRITE_BIT_KHR</code> specifies write access to
an image or buffer resource in a <a href="video_extensions.html#video-decode-operations" class="xref page">video decode    operation</a>.
Such access occurs in the <code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code>
pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_VIDEO_ENCODE_READ_BIT_KHR</code> specifies read access to an
image or buffer resource in a <a href="video_extensions.html#video-encode-operations" class="xref page">video encode    operation</a>.
Such access occurs in the <code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code>
pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_VIDEO_ENCODE_WRITE_BIT_KHR</code> specifies write access to
an image or buffer resource in a <a href="video_extensions.html#video-encode-operations" class="xref page">video encode    operation</a>.
Such access occurs in the <code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code>
pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_DESCRIPTOR_BUFFER_READ_BIT_EXT</code> specifies read access
to a <a href="descriptorsets.html#descriptorbuffers" class="xref page">descriptor buffer</a> in any shader pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_OPTICAL_FLOW_READ_BIT_NV</code> specifies read access to an
image or buffer resource as part of a <a href="VK_NV_optical_flow/optical_flow.html#opticalflow-operations" class="xref page">optical    flow operation</a>.
Such access occurs in the <code>VK_PIPELINE_STAGE_2_OPTICAL_FLOW_BIT_NV</code>
pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_OPTICAL_FLOW_WRITE_BIT_NV</code> specifies write access to an
image or buffer resource as part of a <a href="VK_NV_optical_flow/optical_flow.html#opticalflow-operations" class="xref page">optical    flow operation</a>.
Such access occurs in the <code>VK_PIPELINE_STAGE_2_OPTICAL_FLOW_BIT_NV</code>
pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_MICROMAP_WRITE_BIT_EXT</code> specifies write access to a
micromap object.
Such access occurs in the
<code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_MICROMAP_READ_BIT_EXT</code> specifies read access to a
micromap object.
Such access occurs in the
<code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code> and
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code> pipeline
stages.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>In situations where an application wishes to select all access types for a
given set of pipeline stages, <code>VK_ACCESS_2_MEMORY_READ_BIT</code> or
<code>VK_ACCESS_2_MEMORY_WRITE_BIT</code> can be used.
This is particularly useful when specifying stages that only have a single
access type.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The <code>VkAccessFlags2</code> bitmask goes beyond the 31 individual bit flags
allowable within a C99 enum, which is how <a href="#VkAccessFlagBits">VkAccessFlagBits</a> is defined.
The first 31 values are common to both, and are interchangeable.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>VkAccessFlags2</code> is a bitmask type for setting a mask of zero or more
<a href="#VkAccessFlagBits2">VkAccessFlagBits2</a>:</p>
</div>
<div id="VkAccessFlags2" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
typedef VkFlags64 VkAccessFlags2;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkAccessFlags2KHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_synchronization2
typedef VkAccessFlags2 VkAccessFlags2KHR;</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in the <code>srcAccessMask</code> and <code>dstAccessMask</code>
members of <a href="renderpass.html#VkSubpassDependency" class="xref page">VkSubpassDependency</a>,
<a href="renderpass.html#VkSubpassDependency2" class="xref page">VkSubpassDependency2</a>,
<a href="#VkMemoryBarrier">VkMemoryBarrier</a>, <a href="#VkBufferMemoryBarrier">VkBufferMemoryBarrier</a>, and
<a href="#VkImageMemoryBarrier">VkImageMemoryBarrier</a>, specifying access behavior, are:</p>
</div>
<div id="VkAccessFlagBits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef enum VkAccessFlagBits {
    VK_ACCESS_INDIRECT_COMMAND_READ_BIT = 0x00000001,
    VK_ACCESS_INDEX_READ_BIT = 0x00000002,
    VK_ACCESS_VERTEX_ATTRIBUTE_READ_BIT = 0x00000004,
    VK_ACCESS_UNIFORM_READ_BIT = 0x00000008,
    VK_ACCESS_INPUT_ATTACHMENT_READ_BIT = 0x00000010,
    VK_ACCESS_SHADER_READ_BIT = 0x00000020,
    VK_ACCESS_SHADER_WRITE_BIT = 0x00000040,
    VK_ACCESS_COLOR_ATTACHMENT_READ_BIT = 0x00000080,
    VK_ACCESS_COLOR_ATTACHMENT_WRITE_BIT = 0x00000100,
    VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_READ_BIT = 0x00000200,
    VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT = 0x00000400,
    VK_ACCESS_TRANSFER_READ_BIT = 0x00000800,
    VK_ACCESS_TRANSFER_WRITE_BIT = 0x00001000,
    VK_ACCESS_HOST_READ_BIT = 0x00002000,
    VK_ACCESS_HOST_WRITE_BIT = 0x00004000,
    VK_ACCESS_MEMORY_READ_BIT = 0x00008000,
    VK_ACCESS_MEMORY_WRITE_BIT = 0x00010000,
  // Provided by VK_VERSION_1_3
    VK_ACCESS_NONE = 0,
  // Provided by VK_EXT_transform_feedback
    VK_ACCESS_TRANSFORM_FEEDBACK_WRITE_BIT_EXT = 0x02000000,
  // Provided by VK_EXT_transform_feedback
    VK_ACCESS_TRANSFORM_FEEDBACK_COUNTER_READ_BIT_EXT = 0x04000000,
  // Provided by VK_EXT_transform_feedback
    VK_ACCESS_TRANSFORM_FEEDBACK_COUNTER_WRITE_BIT_EXT = 0x08000000,
  // Provided by VK_EXT_conditional_rendering
    VK_ACCESS_CONDITIONAL_RENDERING_READ_BIT_EXT = 0x00100000,
  // Provided by VK_EXT_blend_operation_advanced
    VK_ACCESS_COLOR_ATTACHMENT_READ_NONCOHERENT_BIT_EXT = 0x00080000,
  // Provided by VK_KHR_acceleration_structure
    VK_ACCESS_ACCELERATION_STRUCTURE_READ_BIT_KHR = 0x00200000,
  // Provided by VK_KHR_acceleration_structure
    VK_ACCESS_ACCELERATION_STRUCTURE_WRITE_BIT_KHR = 0x00400000,
  // Provided by VK_EXT_fragment_density_map
    VK_ACCESS_FRAGMENT_DENSITY_MAP_READ_BIT_EXT = 0x01000000,
  // Provided by VK_KHR_fragment_shading_rate
    VK_ACCESS_FRAGMENT_SHADING_RATE_ATTACHMENT_READ_BIT_KHR = 0x00800000,
  // Provided by VK_NV_device_generated_commands
    VK_ACCESS_COMMAND_PREPROCESS_READ_BIT_NV = 0x00020000,
  // Provided by VK_NV_device_generated_commands
    VK_ACCESS_COMMAND_PREPROCESS_WRITE_BIT_NV = 0x00040000,
  // Provided by VK_NV_shading_rate_image
    VK_ACCESS_SHADING_RATE_IMAGE_READ_BIT_NV = VK_ACCESS_FRAGMENT_SHADING_RATE_ATTACHMENT_READ_BIT_KHR,
  // Provided by VK_NV_ray_tracing
    VK_ACCESS_ACCELERATION_STRUCTURE_READ_BIT_NV = VK_ACCESS_ACCELERATION_STRUCTURE_READ_BIT_KHR,
  // Provided by VK_NV_ray_tracing
    VK_ACCESS_ACCELERATION_STRUCTURE_WRITE_BIT_NV = VK_ACCESS_ACCELERATION_STRUCTURE_WRITE_BIT_KHR,
  // Provided by VK_KHR_synchronization2
    VK_ACCESS_NONE_KHR = VK_ACCESS_NONE,
} VkAccessFlagBits;</code></pre>
</div>
</div>
<div class="paragraph">
<p>These values all have the same meaning as the equivalently named values for
<a href="#VkAccessFlags2">VkAccessFlags2</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_ACCESS_NONE</code> specifies no accesses.</p>
</li>
<li>
<p><code>VK_ACCESS_MEMORY_READ_BIT</code> specifies all read accesses.
It is always valid in any access mask, and is treated as equivalent to
setting all <code>READ</code> access flags that are valid where it is used.</p>
</li>
<li>
<p><code>VK_ACCESS_MEMORY_WRITE_BIT</code> specifies all write accesses.
It is always valid in any access mask, and is treated as equivalent to
setting all <code>WRITE</code> access flags that are valid where it is used.</p>
</li>
<li>
<p><code>VK_ACCESS_INDIRECT_COMMAND_READ_BIT</code> specifies read access to
    indirect command data read as part of an indirect
build,
trace,
    drawing or dispatching command.
    Such access occurs in the <code>VK_PIPELINE_STAGE_DRAW_INDIRECT_BIT</code>
    pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_INDEX_READ_BIT</code> specifies read access to an index buffer
    as part of an indexed drawing command, bound by
<a href="drawing.html#vkCmdBindIndexBuffer2KHR" class="xref page">vkCmdBindIndexBuffer2KHR</a> and
    <a href="drawing.html#vkCmdBindIndexBuffer" class="xref page">vkCmdBindIndexBuffer</a>.
    Such access occurs in the <code>VK_PIPELINE_STAGE_VERTEX_INPUT_BIT</code>
    pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_VERTEX_ATTRIBUTE_READ_BIT</code> specifies read access to a
vertex buffer as part of a drawing command, bound by
<a href="fxvertex.html#vkCmdBindVertexBuffers" class="xref page">vkCmdBindVertexBuffers</a>.
Such access occurs in the <code>VK_PIPELINE_STAGE_VERTEX_INPUT_BIT</code>
pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_UNIFORM_READ_BIT</code> specifies read access to a
<a href="descriptorsets.html#descriptorsets-uniformbuffer" class="xref page">uniform buffer</a> in any shader pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_INPUT_ATTACHMENT_READ_BIT</code> specifies read access to an
<a href="renderpass.html#renderpass" class="xref page">input attachment</a> within a render pass during
subpass shading or
fragment shading.
Such access occurs in the
<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code> or
<code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_SHADER_READ_BIT</code> specifies read access to a
<a href="descriptorsets.html#descriptorsets-uniformtexelbuffer" class="xref page">uniform texel buffer</a>,
<a href="descriptorsets.html#descriptorsets-sampledimage" class="xref page">sampled image</a>,
<a href="descriptorsets.html#descriptorsets-storagebuffer" class="xref page">storage buffer</a>,
<a href="descriptorsets.html#descriptorsets-physical-storage-buffer" class="xref page">physical storage buffer</a>,
<a href="raytracing.html#shader-binding-table" class="xref page">shader binding table</a>,
<a href="descriptorsets.html#descriptorsets-storagetexelbuffer" class="xref page">storage texel buffer</a>, or
<a href="descriptorsets.html#descriptorsets-storageimage" class="xref page">storage image</a> in any shader pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_SHADER_WRITE_BIT</code> specifies write access to a
<a href="descriptorsets.html#descriptorsets-storagebuffer" class="xref page">storage buffer</a>,
<a href="descriptorsets.html#descriptorsets-physical-storage-buffer" class="xref page">physical storage buffer</a>,
<a href="descriptorsets.html#descriptorsets-storagetexelbuffer" class="xref page">storage texel buffer</a>, or
<a href="descriptorsets.html#descriptorsets-storageimage" class="xref page">storage image</a> in any shader pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_COLOR_ATTACHMENT_READ_BIT</code> specifies read access to a
<a href="renderpass.html#renderpass" class="xref page">color attachment</a>, such as via
<a href="framebuffer.html#framebuffer-blending" class="xref page">blending</a> (other than
<a href="framebuffer.html#framebuffer-blend-advanced" class="xref page">advanced blend operations</a>),
<a href="framebuffer.html#framebuffer-logicop" class="xref page">logic operations</a> or certain
<a href="renderpass.html#renderpass-load-operations" class="xref page">render pass load operations</a> in the
<code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code> pipeline stage or
via <a href="fragops.html#fragops-shader-tileimage-reads" class="xref page">fragment shader tile image reads</a>
in the <code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_COLOR_ATTACHMENT_WRITE_BIT</code> specifies write access to a
<a href="renderpass.html#renderpass" class="xref page">color, resolve, or depth/stencil resolve attachment</a>
during a <a href="renderpass.html#renderpass" class="xref page">render pass</a> or via certain render pass
<a href="renderpass.html#renderpass-load-operations" class="xref page">load</a> and <a href="renderpass.html#renderpass-store-operations" class="xref page">    store</a> operations.
Such access occurs in the
<code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_READ_BIT</code> specifies read access
to a <a href="renderpass.html#renderpass" class="xref page">depth/stencil attachment</a>, via <a href="fragops.html#fragops-ds-state" class="xref page">    depth or stencil operations</a> or certain
<a href="renderpass.html#renderpass-load-operations" class="xref page">render pass load operations</a> in the
<code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code> or
<code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code> pipeline stages or via
<a href="fragops.html#fragops-shader-tileimage-reads" class="xref page">fragment shader tile image reads</a> in
the <code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT</code> specifies write
access to a <a href="renderpass.html#renderpass" class="xref page">depth/stencil attachment</a>, via
<a href="fragops.html#fragops-ds-state" class="xref page">depth or stencil operations</a> or certain render pass
<a href="renderpass.html#renderpass-load-operations" class="xref page">load</a> and <a href="renderpass.html#renderpass-store-operations" class="xref page">    store</a> operations.
Such access occurs in the
<code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code> or
<code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code> pipeline stages.</p>
</li>
<li>
<p><code>VK_ACCESS_TRANSFER_READ_BIT</code> specifies read access to an image or
buffer in a <a href="copies.html#copies" class="xref page">copy</a> operation.
Such access occurs in the <code>VK_PIPELINE_STAGE_2_ALL_TRANSFER_BIT</code>
pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_TRANSFER_WRITE_BIT</code> specifies write access to an image or
buffer in a <a href="clears.html#clears" class="xref page">clear</a> or <a href="copies.html#copies" class="xref page">copy</a> operation.
Such access occurs in the <code>VK_PIPELINE_STAGE_2_ALL_TRANSFER_BIT</code>
pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_HOST_READ_BIT</code> specifies read access by a host operation.
Accesses of this type are not performed through a resource, but directly
on memory.
Such access occurs in the <code>VK_PIPELINE_STAGE_HOST_BIT</code> pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_HOST_WRITE_BIT</code> specifies write access by a host
operation.
Accesses of this type are not performed through a resource, but directly
on memory.
Such access occurs in the <code>VK_PIPELINE_STAGE_HOST_BIT</code> pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_CONDITIONAL_RENDERING_READ_BIT_EXT</code> specifies read access
to a predicate as part of conditional rendering.
Such access occurs in the
<code>VK_PIPELINE_STAGE_CONDITIONAL_RENDERING_BIT_EXT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_TRANSFORM_FEEDBACK_WRITE_BIT_EXT</code> specifies write access
to a transform feedback buffer made when transform feedback is active.
Such access occurs in the
<code>VK_PIPELINE_STAGE_TRANSFORM_FEEDBACK_BIT_EXT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_TRANSFORM_FEEDBACK_COUNTER_READ_BIT_EXT</code> specifies read
access to a transform feedback counter buffer which is read when
<code>vkCmdBeginTransformFeedbackEXT</code> executes.
Such access occurs in the
<code>VK_PIPELINE_STAGE_TRANSFORM_FEEDBACK_BIT_EXT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_TRANSFORM_FEEDBACK_COUNTER_WRITE_BIT_EXT</code> specifies write
access to a transform feedback counter buffer which is written when
<code>vkCmdEndTransformFeedbackEXT</code> executes.
Such access occurs in the
<code>VK_PIPELINE_STAGE_TRANSFORM_FEEDBACK_BIT_EXT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_COMMAND_PREPROCESS_READ_BIT_NV</code> specifies reads from
buffer inputs to <a href="VK_NV_device_generated_commands/generatedcommands.html#vkCmdPreprocessGeneratedCommandsNV" class="xref page">vkCmdPreprocessGeneratedCommandsNV</a>.
Such access occurs in the
<code>VK_PIPELINE_STAGE_COMMAND_PREPROCESS_BIT_NV</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_COMMAND_PREPROCESS_WRITE_BIT_NV</code> specifies writes to the
target command buffer preprocess outputs in
<a href="VK_NV_device_generated_commands/generatedcommands.html#vkCmdPreprocessGeneratedCommandsNV" class="xref page">vkCmdPreprocessGeneratedCommandsNV</a>.
Such access occurs in the
<code>VK_PIPELINE_STAGE_COMMAND_PREPROCESS_BIT_NV</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_COLOR_ATTACHMENT_READ_NONCOHERENT_BIT_EXT</code> specifies read
access to <a href="renderpass.html#renderpass" class="xref page">color attachments</a>, including
<a href="framebuffer.html#framebuffer-blend-advanced" class="xref page">advanced blend operations</a>.
Such access occurs in the
<code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_2_INVOCATION_MASK_READ_BIT_HUAWEI</code> specifies read access
to a invocation mask image in the
<code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_ACCELERATION_STRUCTURE_READ_BIT_KHR</code> specifies read
access to an acceleration structure as part of a trace, build, or copy
command, or to an <a href="accelstructures.html#acceleration-structure-scratch" class="xref page">acceleration    structure scratch buffer</a> as part of a build command.
Such access occurs in the
<code>VK_PIPELINE_STAGE_RAY_TRACING_SHADER_BIT_KHR</code> pipeline stage or
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code> pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_ACCELERATION_STRUCTURE_WRITE_BIT_KHR</code> specifies write
access to an acceleration structure or <a href="accelstructures.html#acceleration-structure-scratch" class="xref page">    acceleration structure scratch buffer</a> as part of a build or copy
command.
Such access occurs in the
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code> pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_FRAGMENT_DENSITY_MAP_READ_BIT_EXT</code> specifies read access
to a <a href="renderpass.html#renderpass-fragmentdensitymapattachment" class="xref page">fragment density map    attachment</a> during dynamic <a href="fragmentdensitymapops.html#fragmentdensitymapops" class="xref page">fragment density    map operations</a> Such access occurs in the
<code>VK_PIPELINE_STAGE_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_FRAGMENT_SHADING_RATE_ATTACHMENT_READ_BIT_KHR</code> specifies
read access to a fragment shading rate attachment during rasterization.
Such access occurs in the
<code>VK_PIPELINE_STAGE_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code>
pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_SHADING_RATE_IMAGE_READ_BIT_NV</code> specifies read access to
a shading rate image during rasterization.
Such access occurs in the
<code>VK_PIPELINE_STAGE_SHADING_RATE_IMAGE_BIT_NV</code> pipeline stage.
It is equivalent to
<code>VK_PIPELINE_STAGE_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Certain access types are only performed by a subset of pipeline stages.
Any synchronization command that takes both stage masks and access masks
uses both to define the <a href="#synchronization-dependencies-access-scopes">access scopes</a> - only the specified access types performed by the specified stages
are included in the access scope.
An application <strong>must</strong> not specify an access flag in a synchronization command
if it does not include a pipeline stage in the corresponding stage mask that
is able to perform accesses of that type.
The following table lists, for each access flag, which pipeline stages <strong>can</strong>
perform that type of access.</p>
</div>
<table id="synchronization-access-types-supported" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Supported access types</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Access flag</th>
<th class="tableblock halign-left valign-top">Supported pipeline stages</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_NONE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_INDIRECT_COMMAND_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_INDEX_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_VERTEX_INPUT_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_INDEX_INPUT_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_VERTEX_ATTRIBUTE_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_VERTEX_INPUT_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_VERTEX_ATTRIBUTE_INPUT_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_UNIFORM_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_VERTEX_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_COMPUTE_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code>,
	<code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code>,
	<code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code>,
	<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code>,
	<code>VK_PIPELINE_STAGE_2_CLUSTER_CULLING_SHADER_BIT_HUAWEI</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_INPUT_ATTACHMENT_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_SHADER_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
	<code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code>,
	<code>VK_PIPELINE_STAGE_2_VERTEX_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_COMPUTE_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code>,
	<code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code>,
	<code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code>,
	<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code>,
	<code>VK_PIPELINE_STAGE_2_CLUSTER_CULLING_SHADER_BIT_HUAWEI</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_SHADER_WRITE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_VERTEX_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_COMPUTE_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code>,
	<code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code>,
	<code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code>,
	<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code>,
	<code>VK_PIPELINE_STAGE_2_CLUSTER_CULLING_SHADER_BIT_HUAWEI</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_COLOR_ATTACHMENT_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_COLOR_ATTACHMENT_WRITE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_TRANSFER_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_ALL_TRANSFER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_COPY_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_RESOLVE_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_BLIT_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
	<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
	<code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_TRANSFER_WRITE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_ALL_TRANSFER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_COPY_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_RESOLVE_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_BLIT_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_CLEAR_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
	<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
	<code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_HOST_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_HOST_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_HOST_WRITE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_HOST_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_MEMORY_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_MEMORY_WRITE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_SHADER_SAMPLED_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_VERTEX_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_COMPUTE_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code>,
	<code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code>,
	<code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code>,
	<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code>,
	<code>VK_PIPELINE_STAGE_2_CLUSTER_CULLING_SHADER_BIT_HUAWEI</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_SHADER_STORAGE_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_VERTEX_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_COMPUTE_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code>,
	<code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code>,
	<code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code>,
	<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code>,
	<code>VK_PIPELINE_STAGE_2_CLUSTER_CULLING_SHADER_BIT_HUAWEI</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_SHADER_STORAGE_WRITE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_VERTEX_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_COMPUTE_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code>,
	<code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code>,
	<code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code>,
	<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code>,
	<code>VK_PIPELINE_STAGE_2_CLUSTER_CULLING_SHADER_BIT_HUAWEI</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_VIDEO_DECODE_READ_BIT_KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_VIDEO_DECODE_WRITE_BIT_KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_VIDEO_ENCODE_READ_BIT_KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_VIDEO_ENCODE_WRITE_BIT_KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_TRANSFORM_FEEDBACK_WRITE_BIT_EXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_TRANSFORM_FEEDBACK_COUNTER_READ_BIT_EXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_TRANSFORM_FEEDBACK_COUNTER_WRITE_BIT_EXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_CONDITIONAL_RENDERING_READ_BIT_EXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_COMMAND_PREPROCESS_READ_BIT_NV</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_COMMAND_PREPROCESS_BIT_NV</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_COMMAND_PREPROCESS_WRITE_BIT_NV</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_COMMAND_PREPROCESS_BIT_NV</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_FRAGMENT_SHADING_RATE_ATTACHMENT_READ_BIT_KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_ACCELERATION_STRUCTURE_READ_BIT_KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_VERTEX_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_COMPUTE_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code>,
	<code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code>,
	<code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code>,
	<code>VK_PIPELINE_STAGE_2_CLUSTER_CULLING_SHADER_BIT_HUAWEI</code>,
	<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
	<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
	<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_ACCELERATION_STRUCTURE_WRITE_BIT_KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
	<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_FRAGMENT_DENSITY_MAP_READ_BIT_EXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_COLOR_ATTACHMENT_READ_NONCOHERENT_BIT_EXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_DESCRIPTOR_BUFFER_READ_BIT_EXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_VERTEX_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_COMPUTE_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code>,
	<code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code>,
	<code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code>,
	<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code>,
	<code>VK_PIPELINE_STAGE_2_CLUSTER_CULLING_SHADER_BIT_HUAWEI</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_INVOCATION_MASK_READ_BIT_HUAWEI</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_SHADER_BINDING_TABLE_READ_BIT_KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_VERTEX_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_COMPUTE_SHADER_BIT</code>,
	<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code>,
	<code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code>,
	<code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code>,
	<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code>,
	<code>VK_PIPELINE_STAGE_2_CLUSTER_CULLING_SHADER_BIT_HUAWEI</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_MICROMAP_READ_BIT_EXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code>,
	<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_MICROMAP_WRITE_BIT_EXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_OPTICAL_FLOW_READ_BIT_NV</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_OPTICAL_FLOW_BIT_NV</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_2_OPTICAL_FLOW_WRITE_BIT_NV</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_2_OPTICAL_FLOW_BIT_NV</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkAccessFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef VkFlags VkAccessFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkAccessFlags</code> is a bitmask type for setting a mask of zero or more
<a href="#VkAccessFlagBits">VkAccessFlagBits</a>.</p>
</div>
</div>
</div>
<div id="synchronization-host-access-types" class="paragraph">
<p>If a memory object does not have the
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code> property, then
<a href="memory.html#vkFlushMappedMemoryRanges" class="xref page">vkFlushMappedMemoryRanges</a> <strong>must</strong> be called in order to guarantee that
writes to the memory object from the host are made available to the host
domain, where they <strong>can</strong> be further made available to the device domain via a
domain operation.
Similarly, <a href="memory.html#vkInvalidateMappedMemoryRanges" class="xref page">vkInvalidateMappedMemoryRanges</a> <strong>must</strong> be called to guarantee
that writes which are available to the host domain are made visible to host
operations.</p>
</div>
<div class="paragraph">
<p>If the memory object does have the
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code> property flag, writes to the
memory object from the host are automatically made available to the host
domain.
Similarly, writes made available to the host domain are automatically made
visible to the host.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p><a href="devsandqueues.html#devsandqueues-submission" class="xref page">Queue submission commands</a> automatically
perform a <a href="#synchronization-submission-host-writes">domain operation from host to device</a> for all writes performed before the command executes, so in
most cases an explicit memory barrier is not needed for this case.
In the few circumstances where a submit does not occur between the host
write and the device read access, writes <strong>can</strong> be made available by using an
explicit memory barrier.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-framebuffer-regions"><a class="anchor" href="#synchronization-framebuffer-regions"></a>Framebuffer Region Dependencies</h3>
<div class="paragraph">
<p><a href="#synchronization-pipeline-stages">Pipeline stages</a> that operate on, or
with respect to, the framebuffer are collectively the <em>framebuffer-space</em>
pipeline stages.
These stages are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For these pipeline stages, an execution or memory dependency from the first
set of operations to the second set <strong>can</strong> either be a single
<em>framebuffer-global</em> dependency, or split into multiple <em>framebuffer-local</em>
dependencies.
A dependency with non-framebuffer-space pipeline stages is neither
framebuffer-global nor framebuffer-local.</p>
</div>
<div class="paragraph">
<p>A <em>framebuffer region</em> is a subset of the entire framebuffer, and <strong>can</strong>
either be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <em>sample region</em>, which is set of sample (x, y, layer, sample)
coordinates that is a subset of the entire framebuffer, or</p>
</li>
<li>
<p>A <em>fragment region</em>, which is a set of fragment (x, y, layer)
coordinates that is a subset of the entire framebuffer.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both <a href="#synchronization-dependencies-scopes">synchronization scopes</a> of a
framebuffer-local dependency include only the operations performed within
corresponding framebuffer regions (as defined below).
No ordering guarantees are made between different framebuffer regions for a
framebuffer-local dependency.</p>
</div>
<div class="paragraph">
<p>Both <a href="#synchronization-dependencies-scopes">synchronization scopes</a> of a
framebuffer-global dependency include operations on all framebuffer-regions.</p>
</div>
<div class="paragraph">
<p>If the first synchronization scope includes operations on pixels/fragments
with N samples and the second synchronization scope includes operations on
pixels/fragments with M samples, where N does not equal M, then a
framebuffer region containing all samples at a given (x, y, layer)
coordinate in the first synchronization scope corresponds to a region
containing all samples at the same coordinate in the second synchronization
scope.
In other words, the framebuffer region is a fragment region and it is a
pixel granularity dependency.
If N equals M,
and if the <code>VkSubpassDescription</code>::<code>flags</code> does not specify the
<code>VK_SUBPASS_DESCRIPTION_FRAGMENT_REGION_BIT_QCOM</code> flag,
then a framebuffer region containing a single (x, y, layer, sample)
coordinate in the first synchronization scope corresponds to a region
containing the same sample at the same coordinate in the second
synchronization scope.
In other words, the framebuffer region is a sample region and it is a sample
granularity dependency.</p>
</div>
<div class="paragraph">
<p>If the pipeline performing the operation was created with
<code>VK_PIPELINE_COLOR_BLEND_STATE_CREATE_RASTERIZATION_ORDER_ATTACHMENT_ACCESS_BIT_EXT</code>,
<code>VK_PIPELINE_DEPTH_STENCIL_STATE_CREATE_RASTERIZATION_ORDER_ATTACHMENT_DEPTH_ACCESS_BIT_EXT</code>,
or
<code>VK_PIPELINE_DEPTH_STENCIL_STATE_CREATE_RASTERIZATION_ORDER_ATTACHMENT_STENCIL_ACCESS_BIT_EXT</code>,
the framebuffer region is a fragment region and it is a pixel granularity
dependency.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Since fragment shader invocations are not specified to run in any particular
groupings, the size of a framebuffer region is implementation-dependent, not
known to the application, and <strong>must</strong> be assumed to be no larger than
specified above.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Practically, the pixel vs. sample granularity dependency means that if an
input attachment has a different number of samples than the pipeline&#8217;s
<code>rasterizationSamples</code>, then a fragment <strong>can</strong> access any sample in the
input attachment&#8217;s pixel even if it only uses framebuffer-local
dependencies.
If the input attachment has the same number of samples, then the fragment
<strong>can</strong> only access the covered samples in its input <code>SampleMask</code> (i.e. the
fragment operations happen-after a framebuffer-local dependency for each
sample the fragment covers).
To access samples that are not covered,
either the <code>VkSubpassDescription</code>::<code>flags</code>
<code>VK_SUBPASS_DESCRIPTION_FRAGMENT_REGION_BIT_QCOM</code> flag is required, or
a framebuffer-global dependency is required.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If a synchronization command includes a <code>dependencyFlags</code> parameter, and
specifies the <code>VK_DEPENDENCY_BY_REGION_BIT</code> flag, then it defines
framebuffer-local dependencies for the framebuffer-space pipeline stages in
that synchronization command, for all framebuffer regions.
If no <code>dependencyFlags</code> parameter is included, or the
<code>VK_DEPENDENCY_BY_REGION_BIT</code> flag is not specified, then a
framebuffer-global dependency is specified for those stages.
The <code>VK_DEPENDENCY_BY_REGION_BIT</code> flag does not affect the dependencies
between non-framebuffer-space pipeline stages, nor does it affect the
dependencies between framebuffer-space and non-framebuffer-space pipeline
stages.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Framebuffer-local dependencies are more efficient for most architectures;
particularly tile-based architectures - which can keep framebuffer-regions
entirely in on-chip registers and thus avoid external bandwidth across such
a dependency.
Including a framebuffer-global dependency in your rendering will usually
force all implementations to flush data to memory, or to a higher level
cache, breaking any potential locality optimizations.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-view-local-dependencies"><a class="anchor" href="#synchronization-view-local-dependencies"></a>View-Local Dependencies</h3>
<div class="paragraph">
<p>In a render pass instance that has <a href="renderpass.html#renderpass-multiview" class="xref page">multiview</a>
enabled, dependencies <strong>can</strong> be either view-local or view-global.</p>
</div>
<div class="paragraph">
<p>A view-local dependency only includes operations from a single
<a href="renderpass.html#renderpass-multiview-view-local" class="xref page">source view</a> from the source subpass in
the first synchronization scope, and only includes operations from a single
<a href="renderpass.html#renderpass-multiview-view-local" class="xref page">destination view</a> from the destination
subpass in the second synchronization scope.
A view-global dependency includes all views in the view mask of the source
and destination subpasses in the corresponding synchronization scopes.</p>
</div>
<div class="paragraph">
<p>If a synchronization command includes a <code>dependencyFlags</code> parameter and
specifies the <code>VK_DEPENDENCY_VIEW_LOCAL_BIT</code> flag, then it defines
view-local dependencies for that synchronization command, for all views.
If no <code>dependencyFlags</code> parameter is included or the
<code>VK_DEPENDENCY_VIEW_LOCAL_BIT</code> flag is not specified, then a view-global
dependency is specified.</p>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-device-local-dependencies"><a class="anchor" href="#synchronization-device-local-dependencies"></a>Device-Local Dependencies</h3>
<div class="paragraph">
<p>Dependencies <strong>can</strong> be either device-local or non-device-local.
A device-local dependency acts as multiple separate dependencies, one for
each physical device that executes the synchronization command, where each
dependency only includes operations from that physical device in both
synchronization scopes.
A non-device-local dependency is a single dependency where both
synchronization scopes include operations from all physical devices that
participate in the synchronization command.
For subpass dependencies, all physical devices in the
<a href="renderpass.html#VkDeviceGroupRenderPassBeginInfo" class="xref page">VkDeviceGroupRenderPassBeginInfo</a>::<code>deviceMask</code> participate in the
dependency, and for pipeline barriers all physical devices that are set in
the command buffer&#8217;s current device mask participate in the dependency.</p>
</div>
<div class="paragraph">
<p>If a synchronization command includes a <code>dependencyFlags</code> parameter and
specifies the <code>VK_DEPENDENCY_DEVICE_GROUP_BIT</code> flag, then it defines a
non-device-local dependency for that synchronization command.
If no <code>dependencyFlags</code> parameter is included or the
<code>VK_DEPENDENCY_DEVICE_GROUP_BIT</code> flag is not specified, then it defines
device-local dependencies for that synchronization command, for all
participating physical devices.</p>
</div>
<div class="paragraph">
<p>Semaphore and event dependencies are device-local and only execute on the
one physical device that performs the dependency.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="synchronization-implicit"><a class="anchor" href="#synchronization-implicit"></a>Implicit Synchronization Guarantees</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A small number of implicit ordering guarantees are provided by Vulkan,
ensuring that the order in which commands are submitted is meaningful, and
avoiding unnecessary complexity in common operations.</p>
</div>
<div id="synchronization-submission-order" class="paragraph">
<p><em>Submission order</em> is a fundamental ordering in Vulkan, giving meaning to
the order in which <a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">action and synchronization commands</a> are recorded and submitted to a single queue.
Explicit and implicit ordering guarantees between commands in Vulkan all
work on the premise that this ordering is meaningful.
This order does not itself define any execution or memory dependencies;
synchronization commands and other orderings within the API use this
ordering to define their scopes.</p>
</div>
<div class="paragraph">
<p>Submission order for any given set of commands is based on the order in
which they were recorded to command buffers and then submitted.
This order is determined as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The initial order is determined by the order in which
<a href="cmdbuffers.html#vkQueueSubmit" class="xref page">vkQueueSubmit</a>
and <a href="cmdbuffers.html#vkQueueSubmit2" class="xref page">vkQueueSubmit2</a>
commands are executed on the host, for a single queue, from first to
last.</p>
</li>
<li>
<p>The order in which <a href="cmdbuffers.html#VkSubmitInfo" class="xref page">VkSubmitInfo</a> structures are specified in the
<code>pSubmits</code> parameter of <a href="cmdbuffers.html#vkQueueSubmit" class="xref page">vkQueueSubmit</a>,
or in which <a href="cmdbuffers.html#VkSubmitInfo2" class="xref page">VkSubmitInfo2</a> structures are specified in the
<code>pSubmits</code> parameter of <a href="cmdbuffers.html#vkQueueSubmit2" class="xref page">vkQueueSubmit2</a>,
from lowest index to highest.</p>
</li>
<li>
<p>The order in which command buffers are specified in the
<code>pCommandBuffers</code> member of <a href="cmdbuffers.html#VkSubmitInfo" class="xref page">VkSubmitInfo</a>
or <a href="cmdbuffers.html#VkSubmitInfo2" class="xref page">VkSubmitInfo2</a>
from lowest index to highest.</p>
</li>
<li>
<p>The order in which commands were recorded to a command buffer on the
host, from first to last:</p>
<div class="ulist">
<ul>
<li>
<p>For commands recorded outside a render pass, this includes all other
commands recorded outside a render pass, including
<a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">vkCmdBeginRenderPass</a> and <a href="renderpass.html#vkCmdEndRenderPass" class="xref page">vkCmdEndRenderPass</a> commands; it
does not directly include commands inside a render pass.</p>
</li>
<li>
<p>For commands recorded inside a render pass, this includes all other
     commands recorded inside the same subpass, including the
     <a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">vkCmdBeginRenderPass</a> and <a href="renderpass.html#vkCmdEndRenderPass" class="xref page">vkCmdEndRenderPass</a> commands that
     delimit the same render pass instance; it does not include commands
     recorded to other subpasses.
<a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">State commands</a> do not execute
any operations on the device, instead they set the state of the command
buffer when they execute on the host, in the order that they are recorded.
<a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Action commands</a> consume the
current state of the command buffer when they are recorded, and will execute
state changes on the device as required to match the recorded state.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a href="drawing.html#drawing-primitive-order" class="xref page">The order of primitives passing through the graphics pipeline</a> and
<a href="#synchronization-image-barrier-layout-transition-order">image layout transitions as part of an image memory barrier</a> provide additional
guarantees based on submission order.</p>
</div>
<div class="paragraph">
<p>Execution of <a href="#synchronization-pipeline-stages-order">pipeline stages</a>
within a given command also has a loose ordering, dependent only on a single
command.</p>
</div>
<div id="synchronization-signal-operation-order" class="paragraph">
<p><em>Signal operation order</em> is a fundamental ordering in Vulkan, giving meaning
to the order in which semaphore and fence signal operations occur when
submitted to a single queue.
The signal operation order for queue operations is determined as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The initial order is determined by the order in which
<a href="cmdbuffers.html#vkQueueSubmit" class="xref page">vkQueueSubmit</a>
and <a href="cmdbuffers.html#vkQueueSubmit2" class="xref page">vkQueueSubmit2</a>
commands are executed on the host, for a single queue, from first to
last.</p>
</li>
<li>
<p>The order in which <a href="cmdbuffers.html#VkSubmitInfo" class="xref page">VkSubmitInfo</a> structures are specified in the
<code>pSubmits</code> parameter of <a href="cmdbuffers.html#vkQueueSubmit" class="xref page">vkQueueSubmit</a>,
or in which <a href="cmdbuffers.html#VkSubmitInfo2" class="xref page">VkSubmitInfo2</a> structures are specified in the
<code>pSubmits</code> parameter of <a href="cmdbuffers.html#vkQueueSubmit2" class="xref page">vkQueueSubmit2</a>,
from lowest index to highest.</p>
</li>
<li>
<p>The fence signal operation defined by the <code>fence</code> parameter of a
    <a href="cmdbuffers.html#vkQueueSubmit" class="xref page">vkQueueSubmit</a>
or <a href="cmdbuffers.html#vkQueueSubmit2" class="xref page">vkQueueSubmit2</a>
or <a href="sparsemem.html#vkQueueBindSparse" class="xref page">vkQueueBindSparse</a>
    command is ordered after all semaphore signal operations defined by that
    command.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Semaphore signal operations defined by a single <a href="cmdbuffers.html#VkSubmitInfo" class="xref page">VkSubmitInfo</a>
or <a href="cmdbuffers.html#VkSubmitInfo2" class="xref page">VkSubmitInfo2</a>
or <a href="sparsemem.html#VkBindSparseInfo" class="xref page">VkBindSparseInfo</a>
structure are unordered with respect to other semaphore signal operations
defined within the same structure.</p>
</div>
<div class="paragraph">
<p>The <a href="#vkSignalSemaphore">vkSignalSemaphore</a> command does not execute on a queue but instead
performs the signal operation from the host.
The semaphore signal operation defined by executing a
<a href="#vkSignalSemaphore">vkSignalSemaphore</a> command happens-after the <a href="#vkSignalSemaphore">vkSignalSemaphore</a>
command is invoked and happens-before the command returns.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>When signaling timeline semaphores, it is the responsibility of the
application to ensure that they are ordered such that the semaphore value is
strictly increasing.
Because the first synchronization scope for a semaphore signal operation
contains all semaphore signal operations which occur earlier in submission
order, all semaphore signal operations contained in any given batch are
guaranteed to happen-after all semaphore signal operations contained in any
previous batches.
However, no ordering guarantee is provided between the semaphore signal
operations defined within a single batch.
This, combined with the requirement that timeline semaphore values strictly
increase, means that it is invalid to signal the same timeline semaphore
twice within a single batch.</p>
</div>
<div class="paragraph">
<p>If an application wishes to ensure that some semaphore signal operation
happens-after some other semaphore signal operation, it can submit a
separate batch containing only semaphore signal operations, which will
happen-after the semaphore signal operations in any earlier batches.</p>
</div>
<div class="paragraph">
<p>When signaling a semaphore from the host, the only ordering guarantee is
that the signal operation happens-after when <a href="#vkSignalSemaphore">vkSignalSemaphore</a> is
called and happens-before it returns.
Therefore, it is invalid to call <code>vkSignalSemaphore</code> while there are any
outstanding signal operations on that semaphore from any queue submissions
unless those queue submissions have some dependency which ensures that they
happen-after the host signal operation.
One example of this would be if the pending signal operation is, itself,
waiting on the same semaphore at a lower value and the call to
<code>vkSignalSemaphore</code> signals that lower value.
Furthermore, if there are two or more processes or threads signaling the
same timeline semaphore from the host, the application must ensure that the
<code>vkSignalSemaphore</code> with the lower semaphore value returns before
<code>vkSignalSemaphore</code> is called with the higher value.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="synchronization-fences"><a class="anchor" href="#synchronization-fences"></a>Fences</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Fences are a synchronization primitive that <strong>can</strong> be used to insert a
dependency from a queue to the host.
Fences have two states - signaled and unsignaled.
A fence <strong>can</strong> be signaled as part of the execution of a
<a href="devsandqueues.html#devsandqueues-submission" class="xref page">queue submission</a> command.
Fences <strong>can</strong> be unsignaled on the host with <a href="#vkResetFences">vkResetFences</a>.
Fences <strong>can</strong> be waited on by the host with the <a href="#vkWaitForFences">vkWaitForFences</a> command,
and the current state <strong>can</strong> be queried with <a href="#vkGetFenceStatus">vkGetFenceStatus</a>.</p>
</div>
<div id="synchronization-fences-payloads" class="paragraph">
<p>The internal data of a fence <strong>may</strong> include a reference to any resources and
pending work associated with signal or unsignal operations performed on that
fence object, collectively referred to as the fence&#8217;s <em>payload</em>.
Mechanisms to import and export that internal data to and from fences are
provided <a href="#VkExportFenceCreateInfo">below</a>.
These mechanisms indirectly enable applications to share fence state between
two or more fences and other synchronization primitives across process and
API boundaries.</p>
</div>
<div class="paragraph">
<p>Fences are represented by <code>VkFence</code> handles:</p>
</div>
<div id="VkFence" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkFence)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a fence, call:</p>
</div>
<div id="vkCreateFence" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VkResult vkCreateFence(
    VkDevice                                    device,
    const VkFenceCreateInfo*                    pCreateInfo,
    const VkAllocationCallbacks*                pAllocator,
    VkFence*                                    pFence);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the fence.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to a <a href="#VkFenceCreateInfo">VkFenceCreateInfo</a> structure
containing information about how the fence is to be created.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="memory.html#memory-allocation" class="xref page">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pFence</code> is a pointer to a handle in which the resulting fence
object is returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateFence-device-parameter" href="#VUID-vkCreateFence-device-parameter"></a> <span class="vuid">VUID-vkCreateFence-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateFence-pCreateInfo-parameter" href="#VUID-vkCreateFence-pCreateInfo-parameter"></a> <span class="vuid">VUID-vkCreateFence-pCreateInfo-parameter</span><br>
 <code>pCreateInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkFenceCreateInfo">VkFenceCreateInfo</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateFence-pAllocator-parameter" href="#VUID-vkCreateFence-pAllocator-parameter"></a> <span class="vuid">VUID-vkCreateFence-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong>must</strong> be a valid pointer to a valid <a href="memory.html#VkAllocationCallbacks" class="xref page">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateFence-pFence-parameter" href="#VUID-vkCreateFence-pFence-parameter"></a> <span class="vuid">VUID-vkCreateFence-pFence-parameter</span><br>
 <code>pFence</code> <strong>must</strong> be a valid pointer to a <a href="#VkFence">VkFence</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkFenceCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkFenceCreateInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef struct VkFenceCreateInfo {
    VkStructureType       sType;
    const void*           pNext;
    VkFenceCreateFlags    flags;
} VkFenceCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkFenceCreateFlagBits">VkFenceCreateFlagBits</a> specifying the
initial state and behavior of the fence.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkFenceCreateInfo-sType-sType" href="#VUID-VkFenceCreateInfo-sType-sType"></a> <span class="vuid">VUID-VkFenceCreateInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_FENCE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkFenceCreateInfo-pNext-pNext" href="#VUID-VkFenceCreateInfo-pNext-pNext"></a> <span class="vuid">VUID-VkFenceCreateInfo-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="#VkExportFenceCreateInfo">VkExportFenceCreateInfo</a> or <a href="#VkExportFenceWin32HandleInfoKHR">VkExportFenceWin32HandleInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkFenceCreateInfo-sType-unique" href="#VUID-VkFenceCreateInfo-sType-unique"></a> <span class="vuid">VUID-VkFenceCreateInfo-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkFenceCreateInfo-flags-parameter" href="#VUID-VkFenceCreateInfo-flags-parameter"></a> <span class="vuid">VUID-VkFenceCreateInfo-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkFenceCreateFlagBits">VkFenceCreateFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkFenceCreateFlagBits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef enum VkFenceCreateFlagBits {
    VK_FENCE_CREATE_SIGNALED_BIT = 0x00000001,
} VkFenceCreateFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_FENCE_CREATE_SIGNALED_BIT</code> specifies that the fence object is
created in the signaled state.
Otherwise, it is created in the unsignaled state.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkFenceCreateFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef VkFlags VkFenceCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkFenceCreateFlags</code> is a bitmask type for setting a mask of zero or
more <a href="#VkFenceCreateFlagBits">VkFenceCreateFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a fence whose payload <strong>can</strong> be exported to external handles, add a
<a href="#VkExportFenceCreateInfo">VkExportFenceCreateInfo</a> structure to the <code>pNext</code> chain of the
<a href="#VkFenceCreateInfo">VkFenceCreateInfo</a> structure.
The <code>VkExportFenceCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkExportFenceCreateInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_1
typedef struct VkExportFenceCreateInfo {
    VkStructureType                   sType;
    const void*                       pNext;
    VkExternalFenceHandleTypeFlags    handleTypes;
} VkExportFenceCreateInfo;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkExportFenceCreateInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_fence
typedef VkExportFenceCreateInfo VkExportFenceCreateInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>handleTypes</code> is a bitmask of
<a href="capabilities.html#VkExternalFenceHandleTypeFlagBits" class="xref page">VkExternalFenceHandleTypeFlagBits</a> specifying one or more fence
handle types the application <strong>can</strong> export from the resulting fence.
The application <strong>can</strong> request multiple handle types for the same fence.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkExportFenceCreateInfo-handleTypes-01446" href="#VUID-VkExportFenceCreateInfo-handleTypes-01446"></a> <span class="vuid">VUID-VkExportFenceCreateInfo-handleTypes-01446</span><br>

The bits in <code>handleTypes</code> <strong>must</strong> be supported and compatible, as
reported by <a href="capabilities.html#VkExternalFenceProperties" class="xref page">VkExternalFenceProperties</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkExportFenceCreateInfo-sType-sType" href="#VUID-VkExportFenceCreateInfo-sType-sType"></a> <span class="vuid">VUID-VkExportFenceCreateInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_EXPORT_FENCE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkExportFenceCreateInfo-handleTypes-parameter" href="#VUID-VkExportFenceCreateInfo-handleTypes-parameter"></a> <span class="vuid">VUID-VkExportFenceCreateInfo-handleTypes-parameter</span><br>
 <code>handleTypes</code> <strong>must</strong> be a valid combination of <a href="capabilities.html#VkExternalFenceHandleTypeFlagBits" class="xref page">VkExternalFenceHandleTypeFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To specify additional attributes of NT handles exported from a fence, add a
<a href="#VkExportFenceWin32HandleInfoKHR">VkExportFenceWin32HandleInfoKHR</a> structure to the <code>pNext</code> chain of
the <a href="#VkFenceCreateInfo">VkFenceCreateInfo</a> structure.
The <code>VkExportFenceWin32HandleInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkExportFenceWin32HandleInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_fence_win32
typedef struct VkExportFenceWin32HandleInfoKHR {
    VkStructureType               sType;
    const void*                   pNext;
    const SECURITY_ATTRIBUTES*    pAttributes;
    DWORD                         dwAccess;
    LPCWSTR                       name;
} VkExportFenceWin32HandleInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pAttributes</code> is a pointer to a Windows <code>SECURITY_ATTRIBUTES</code>
structure specifying security attributes of the handle.</p>
</li>
<li>
<p><code>dwAccess</code> is a <code>DWORD</code> specifying access rights of the handle.</p>
</li>
<li>
<p><code>name</code> is a null-terminated UTF-16 string to associate with the
underlying synchronization primitive referenced by NT handles exported
from the created fence.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <a href="#VkExportFenceCreateInfo">VkExportFenceCreateInfo</a> is not included in the same <code>pNext</code>
chain, this structure is ignored.</p>
</div>
<div class="paragraph">
<p>If <a href="#VkExportFenceCreateInfo">VkExportFenceCreateInfo</a> is included in the <code>pNext</code> chain of
<a href="#VkFenceCreateInfo">VkFenceCreateInfo</a> with a Windows <code>handleType</code>, but either
<code>VkExportFenceWin32HandleInfoKHR</code> is not included in the <code>pNext</code>
chain, or it is included but <code>pAttributes</code> is set to <code>NULL</code>, default
security descriptor values will be used, and child processes created by the
application will not inherit the handle, as described in the MSDN
documentation for &#8220;Synchronization Object Security and Access Rights&#8221;<sup>1</sup>.
Further, if the structure is not present, the access rights will be</p>
</div>
<div class="paragraph">
<p><code>DXGI_SHARED_RESOURCE_READ</code> | <code>DXGI_SHARED_RESOURCE_WRITE</code></p>
</div>
<div class="paragraph">
<p>for handles of the following types:</p>
</div>
<div class="paragraph">
<p><code>VK_EXTERNAL_FENCE_HANDLE_TYPE_OPAQUE_WIN32_BIT</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">1</dt>
<dd>
<p><a href="https://docs.microsoft.com/en-us/windows/win32/sync/synchronization-object-security-and-access-rights" class="bare">https://docs.microsoft.com/en-us/windows/win32/sync/synchronization-object-security-and-access-rights</a></p>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkExportFenceWin32HandleInfoKHR-handleTypes-01447" href="#VUID-VkExportFenceWin32HandleInfoKHR-handleTypes-01447"></a> <span class="vuid">VUID-VkExportFenceWin32HandleInfoKHR-handleTypes-01447</span><br>

If <a href="#VkExportFenceCreateInfo">VkExportFenceCreateInfo</a>::<code>handleTypes</code> does not include
<code>VK_EXTERNAL_FENCE_HANDLE_TYPE_OPAQUE_WIN32_BIT</code>, a
<code>VkExportFenceWin32HandleInfoKHR</code> structure <strong>must</strong> not be included in
the <code>pNext</code> chain of <a href="#VkFenceCreateInfo">VkFenceCreateInfo</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkExportFenceWin32HandleInfoKHR-sType-sType" href="#VUID-VkExportFenceWin32HandleInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkExportFenceWin32HandleInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_EXPORT_FENCE_WIN32_HANDLE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkExportFenceWin32HandleInfoKHR-pAttributes-parameter" href="#VUID-VkExportFenceWin32HandleInfoKHR-pAttributes-parameter"></a> <span class="vuid">VUID-VkExportFenceWin32HandleInfoKHR-pAttributes-parameter</span><br>
 If <code>pAttributes</code> is not <code>NULL</code>, <code>pAttributes</code> <strong>must</strong> be a valid pointer to a valid <code>SECURITY_ATTRIBUTES</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To export a Windows handle representing the state of a fence, call:</p>
</div>
<div id="vkGetFenceWin32HandleKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_fence_win32
VkResult vkGetFenceWin32HandleKHR(
    VkDevice                                    device,
    const VkFenceGetWin32HandleInfoKHR*         pGetWin32HandleInfo,
    HANDLE*                                     pHandle);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that created the fence being
exported.</p>
</li>
<li>
<p><code>pGetWin32HandleInfo</code> is a pointer to a
<a href="#VkFenceGetWin32HandleInfoKHR">VkFenceGetWin32HandleInfoKHR</a> structure containing parameters of
the export operation.</p>
</li>
<li>
<p><code>pHandle</code> will return the Windows handle representing the fence
state.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For handle types defined as NT handles, the handles returned by
<code>vkGetFenceWin32HandleKHR</code> are owned by the application.
To avoid leaking resources, the application <strong>must</strong> release ownership of them
using the <code>CloseHandle</code> system call when they are no longer needed.</p>
</div>
<div class="paragraph">
<p>Exporting a Windows handle from a fence <strong>may</strong> have side effects depending on
the transference of the specified handle type, as described in
<a href="#synchronization-fences-importing">Importing Fence Payloads</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetFenceWin32HandleKHR-device-parameter" href="#VUID-vkGetFenceWin32HandleKHR-device-parameter"></a> <span class="vuid">VUID-vkGetFenceWin32HandleKHR-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetFenceWin32HandleKHR-pGetWin32HandleInfo-parameter" href="#VUID-vkGetFenceWin32HandleKHR-pGetWin32HandleInfo-parameter"></a> <span class="vuid">VUID-vkGetFenceWin32HandleKHR-pGetWin32HandleInfo-parameter</span><br>
 <code>pGetWin32HandleInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkFenceGetWin32HandleInfoKHR">VkFenceGetWin32HandleInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetFenceWin32HandleKHR-pHandle-parameter" href="#VUID-vkGetFenceWin32HandleKHR-pHandle-parameter"></a> <span class="vuid">VUID-vkGetFenceWin32HandleKHR-pHandle-parameter</span><br>
 <code>pHandle</code> <strong>must</strong> be a valid pointer to a <code>HANDLE</code> value</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkFenceGetWin32HandleInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkFenceGetWin32HandleInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_fence_win32
typedef struct VkFenceGetWin32HandleInfoKHR {
    VkStructureType                      sType;
    const void*                          pNext;
    VkFence                              fence;
    VkExternalFenceHandleTypeFlagBits    handleType;
} VkFenceGetWin32HandleInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>fence</code> is the fence from which state will be exported.</p>
</li>
<li>
<p><code>handleType</code> is a <a href="capabilities.html#VkExternalFenceHandleTypeFlagBits" class="xref page">VkExternalFenceHandleTypeFlagBits</a> value
specifying the type of handle requested.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The properties of the handle returned depend on the value of
<code>handleType</code>.
See <a href="capabilities.html#VkExternalFenceHandleTypeFlagBits" class="xref page">VkExternalFenceHandleTypeFlagBits</a> for a description of the
properties of the defined external fence handle types.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkFenceGetWin32HandleInfoKHR-handleType-01448" href="#VUID-VkFenceGetWin32HandleInfoKHR-handleType-01448"></a> <span class="vuid">VUID-VkFenceGetWin32HandleInfoKHR-handleType-01448</span><br>

<code>handleType</code> <strong>must</strong> have been included in
<a href="#VkExportFenceCreateInfo">VkExportFenceCreateInfo</a>::<code>handleTypes</code> when the <code>fence</code>&#8217;s
current payload was created</p>
</li>
<li>
<p><a id="VUID-VkFenceGetWin32HandleInfoKHR-handleType-01449" href="#VUID-VkFenceGetWin32HandleInfoKHR-handleType-01449"></a> <span class="vuid">VUID-VkFenceGetWin32HandleInfoKHR-handleType-01449</span><br>

If <code>handleType</code> is defined as an NT handle,
<a href="#vkGetFenceWin32HandleKHR">vkGetFenceWin32HandleKHR</a> <strong>must</strong> be called no more than once for
each valid unique combination of <code>fence</code> and <code>handleType</code></p>
</li>
<li>
<p><a id="VUID-VkFenceGetWin32HandleInfoKHR-fence-01450" href="#VUID-VkFenceGetWin32HandleInfoKHR-fence-01450"></a> <span class="vuid">VUID-VkFenceGetWin32HandleInfoKHR-fence-01450</span><br>

<code>fence</code> <strong>must</strong> not currently have its payload replaced by an imported
payload as described below in
<a href="#synchronization-fences-importing">Importing Fence Payloads</a> unless
that imported payload&#8217;s handle type was included in
<a href="capabilities.html#VkExternalFenceProperties" class="xref page">VkExternalFenceProperties</a>::<code>exportFromImportedHandleTypes</code> for
<code>handleType</code></p>
</li>
<li>
<p><a id="VUID-VkFenceGetWin32HandleInfoKHR-handleType-01451" href="#VUID-VkFenceGetWin32HandleInfoKHR-handleType-01451"></a> <span class="vuid">VUID-VkFenceGetWin32HandleInfoKHR-handleType-01451</span><br>

If <code>handleType</code> refers to a handle type with copy payload
transference semantics, <code>fence</code> <strong>must</strong> be signaled, or have an
associated <a href="#synchronization-fences-signaling">fence signal operation</a>
pending execution</p>
</li>
<li>
<p><a id="VUID-VkFenceGetWin32HandleInfoKHR-handleType-01452" href="#VUID-VkFenceGetWin32HandleInfoKHR-handleType-01452"></a> <span class="vuid">VUID-VkFenceGetWin32HandleInfoKHR-handleType-01452</span><br>

<code>handleType</code> <strong>must</strong> be defined as an NT handle or a global share
handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkFenceGetWin32HandleInfoKHR-sType-sType" href="#VUID-VkFenceGetWin32HandleInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkFenceGetWin32HandleInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_FENCE_GET_WIN32_HANDLE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkFenceGetWin32HandleInfoKHR-pNext-pNext" href="#VUID-VkFenceGetWin32HandleInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkFenceGetWin32HandleInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkFenceGetWin32HandleInfoKHR-fence-parameter" href="#VUID-VkFenceGetWin32HandleInfoKHR-fence-parameter"></a> <span class="vuid">VUID-VkFenceGetWin32HandleInfoKHR-fence-parameter</span><br>
 <code>fence</code> <strong>must</strong> be a valid <a href="#VkFence">VkFence</a> handle</p>
</li>
<li>
<p><a id="VUID-VkFenceGetWin32HandleInfoKHR-handleType-parameter" href="#VUID-VkFenceGetWin32HandleInfoKHR-handleType-parameter"></a> <span class="vuid">VUID-VkFenceGetWin32HandleInfoKHR-handleType-parameter</span><br>
 <code>handleType</code> <strong>must</strong> be a valid <a href="capabilities.html#VkExternalFenceHandleTypeFlagBits" class="xref page">VkExternalFenceHandleTypeFlagBits</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To export a POSIX file descriptor representing the payload of a fence, call:</p>
</div>
<div id="vkGetFenceFdKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_fence_fd
VkResult vkGetFenceFdKHR(
    VkDevice                                    device,
    const VkFenceGetFdInfoKHR*                  pGetFdInfo,
    int*                                        pFd);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that created the fence being
exported.</p>
</li>
<li>
<p><code>pGetFdInfo</code> is a pointer to a <a href="#VkFenceGetFdInfoKHR">VkFenceGetFdInfoKHR</a> structure
containing parameters of the export operation.</p>
</li>
<li>
<p><code>pFd</code> will return the file descriptor representing the fence
payload.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each call to <code>vkGetFenceFdKHR</code> <strong>must</strong> create a new file descriptor and
transfer ownership of it to the application.
To avoid leaking resources, the application <strong>must</strong> release ownership of the
file descriptor when it is no longer needed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Ownership can be released in many ways.
For example, the application can call <code>close</code>() on the file descriptor,
or transfer ownership back to Vulkan by using the file descriptor to import
a fence payload.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code>pGetFdInfo-&gt;handleType</code> is
<code>VK_EXTERNAL_FENCE_HANDLE_TYPE_SYNC_FD_BIT</code> and the fence is signaled at
the time <code>vkGetFenceFdKHR</code> is called, <code>pFd</code> <strong>may</strong> return the value
<code>-1</code> instead of a valid file descriptor.</p>
</div>
<div class="paragraph">
<p>Where supported by the operating system, the implementation <strong>must</strong> set the
file descriptor to be closed automatically when an <code>execve</code> system call
is made.</p>
</div>
<div class="paragraph">
<p>Exporting a file descriptor from a fence <strong>may</strong> have side effects depending on
the transference of the specified handle type, as described in
<a href="#synchronization-fences-importing">Importing Fence State</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetFenceFdKHR-device-parameter" href="#VUID-vkGetFenceFdKHR-device-parameter"></a> <span class="vuid">VUID-vkGetFenceFdKHR-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetFenceFdKHR-pGetFdInfo-parameter" href="#VUID-vkGetFenceFdKHR-pGetFdInfo-parameter"></a> <span class="vuid">VUID-vkGetFenceFdKHR-pGetFdInfo-parameter</span><br>
 <code>pGetFdInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkFenceGetFdInfoKHR">VkFenceGetFdInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetFenceFdKHR-pFd-parameter" href="#VUID-vkGetFenceFdKHR-pFd-parameter"></a> <span class="vuid">VUID-vkGetFenceFdKHR-pFd-parameter</span><br>
 <code>pFd</code> <strong>must</strong> be a valid pointer to an <code>int</code> value</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkFenceGetFdInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkFenceGetFdInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_fence_fd
typedef struct VkFenceGetFdInfoKHR {
    VkStructureType                      sType;
    const void*                          pNext;
    VkFence                              fence;
    VkExternalFenceHandleTypeFlagBits    handleType;
} VkFenceGetFdInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>fence</code> is the fence from which state will be exported.</p>
</li>
<li>
<p><code>handleType</code> is a <a href="capabilities.html#VkExternalFenceHandleTypeFlagBits" class="xref page">VkExternalFenceHandleTypeFlagBits</a> value
specifying the type of handle requested.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The properties of the file descriptor returned depend on the value of
<code>handleType</code>.
See <a href="capabilities.html#VkExternalFenceHandleTypeFlagBits" class="xref page">VkExternalFenceHandleTypeFlagBits</a> for a description of the
properties of the defined external fence handle types.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkFenceGetFdInfoKHR-handleType-01453" href="#VUID-VkFenceGetFdInfoKHR-handleType-01453"></a> <span class="vuid">VUID-VkFenceGetFdInfoKHR-handleType-01453</span><br>

<code>handleType</code> <strong>must</strong> have been included in
<a href="#VkExportFenceCreateInfo">VkExportFenceCreateInfo</a>::<code>handleTypes</code> when <code>fence</code>&#8217;s
current payload was created</p>
</li>
<li>
<p><a id="VUID-VkFenceGetFdInfoKHR-handleType-01454" href="#VUID-VkFenceGetFdInfoKHR-handleType-01454"></a> <span class="vuid">VUID-VkFenceGetFdInfoKHR-handleType-01454</span><br>

If <code>handleType</code> refers to a handle type with copy payload
transference semantics, <code>fence</code> <strong>must</strong> be signaled, or have an
associated <a href="#synchronization-fences-signaling">fence signal operation</a>
pending execution</p>
</li>
<li>
<p><a id="VUID-VkFenceGetFdInfoKHR-fence-01455" href="#VUID-VkFenceGetFdInfoKHR-fence-01455"></a> <span class="vuid">VUID-VkFenceGetFdInfoKHR-fence-01455</span><br>

<code>fence</code> <strong>must</strong> not currently have its payload replaced by an imported
payload as described below in
<a href="#synchronization-fences-importing">Importing Fence Payloads</a> unless
that imported payload&#8217;s handle type was included in
<a href="capabilities.html#VkExternalFenceProperties" class="xref page">VkExternalFenceProperties</a>::<code>exportFromImportedHandleTypes</code> for
<code>handleType</code></p>
</li>
<li>
<p><a id="VUID-VkFenceGetFdInfoKHR-handleType-01456" href="#VUID-VkFenceGetFdInfoKHR-handleType-01456"></a> <span class="vuid">VUID-VkFenceGetFdInfoKHR-handleType-01456</span><br>

<code>handleType</code> <strong>must</strong> be defined as a POSIX file descriptor handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkFenceGetFdInfoKHR-sType-sType" href="#VUID-VkFenceGetFdInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkFenceGetFdInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_FENCE_GET_FD_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkFenceGetFdInfoKHR-pNext-pNext" href="#VUID-VkFenceGetFdInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkFenceGetFdInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkFenceGetFdInfoKHR-fence-parameter" href="#VUID-VkFenceGetFdInfoKHR-fence-parameter"></a> <span class="vuid">VUID-VkFenceGetFdInfoKHR-fence-parameter</span><br>
 <code>fence</code> <strong>must</strong> be a valid <a href="#VkFence">VkFence</a> handle</p>
</li>
<li>
<p><a id="VUID-VkFenceGetFdInfoKHR-handleType-parameter" href="#VUID-VkFenceGetFdInfoKHR-handleType-parameter"></a> <span class="vuid">VUID-VkFenceGetFdInfoKHR-handleType-parameter</span><br>
 <code>handleType</code> <strong>must</strong> be a valid <a href="capabilities.html#VkExternalFenceHandleTypeFlagBits" class="xref page">VkExternalFenceHandleTypeFlagBits</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a fence, call:</p>
</div>
<div id="vkDestroyFence" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkDestroyFence(
    VkDevice                                    device,
    VkFence                                     fence,
    const VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the fence.</p>
</li>
<li>
<p><code>fence</code> is the handle of the fence to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="memory.html#memory-allocation" class="xref page">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyFence-fence-01120" href="#VUID-vkDestroyFence-fence-01120"></a> <span class="vuid">VUID-vkDestroyFence-fence-01120</span><br>

All <a href="devsandqueues.html#devsandqueues-submission" class="xref page">queue submission</a> commands that refer
to <code>fence</code> <strong>must</strong> have completed execution</p>
</li>
<li>
<p><a id="VUID-vkDestroyFence-fence-01121" href="#VUID-vkDestroyFence-fence-01121"></a> <span class="vuid">VUID-vkDestroyFence-fence-01121</span><br>

If <code>VkAllocationCallbacks</code> were provided when <code>fence</code> was
created, a compatible set of callbacks <strong>must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyFence-fence-01122" href="#VUID-vkDestroyFence-fence-01122"></a> <span class="vuid">VUID-vkDestroyFence-fence-01122</span><br>

If no <code>VkAllocationCallbacks</code> were provided when <code>fence</code> was
created, <code>pAllocator</code> <strong>must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyFence-device-parameter" href="#VUID-vkDestroyFence-device-parameter"></a> <span class="vuid">VUID-vkDestroyFence-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyFence-fence-parameter" href="#VUID-vkDestroyFence-fence-parameter"></a> <span class="vuid">VUID-vkDestroyFence-fence-parameter</span><br>
 If <code>fence</code> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, <code>fence</code> <strong>must</strong> be a valid <a href="#VkFence">VkFence</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyFence-pAllocator-parameter" href="#VUID-vkDestroyFence-pAllocator-parameter"></a> <span class="vuid">VUID-vkDestroyFence-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong>must</strong> be a valid pointer to a valid <a href="memory.html#VkAllocationCallbacks" class="xref page">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyFence-fence-parent" href="#VUID-vkDestroyFence-fence-parent"></a> <span class="vuid">VUID-vkDestroyFence-fence-parent</span><br>
 If <code>fence</code> is a valid handle, it <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>fence</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query the status of a fence from the host, call:</p>
</div>
<div id="vkGetFenceStatus" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VkResult vkGetFenceStatus(
    VkDevice                                    device,
    VkFence                                     fence);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the fence.</p>
</li>
<li>
<p><code>fence</code> is the handle of the fence to query.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Upon success, <code>vkGetFenceStatus</code> returns the status of the fence object,
with the following return codes:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 3. Fence Object Status Codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Status</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_SUCCESS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The fence specified by <code>fence</code> is signaled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_NOT_READY</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The fence specified by <code>fence</code> is unsignaled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ERROR_DEVICE_LOST</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The device has been lost.  See <a href="devsandqueues.html#devsandqueues-lost-device" class="xref page">Lost Device</a>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If a <a href="devsandqueues.html#devsandqueues-submission" class="xref page">queue submission</a> command is pending
execution, then the value returned by this command <strong>may</strong> immediately be out
of date.</p>
</div>
<div class="paragraph">
<p>If the device has been lost (see <a href="devsandqueues.html#devsandqueues-lost-device" class="xref page">Lost Device</a>),
<code>vkGetFenceStatus</code> <strong>may</strong> return any of the above status codes.
If the device has been lost and <code>vkGetFenceStatus</code> is called repeatedly,
it will eventually return either <code>VK_SUCCESS</code> or
<code>VK_ERROR_DEVICE_LOST</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetFenceStatus-device-parameter" href="#VUID-vkGetFenceStatus-device-parameter"></a> <span class="vuid">VUID-vkGetFenceStatus-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetFenceStatus-fence-parameter" href="#VUID-vkGetFenceStatus-fence-parameter"></a> <span class="vuid">VUID-vkGetFenceStatus-fence-parameter</span><br>
 <code>fence</code> <strong>must</strong> be a valid <a href="#VkFence">VkFence</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetFenceStatus-fence-parent" href="#VUID-vkGetFenceStatus-fence-parent"></a> <span class="vuid">VUID-vkGetFenceStatus-fence-parent</span><br>
 <code>fence</code> <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_NOT_READY</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div id="synchronization-fences-unsignaling" class="openblock">
<div class="content">
<div class="paragraph">
<p>To set the state of fences to unsignaled from the host, call:</p>
</div>
<div id="vkResetFences" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VkResult vkResetFences(
    VkDevice                                    device,
    uint32_t                                    fenceCount,
    const VkFence*                              pFences);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the fences.</p>
</li>
<li>
<p><code>fenceCount</code> is the number of fences to reset.</p>
</li>
<li>
<p><code>pFences</code> is a pointer to an array of fence handles to reset.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If any member of <code>pFences</code> currently has its
<a href="#synchronization-fences-importing">payload imported</a> with temporary
permanence, that fence&#8217;s prior permanent payload is first restored.
The remaining operations described therefore operate on the restored
payload.</p>
</div>
<div class="paragraph">
<p>When <a href="#vkResetFences">vkResetFences</a> is executed on the host, it defines a <em>fence
unsignal operation</em> for each fence, which resets the fence to the unsignaled
state.</p>
</div>
<div class="paragraph">
<p>If any member of <code>pFences</code> is already in the unsignaled state when
<a href="#vkResetFences">vkResetFences</a> is executed, then <a href="#vkResetFences">vkResetFences</a> has no effect on
that fence.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetFences-pFences-01123" href="#VUID-vkResetFences-pFences-01123"></a> <span class="vuid">VUID-vkResetFences-pFences-01123</span><br>

Each element of <code>pFences</code> <strong>must</strong> not be currently associated with any
queue command that has not yet completed execution on that queue</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetFences-device-parameter" href="#VUID-vkResetFences-device-parameter"></a> <span class="vuid">VUID-vkResetFences-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkResetFences-pFences-parameter" href="#VUID-vkResetFences-pFences-parameter"></a> <span class="vuid">VUID-vkResetFences-pFences-parameter</span><br>
 <code>pFences</code> <strong>must</strong> be a valid pointer to an array of <code>fenceCount</code> valid <a href="#VkFence">VkFence</a> handles</p>
</li>
<li>
<p><a id="VUID-vkResetFences-fenceCount-arraylength" href="#VUID-vkResetFences-fenceCount-arraylength"></a> <span class="vuid">VUID-vkResetFences-fenceCount-arraylength</span><br>
 <code>fenceCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkResetFences-pFences-parent" href="#VUID-vkResetFences-pFences-parent"></a> <span class="vuid">VUID-vkResetFences-pFences-parent</span><br>
 Each element of <code>pFences</code> <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to each member of <code>pFences</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div id="synchronization-fences-signaling" class="paragraph">
<p>When a fence is submitted to a queue as part of a
<a href="devsandqueues.html#devsandqueues-submission" class="xref page">queue submission</a> command, it defines a memory
dependency on the batches that were submitted as part of that command, and
defines a <em>fence signal operation</em> which sets the fence to the signaled
state.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes every batch submitted in the same <a href="devsandqueues.html#devsandqueues-submission" class="xref page">queue submission</a> command.
Fence signal operations that are defined by <a href="cmdbuffers.html#vkQueueSubmit" class="xref page">vkQueueSubmit</a>
or <a href="cmdbuffers.html#vkQueueSubmit2" class="xref page">vkQueueSubmit2</a>
additionally include in the first synchronization scope all commands that
occur earlier in <a href="#synchronization-submission-order">submission order</a>.
Fence signal operations that are defined by <a href="cmdbuffers.html#vkQueueSubmit" class="xref page">vkQueueSubmit</a>
or <a href="cmdbuffers.html#vkQueueSubmit2" class="xref page">vkQueueSubmit2</a>
or <a href="sparsemem.html#vkQueueBindSparse" class="xref page">vkQueueBindSparse</a>
additionally include in the first synchronization scope any semaphore and
fence signal operations that occur earlier in
<a href="#synchronization-signal-operation-order">signal operation order</a>.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
only includes the fence signal operation.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-access-scopes">access scope</a>
includes all memory access performed by the device.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-access-scopes">access scope</a> is
empty.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To wait for one or more fences to enter the signaled state on the host,
call:</p>
</div>
<div id="vkWaitForFences" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VkResult vkWaitForFences(
    VkDevice                                    device,
    uint32_t                                    fenceCount,
    const VkFence*                              pFences,
    VkBool32                                    waitAll,
    uint64_t                                    timeout);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the fences.</p>
</li>
<li>
<p><code>fenceCount</code> is the number of fences to wait on.</p>
</li>
<li>
<p><code>pFences</code> is a pointer to an array of <code>fenceCount</code> fence
handles.</p>
</li>
<li>
<p><code>waitAll</code> is the condition that <strong>must</strong> be satisfied to successfully
unblock the wait.
If <code>waitAll</code> is <code>VK_TRUE</code>, then the condition is that all fences
in <code>pFences</code> are signaled.
Otherwise, the condition is that at least one fence in <code>pFences</code> is
signaled.</p>
</li>
<li>
<p><code>timeout</code> is the timeout period in units of nanoseconds.
<code>timeout</code> is adjusted to the closest value allowed by the
implementation-dependent timeout accuracy, which <strong>may</strong> be substantially
longer than one nanosecond, and <strong>may</strong> be longer than the requested
period.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the condition is satisfied when <code>vkWaitForFences</code> is called, then
<code>vkWaitForFences</code> returns immediately.
If the condition is not satisfied at the time <code>vkWaitForFences</code> is
called, then <code>vkWaitForFences</code> will block and wait until the condition
is satisfied or the <code>timeout</code> has expired, whichever is sooner.</p>
</div>
<div class="paragraph">
<p>If <code>timeout</code> is zero, then <code>vkWaitForFences</code> does not wait, but
simply returns the current state of the fences.
<code>VK_TIMEOUT</code> will be returned in this case if the condition is not
satisfied, even though no actual wait was performed.</p>
</div>
<div class="paragraph">
<p>If the condition is satisfied before the <code>timeout</code> has expired,
<code>vkWaitForFences</code> returns <code>VK_SUCCESS</code>.
Otherwise, <code>vkWaitForFences</code> returns <code>VK_TIMEOUT</code> after the
<code>timeout</code> has expired.</p>
</div>
<div class="paragraph">
<p>If device loss occurs (see <a href="devsandqueues.html#devsandqueues-lost-device" class="xref page">Lost Device</a>) before
the timeout has expired, <code>vkWaitForFences</code> <strong>must</strong> return in finite time
with either <code>VK_SUCCESS</code> or <code>VK_ERROR_DEVICE_LOST</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>While we guarantee that <code>vkWaitForFences</code> <strong>must</strong> return in finite time,
no guarantees are made that it returns immediately upon device loss.
However, the client can reasonably expect that the delay will be on the
order of seconds and that calling <code>vkWaitForFences</code> will not result in a
permanently (or seemingly permanently) dead process.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkWaitForFences-device-parameter" href="#VUID-vkWaitForFences-device-parameter"></a> <span class="vuid">VUID-vkWaitForFences-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkWaitForFences-pFences-parameter" href="#VUID-vkWaitForFences-pFences-parameter"></a> <span class="vuid">VUID-vkWaitForFences-pFences-parameter</span><br>
 <code>pFences</code> <strong>must</strong> be a valid pointer to an array of <code>fenceCount</code> valid <a href="#VkFence">VkFence</a> handles</p>
</li>
<li>
<p><a id="VUID-vkWaitForFences-fenceCount-arraylength" href="#VUID-vkWaitForFences-fenceCount-arraylength"></a> <span class="vuid">VUID-vkWaitForFences-fenceCount-arraylength</span><br>
 <code>fenceCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkWaitForFences-pFences-parent" href="#VUID-vkWaitForFences-pFences-parent"></a> <span class="vuid">VUID-vkWaitForFences-pFences-parent</span><br>
 Each element of <code>pFences</code> <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_TIMEOUT</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div id="synchronization-fences-waiting" class="paragraph">
<p>An execution dependency is defined by waiting for a fence to become
signaled, either via <a href="#vkWaitForFences">vkWaitForFences</a> or by polling on
<a href="#vkGetFenceStatus">vkGetFenceStatus</a>.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes only the fence signal operation.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes the host operations of <a href="#vkWaitForFences">vkWaitForFences</a> or
<a href="#vkGetFenceStatus">vkGetFenceStatus</a> indicating that the fence has become signaled.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Signaling a fence and waiting on the host does not guarantee that the
results of memory accesses will be visible to the host, as the access scope
of a memory dependency defined by a fence only includes device access.
A <a href="#synchronization-memory-barriers">memory barrier</a> or other memory
dependency <strong>must</strong> be used to guarantee this.
See the description of <a href="#synchronization-host-access-types">host access types</a> for more information.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_alternate_methods_to_signal_fences"><a class="anchor" href="#_alternate_methods_to_signal_fences"></a>Alternate Methods to Signal Fences</h3>
<div class="paragraph">
<p>Besides submitting a fence to a queue as part of a
<a href="devsandqueues.html#devsandqueues-submission" class="xref page">queue submission</a> command, a fence <strong>may</strong> also be
signaled when a particular event occurs on a device or display.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a fence that will be signaled when an event occurs on a device,
call:</p>
</div>
<div id="vkRegisterDeviceEventEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_display_control
VkResult vkRegisterDeviceEventEXT(
    VkDevice                                    device,
    const VkDeviceEventInfoEXT*                 pDeviceEventInfo,
    const VkAllocationCallbacks*                pAllocator,
    VkFence*                                    pFence);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is a logical device on which the event <strong>may</strong> occur.</p>
</li>
<li>
<p><code>pDeviceEventInfo</code> is a pointer to a <a href="#VkDeviceEventInfoEXT">VkDeviceEventInfoEXT</a>
structure describing the event of interest to the application.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="memory.html#memory-allocation" class="xref page">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pFence</code> is a pointer to a handle in which the resulting fence
object is returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkRegisterDeviceEventEXT-device-parameter" href="#VUID-vkRegisterDeviceEventEXT-device-parameter"></a> <span class="vuid">VUID-vkRegisterDeviceEventEXT-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkRegisterDeviceEventEXT-pDeviceEventInfo-parameter" href="#VUID-vkRegisterDeviceEventEXT-pDeviceEventInfo-parameter"></a> <span class="vuid">VUID-vkRegisterDeviceEventEXT-pDeviceEventInfo-parameter</span><br>
 <code>pDeviceEventInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkDeviceEventInfoEXT">VkDeviceEventInfoEXT</a> structure</p>
</li>
<li>
<p><a id="VUID-vkRegisterDeviceEventEXT-pAllocator-parameter" href="#VUID-vkRegisterDeviceEventEXT-pAllocator-parameter"></a> <span class="vuid">VUID-vkRegisterDeviceEventEXT-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong>must</strong> be a valid pointer to a valid <a href="memory.html#VkAllocationCallbacks" class="xref page">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkRegisterDeviceEventEXT-pFence-parameter" href="#VUID-vkRegisterDeviceEventEXT-pFence-parameter"></a> <span class="vuid">VUID-vkRegisterDeviceEventEXT-pFence-parameter</span><br>
 <code>pFence</code> <strong>must</strong> be a valid pointer to a <a href="#VkFence">VkFence</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkDeviceEventInfoEXT</code> structure is defined as:</p>
</div>
<div id="VkDeviceEventInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_display_control
typedef struct VkDeviceEventInfoEXT {
    VkStructureType         sType;
    const void*             pNext;
    VkDeviceEventTypeEXT    deviceEvent;
} VkDeviceEventInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>device</code> is a <a href="#VkDeviceEventTypeEXT">VkDeviceEventTypeEXT</a> value specifying when the
fence will be signaled.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkDeviceEventInfoEXT-sType-sType" href="#VUID-VkDeviceEventInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkDeviceEventInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_DEVICE_EVENT_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkDeviceEventInfoEXT-pNext-pNext" href="#VUID-VkDeviceEventInfoEXT-pNext-pNext"></a> <span class="vuid">VUID-VkDeviceEventInfoEXT-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkDeviceEventInfoEXT-deviceEvent-parameter" href="#VUID-VkDeviceEventInfoEXT-deviceEvent-parameter"></a> <span class="vuid">VUID-VkDeviceEventInfoEXT-deviceEvent-parameter</span><br>
 <code>deviceEvent</code> <strong>must</strong> be a valid <a href="#VkDeviceEventTypeEXT">VkDeviceEventTypeEXT</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <a href="#VkDeviceEventInfoEXT">VkDeviceEventInfoEXT</a>::<code>device</code>, specifying when
a fence will be signaled, are:</p>
</div>
<div id="VkDeviceEventTypeEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_display_control
typedef enum VkDeviceEventTypeEXT {
    VK_DEVICE_EVENT_TYPE_DISPLAY_HOTPLUG_EXT = 0,
} VkDeviceEventTypeEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_DEVICE_EVENT_TYPE_DISPLAY_HOTPLUG_EXT</code> specifies that the fence
is signaled when a display is plugged into or unplugged from the
specified device.
Applications <strong>can</strong> use this notification to determine when they need to
re-enumerate the available displays on a device.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a fence that will be signaled when an event occurs on a
<a href="VK_KHR_surface/wsi.html#VkDisplayKHR" class="xref page">VkDisplayKHR</a> object, call:</p>
</div>
<div id="vkRegisterDisplayEventEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_display_control
VkResult vkRegisterDisplayEventEXT(
    VkDevice                                    device,
    VkDisplayKHR                                display,
    const VkDisplayEventInfoEXT*                pDisplayEventInfo,
    const VkAllocationCallbacks*                pAllocator,
    VkFence*                                    pFence);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is a logical device associated with <code>display</code></p>
</li>
<li>
<p><code>display</code> is the display on which the event <strong>may</strong> occur.</p>
</li>
<li>
<p><code>pDisplayEventInfo</code> is a pointer to a <a href="#VkDisplayEventInfoEXT">VkDisplayEventInfoEXT</a>
structure describing the event of interest to the application.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="memory.html#memory-allocation" class="xref page">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pFence</code> is a pointer to a handle in which the resulting fence
object is returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkRegisterDisplayEventEXT-device-parameter" href="#VUID-vkRegisterDisplayEventEXT-device-parameter"></a> <span class="vuid">VUID-vkRegisterDisplayEventEXT-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkRegisterDisplayEventEXT-display-parameter" href="#VUID-vkRegisterDisplayEventEXT-display-parameter"></a> <span class="vuid">VUID-vkRegisterDisplayEventEXT-display-parameter</span><br>
 <code>display</code> <strong>must</strong> be a valid <a href="VK_KHR_surface/wsi.html#VkDisplayKHR" class="xref page">VkDisplayKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkRegisterDisplayEventEXT-pDisplayEventInfo-parameter" href="#VUID-vkRegisterDisplayEventEXT-pDisplayEventInfo-parameter"></a> <span class="vuid">VUID-vkRegisterDisplayEventEXT-pDisplayEventInfo-parameter</span><br>
 <code>pDisplayEventInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkDisplayEventInfoEXT">VkDisplayEventInfoEXT</a> structure</p>
</li>
<li>
<p><a id="VUID-vkRegisterDisplayEventEXT-pAllocator-parameter" href="#VUID-vkRegisterDisplayEventEXT-pAllocator-parameter"></a> <span class="vuid">VUID-vkRegisterDisplayEventEXT-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong>must</strong> be a valid pointer to a valid <a href="memory.html#VkAllocationCallbacks" class="xref page">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkRegisterDisplayEventEXT-pFence-parameter" href="#VUID-vkRegisterDisplayEventEXT-pFence-parameter"></a> <span class="vuid">VUID-vkRegisterDisplayEventEXT-pFence-parameter</span><br>
 <code>pFence</code> <strong>must</strong> be a valid pointer to a <a href="#VkFence">VkFence</a> handle</p>
</li>
<li>
<p><a id="VUID-vkRegisterDisplayEventEXT-commonparent" href="#VUID-vkRegisterDisplayEventEXT-commonparent"></a> <span class="vuid">VUID-vkRegisterDisplayEventEXT-commonparent</span><br>
 Both of <code>device</code>, and <code>display</code> <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkPhysicalDevice" class="xref page">VkPhysicalDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkDisplayEventInfoEXT</code> structure is defined as:</p>
</div>
<div id="VkDisplayEventInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_display_control
typedef struct VkDisplayEventInfoEXT {
    VkStructureType          sType;
    const void*              pNext;
    VkDisplayEventTypeEXT    displayEvent;
} VkDisplayEventInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>displayEvent</code> is a <a href="#VkDisplayEventTypeEXT">VkDisplayEventTypeEXT</a> specifying when the
fence will be signaled.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkDisplayEventInfoEXT-sType-sType" href="#VUID-VkDisplayEventInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkDisplayEventInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_DISPLAY_EVENT_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkDisplayEventInfoEXT-pNext-pNext" href="#VUID-VkDisplayEventInfoEXT-pNext-pNext"></a> <span class="vuid">VUID-VkDisplayEventInfoEXT-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkDisplayEventInfoEXT-displayEvent-parameter" href="#VUID-VkDisplayEventInfoEXT-displayEvent-parameter"></a> <span class="vuid">VUID-VkDisplayEventInfoEXT-displayEvent-parameter</span><br>
 <code>displayEvent</code> <strong>must</strong> be a valid <a href="#VkDisplayEventTypeEXT">VkDisplayEventTypeEXT</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <a href="#VkDisplayEventInfoEXT">VkDisplayEventInfoEXT</a>::<code>displayEvent</code>,
specifying when a fence will be signaled, are:</p>
</div>
<div id="VkDisplayEventTypeEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_display_control
typedef enum VkDisplayEventTypeEXT {
    VK_DISPLAY_EVENT_TYPE_FIRST_PIXEL_OUT_EXT = 0,
} VkDisplayEventTypeEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_DISPLAY_EVENT_TYPE_FIRST_PIXEL_OUT_EXT</code> specifies that the fence
is signaled when the first pixel of the next display refresh cycle
leaves the display engine for the display.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-fences-importing"><a class="anchor" href="#synchronization-fences-importing"></a>Importing Fence Payloads</h3>
<div class="paragraph">
<p>Applications <strong>can</strong> import a fence payload into an existing fence using an
external fence handle.
The effects of the import operation will be either temporary or permanent,
as specified by the application.
If the import is temporary, the fence will be <em>restored</em> to its permanent
state the next time that fence is passed to <a href="#vkResetFences">vkResetFences</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Restoring a fence to its prior permanent payload is a distinct operation
from resetting a fence payload.
See <a href="#vkResetFences">vkResetFences</a> for more detail.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Performing a subsequent temporary import on a fence before resetting it has
no effect on this requirement; the next unsignal of the fence <strong>must</strong> still
restore its last permanent state.
A permanent payload import behaves as if the target fence was destroyed, and
a new fence was created with the same handle but the imported payload.
Because importing a fence payload temporarily or permanently detaches the
existing payload from a fence, similar usage restrictions to those applied
to <code>vkDestroyFence</code> are applied to any command that imports a fence
payload.
Which of these import types is used is referred to as the import operation&#8217;s
<em>permanence</em>.
Each handle type supports either one or both types of permanence.</p>
</div>
<div class="paragraph">
<p>The implementation <strong>must</strong> perform the import operation by either referencing
or copying the payload referred to by the specified external fence handle,
depending on the handle&#8217;s type.
The import method used is referred to as the handle type&#8217;s <em>transference</em>.
When using handle types with reference transference, importing a payload to
a fence adds the fence to the set of all fences sharing that payload.
This set includes the fence from which the payload was exported.
Fence signaling, waiting, and resetting operations performed on any fence in
the set <strong>must</strong> behave as if the set were a single fence.
Importing a payload using handle types with copy transference creates a
duplicate copy of the payload at the time of import, but makes no further
reference to it.
Fence signaling, waiting, and resetting operations performed on the target
of copy imports <strong>must</strong> not affect any other fence or payload.</p>
</div>
<div class="paragraph">
<p>Export operations have the same transference as the specified handle type&#8217;s
import operations.
Additionally, exporting a fence payload to a handle with copy transference
has the same side effects on the source fence&#8217;s payload as executing a fence
reset operation.
If the fence was using a temporarily imported payload, the fence&#8217;s prior
permanent payload will be restored.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The
tables
<a href="#synchronization-fence-handletypes-win32">Handle Types Supported by <code>VkImportFenceWin32HandleInfoKHR</code></a>
and
<a href="#synchronization-fence-handletypes-fd">Handle Types Supported by <code>VkImportFenceFdInfoKHR</code></a>
define
the permanence and transference of each handle type.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="fundamentals.html#fundamentals-threadingbehavior" class="xref page">External synchronization</a> allows
implementations to modify an object&#8217;s internal state, i.e. payload, without
internal synchronization.
However, for fences sharing a payload across processes, satisfying the
external synchronization requirements of <code>VkFence</code> parameters as if all
fences in the set were the same object is sometimes infeasible.
Satisfying valid usage constraints on the state of a fence would similarly
require impractical coordination or levels of trust between processes.
Therefore, these constraints only apply to a specific fence handle, not to
its payload.
For distinct fence objects which share a payload:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If multiple commands which queue a signal operation, or which unsignal a
fence, are called concurrently, behavior will be as if the commands were
called in an arbitrary sequential order.</p>
</li>
<li>
<p>If a queue submission command is called with a fence that is sharing a
payload, and the payload is already associated with another queue
command that has not yet completed execution, either one or both of the
commands will cause the fence to become signaled when they complete
execution.</p>
</li>
<li>
<p>If a fence payload is reset while it is associated with a queue command
that has not yet completed execution, the payload will become
unsignaled, but <strong>may</strong> become signaled again when the command completes
execution.</p>
</li>
<li>
<p>In the preceding cases, any of the devices associated with the fences
sharing the payload <strong>may</strong> be lost, or any of the queue submission or
fence reset commands <strong>may</strong> return <code>VK_ERROR_INITIALIZATION_FAILED</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Other than these non-deterministic results, behavior is well defined.
In particular:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The implementation <strong>must</strong> not crash or enter an internally inconsistent
state where future valid Vulkan commands might cause <strong>undefined</strong> results,</p>
</li>
<li>
<p>Timeouts on future wait commands on fences sharing the payload <strong>must</strong> be
effective.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>These rules allow processes to synchronize access to shared memory without
trusting each other.
However, such processes must still be cautious not to use the shared fence
for more than synchronizing access to the shared memory.
For example, a process should not use a fence with shared payload to tell
when commands it submitted to a queue have completed and objects used by
those commands may be destroyed, since the other process can accidentally or
maliciously cause the fence to signal before the commands actually complete.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When a fence is using an imported payload, its
<a href="#VkExportFenceCreateInfo">VkExportFenceCreateInfo</a>::<code>handleTypes</code> value is specified when
creating the fence from which the payload was exported, rather than
specified when creating the fence.
Additionally,
<a href="capabilities.html#VkExternalFenceProperties" class="xref page">VkExternalFenceProperties</a>::<code>exportFromImportedHandleTypes</code>
restricts which handle types <strong>can</strong> be exported from such a fence based on the
specific handle type used to import the current payload.
Passing a fence to <a href="VK_KHR_surface/wsi.html#vkAcquireNextImageKHR" class="xref page">vkAcquireNextImageKHR</a> is equivalent to temporarily
importing a fence payload to that fence.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Because the exportable handle types of an imported fence correspond to its
current imported payload, and <a href="VK_KHR_surface/wsi.html#vkAcquireNextImageKHR" class="xref page">vkAcquireNextImageKHR</a> behaves the same
as a temporary import operation for which the source fence is opaque to the
application, applications have no way of determining whether any external
handle types <strong>can</strong> be exported from a fence in this state.
Therefore, applications <strong>must</strong> not attempt to export handles from fences
using a temporarily imported payload from <a href="VK_KHR_surface/wsi.html#vkAcquireNextImageKHR" class="xref page">vkAcquireNextImageKHR</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When importing a fence payload, it is the responsibility of the application
to ensure the external handles meet all valid usage requirements.
However, implementations <strong>must</strong> perform sufficient validation of external
handles to ensure that the operation results in a valid fence which will not
cause program termination, device loss, queue stalls, host thread stalls, or
corruption of other resources when used as allowed according to its import
parameters.
If the external handle provided does not meet these requirements, the
implementation <strong>must</strong> fail the fence payload import operation with the error
code <code>VK_ERROR_INVALID_EXTERNAL_HANDLE</code>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To import a fence payload from a Windows handle, call:</p>
</div>
<div id="vkImportFenceWin32HandleKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_fence_win32
VkResult vkImportFenceWin32HandleKHR(
    VkDevice                                    device,
    const VkImportFenceWin32HandleInfoKHR*      pImportFenceWin32HandleInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that created the fence.</p>
</li>
<li>
<p><code>pImportFenceWin32HandleInfo</code> is a pointer to a
<a href="#VkImportFenceWin32HandleInfoKHR">VkImportFenceWin32HandleInfoKHR</a> structure specifying the fence and
import parameters.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Importing a fence payload from Windows handles does not transfer ownership
of the handle to the Vulkan implementation.
For handle types defined as NT handles, the application <strong>must</strong> release
ownership using the <code>CloseHandle</code> system call when the handle is no
longer needed.</p>
</div>
<div class="paragraph">
<p>Applications <strong>can</strong> import the same fence payload into multiple instances of
Vulkan, into the same instance from which it was exported, and multiple
times into a given Vulkan instance.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkImportFenceWin32HandleKHR-fence-04448" href="#VUID-vkImportFenceWin32HandleKHR-fence-04448"></a> <span class="vuid">VUID-vkImportFenceWin32HandleKHR-fence-04448</span><br>

<code>fence</code> <strong>must</strong> not be associated with any queue command that has not
yet completed execution on that queue</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkImportFenceWin32HandleKHR-device-parameter" href="#VUID-vkImportFenceWin32HandleKHR-device-parameter"></a> <span class="vuid">VUID-vkImportFenceWin32HandleKHR-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkImportFenceWin32HandleKHR-pImportFenceWin32HandleInfo-parameter" href="#VUID-vkImportFenceWin32HandleKHR-pImportFenceWin32HandleInfo-parameter"></a> <span class="vuid">VUID-vkImportFenceWin32HandleKHR-pImportFenceWin32HandleInfo-parameter</span><br>
 <code>pImportFenceWin32HandleInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkImportFenceWin32HandleInfoKHR">VkImportFenceWin32HandleInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_INVALID_EXTERNAL_HANDLE</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkImportFenceWin32HandleInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkImportFenceWin32HandleInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_fence_win32
typedef struct VkImportFenceWin32HandleInfoKHR {
    VkStructureType                      sType;
    const void*                          pNext;
    VkFence                              fence;
    VkFenceImportFlags                   flags;
    VkExternalFenceHandleTypeFlagBits    handleType;
    HANDLE                               handle;
    LPCWSTR                              name;
} VkImportFenceWin32HandleInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>fence</code> is the fence into which the state will be imported.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkFenceImportFlagBits">VkFenceImportFlagBits</a> specifying
additional parameters for the fence payload import operation.</p>
</li>
<li>
<p><code>handleType</code> is a <a href="capabilities.html#VkExternalFenceHandleTypeFlagBits" class="xref page">VkExternalFenceHandleTypeFlagBits</a> value
specifying the type of <code>handle</code>.</p>
</li>
<li>
<p><code>handle</code> is <code>NULL</code> or the external handle to import.</p>
</li>
<li>
<p><code>name</code> is <code>NULL</code> or a null-terminated UTF-16 string naming the
underlying synchronization primitive to import.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The handle types supported by <code>handleType</code> are:</p>
</div>
<table id="synchronization-fence-handletypes-win32" class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 4. Handle Types Supported by <code>VkImportFenceWin32HandleInfoKHR</code></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Handle Type</th>
<th class="tableblock halign-left valign-top">Transference</th>
<th class="tableblock halign-left valign-top">Permanence Supported</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_EXTERNAL_FENCE_HANDLE_TYPE_OPAQUE_WIN32_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reference</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temporary,Permanent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_EXTERNAL_FENCE_HANDLE_TYPE_OPAQUE_WIN32_KMT_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reference</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temporary,Permanent</p></td>
</tr>
</tbody>
</table>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImportFenceWin32HandleInfoKHR-handleType-01457" href="#VUID-VkImportFenceWin32HandleInfoKHR-handleType-01457"></a> <span class="vuid">VUID-VkImportFenceWin32HandleInfoKHR-handleType-01457</span><br>

<code>handleType</code> <strong>must</strong> be a value included in the
<a href="#synchronization-fence-handletypes-win32">Handle Types Supported by    <code>VkImportFenceWin32HandleInfoKHR</code></a> table</p>
</li>
<li>
<p><a id="VUID-VkImportFenceWin32HandleInfoKHR-handleType-01459" href="#VUID-VkImportFenceWin32HandleInfoKHR-handleType-01459"></a> <span class="vuid">VUID-VkImportFenceWin32HandleInfoKHR-handleType-01459</span><br>

If <code>handleType</code> is not
<code>VK_EXTERNAL_FENCE_HANDLE_TYPE_OPAQUE_WIN32_BIT</code>, <code>name</code> <strong>must</strong>
be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkImportFenceWin32HandleInfoKHR-handleType-01460" href="#VUID-VkImportFenceWin32HandleInfoKHR-handleType-01460"></a> <span class="vuid">VUID-VkImportFenceWin32HandleInfoKHR-handleType-01460</span><br>

If <code>handle</code> is <code>NULL</code>, <code>name</code> <strong>must</strong> name a valid synchronization
primitive of the type specified by <code>handleType</code></p>
</li>
<li>
<p><a id="VUID-VkImportFenceWin32HandleInfoKHR-handleType-01461" href="#VUID-VkImportFenceWin32HandleInfoKHR-handleType-01461"></a> <span class="vuid">VUID-VkImportFenceWin32HandleInfoKHR-handleType-01461</span><br>

If <code>name</code> is <code>NULL</code>, <code>handle</code> <strong>must</strong> be a valid handle of the
type specified by <code>handleType</code></p>
</li>
<li>
<p><a id="VUID-VkImportFenceWin32HandleInfoKHR-handle-01462" href="#VUID-VkImportFenceWin32HandleInfoKHR-handle-01462"></a> <span class="vuid">VUID-VkImportFenceWin32HandleInfoKHR-handle-01462</span><br>

If <code>handle</code> is not <code>NULL</code>, <code>name</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkImportFenceWin32HandleInfoKHR-handle-01539" href="#VUID-VkImportFenceWin32HandleInfoKHR-handle-01539"></a> <span class="vuid">VUID-VkImportFenceWin32HandleInfoKHR-handle-01539</span><br>

If <code>handle</code> is not <code>NULL</code>, it <strong>must</strong> obey any requirements listed for
<code>handleType</code> in <a href="capabilities.html#external-fence-handle-types-compatibility" class="xref page">external    fence handle types compatibility</a></p>
</li>
<li>
<p><a id="VUID-VkImportFenceWin32HandleInfoKHR-name-01540" href="#VUID-VkImportFenceWin32HandleInfoKHR-name-01540"></a> <span class="vuid">VUID-VkImportFenceWin32HandleInfoKHR-name-01540</span><br>

If <code>name</code> is not <code>NULL</code>, it <strong>must</strong> obey any requirements listed for
<code>handleType</code> in <a href="capabilities.html#external-fence-handle-types-compatibility" class="xref page">external    fence handle types compatibility</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImportFenceWin32HandleInfoKHR-sType-sType" href="#VUID-VkImportFenceWin32HandleInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkImportFenceWin32HandleInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_IMPORT_FENCE_WIN32_HANDLE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImportFenceWin32HandleInfoKHR-pNext-pNext" href="#VUID-VkImportFenceWin32HandleInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkImportFenceWin32HandleInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkImportFenceWin32HandleInfoKHR-fence-parameter" href="#VUID-VkImportFenceWin32HandleInfoKHR-fence-parameter"></a> <span class="vuid">VUID-VkImportFenceWin32HandleInfoKHR-fence-parameter</span><br>
 <code>fence</code> <strong>must</strong> be a valid <a href="#VkFence">VkFence</a> handle</p>
</li>
<li>
<p><a id="VUID-VkImportFenceWin32HandleInfoKHR-flags-parameter" href="#VUID-VkImportFenceWin32HandleInfoKHR-flags-parameter"></a> <span class="vuid">VUID-VkImportFenceWin32HandleInfoKHR-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkFenceImportFlagBits">VkFenceImportFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>fence</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To import a fence payload from a POSIX file descriptor, call:</p>
</div>
<div id="vkImportFenceFdKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_fence_fd
VkResult vkImportFenceFdKHR(
    VkDevice                                    device,
    const VkImportFenceFdInfoKHR*               pImportFenceFdInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that created the fence.</p>
</li>
<li>
<p><code>pImportFenceFdInfo</code> is a pointer to a <a href="#VkImportFenceFdInfoKHR">VkImportFenceFdInfoKHR</a>
structure specifying the fence and import parameters.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Importing a fence payload from a file descriptor transfers ownership of the
file descriptor from the application to the Vulkan implementation.
The application <strong>must</strong> not perform any operations on the file descriptor
after a successful import.</p>
</div>
<div class="paragraph">
<p>Applications <strong>can</strong> import the same fence payload into multiple instances of
Vulkan, into the same instance from which it was exported, and multiple
times into a given Vulkan instance.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkImportFenceFdKHR-fence-01463" href="#VUID-vkImportFenceFdKHR-fence-01463"></a> <span class="vuid">VUID-vkImportFenceFdKHR-fence-01463</span><br>

<code>fence</code> <strong>must</strong> not be associated with any queue command that has not
yet completed execution on that queue</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkImportFenceFdKHR-device-parameter" href="#VUID-vkImportFenceFdKHR-device-parameter"></a> <span class="vuid">VUID-vkImportFenceFdKHR-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkImportFenceFdKHR-pImportFenceFdInfo-parameter" href="#VUID-vkImportFenceFdKHR-pImportFenceFdInfo-parameter"></a> <span class="vuid">VUID-vkImportFenceFdKHR-pImportFenceFdInfo-parameter</span><br>
 <code>pImportFenceFdInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkImportFenceFdInfoKHR">VkImportFenceFdInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_INVALID_EXTERNAL_HANDLE</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkImportFenceFdInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkImportFenceFdInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_fence_fd
typedef struct VkImportFenceFdInfoKHR {
    VkStructureType                      sType;
    const void*                          pNext;
    VkFence                              fence;
    VkFenceImportFlags                   flags;
    VkExternalFenceHandleTypeFlagBits    handleType;
    int                                  fd;
} VkImportFenceFdInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>fence</code> is the fence into which the payload will be imported.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkFenceImportFlagBits">VkFenceImportFlagBits</a> specifying
additional parameters for the fence payload import operation.</p>
</li>
<li>
<p><code>handleType</code> is a <a href="capabilities.html#VkExternalFenceHandleTypeFlagBits" class="xref page">VkExternalFenceHandleTypeFlagBits</a> value
specifying the type of <code>fd</code>.</p>
</li>
<li>
<p><code>fd</code> is the external handle to import.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The handle types supported by <code>handleType</code> are:</p>
</div>
<table id="synchronization-fence-handletypes-fd" class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 5. Handle Types Supported by <code>VkImportFenceFdInfoKHR</code></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Handle Type</th>
<th class="tableblock halign-left valign-top">Transference</th>
<th class="tableblock halign-left valign-top">Permanence Supported</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_EXTERNAL_FENCE_HANDLE_TYPE_OPAQUE_FD_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reference</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temporary,Permanent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_EXTERNAL_FENCE_HANDLE_TYPE_SYNC_FD_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Copy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temporary</p></td>
</tr>
</tbody>
</table>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImportFenceFdInfoKHR-handleType-01464" href="#VUID-VkImportFenceFdInfoKHR-handleType-01464"></a> <span class="vuid">VUID-VkImportFenceFdInfoKHR-handleType-01464</span><br>

<code>handleType</code> <strong>must</strong> be a value included in the
<a href="#synchronization-fence-handletypes-fd">Handle Types Supported by    <code>VkImportFenceFdInfoKHR</code></a> table</p>
</li>
<li>
<p><a id="VUID-VkImportFenceFdInfoKHR-fd-01541" href="#VUID-VkImportFenceFdInfoKHR-fd-01541"></a> <span class="vuid">VUID-VkImportFenceFdInfoKHR-fd-01541</span><br>

<code>fd</code> <strong>must</strong> obey any requirements listed for <code>handleType</code> in
<a href="capabilities.html#external-fence-handle-types-compatibility" class="xref page">external fence handle types    compatibility</a></p>
</li>
<li>
<p><a id="VUID-VkImportFenceFdInfoKHR-handleType-07306" href="#VUID-VkImportFenceFdInfoKHR-handleType-07306"></a> <span class="vuid">VUID-VkImportFenceFdInfoKHR-handleType-07306</span><br>

If <code>handleType</code> refers to a handle type with copy payload
transference semantics, <code>flags</code> <strong>must</strong> contain
<code>VK_FENCE_IMPORT_TEMPORARY_BIT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>If <code>handleType</code> is <code>VK_EXTERNAL_FENCE_HANDLE_TYPE_SYNC_FD_BIT</code>, the
special value <code>-1</code> for <code>fd</code> is treated like a valid sync file descriptor
referring to an object that has already signaled.
The import operation will succeed and the <code>VkFence</code> will have a
temporarily imported payload as if a valid file descriptor had been
provided.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This special behavior for importing an invalid sync file descriptor allows
easier interoperability with other system APIs which use the convention that
an invalid sync file descriptor represents work that has already completed
and does not need to be waited for.
It is consistent with the option for implementations to return a <code>-1</code> file
descriptor when exporting a <code>VK_EXTERNAL_FENCE_HANDLE_TYPE_SYNC_FD_BIT</code>
from a <code>VkFence</code> which is signaled.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImportFenceFdInfoKHR-sType-sType" href="#VUID-VkImportFenceFdInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkImportFenceFdInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_IMPORT_FENCE_FD_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImportFenceFdInfoKHR-pNext-pNext" href="#VUID-VkImportFenceFdInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkImportFenceFdInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkImportFenceFdInfoKHR-fence-parameter" href="#VUID-VkImportFenceFdInfoKHR-fence-parameter"></a> <span class="vuid">VUID-VkImportFenceFdInfoKHR-fence-parameter</span><br>
 <code>fence</code> <strong>must</strong> be a valid <a href="#VkFence">VkFence</a> handle</p>
</li>
<li>
<p><a id="VUID-VkImportFenceFdInfoKHR-flags-parameter" href="#VUID-VkImportFenceFdInfoKHR-flags-parameter"></a> <span class="vuid">VUID-VkImportFenceFdInfoKHR-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkFenceImportFlagBits">VkFenceImportFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkImportFenceFdInfoKHR-handleType-parameter" href="#VUID-VkImportFenceFdInfoKHR-handleType-parameter"></a> <span class="vuid">VUID-VkImportFenceFdInfoKHR-handleType-parameter</span><br>
 <code>handleType</code> <strong>must</strong> be a valid <a href="capabilities.html#VkExternalFenceHandleTypeFlagBits" class="xref page">VkExternalFenceHandleTypeFlagBits</a> value</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>fence</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#VkImportFenceWin32HandleInfoKHR">VkImportFenceWin32HandleInfoKHR</a>::<code>flags</code></p>
</li>
<li>
<p><a href="#VkImportFenceFdInfoKHR">VkImportFenceFdInfoKHR</a>::<code>flags</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>specifying additional parameters of a fence import operation are:</p>
</div>
<div id="VkFenceImportFlagBits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_1
typedef enum VkFenceImportFlagBits {
    VK_FENCE_IMPORT_TEMPORARY_BIT = 0x00000001,
  // Provided by VK_KHR_external_fence
    VK_FENCE_IMPORT_TEMPORARY_BIT_KHR = VK_FENCE_IMPORT_TEMPORARY_BIT,
} VkFenceImportFlagBits;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkFenceImportFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_fence
typedef VkFenceImportFlagBits VkFenceImportFlagBitsKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_FENCE_IMPORT_TEMPORARY_BIT</code> specifies that the fence payload
will be imported only temporarily, as described in
<a href="#synchronization-fences-importing">Importing Fence Payloads</a>,
regardless of the permanence of <code>handleType</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkFenceImportFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_1
typedef VkFlags VkFenceImportFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkFenceImportFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_fence
typedef VkFenceImportFlags VkFenceImportFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkFenceImportFlags</code> is a bitmask type for setting a mask of zero or
more <a href="#VkFenceImportFlagBits">VkFenceImportFlagBits</a>.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="synchronization-semaphores"><a class="anchor" href="#synchronization-semaphores"></a>Semaphores</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Semaphores are a synchronization primitive that <strong>can</strong> be used to insert a
dependency
between queue operations or between a queue operation and the host.
<a href="../appendices/glossary.html#glossary" class="xref page">Binary semaphores</a> have two states - signaled and unsignaled.
<a href="../appendices/glossary.html#glossary" class="xref page">Timeline semaphores</a> have a strictly increasing 64-bit unsigned
integer payload and are signaled with respect to a particular reference
value.
A semaphore <strong>can</strong> be signaled after execution of a queue operation is
completed, and a queue operation <strong>can</strong> wait for a semaphore to become
signaled before it begins execution.
A timeline semaphore <strong>can</strong> additionally be signaled from the host with the
<a href="#vkSignalSemaphore">vkSignalSemaphore</a> command and waited on from the host with the
<a href="#vkWaitSemaphores">vkWaitSemaphores</a> command.</p>
</div>
<div id="synchronization-semaphores-payloads" class="paragraph">
<p>The internal data of a semaphore <strong>may</strong> include a reference to any resources
and pending work associated with signal or unsignal operations performed on
that semaphore object, collectively referred to as the semaphore&#8217;s
<em>payload</em>.
Mechanisms to import and export that internal data to and from semaphores
are provided <a href="#VkExportSemaphoreCreateInfo">below</a>.
These mechanisms indirectly enable applications to share semaphore state
between two or more semaphores and other synchronization primitives across
process and API boundaries.</p>
</div>
<div class="paragraph">
<p>Semaphores are represented by <code>VkSemaphore</code> handles:</p>
</div>
<div id="VkSemaphore" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkSemaphore)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a semaphore, call:</p>
</div>
<div id="vkCreateSemaphore" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VkResult vkCreateSemaphore(
    VkDevice                                    device,
    const VkSemaphoreCreateInfo*                pCreateInfo,
    const VkAllocationCallbacks*                pAllocator,
    VkSemaphore*                                pSemaphore);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the semaphore.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to a <a href="#VkSemaphoreCreateInfo">VkSemaphoreCreateInfo</a>
structure containing information about how the semaphore is to be
created.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="memory.html#memory-allocation" class="xref page">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pSemaphore</code> is a pointer to a handle in which the resulting
semaphore object is returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateSemaphore-device-parameter" href="#VUID-vkCreateSemaphore-device-parameter"></a> <span class="vuid">VUID-vkCreateSemaphore-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateSemaphore-pCreateInfo-parameter" href="#VUID-vkCreateSemaphore-pCreateInfo-parameter"></a> <span class="vuid">VUID-vkCreateSemaphore-pCreateInfo-parameter</span><br>
 <code>pCreateInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkSemaphoreCreateInfo">VkSemaphoreCreateInfo</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateSemaphore-pAllocator-parameter" href="#VUID-vkCreateSemaphore-pAllocator-parameter"></a> <span class="vuid">VUID-vkCreateSemaphore-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong>must</strong> be a valid pointer to a valid <a href="memory.html#VkAllocationCallbacks" class="xref page">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateSemaphore-pSemaphore-parameter" href="#VUID-vkCreateSemaphore-pSemaphore-parameter"></a> <span class="vuid">VUID-vkCreateSemaphore-pSemaphore-parameter</span><br>
 <code>pSemaphore</code> <strong>must</strong> be a valid pointer to a <a href="#VkSemaphore">VkSemaphore</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkSemaphoreCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkSemaphoreCreateInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef struct VkSemaphoreCreateInfo {
    VkStructureType           sType;
    const void*               pNext;
    VkSemaphoreCreateFlags    flags;
} VkSemaphoreCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSemaphoreCreateInfo-pNext-06789" href="#VUID-VkSemaphoreCreateInfo-pNext-06789"></a> <span class="vuid">VUID-VkSemaphoreCreateInfo-pNext-06789</span><br>

If the <code>pNext</code> chain includes a
<a href="memory.html#VkExportMetalObjectCreateInfoEXT" class="xref page">VkExportMetalObjectCreateInfoEXT</a> structure, its
<code>exportObjectType</code> member <strong>must</strong> be
<code>VK_EXPORT_METAL_OBJECT_TYPE_METAL_SHARED_EVENT_BIT_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSemaphoreCreateInfo-sType-sType" href="#VUID-VkSemaphoreCreateInfo-sType-sType"></a> <span class="vuid">VUID-VkSemaphoreCreateInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_SEMAPHORE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreCreateInfo-pNext-pNext" href="#VUID-VkSemaphoreCreateInfo-pNext-pNext"></a> <span class="vuid">VUID-VkSemaphoreCreateInfo-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="memory.html#VkExportMetalObjectCreateInfoEXT" class="xref page">VkExportMetalObjectCreateInfoEXT</a>, <a href="#VkExportSemaphoreCreateInfo">VkExportSemaphoreCreateInfo</a>, <a href="#VkExportSemaphoreWin32HandleInfoKHR">VkExportSemaphoreWin32HandleInfoKHR</a>, <a href="memory.html#VkImportMetalSharedEventInfoEXT" class="xref page">VkImportMetalSharedEventInfoEXT</a>, <a href="#VkQueryLowLatencySupportNV">VkQueryLowLatencySupportNV</a>, or <a href="#VkSemaphoreTypeCreateInfo">VkSemaphoreTypeCreateInfo</a></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreCreateInfo-sType-unique" href="#VUID-VkSemaphoreCreateInfo-sType-unique"></a> <span class="vuid">VUID-VkSemaphoreCreateInfo-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique, with the exception of structures of type <a href="memory.html#VkExportMetalObjectCreateInfoEXT" class="xref page">VkExportMetalObjectCreateInfoEXT</a></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreCreateInfo-flags-zerobitmask" href="#VUID-VkSemaphoreCreateInfo-flags-zerobitmask"></a> <span class="vuid">VUID-VkSemaphoreCreateInfo-flags-zerobitmask</span><br>
 <code>flags</code> <strong>must</strong> be <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkSemaphoreCreateFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef VkFlags VkSemaphoreCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkSemaphoreCreateFlags</code> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkSemaphoreTypeCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkSemaphoreTypeCreateInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_2
typedef struct VkSemaphoreTypeCreateInfo {
    VkStructureType    sType;
    const void*        pNext;
    VkSemaphoreType    semaphoreType;
    uint64_t           initialValue;
} VkSemaphoreTypeCreateInfo;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkSemaphoreTypeCreateInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_timeline_semaphore
typedef VkSemaphoreTypeCreateInfo VkSemaphoreTypeCreateInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>semaphoreType</code> is a <a href="#VkSemaphoreType">VkSemaphoreType</a> value specifying the type
of the semaphore.</p>
</li>
<li>
<p><code>initialValue</code> is the initial payload value if <code>semaphoreType</code>
is <code>VK_SEMAPHORE_TYPE_TIMELINE</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To create a semaphore of a specific type, add a
<code>VkSemaphoreTypeCreateInfo</code> structure to the
<a href="#VkSemaphoreCreateInfo">VkSemaphoreCreateInfo</a>::<code>pNext</code> chain.</p>
</div>
<div class="paragraph">
<p>If no <code>VkSemaphoreTypeCreateInfo</code> structure is included in the
<code>pNext</code> chain of <a href="#VkSemaphoreCreateInfo">VkSemaphoreCreateInfo</a>, then the created semaphore
will have a default <a href="#VkSemaphoreType">VkSemaphoreType</a> of <code>VK_SEMAPHORE_TYPE_BINARY</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSemaphoreTypeCreateInfo-timelineSemaphore-03252" href="#VUID-VkSemaphoreTypeCreateInfo-timelineSemaphore-03252"></a> <span class="vuid">VUID-VkSemaphoreTypeCreateInfo-timelineSemaphore-03252</span><br>

If the <a href="features.html#features-timelineSemaphore" class="xref page"><code>timelineSemaphore</code></a> feature
is not enabled, <code>semaphoreType</code> <strong>must</strong> not equal
<code>VK_SEMAPHORE_TYPE_TIMELINE</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreTypeCreateInfo-semaphoreType-03279" href="#VUID-VkSemaphoreTypeCreateInfo-semaphoreType-03279"></a> <span class="vuid">VUID-VkSemaphoreTypeCreateInfo-semaphoreType-03279</span><br>

If <code>semaphoreType</code> is <code>VK_SEMAPHORE_TYPE_BINARY</code>,
<code>initialValue</code> <strong>must</strong> be zero</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSemaphoreTypeCreateInfo-sType-sType" href="#VUID-VkSemaphoreTypeCreateInfo-sType-sType"></a> <span class="vuid">VUID-VkSemaphoreTypeCreateInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_SEMAPHORE_TYPE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreTypeCreateInfo-semaphoreType-parameter" href="#VUID-VkSemaphoreTypeCreateInfo-semaphoreType-parameter"></a> <span class="vuid">VUID-VkSemaphoreTypeCreateInfo-semaphoreType-parameter</span><br>
 <code>semaphoreType</code> <strong>must</strong> be a valid <a href="#VkSemaphoreType">VkSemaphoreType</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <a href="#VkSemaphoreTypeCreateInfo">VkSemaphoreTypeCreateInfo</a>::<code>semaphoreType</code>,
specifying the type of a semaphore, are:</p>
</div>
<div id="VkSemaphoreType" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_2
typedef enum VkSemaphoreType {
    VK_SEMAPHORE_TYPE_BINARY = 0,
    VK_SEMAPHORE_TYPE_TIMELINE = 1,
  // Provided by VK_KHR_timeline_semaphore
    VK_SEMAPHORE_TYPE_BINARY_KHR = VK_SEMAPHORE_TYPE_BINARY,
  // Provided by VK_KHR_timeline_semaphore
    VK_SEMAPHORE_TYPE_TIMELINE_KHR = VK_SEMAPHORE_TYPE_TIMELINE,
} VkSemaphoreType;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkSemaphoreTypeKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_timeline_semaphore
typedef VkSemaphoreType VkSemaphoreTypeKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_SEMAPHORE_TYPE_BINARY</code> specifies a <em>binary semaphore</em> type that
has a boolean payload indicating whether the semaphore is currently
signaled or unsignaled.
When created, the semaphore is in the unsignaled state.</p>
</li>
<li>
<p><code>VK_SEMAPHORE_TYPE_TIMELINE</code> specifies a <em>timeline semaphore</em> type
that has a strictly increasing 64-bit unsigned integer payload
indicating whether the semaphore is signaled with respect to a
particular reference value.
When created, the semaphore payload has the value given by the
<code>initialValue</code> field of <a href="#VkSemaphoreTypeCreateInfo">VkSemaphoreTypeCreateInfo</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a semaphore whose payload <strong>can</strong> be exported to external handles,
add a <a href="#VkExportSemaphoreCreateInfo">VkExportSemaphoreCreateInfo</a> structure to the <code>pNext</code> chain
of the <a href="#VkSemaphoreCreateInfo">VkSemaphoreCreateInfo</a> structure.
The <code>VkExportSemaphoreCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkExportSemaphoreCreateInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_1
typedef struct VkExportSemaphoreCreateInfo {
    VkStructureType                       sType;
    const void*                           pNext;
    VkExternalSemaphoreHandleTypeFlags    handleTypes;
} VkExportSemaphoreCreateInfo;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkExportSemaphoreCreateInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_semaphore
typedef VkExportSemaphoreCreateInfo VkExportSemaphoreCreateInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>handleTypes</code> is a bitmask of
<a href="capabilities.html#VkExternalSemaphoreHandleTypeFlagBits" class="xref page">VkExternalSemaphoreHandleTypeFlagBits</a> specifying one or more
semaphore handle types the application <strong>can</strong> export from the resulting
semaphore.
The application <strong>can</strong> request multiple handle types for the same
semaphore.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkExportSemaphoreCreateInfo-handleTypes-01124" href="#VUID-VkExportSemaphoreCreateInfo-handleTypes-01124"></a> <span class="vuid">VUID-VkExportSemaphoreCreateInfo-handleTypes-01124</span><br>

The bits in <code>handleTypes</code> <strong>must</strong> be supported and compatible, as
reported by <a href="capabilities.html#VkExternalSemaphoreProperties" class="xref page">VkExternalSemaphoreProperties</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkExportSemaphoreCreateInfo-sType-sType" href="#VUID-VkExportSemaphoreCreateInfo-sType-sType"></a> <span class="vuid">VUID-VkExportSemaphoreCreateInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_EXPORT_SEMAPHORE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkExportSemaphoreCreateInfo-handleTypes-parameter" href="#VUID-VkExportSemaphoreCreateInfo-handleTypes-parameter"></a> <span class="vuid">VUID-VkExportSemaphoreCreateInfo-handleTypes-parameter</span><br>
 <code>handleTypes</code> <strong>must</strong> be a valid combination of <a href="capabilities.html#VkExternalSemaphoreHandleTypeFlagBits" class="xref page">VkExternalSemaphoreHandleTypeFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To specify additional attributes of NT handles exported from a semaphore,
add a <code>VkExportSemaphoreWin32HandleInfoKHR</code> structure to the <code>pNext</code>
chain of the <a href="#VkSemaphoreCreateInfo">VkSemaphoreCreateInfo</a> structure.
The <code>VkExportSemaphoreWin32HandleInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkExportSemaphoreWin32HandleInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_semaphore_win32
typedef struct VkExportSemaphoreWin32HandleInfoKHR {
    VkStructureType               sType;
    const void*                   pNext;
    const SECURITY_ATTRIBUTES*    pAttributes;
    DWORD                         dwAccess;
    LPCWSTR                       name;
} VkExportSemaphoreWin32HandleInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pAttributes</code> is a pointer to a Windows <code>SECURITY_ATTRIBUTES</code>
structure specifying security attributes of the handle.</p>
</li>
<li>
<p><code>dwAccess</code> is a <code>DWORD</code> specifying access rights of the handle.</p>
</li>
<li>
<p><code>name</code> is a null-terminated UTF-16 string to associate with the
underlying synchronization primitive referenced by NT handles exported
from the created semaphore.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <a href="#VkExportSemaphoreCreateInfo">VkExportSemaphoreCreateInfo</a> is not included in the same <code>pNext</code>
chain, this structure is ignored.</p>
</div>
<div class="paragraph">
<p>If <a href="#VkExportSemaphoreCreateInfo">VkExportSemaphoreCreateInfo</a> is included in the <code>pNext</code> chain of
<a href="#VkSemaphoreCreateInfo">VkSemaphoreCreateInfo</a> with a Windows <code>handleType</code>, but either
<code>VkExportSemaphoreWin32HandleInfoKHR</code> is not included in the <code>pNext</code>
chain, or it is included but <code>pAttributes</code> is set to <code>NULL</code>, default
security descriptor values will be used, and child processes created by the
application will not inherit the handle, as described in the MSDN
documentation for &#8220;Synchronization Object Security and Access Rights&#8221;<sup>1</sup>.
Further, if the structure is not present, the access rights used depend on
the handle type.</p>
</div>
<div class="paragraph">
<p>For handles of the following types:</p>
</div>
<div class="paragraph">
<p><code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_OPAQUE_WIN32_BIT</code></p>
</div>
<div class="paragraph">
<p>The implementation <strong>must</strong> ensure the access rights allow both signal and wait
operations on the semaphore.</p>
</div>
<div class="paragraph">
<p>For handles of the following types:</p>
</div>
<div class="paragraph">
<p><code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_D3D12_FENCE_BIT</code></p>
</div>
<div class="paragraph">
<p>The access rights <strong>must</strong> be:</p>
</div>
<div class="paragraph">
<p><code>GENERIC_ALL</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">1</dt>
<dd>
<p><a href="https://docs.microsoft.com/en-us/windows/win32/sync/synchronization-object-security-and-access-rights" class="bare">https://docs.microsoft.com/en-us/windows/win32/sync/synchronization-object-security-and-access-rights</a></p>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkExportSemaphoreWin32HandleInfoKHR-handleTypes-01125" href="#VUID-VkExportSemaphoreWin32HandleInfoKHR-handleTypes-01125"></a> <span class="vuid">VUID-VkExportSemaphoreWin32HandleInfoKHR-handleTypes-01125</span><br>

If <a href="#VkExportSemaphoreCreateInfo">VkExportSemaphoreCreateInfo</a>::<code>handleTypes</code> does not include
<code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_OPAQUE_WIN32_BIT</code> or
<code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_D3D12_FENCE_BIT</code>,
<code>VkExportSemaphoreWin32HandleInfoKHR</code> <strong>must</strong> not be included in the
<code>pNext</code> chain of <a href="#VkSemaphoreCreateInfo">VkSemaphoreCreateInfo</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkExportSemaphoreWin32HandleInfoKHR-sType-sType" href="#VUID-VkExportSemaphoreWin32HandleInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkExportSemaphoreWin32HandleInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_EXPORT_SEMAPHORE_WIN32_HANDLE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkExportSemaphoreWin32HandleInfoKHR-pAttributes-parameter" href="#VUID-VkExportSemaphoreWin32HandleInfoKHR-pAttributes-parameter"></a> <span class="vuid">VUID-VkExportSemaphoreWin32HandleInfoKHR-pAttributes-parameter</span><br>
 If <code>pAttributes</code> is not <code>NULL</code>, <code>pAttributes</code> <strong>must</strong> be a valid pointer to a valid <code>SECURITY_ATTRIBUTES</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To export a Windows handle representing the payload of a semaphore, call:</p>
</div>
<div id="vkGetSemaphoreWin32HandleKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_semaphore_win32
VkResult vkGetSemaphoreWin32HandleKHR(
    VkDevice                                    device,
    const VkSemaphoreGetWin32HandleInfoKHR*     pGetWin32HandleInfo,
    HANDLE*                                     pHandle);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that created the semaphore being
exported.</p>
</li>
<li>
<p><code>pGetWin32HandleInfo</code> is a pointer to a
<a href="#VkSemaphoreGetWin32HandleInfoKHR">VkSemaphoreGetWin32HandleInfoKHR</a> structure containing parameters
of the export operation.</p>
</li>
<li>
<p><code>pHandle</code> will return the Windows handle representing the semaphore
state.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For handle types defined as NT handles, the handles returned by
<code>vkGetSemaphoreWin32HandleKHR</code> are owned by the application.
To avoid leaking resources, the application <strong>must</strong> release ownership of them
using the <code>CloseHandle</code> system call when they are no longer needed.</p>
</div>
<div class="paragraph">
<p>Exporting a Windows handle from a semaphore <strong>may</strong> have side effects depending
on the transference of the specified handle type, as described in
<a href="#synchronization-semaphores-importing">Importing Semaphore Payloads</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetSemaphoreWin32HandleKHR-device-parameter" href="#VUID-vkGetSemaphoreWin32HandleKHR-device-parameter"></a> <span class="vuid">VUID-vkGetSemaphoreWin32HandleKHR-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetSemaphoreWin32HandleKHR-pGetWin32HandleInfo-parameter" href="#VUID-vkGetSemaphoreWin32HandleKHR-pGetWin32HandleInfo-parameter"></a> <span class="vuid">VUID-vkGetSemaphoreWin32HandleKHR-pGetWin32HandleInfo-parameter</span><br>
 <code>pGetWin32HandleInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkSemaphoreGetWin32HandleInfoKHR">VkSemaphoreGetWin32HandleInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetSemaphoreWin32HandleKHR-pHandle-parameter" href="#VUID-vkGetSemaphoreWin32HandleKHR-pHandle-parameter"></a> <span class="vuid">VUID-vkGetSemaphoreWin32HandleKHR-pHandle-parameter</span><br>
 <code>pHandle</code> <strong>must</strong> be a valid pointer to a <code>HANDLE</code> value</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkSemaphoreGetWin32HandleInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkSemaphoreGetWin32HandleInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_semaphore_win32
typedef struct VkSemaphoreGetWin32HandleInfoKHR {
    VkStructureType                          sType;
    const void*                              pNext;
    VkSemaphore                              semaphore;
    VkExternalSemaphoreHandleTypeFlagBits    handleType;
} VkSemaphoreGetWin32HandleInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>semaphore</code> is the semaphore from which state will be exported.</p>
</li>
<li>
<p><code>handleType</code> is a <a href="capabilities.html#VkExternalSemaphoreHandleTypeFlagBits" class="xref page">VkExternalSemaphoreHandleTypeFlagBits</a> value
specifying the type of handle requested.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The properties of the handle returned depend on the value of
<code>handleType</code>.
See <a href="capabilities.html#VkExternalSemaphoreHandleTypeFlagBits" class="xref page">VkExternalSemaphoreHandleTypeFlagBits</a> for a description of the
properties of the defined external semaphore handle types.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSemaphoreGetWin32HandleInfoKHR-handleType-01126" href="#VUID-VkSemaphoreGetWin32HandleInfoKHR-handleType-01126"></a> <span class="vuid">VUID-VkSemaphoreGetWin32HandleInfoKHR-handleType-01126</span><br>

<code>handleType</code> <strong>must</strong> have been included in
<a href="#VkExportSemaphoreCreateInfo">VkExportSemaphoreCreateInfo</a>::<code>handleTypes</code> when the
<code>semaphore</code>&#8217;s current payload was created</p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetWin32HandleInfoKHR-handleType-01127" href="#VUID-VkSemaphoreGetWin32HandleInfoKHR-handleType-01127"></a> <span class="vuid">VUID-VkSemaphoreGetWin32HandleInfoKHR-handleType-01127</span><br>

If <code>handleType</code> is defined as an NT handle,
<a href="#vkGetSemaphoreWin32HandleKHR">vkGetSemaphoreWin32HandleKHR</a> <strong>must</strong> be called no more than once for
each valid unique combination of <code>semaphore</code> and <code>handleType</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetWin32HandleInfoKHR-semaphore-01128" href="#VUID-VkSemaphoreGetWin32HandleInfoKHR-semaphore-01128"></a> <span class="vuid">VUID-VkSemaphoreGetWin32HandleInfoKHR-semaphore-01128</span><br>

<code>semaphore</code> <strong>must</strong> not currently have its payload replaced by an
imported payload as described below in
<a href="#synchronization-semaphores-importing">Importing Semaphore Payloads</a>
unless that imported payload&#8217;s handle type was included in
<a href="capabilities.html#VkExternalSemaphoreProperties" class="xref page">VkExternalSemaphoreProperties</a>::<code>exportFromImportedHandleTypes</code>
for <code>handleType</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetWin32HandleInfoKHR-handleType-01129" href="#VUID-VkSemaphoreGetWin32HandleInfoKHR-handleType-01129"></a> <span class="vuid">VUID-VkSemaphoreGetWin32HandleInfoKHR-handleType-01129</span><br>

If <code>handleType</code> refers to a handle type with copy payload
transference semantics, as defined below in
<a href="#synchronization-semaphores-importing">Importing Semaphore Payloads</a>,
there <strong>must</strong> be no queue waiting on <code>semaphore</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetWin32HandleInfoKHR-handleType-01130" href="#VUID-VkSemaphoreGetWin32HandleInfoKHR-handleType-01130"></a> <span class="vuid">VUID-VkSemaphoreGetWin32HandleInfoKHR-handleType-01130</span><br>

If <code>handleType</code> refers to a handle type with copy payload
transference semantics, <code>semaphore</code> <strong>must</strong> be signaled, or have an
associated <a href="#synchronization-semaphores-signaling">semaphore signal    operation</a> pending execution</p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetWin32HandleInfoKHR-handleType-01131" href="#VUID-VkSemaphoreGetWin32HandleInfoKHR-handleType-01131"></a> <span class="vuid">VUID-VkSemaphoreGetWin32HandleInfoKHR-handleType-01131</span><br>

<code>handleType</code> <strong>must</strong> be defined as an NT handle or a global share
handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSemaphoreGetWin32HandleInfoKHR-sType-sType" href="#VUID-VkSemaphoreGetWin32HandleInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkSemaphoreGetWin32HandleInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_SEMAPHORE_GET_WIN32_HANDLE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetWin32HandleInfoKHR-pNext-pNext" href="#VUID-VkSemaphoreGetWin32HandleInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkSemaphoreGetWin32HandleInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetWin32HandleInfoKHR-semaphore-parameter" href="#VUID-VkSemaphoreGetWin32HandleInfoKHR-semaphore-parameter"></a> <span class="vuid">VUID-VkSemaphoreGetWin32HandleInfoKHR-semaphore-parameter</span><br>
 <code>semaphore</code> <strong>must</strong> be a valid <a href="#VkSemaphore">VkSemaphore</a> handle</p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetWin32HandleInfoKHR-handleType-parameter" href="#VUID-VkSemaphoreGetWin32HandleInfoKHR-handleType-parameter"></a> <span class="vuid">VUID-VkSemaphoreGetWin32HandleInfoKHR-handleType-parameter</span><br>
 <code>handleType</code> <strong>must</strong> be a valid <a href="capabilities.html#VkExternalSemaphoreHandleTypeFlagBits" class="xref page">VkExternalSemaphoreHandleTypeFlagBits</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkQueryLowLatencySupportNV</code> structure is defined as:</p>
</div>
<div id="VkQueryLowLatencySupportNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_NV_low_latency
typedef struct VkQueryLowLatencySupportNV {
    VkStructureType    sType;
    const void*        pNext;
    void*              pQueriedLowLatencyData;
} VkQueryLowLatencySupportNV;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This structure describes the following feature:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pQueriedLowLatencyData</code> is used for NVIDIA Reflex Support.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkQueryLowLatencySupportNV-sType-sType" href="#VUID-VkQueryLowLatencySupportNV-sType-sType"></a> <span class="vuid">VUID-VkQueryLowLatencySupportNV-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_QUERY_LOW_LATENCY_SUPPORT_NV</code></p>
</li>
<li>
<p><a id="VUID-VkQueryLowLatencySupportNV-pQueriedLowLatencyData-parameter" href="#VUID-VkQueryLowLatencySupportNV-pQueriedLowLatencyData-parameter"></a> <span class="vuid">VUID-VkQueryLowLatencySupportNV-pQueriedLowLatencyData-parameter</span><br>
 <code>pQueriedLowLatencyData</code> <strong>must</strong> be a pointer value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To export a POSIX file descriptor representing the payload of a semaphore,
call:</p>
</div>
<div id="vkGetSemaphoreFdKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_semaphore_fd
VkResult vkGetSemaphoreFdKHR(
    VkDevice                                    device,
    const VkSemaphoreGetFdInfoKHR*              pGetFdInfo,
    int*                                        pFd);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that created the semaphore being
exported.</p>
</li>
<li>
<p><code>pGetFdInfo</code> is a pointer to a <a href="#VkSemaphoreGetFdInfoKHR">VkSemaphoreGetFdInfoKHR</a>
structure containing parameters of the export operation.</p>
</li>
<li>
<p><code>pFd</code> will return the file descriptor representing the semaphore
payload.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each call to <code>vkGetSemaphoreFdKHR</code> <strong>must</strong> create a new file descriptor
and transfer ownership of it to the application.
To avoid leaking resources, the application <strong>must</strong> release ownership of the
file descriptor when it is no longer needed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Ownership can be released in many ways.
For example, the application can call <code>close</code>() on the file descriptor,
or transfer ownership back to Vulkan by using the file descriptor to import
a semaphore payload.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Where supported by the operating system, the implementation <strong>must</strong> set the
file descriptor to be closed automatically when an <code>execve</code> system call
is made.</p>
</div>
<div class="paragraph">
<p>Exporting a file descriptor from a semaphore <strong>may</strong> have side effects
depending on the transference of the specified handle type, as described in
<a href="#synchronization-semaphores-importing">Importing Semaphore State</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetSemaphoreFdKHR-device-parameter" href="#VUID-vkGetSemaphoreFdKHR-device-parameter"></a> <span class="vuid">VUID-vkGetSemaphoreFdKHR-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetSemaphoreFdKHR-pGetFdInfo-parameter" href="#VUID-vkGetSemaphoreFdKHR-pGetFdInfo-parameter"></a> <span class="vuid">VUID-vkGetSemaphoreFdKHR-pGetFdInfo-parameter</span><br>
 <code>pGetFdInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkSemaphoreGetFdInfoKHR">VkSemaphoreGetFdInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetSemaphoreFdKHR-pFd-parameter" href="#VUID-vkGetSemaphoreFdKHR-pFd-parameter"></a> <span class="vuid">VUID-vkGetSemaphoreFdKHR-pFd-parameter</span><br>
 <code>pFd</code> <strong>must</strong> be a valid pointer to an <code>int</code> value</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkSemaphoreGetFdInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkSemaphoreGetFdInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_semaphore_fd
typedef struct VkSemaphoreGetFdInfoKHR {
    VkStructureType                          sType;
    const void*                              pNext;
    VkSemaphore                              semaphore;
    VkExternalSemaphoreHandleTypeFlagBits    handleType;
} VkSemaphoreGetFdInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>semaphore</code> is the semaphore from which state will be exported.</p>
</li>
<li>
<p><code>handleType</code> is a <a href="capabilities.html#VkExternalSemaphoreHandleTypeFlagBits" class="xref page">VkExternalSemaphoreHandleTypeFlagBits</a> value
specifying the type of handle requested.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The properties of the file descriptor returned depend on the value of
<code>handleType</code>.
See <a href="capabilities.html#VkExternalSemaphoreHandleTypeFlagBits" class="xref page">VkExternalSemaphoreHandleTypeFlagBits</a> for a description of the
properties of the defined external semaphore handle types.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSemaphoreGetFdInfoKHR-handleType-01132" href="#VUID-VkSemaphoreGetFdInfoKHR-handleType-01132"></a> <span class="vuid">VUID-VkSemaphoreGetFdInfoKHR-handleType-01132</span><br>

<code>handleType</code> <strong>must</strong> have been included in
<a href="#VkExportSemaphoreCreateInfo">VkExportSemaphoreCreateInfo</a>::<code>handleTypes</code> when
<code>semaphore</code>&#8217;s current payload was created</p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetFdInfoKHR-semaphore-01133" href="#VUID-VkSemaphoreGetFdInfoKHR-semaphore-01133"></a> <span class="vuid">VUID-VkSemaphoreGetFdInfoKHR-semaphore-01133</span><br>

<code>semaphore</code> <strong>must</strong> not currently have its payload replaced by an
imported payload as described below in
<a href="#synchronization-semaphores-importing">Importing Semaphore Payloads</a>
unless that imported payload&#8217;s handle type was included in
<a href="capabilities.html#VkExternalSemaphoreProperties" class="xref page">VkExternalSemaphoreProperties</a>::<code>exportFromImportedHandleTypes</code>
for <code>handleType</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetFdInfoKHR-handleType-01134" href="#VUID-VkSemaphoreGetFdInfoKHR-handleType-01134"></a> <span class="vuid">VUID-VkSemaphoreGetFdInfoKHR-handleType-01134</span><br>

If <code>handleType</code> refers to a handle type with copy payload
transference semantics, as defined below in
<a href="#synchronization-semaphores-importing">Importing Semaphore Payloads</a>,
there <strong>must</strong> be no queue waiting on <code>semaphore</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetFdInfoKHR-handleType-01135" href="#VUID-VkSemaphoreGetFdInfoKHR-handleType-01135"></a> <span class="vuid">VUID-VkSemaphoreGetFdInfoKHR-handleType-01135</span><br>

If <code>handleType</code> refers to a handle type with copy payload
transference semantics, <code>semaphore</code> <strong>must</strong> be signaled, or have an
associated <a href="#synchronization-semaphores-signaling">semaphore signal    operation</a> pending execution</p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetFdInfoKHR-handleType-01136" href="#VUID-VkSemaphoreGetFdInfoKHR-handleType-01136"></a> <span class="vuid">VUID-VkSemaphoreGetFdInfoKHR-handleType-01136</span><br>

<code>handleType</code> <strong>must</strong> be defined as a POSIX file descriptor handle</p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetFdInfoKHR-handleType-03253" href="#VUID-VkSemaphoreGetFdInfoKHR-handleType-03253"></a> <span class="vuid">VUID-VkSemaphoreGetFdInfoKHR-handleType-03253</span><br>

If <code>handleType</code> refers to a handle type with copy payload
transference semantics, <code>semaphore</code> <strong>must</strong> have been created with a
<a href="#VkSemaphoreType">VkSemaphoreType</a> of <code>VK_SEMAPHORE_TYPE_BINARY</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetFdInfoKHR-handleType-03254" href="#VUID-VkSemaphoreGetFdInfoKHR-handleType-03254"></a> <span class="vuid">VUID-VkSemaphoreGetFdInfoKHR-handleType-03254</span><br>

If <code>handleType</code> refers to a handle type with copy payload
transference semantics, <code>semaphore</code> <strong>must</strong> have an associated
semaphore signal operation that has been submitted for execution and any
semaphore signal operations on which it depends (if any) <strong>must</strong> have also
been submitted for execution</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSemaphoreGetFdInfoKHR-sType-sType" href="#VUID-VkSemaphoreGetFdInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkSemaphoreGetFdInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_SEMAPHORE_GET_FD_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetFdInfoKHR-pNext-pNext" href="#VUID-VkSemaphoreGetFdInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkSemaphoreGetFdInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetFdInfoKHR-semaphore-parameter" href="#VUID-VkSemaphoreGetFdInfoKHR-semaphore-parameter"></a> <span class="vuid">VUID-VkSemaphoreGetFdInfoKHR-semaphore-parameter</span><br>
 <code>semaphore</code> <strong>must</strong> be a valid <a href="#VkSemaphore">VkSemaphore</a> handle</p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetFdInfoKHR-handleType-parameter" href="#VUID-VkSemaphoreGetFdInfoKHR-handleType-parameter"></a> <span class="vuid">VUID-VkSemaphoreGetFdInfoKHR-handleType-parameter</span><br>
 <code>handleType</code> <strong>must</strong> be a valid <a href="capabilities.html#VkExternalSemaphoreHandleTypeFlagBits" class="xref page">VkExternalSemaphoreHandleTypeFlagBits</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To export a Zircon event handle representing the payload of a semaphore,
call:</p>
</div>
<div id="vkGetSemaphoreZirconHandleFUCHSIA" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_FUCHSIA_external_semaphore
VkResult vkGetSemaphoreZirconHandleFUCHSIA(
    VkDevice                                    device,
    const VkSemaphoreGetZirconHandleInfoFUCHSIA* pGetZirconHandleInfo,
    zx_handle_t*                                pZirconHandle);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that created the semaphore being
exported.</p>
</li>
<li>
<p><code>pGetZirconHandleInfo</code> is a pointer to a
<a href="#VkSemaphoreGetZirconHandleInfoFUCHSIA">VkSemaphoreGetZirconHandleInfoFUCHSIA</a> structure containing
parameters of the export operation.</p>
</li>
<li>
<p><code>pZirconHandle</code> will return the Zircon event handle representing the
semaphore payload.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each call to <code>vkGetSemaphoreZirconHandleFUCHSIA</code> <strong>must</strong> create a Zircon
event handle and transfer ownership of it to the application.
To avoid leaking resources, the application <strong>must</strong> release ownership of the
Zircon event handle when it is no longer needed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Ownership can be released in many ways.
For example, the application can call zx_handle_close() on the file
descriptor, or transfer ownership back to Vulkan by using the file
descriptor to import a semaphore payload.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Exporting a Zircon event handle from a semaphore <strong>may</strong> have side effects
depending on the transference of the specified handle type, as described in
<a href="#synchronization-semaphores-importing">Importing Semaphore State</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetSemaphoreZirconHandleFUCHSIA-device-parameter" href="#VUID-vkGetSemaphoreZirconHandleFUCHSIA-device-parameter"></a> <span class="vuid">VUID-vkGetSemaphoreZirconHandleFUCHSIA-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetSemaphoreZirconHandleFUCHSIA-pGetZirconHandleInfo-parameter" href="#VUID-vkGetSemaphoreZirconHandleFUCHSIA-pGetZirconHandleInfo-parameter"></a> <span class="vuid">VUID-vkGetSemaphoreZirconHandleFUCHSIA-pGetZirconHandleInfo-parameter</span><br>
 <code>pGetZirconHandleInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkSemaphoreGetZirconHandleInfoFUCHSIA">VkSemaphoreGetZirconHandleInfoFUCHSIA</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetSemaphoreZirconHandleFUCHSIA-pZirconHandle-parameter" href="#VUID-vkGetSemaphoreZirconHandleFUCHSIA-pZirconHandle-parameter"></a> <span class="vuid">VUID-vkGetSemaphoreZirconHandleFUCHSIA-pZirconHandle-parameter</span><br>
 <code>pZirconHandle</code> <strong>must</strong> be a valid pointer to a <code>zx_handle_t</code> value</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkSemaphoreGetZirconHandleInfoFUCHSIA</code> structure is defined as:</p>
</div>
<div id="VkSemaphoreGetZirconHandleInfoFUCHSIA" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_FUCHSIA_external_semaphore
typedef struct VkSemaphoreGetZirconHandleInfoFUCHSIA {
    VkStructureType                          sType;
    const void*                              pNext;
    VkSemaphore                              semaphore;
    VkExternalSemaphoreHandleTypeFlagBits    handleType;
} VkSemaphoreGetZirconHandleInfoFUCHSIA;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>semaphore</code> is the semaphore from which state will be exported.</p>
</li>
<li>
<p><code>handleType</code> is a <a href="capabilities.html#VkExternalSemaphoreHandleTypeFlagBits" class="xref page">VkExternalSemaphoreHandleTypeFlagBits</a> value
specifying the type of handle requested.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The properties of the Zircon event handle returned depend on the value of
<code>handleType</code>.
See <a href="capabilities.html#VkExternalSemaphoreHandleTypeFlagBits" class="xref page">VkExternalSemaphoreHandleTypeFlagBits</a> for a description of the
properties of the defined external semaphore handle types.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-handleType-04758" href="#VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-handleType-04758"></a> <span class="vuid">VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-handleType-04758</span><br>

<code>handleType</code> <strong>must</strong> have been included in
<a href="#VkExportSemaphoreCreateInfo">VkExportSemaphoreCreateInfo</a>::<code>handleTypes</code> when
<code>semaphore</code>&#8217;s current payload was created</p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-semaphore-04759" href="#VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-semaphore-04759"></a> <span class="vuid">VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-semaphore-04759</span><br>

<code>semaphore</code> <strong>must</strong> not currently have its payload replaced by an
imported payload as described below in
<a href="#synchronization-semaphores-importing">Importing Semaphore Payloads</a>
unless that imported payload&#8217;s handle type was included in
<a href="capabilities.html#VkExternalSemaphoreProperties" class="xref page">VkExternalSemaphoreProperties</a>::<code>exportFromImportedHandleTypes</code>
for <code>handleType</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-handleType-04760" href="#VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-handleType-04760"></a> <span class="vuid">VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-handleType-04760</span><br>

If <code>handleType</code> refers to a handle type with copy payload
transference semantics, as defined below in
<a href="#synchronization-semaphores-importing">Importing Semaphore Payloads</a>,
there <strong>must</strong> be no queue waiting on <code>semaphore</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-handleType-04761" href="#VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-handleType-04761"></a> <span class="vuid">VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-handleType-04761</span><br>

If <code>handleType</code> refers to a handle type with copy payload
transference semantics, <code>semaphore</code> <strong>must</strong> be signaled, or have an
associated <a href="#synchronization-semaphores-signaling">semaphore signal    operation</a> pending execution</p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-handleType-04762" href="#VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-handleType-04762"></a> <span class="vuid">VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-handleType-04762</span><br>

<code>handleType</code> <strong>must</strong> be defined as a Zircon event handle</p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-semaphore-04763" href="#VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-semaphore-04763"></a> <span class="vuid">VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-semaphore-04763</span><br>

<code>semaphore</code> <strong>must</strong> have been created with a <a href="#VkSemaphoreType">VkSemaphoreType</a> of
<code>VK_SEMAPHORE_TYPE_BINARY</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-sType-sType" href="#VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-sType-sType"></a> <span class="vuid">VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_SEMAPHORE_GET_ZIRCON_HANDLE_INFO_FUCHSIA</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-pNext-pNext" href="#VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-pNext-pNext"></a> <span class="vuid">VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-semaphore-parameter" href="#VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-semaphore-parameter"></a> <span class="vuid">VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-semaphore-parameter</span><br>
 <code>semaphore</code> <strong>must</strong> be a valid <a href="#VkSemaphore">VkSemaphore</a> handle</p>
</li>
<li>
<p><a id="VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-handleType-parameter" href="#VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-handleType-parameter"></a> <span class="vuid">VUID-VkSemaphoreGetZirconHandleInfoFUCHSIA-handleType-parameter</span><br>
 <code>handleType</code> <strong>must</strong> be a valid <a href="capabilities.html#VkExternalSemaphoreHandleTypeFlagBits" class="xref page">VkExternalSemaphoreHandleTypeFlagBits</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a semaphore, call:</p>
</div>
<div id="vkDestroySemaphore" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkDestroySemaphore(
    VkDevice                                    device,
    VkSemaphore                                 semaphore,
    const VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the semaphore.</p>
</li>
<li>
<p><code>semaphore</code> is the handle of the semaphore to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="memory.html#memory-allocation" class="xref page">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroySemaphore-semaphore-01137" href="#VUID-vkDestroySemaphore-semaphore-01137"></a> <span class="vuid">VUID-vkDestroySemaphore-semaphore-01137</span><br>

All submitted batches that refer to <code>semaphore</code> <strong>must</strong> have completed
execution</p>
</li>
<li>
<p><a id="VUID-vkDestroySemaphore-semaphore-01138" href="#VUID-vkDestroySemaphore-semaphore-01138"></a> <span class="vuid">VUID-vkDestroySemaphore-semaphore-01138</span><br>

If <code>VkAllocationCallbacks</code> were provided when <code>semaphore</code> was
created, a compatible set of callbacks <strong>must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroySemaphore-semaphore-01139" href="#VUID-vkDestroySemaphore-semaphore-01139"></a> <span class="vuid">VUID-vkDestroySemaphore-semaphore-01139</span><br>

If no <code>VkAllocationCallbacks</code> were provided when <code>semaphore</code> was
created, <code>pAllocator</code> <strong>must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroySemaphore-device-parameter" href="#VUID-vkDestroySemaphore-device-parameter"></a> <span class="vuid">VUID-vkDestroySemaphore-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroySemaphore-semaphore-parameter" href="#VUID-vkDestroySemaphore-semaphore-parameter"></a> <span class="vuid">VUID-vkDestroySemaphore-semaphore-parameter</span><br>
 If <code>semaphore</code> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, <code>semaphore</code> <strong>must</strong> be a valid <a href="#VkSemaphore">VkSemaphore</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroySemaphore-pAllocator-parameter" href="#VUID-vkDestroySemaphore-pAllocator-parameter"></a> <span class="vuid">VUID-vkDestroySemaphore-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong>must</strong> be a valid pointer to a valid <a href="memory.html#VkAllocationCallbacks" class="xref page">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroySemaphore-semaphore-parent" href="#VUID-vkDestroySemaphore-semaphore-parent"></a> <span class="vuid">VUID-vkDestroySemaphore-semaphore-parent</span><br>
 If <code>semaphore</code> is a valid handle, it <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>semaphore</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-semaphores-signaling"><a class="anchor" href="#synchronization-semaphores-signaling"></a>Semaphore Signaling</h3>
<div class="paragraph">
<p>When a batch is submitted to a queue via a <a href="devsandqueues.html#devsandqueues-submission" class="xref page">queue submission</a>, and it includes semaphores to be signaled, it defines a memory
dependency on the batch, and defines <em>semaphore signal operations</em> which set
the semaphores to the signaled state.</p>
</div>
<div class="paragraph">
<p>In case of semaphores created with a <a href="#VkSemaphoreType">VkSemaphoreType</a> of
<code>VK_SEMAPHORE_TYPE_TIMELINE</code> the semaphore is considered signaled with
respect to the counter value set to be signaled as specified in
<a href="cmdbuffers.html#VkTimelineSemaphoreSubmitInfo" class="xref page">VkTimelineSemaphoreSubmitInfo</a> or <a href="#VkSemaphoreSignalInfo">VkSemaphoreSignalInfo</a>.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes every command submitted in the same batch.
In the case of <a href="cmdbuffers.html#vkQueueSubmit2" class="xref page">vkQueueSubmit2</a>, the first synchronization scope is
limited to the pipeline stage specified by
<a href="cmdbuffers.html#VkSemaphoreSubmitInfo" class="xref page">VkSemaphoreSubmitInfo</a>::<code>stageMask</code>.
Semaphore signal operations that are defined by <a href="cmdbuffers.html#vkQueueSubmit" class="xref page">vkQueueSubmit</a>
or <a href="cmdbuffers.html#vkQueueSubmit2" class="xref page">vkQueueSubmit2</a>
additionally include all commands that occur earlier in
<a href="#synchronization-submission-order">submission order</a>.
Semaphore signal operations that are defined by <a href="cmdbuffers.html#vkQueueSubmit" class="xref page">vkQueueSubmit</a>
or <a href="cmdbuffers.html#vkQueueSubmit2" class="xref page">vkQueueSubmit2</a>
or <a href="sparsemem.html#vkQueueBindSparse" class="xref page">vkQueueBindSparse</a>
additionally include in the first synchronization scope any semaphore and
fence signal operations that occur earlier in
<a href="#synchronization-signal-operation-order">signal operation order</a>.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes only the semaphore signal operation.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-access-scopes">access scope</a>
includes all memory access performed by the device.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-access-scopes">access scope</a> is
empty.</p>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-semaphores-waiting"><a class="anchor" href="#synchronization-semaphores-waiting"></a>Semaphore Waiting</h3>
<div class="paragraph">
<p>When a batch is submitted to a queue via a <a href="devsandqueues.html#devsandqueues-submission" class="xref page">queue submission</a>, and it includes semaphores to be waited on, it defines a
memory dependency between prior semaphore signal operations and the batch,
and defines <em>semaphore wait operations</em>.</p>
</div>
<div class="paragraph">
<p>Such semaphore wait operations set the semaphores
created with a <a href="#VkSemaphoreType">VkSemaphoreType</a> of <code>VK_SEMAPHORE_TYPE_BINARY</code>
to the unsignaled state.
In case of semaphores created with a <a href="#VkSemaphoreType">VkSemaphoreType</a> of
<code>VK_SEMAPHORE_TYPE_TIMELINE</code> a prior semaphore signal operation defines
a memory dependency with a semaphore wait operation if the value the
semaphore is signaled with is greater than or equal to the value the
semaphore is waited with, thus the semaphore will continue to be considered
signaled with respect to the counter value waited on as specified in
<a href="cmdbuffers.html#VkTimelineSemaphoreSubmitInfo" class="xref page">VkTimelineSemaphoreSubmitInfo</a>.</p>
</div>
<div class="paragraph">
<p>The first synchronization scope includes all semaphore signal operations
that operate on semaphores waited on in the same batch, and that
happen-before the wait completes.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes every command submitted in the same batch.
In the case of <a href="cmdbuffers.html#vkQueueSubmit" class="xref page">vkQueueSubmit</a>, the second synchronization scope is
limited to operations on the pipeline stages determined by the
<a href="#synchronization-pipeline-stages-masks">destination stage mask</a> specified
by the corresponding element of <code>pWaitDstStageMask</code>.
In the case of <a href="cmdbuffers.html#vkQueueSubmit2" class="xref page">vkQueueSubmit2</a>, the second synchronization scope is
limited to the pipeline stage specified by
<a href="cmdbuffers.html#VkSemaphoreSubmitInfo" class="xref page">VkSemaphoreSubmitInfo</a>::<code>stageMask</code>.
Also, in the case of
either <a href="cmdbuffers.html#vkQueueSubmit2" class="xref page">vkQueueSubmit2</a> or
<a href="cmdbuffers.html#vkQueueSubmit" class="xref page">vkQueueSubmit</a>, the second synchronization scope additionally includes
all commands that occur later in
<a href="#synchronization-submission-order">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-access-scopes">access scope</a> is
empty.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-access-scopes">access scope</a>
includes all memory access performed by the device.</p>
</div>
<div class="paragraph">
<p>The semaphore wait operation happens-after the first set of operations in
the execution dependency, and happens-before the second set of operations in
the execution dependency.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Unlike
timeline semaphores,
fences or events, the act of waiting for a binary semaphore also unsignals
that semaphore.
Applications <strong>must</strong> ensure that between two such wait operations, the
semaphore is signaled again, with execution dependencies used to ensure
these occur in order.
Binary semaphore waits and signals should thus occur in discrete 1:1 pairs.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>A common scenario for using <code>pWaitDstStageMask</code> with values other than
<code>VK_PIPELINE_STAGE_ALL_COMMANDS_BIT</code> is when synchronizing a window
system presentation operation against subsequent command buffers which
render the next frame.
In this case, a presentation image <strong>must</strong> not be overwritten until the
presentation operation completes, but other pipeline stages <strong>can</strong> execute
without waiting.
A mask of <code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code> prevents
subsequent color attachment writes from executing until the semaphore
signals.
Some implementations <strong>may</strong> be able to execute transfer operations and/or
pre-rasterization work before the semaphore is signaled.</p>
</div>
<div class="paragraph">
<p>If an image layout transition needs to be performed on a presentable image
before it is used in a framebuffer, that <strong>can</strong> be performed as the first
operation submitted to the queue after acquiring the image, and <strong>should</strong> not
prevent other work from overlapping with the presentation operation.
For example, a <code>VkImageMemoryBarrier</code> could use:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>srcStageMask</code> = <code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code></p>
</li>
<li>
<p><code>srcAccessMask</code> = 0</p>
</li>
<li>
<p><code>dstStageMask</code> = <code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code></p>
</li>
<li>
<p><code>dstAccessMask</code> = <code>VK_ACCESS_COLOR_ATTACHMENT_READ_BIT</code> |
<code>VK_ACCESS_COLOR_ATTACHMENT_WRITE_BIT</code>.</p>
</li>
<li>
<p><code>oldLayout</code> = <code>VK_IMAGE_LAYOUT_PRESENT_SRC_KHR</code></p>
</li>
<li>
<p><code>newLayout</code> = <code>VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Alternatively, <code>oldLayout</code> <strong>can</strong> be <code>VK_IMAGE_LAYOUT_UNDEFINED</code>, if
the image&#8217;s contents need not be preserved.</p>
</div>
<div class="paragraph">
<p>This barrier accomplishes a dependency chain between previous presentation
operations and subsequent color attachment output operations, with the
layout transition performed in between, and does not introduce a dependency
between previous work and any
<a href="pipelines.html#pipelines-graphics-subsets-pre-rasterization" class="xref page">pre-rasterization shader stage</a>s.
More precisely, the semaphore signals after the presentation operation
completes, the semaphore wait stalls the
<code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code> stage, and there is a
dependency from that same stage to itself with the layout transition
performed in between.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-semaphores-waiting-state"><a class="anchor" href="#synchronization-semaphores-waiting-state"></a>Semaphore State Requirements For Wait Operations</h3>
<div class="paragraph">
<p>Before waiting on a semaphore, the application <strong>must</strong> ensure the semaphore is
in a valid state for a wait operation.
Specifically, when a <a href="#synchronization-semaphores-waiting">semaphore wait operation</a> is submitted to a queue:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A binary semaphore <strong>must</strong> be signaled, or have an associated
<a href="#synchronization-semaphores-signaling">semaphore signal operation</a> that
is pending execution.</p>
</li>
<li>
<p>Any <a href="#synchronization-semaphores-signaling">semaphore signal operations</a>
on which the pending binary semaphore signal operation depends <strong>must</strong>
also be completed or pending execution.</p>
</li>
<li>
<p>There <strong>must</strong> be no other queue waiting on the same binary semaphore when
the operation executes.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-semaphores-hostops"><a class="anchor" href="#synchronization-semaphores-hostops"></a>Host Operations on Semaphores</h3>
<div class="paragraph">
<p>In addition to <a href="#synchronization-semaphores-signaling">semaphore signal operations</a> and <a href="#synchronization-semaphores-waiting">semaphore wait operations</a> submitted to device queues, timeline semaphores support the
following host operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Query the current counter value of the semaphore using the
<a href="#vkGetSemaphoreCounterValue">vkGetSemaphoreCounterValue</a> command.</p>
</li>
<li>
<p>Wait for a set of semaphores to reach particular counter values using
the <a href="#vkWaitSemaphores">vkWaitSemaphores</a> command.</p>
</li>
<li>
<p>Signal the semaphore with a particular counter value from the host using
the <a href="#vkSignalSemaphore">vkSignalSemaphore</a> command.</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query the current counter value of a semaphore created with a
<a href="#VkSemaphoreType">VkSemaphoreType</a> of <code>VK_SEMAPHORE_TYPE_TIMELINE</code> from the host,
call:</p>
</div>
<div id="vkGetSemaphoreCounterValue" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_2
VkResult vkGetSemaphoreCounterValue(
    VkDevice                                    device,
    VkSemaphore                                 semaphore,
    uint64_t*                                   pValue);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent command</p>
</div>
<div id="vkGetSemaphoreCounterValueKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_timeline_semaphore
VkResult vkGetSemaphoreCounterValueKHR(
    VkDevice                                    device,
    VkSemaphore                                 semaphore,
    uint64_t*                                   pValue);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the semaphore.</p>
</li>
<li>
<p><code>semaphore</code> is the handle of the semaphore to query.</p>
</li>
<li>
<p><code>pValue</code> is a pointer to a 64-bit integer value in which the current
counter value of the semaphore is returned.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>If a <a href="devsandqueues.html#devsandqueues-submission" class="xref page">queue submission</a> command is pending
execution, then the value returned by this command <strong>may</strong> immediately be out
of date.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetSemaphoreCounterValue-semaphore-03255" href="#VUID-vkGetSemaphoreCounterValue-semaphore-03255"></a> <span class="vuid">VUID-vkGetSemaphoreCounterValue-semaphore-03255</span><br>

<code>semaphore</code> <strong>must</strong> have been created with a <a href="#VkSemaphoreType">VkSemaphoreType</a> of
<code>VK_SEMAPHORE_TYPE_TIMELINE</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetSemaphoreCounterValue-device-parameter" href="#VUID-vkGetSemaphoreCounterValue-device-parameter"></a> <span class="vuid">VUID-vkGetSemaphoreCounterValue-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetSemaphoreCounterValue-semaphore-parameter" href="#VUID-vkGetSemaphoreCounterValue-semaphore-parameter"></a> <span class="vuid">VUID-vkGetSemaphoreCounterValue-semaphore-parameter</span><br>
 <code>semaphore</code> <strong>must</strong> be a valid <a href="#VkSemaphore">VkSemaphore</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetSemaphoreCounterValue-pValue-parameter" href="#VUID-vkGetSemaphoreCounterValue-pValue-parameter"></a> <span class="vuid">VUID-vkGetSemaphoreCounterValue-pValue-parameter</span><br>
 <code>pValue</code> <strong>must</strong> be a valid pointer to a <code>uint64_t</code> value</p>
</li>
<li>
<p><a id="VUID-vkGetSemaphoreCounterValue-semaphore-parent" href="#VUID-vkGetSemaphoreCounterValue-semaphore-parent"></a> <span class="vuid">VUID-vkGetSemaphoreCounterValue-semaphore-parent</span><br>
 <code>semaphore</code> <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To wait for a set of semaphores created with a <a href="#VkSemaphoreType">VkSemaphoreType</a> of
<code>VK_SEMAPHORE_TYPE_TIMELINE</code> to reach particular counter values on the
host, call:</p>
</div>
<div id="vkWaitSemaphores" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_2
VkResult vkWaitSemaphores(
    VkDevice                                    device,
    const VkSemaphoreWaitInfo*                  pWaitInfo,
    uint64_t                                    timeout);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent command</p>
</div>
<div id="vkWaitSemaphoresKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_timeline_semaphore
VkResult vkWaitSemaphoresKHR(
    VkDevice                                    device,
    const VkSemaphoreWaitInfo*                  pWaitInfo,
    uint64_t                                    timeout);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the semaphores.</p>
</li>
<li>
<p><code>pWaitInfo</code> is a pointer to a <a href="#VkSemaphoreWaitInfo">VkSemaphoreWaitInfo</a> structure
containing information about the wait condition.</p>
</li>
<li>
<p><code>timeout</code> is the timeout period in units of nanoseconds.
<code>timeout</code> is adjusted to the closest value allowed by the
implementation-dependent timeout accuracy, which <strong>may</strong> be substantially
longer than one nanosecond, and <strong>may</strong> be longer than the requested
period.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the condition is satisfied when <code>vkWaitSemaphores</code> is called, then
<code>vkWaitSemaphores</code> returns immediately.
If the condition is not satisfied at the time <code>vkWaitSemaphores</code> is
called, then <code>vkWaitSemaphores</code> will block and wait until the condition
is satisfied or the <code>timeout</code> has expired, whichever is sooner.</p>
</div>
<div class="paragraph">
<p>If <code>timeout</code> is zero, then <code>vkWaitSemaphores</code> does not wait, but
simply returns information about the current state of the semaphores.
<code>VK_TIMEOUT</code> will be returned in this case if the condition is not
satisfied, even though no actual wait was performed.</p>
</div>
<div class="paragraph">
<p>If the condition is satisfied before the <code>timeout</code> has expired,
<code>vkWaitSemaphores</code> returns <code>VK_SUCCESS</code>.
Otherwise, <code>vkWaitSemaphores</code> returns <code>VK_TIMEOUT</code> after the
<code>timeout</code> has expired.</p>
</div>
<div class="paragraph">
<p>If device loss occurs (see <a href="devsandqueues.html#devsandqueues-lost-device" class="xref page">Lost Device</a>) before
the timeout has expired, <code>vkWaitSemaphores</code> <strong>must</strong> return in finite time
with either <code>VK_SUCCESS</code> or <code>VK_ERROR_DEVICE_LOST</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkWaitSemaphores-device-parameter" href="#VUID-vkWaitSemaphores-device-parameter"></a> <span class="vuid">VUID-vkWaitSemaphores-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkWaitSemaphores-pWaitInfo-parameter" href="#VUID-vkWaitSemaphores-pWaitInfo-parameter"></a> <span class="vuid">VUID-vkWaitSemaphores-pWaitInfo-parameter</span><br>
 <code>pWaitInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkSemaphoreWaitInfo">VkSemaphoreWaitInfo</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_TIMEOUT</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkSemaphoreWaitInfo</code> structure is defined as:</p>
</div>
<div id="VkSemaphoreWaitInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_2
typedef struct VkSemaphoreWaitInfo {
    VkStructureType         sType;
    const void*             pNext;
    VkSemaphoreWaitFlags    flags;
    uint32_t                semaphoreCount;
    const VkSemaphore*      pSemaphores;
    const uint64_t*         pValues;
} VkSemaphoreWaitInfo;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkSemaphoreWaitInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_timeline_semaphore
typedef VkSemaphoreWaitInfo VkSemaphoreWaitInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkSemaphoreWaitFlagBits">VkSemaphoreWaitFlagBits</a> specifying
additional parameters for the semaphore wait operation.</p>
</li>
<li>
<p><code>semaphoreCount</code> is the number of semaphores to wait on.</p>
</li>
<li>
<p><code>pSemaphores</code> is a pointer to an array of <code>semaphoreCount</code>
semaphore handles to wait on.</p>
</li>
<li>
<p><code>pValues</code> is a pointer to an array of <code>semaphoreCount</code> timeline
semaphore values.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSemaphoreWaitInfo-pSemaphores-03256" href="#VUID-VkSemaphoreWaitInfo-pSemaphores-03256"></a> <span class="vuid">VUID-VkSemaphoreWaitInfo-pSemaphores-03256</span><br>

All of the elements of <code>pSemaphores</code> <strong>must</strong> reference a semaphore
that was created with a <a href="#VkSemaphoreType">VkSemaphoreType</a> of
<code>VK_SEMAPHORE_TYPE_TIMELINE</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSemaphoreWaitInfo-sType-sType" href="#VUID-VkSemaphoreWaitInfo-sType-sType"></a> <span class="vuid">VUID-VkSemaphoreWaitInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_SEMAPHORE_WAIT_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreWaitInfo-pNext-pNext" href="#VUID-VkSemaphoreWaitInfo-pNext-pNext"></a> <span class="vuid">VUID-VkSemaphoreWaitInfo-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreWaitInfo-flags-parameter" href="#VUID-VkSemaphoreWaitInfo-flags-parameter"></a> <span class="vuid">VUID-VkSemaphoreWaitInfo-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkSemaphoreWaitFlagBits">VkSemaphoreWaitFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkSemaphoreWaitInfo-pSemaphores-parameter" href="#VUID-VkSemaphoreWaitInfo-pSemaphores-parameter"></a> <span class="vuid">VUID-VkSemaphoreWaitInfo-pSemaphores-parameter</span><br>
 <code>pSemaphores</code> <strong>must</strong> be a valid pointer to an array of <code>semaphoreCount</code> valid <a href="#VkSemaphore">VkSemaphore</a> handles</p>
</li>
<li>
<p><a id="VUID-VkSemaphoreWaitInfo-pValues-parameter" href="#VUID-VkSemaphoreWaitInfo-pValues-parameter"></a> <span class="vuid">VUID-VkSemaphoreWaitInfo-pValues-parameter</span><br>
 <code>pValues</code> <strong>must</strong> be a valid pointer to an array of <code>semaphoreCount</code> <code>uint64_t</code> values</p>
</li>
<li>
<p><a id="VUID-VkSemaphoreWaitInfo-semaphoreCount-arraylength" href="#VUID-VkSemaphoreWaitInfo-semaphoreCount-arraylength"></a> <span class="vuid">VUID-VkSemaphoreWaitInfo-semaphoreCount-arraylength</span><br>
 <code>semaphoreCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in <a href="#VkSemaphoreWaitInfo">VkSemaphoreWaitInfo</a>::<code>flags</code>, specifying
additional parameters of a semaphore wait operation, are:</p>
</div>
<div id="VkSemaphoreWaitFlagBits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_2
typedef enum VkSemaphoreWaitFlagBits {
    VK_SEMAPHORE_WAIT_ANY_BIT = 0x00000001,
  // Provided by VK_KHR_timeline_semaphore
    VK_SEMAPHORE_WAIT_ANY_BIT_KHR = VK_SEMAPHORE_WAIT_ANY_BIT,
} VkSemaphoreWaitFlagBits;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkSemaphoreWaitFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_timeline_semaphore
typedef VkSemaphoreWaitFlagBits VkSemaphoreWaitFlagBitsKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_SEMAPHORE_WAIT_ANY_BIT</code> specifies that the semaphore wait
condition is that at least one of the semaphores in
<code>VkSemaphoreWaitInfo</code>::<code>pSemaphores</code> has reached the value
specified by the corresponding element of
<code>VkSemaphoreWaitInfo</code>::<code>pValues</code>.
If <code>VK_SEMAPHORE_WAIT_ANY_BIT</code> is not set, the semaphore wait
condition is that all of the semaphores in
<code>VkSemaphoreWaitInfo</code>::<code>pSemaphores</code> have reached the value
specified by the corresponding element of
<code>VkSemaphoreWaitInfo</code>::<code>pValues</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkSemaphoreWaitFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_2
typedef VkFlags VkSemaphoreWaitFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkSemaphoreWaitFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_timeline_semaphore
typedef VkSemaphoreWaitFlags VkSemaphoreWaitFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkSemaphoreWaitFlags</code> is a bitmask type for setting a mask of zero or
more <a href="#VkSemaphoreWaitFlagBits">VkSemaphoreWaitFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To signal a semaphore created with a <a href="#VkSemaphoreType">VkSemaphoreType</a> of
<code>VK_SEMAPHORE_TYPE_TIMELINE</code> with a particular counter value, on the
host, call:</p>
</div>
<div id="vkSignalSemaphore" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_2
VkResult vkSignalSemaphore(
    VkDevice                                    device,
    const VkSemaphoreSignalInfo*                pSignalInfo);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent command</p>
</div>
<div id="vkSignalSemaphoreKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_timeline_semaphore
VkResult vkSignalSemaphoreKHR(
    VkDevice                                    device,
    const VkSemaphoreSignalInfo*                pSignalInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the semaphore.</p>
</li>
<li>
<p><code>pSignalInfo</code> is a pointer to a <a href="#VkSemaphoreSignalInfo">VkSemaphoreSignalInfo</a>
structure containing information about the signal operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <code>vkSignalSemaphore</code> is executed on the host, it defines and
immediately executes a <a href="#synchronization-semaphores-signaling"><em>semaphore signal operation</em></a> which sets the timeline semaphore to the given value.</p>
</div>
<div class="paragraph">
<p>The first synchronization scope is defined by the host execution model, but
includes execution of <code>vkSignalSemaphore</code> on the host and anything that
happened-before it.</p>
</div>
<div class="paragraph">
<p>The second synchronization scope is empty.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkSignalSemaphore-device-parameter" href="#VUID-vkSignalSemaphore-device-parameter"></a> <span class="vuid">VUID-vkSignalSemaphore-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkSignalSemaphore-pSignalInfo-parameter" href="#VUID-vkSignalSemaphore-pSignalInfo-parameter"></a> <span class="vuid">VUID-vkSignalSemaphore-pSignalInfo-parameter</span><br>
 <code>pSignalInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkSemaphoreSignalInfo">VkSemaphoreSignalInfo</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkSemaphoreSignalInfo</code> structure is defined as:</p>
</div>
<div id="VkSemaphoreSignalInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_2
typedef struct VkSemaphoreSignalInfo {
    VkStructureType    sType;
    const void*        pNext;
    VkSemaphore        semaphore;
    uint64_t           value;
} VkSemaphoreSignalInfo;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkSemaphoreSignalInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_timeline_semaphore
typedef VkSemaphoreSignalInfo VkSemaphoreSignalInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>semaphore</code> is the handle of the semaphore to signal.</p>
</li>
<li>
<p><code>value</code> is the value to signal.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSemaphoreSignalInfo-semaphore-03257" href="#VUID-VkSemaphoreSignalInfo-semaphore-03257"></a> <span class="vuid">VUID-VkSemaphoreSignalInfo-semaphore-03257</span><br>

<code>semaphore</code> <strong>must</strong> have been created with a <a href="#VkSemaphoreType">VkSemaphoreType</a> of
<code>VK_SEMAPHORE_TYPE_TIMELINE</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreSignalInfo-value-03258" href="#VUID-VkSemaphoreSignalInfo-value-03258"></a> <span class="vuid">VUID-VkSemaphoreSignalInfo-value-03258</span><br>

<code>value</code> <strong>must</strong> have a value greater than the current value of the
semaphore</p>
</li>
<li>
<p><a id="VUID-VkSemaphoreSignalInfo-value-03259" href="#VUID-VkSemaphoreSignalInfo-value-03259"></a> <span class="vuid">VUID-VkSemaphoreSignalInfo-value-03259</span><br>

<code>value</code> <strong>must</strong> be less than the value of any pending semaphore signal
operations</p>
</li>
<li>
<p><a id="VUID-VkSemaphoreSignalInfo-value-03260" href="#VUID-VkSemaphoreSignalInfo-value-03260"></a> <span class="vuid">VUID-VkSemaphoreSignalInfo-value-03260</span><br>

<code>value</code> <strong>must</strong> have a value which does not differ from the current
value of the semaphore or the value of any outstanding semaphore wait or
signal operation on <code>semaphore</code> by more than
<a href="devsandqueues.html#limits-maxTimelineSemaphoreValueDifference" class="xref page">    <code>maxTimelineSemaphoreValueDifference</code></a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSemaphoreSignalInfo-sType-sType" href="#VUID-VkSemaphoreSignalInfo-sType-sType"></a> <span class="vuid">VUID-VkSemaphoreSignalInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_SEMAPHORE_SIGNAL_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreSignalInfo-pNext-pNext" href="#VUID-VkSemaphoreSignalInfo-pNext-pNext"></a> <span class="vuid">VUID-VkSemaphoreSignalInfo-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreSignalInfo-semaphore-parameter" href="#VUID-VkSemaphoreSignalInfo-semaphore-parameter"></a> <span class="vuid">VUID-VkSemaphoreSignalInfo-semaphore-parameter</span><br>
 <code>semaphore</code> <strong>must</strong> be a valid <a href="#VkSemaphore">VkSemaphore</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-semaphores-importing"><a class="anchor" href="#synchronization-semaphores-importing"></a>Importing Semaphore Payloads</h3>
<div class="paragraph">
<p>Applications <strong>can</strong> import a semaphore payload into an existing semaphore
using an external semaphore handle.
The effects of the import operation will be either temporary or permanent,
as specified by the application.
If the import is temporary, the implementation <strong>must</strong> restore the semaphore
to its prior permanent state after submitting the next semaphore wait
operation.
Performing a subsequent temporary import on a semaphore before performing a
semaphore wait has no effect on this requirement; the next wait submitted on
the semaphore <strong>must</strong> still restore its last permanent state.
A permanent payload import behaves as if the target semaphore was destroyed,
and a new semaphore was created with the same handle but the imported
payload.
Because importing a semaphore payload temporarily or permanently detaches
the existing payload from a semaphore, similar usage restrictions to those
applied to <code>vkDestroySemaphore</code> are applied to any command that imports
a semaphore payload.
Which of these import types is used is referred to as the import operation&#8217;s
<em>permanence</em>.
Each handle type supports either one or both types of permanence.</p>
</div>
<div class="paragraph">
<p>The implementation <strong>must</strong> perform the import operation by either referencing
or copying the payload referred to by the specified external semaphore
handle, depending on the handle&#8217;s type.
The import method used is referred to as the handle type&#8217;s <em>transference</em>.
When using handle types with reference transference, importing a payload to
a semaphore adds the semaphore to the set of all semaphores sharing that
payload.
This set includes the semaphore from which the payload was exported.
Semaphore signaling and waiting operations performed on any semaphore in the
set <strong>must</strong> behave as if the set were a single semaphore.
Importing a payload using handle types with copy transference creates a
duplicate copy of the payload at the time of import, but makes no further
reference to it.
Semaphore signaling and waiting operations performed on the target of copy
imports <strong>must</strong> not affect any other semaphore or payload.</p>
</div>
<div class="paragraph">
<p>Export operations have the same transference as the specified handle type&#8217;s
import operations.
Additionally, exporting a semaphore payload to a handle with copy
transference has the same side effects on the source semaphore&#8217;s payload as
executing a semaphore wait operation.
If the semaphore was using a temporarily imported payload, the semaphore&#8217;s
prior permanent payload will be restored.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The permanence and transference of handle types can be found in:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#synchronization-semaphore-handletypes-win32">Handle Types Supported by    <code>VkImportSemaphoreWin32HandleInfoKHR</code></a></p>
</li>
<li>
<p><a href="#synchronization-semaphore-handletypes-fd">Handle Types Supported by    <code>VkImportSemaphoreFdInfoKHR</code></a></p>
</li>
<li>
<p><a href="#synchronization-semaphore-handletypes-fuchsia">Handle Types Supported    by <code>VkImportSemaphoreZirconHandleInfoFUCHSIA</code></a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="fundamentals.html#fundamentals-threadingbehavior" class="xref page">External synchronization</a> allows
implementations to modify an object&#8217;s internal state, i.e. payload, without
internal synchronization.
However, for semaphores sharing a payload across processes, satisfying the
external synchronization requirements of <code>VkSemaphore</code> parameters as if
all semaphores in the set were the same object is sometimes infeasible.
Satisfying the <a href="#synchronization-semaphores-waiting-state">wait operation state requirements</a> would similarly require impractical coordination or
levels of trust between processes.
Therefore, these constraints only apply to a specific semaphore handle, not
to its payload.
For distinct semaphore objects which share a payload, if the semaphores are
passed to separate queue submission commands concurrently, behavior will be
as if the commands were called in an arbitrary sequential order.
If the <a href="#synchronization-semaphores-waiting-state">wait operation state requirements</a> are violated for the shared payload by a queue submission
command, or if a signal operation is queued for a shared payload that is
already signaled or has a pending signal operation, effects <strong>must</strong> be limited
to one or more of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Returning <code>VK_ERROR_INITIALIZATION_FAILED</code> from the command which
resulted in the violation.</p>
</li>
<li>
<p>Losing the logical device on which the violation occurred immediately or
at a future time, resulting in a <code>VK_ERROR_DEVICE_LOST</code> error from
subsequent commands, including the one causing the violation.</p>
</li>
<li>
<p>Continuing execution of the violating command or operation as if the
semaphore wait completed successfully after an implementation-dependent
timeout.
In this case, the state of the payload becomes <strong>undefined</strong>, and future
operations on semaphores sharing the payload will be subject to these
same rules.
The semaphore <strong>must</strong> be destroyed or have its payload replaced by an
import operation to again have a well-defined state.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>These rules allow processes to synchronize access to shared memory without
trusting each other.
However, such processes must still be cautious not to use the shared
semaphore for more than synchronizing access to the shared memory.
For example, a process should not use a shared semaphore as part of an
execution dependency chain that, when complete, leads to objects being
destroyed, if it does not trust other processes sharing the semaphore
payload.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When a semaphore is using an imported payload, its
<a href="#VkExportSemaphoreCreateInfo">VkExportSemaphoreCreateInfo</a>::<code>handleTypes</code> value is specified when
creating the semaphore from which the payload was exported, rather than
specified when creating the semaphore.
Additionally,
<a href="capabilities.html#VkExternalSemaphoreProperties" class="xref page">VkExternalSemaphoreProperties</a>::<code>exportFromImportedHandleTypes</code>
restricts which handle types <strong>can</strong> be exported from such a semaphore based on
the specific handle type used to import the current payload.
Passing a semaphore to <a href="VK_KHR_surface/wsi.html#vkAcquireNextImageKHR" class="xref page">vkAcquireNextImageKHR</a> is equivalent to
temporarily importing a semaphore payload to that semaphore.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Because the exportable handle types of an imported semaphore correspond to
its current imported payload, and <a href="VK_KHR_surface/wsi.html#vkAcquireNextImageKHR" class="xref page">vkAcquireNextImageKHR</a> behaves the
same as a temporary import operation for which the source semaphore is
opaque to the application, applications have no way of determining whether
any external handle types <strong>can</strong> be exported from a semaphore in this state.
Therefore, applications <strong>must</strong> not attempt to export external handles from
semaphores using a temporarily imported payload from
<a href="VK_KHR_surface/wsi.html#vkAcquireNextImageKHR" class="xref page">vkAcquireNextImageKHR</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When importing a semaphore payload, it is the responsibility of the
application to ensure the external handles meet all valid usage
requirements.
However, implementations <strong>must</strong> perform sufficient validation of external
handles to ensure that the operation results in a valid semaphore which will
not cause program termination, device loss, queue stalls, or corruption of
other resources when used as allowed according to its import parameters, and
excepting those side effects allowed for violations of the
<a href="#synchronization-semaphores-waiting-state">valid semaphore state for wait operations</a> rules.
If the external handle provided does not meet these requirements, the
implementation <strong>must</strong> fail the semaphore payload import operation with the
error code <code>VK_ERROR_INVALID_EXTERNAL_HANDLE</code>.</p>
</div>
<div class="paragraph">
<p>In addition, when importing a semaphore payload that is not compatible with
the payload type corresponding to the <a href="#VkSemaphoreType">VkSemaphoreType</a> the semaphore
was created with, the implementation <strong>may</strong> fail the semaphore payload import
operation with the error code <code>VK_ERROR_INVALID_EXTERNAL_HANDLE</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>As the introduction of the external semaphore handle type
<code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_D3D12_FENCE_BIT</code> predates that of
timeline semaphores, support for importing semaphore payloads from external
handles of that type into semaphores created (implicitly or explicitly) with
a <a href="#VkSemaphoreType">VkSemaphoreType</a> of <code>VK_SEMAPHORE_TYPE_BINARY</code> is preserved for
backwards compatibility.
However, applications <strong>should</strong> prefer importing such handle types into
semaphores created with a <a href="#VkSemaphoreType">VkSemaphoreType</a> of
<code>VK_SEMAPHORE_TYPE_TIMELINE</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To import a semaphore payload from a Windows handle, call:</p>
</div>
<div id="vkImportSemaphoreWin32HandleKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_semaphore_win32
VkResult vkImportSemaphoreWin32HandleKHR(
    VkDevice                                    device,
    const VkImportSemaphoreWin32HandleInfoKHR*  pImportSemaphoreWin32HandleInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that created the semaphore.</p>
</li>
<li>
<p><code>pImportSemaphoreWin32HandleInfo</code> is a pointer to a
<a href="#VkImportSemaphoreWin32HandleInfoKHR">VkImportSemaphoreWin32HandleInfoKHR</a> structure specifying the
semaphore and import parameters.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Importing a semaphore payload from Windows handles does not transfer
ownership of the handle to the Vulkan implementation.
For handle types defined as NT handles, the application <strong>must</strong> release
ownership using the <code>CloseHandle</code> system call when the handle is no
longer needed.</p>
</div>
<div class="paragraph">
<p>Applications <strong>can</strong> import the same semaphore payload into multiple instances
of Vulkan, into the same instance from which it was exported, and multiple
times into a given Vulkan instance.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkImportSemaphoreWin32HandleKHR-device-parameter" href="#VUID-vkImportSemaphoreWin32HandleKHR-device-parameter"></a> <span class="vuid">VUID-vkImportSemaphoreWin32HandleKHR-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkImportSemaphoreWin32HandleKHR-pImportSemaphoreWin32HandleInfo-parameter" href="#VUID-vkImportSemaphoreWin32HandleKHR-pImportSemaphoreWin32HandleInfo-parameter"></a> <span class="vuid">VUID-vkImportSemaphoreWin32HandleKHR-pImportSemaphoreWin32HandleInfo-parameter</span><br>
 <code>pImportSemaphoreWin32HandleInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkImportSemaphoreWin32HandleInfoKHR">VkImportSemaphoreWin32HandleInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_INVALID_EXTERNAL_HANDLE</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkImportSemaphoreWin32HandleInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkImportSemaphoreWin32HandleInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_semaphore_win32
typedef struct VkImportSemaphoreWin32HandleInfoKHR {
    VkStructureType                          sType;
    const void*                              pNext;
    VkSemaphore                              semaphore;
    VkSemaphoreImportFlags                   flags;
    VkExternalSemaphoreHandleTypeFlagBits    handleType;
    HANDLE                                   handle;
    LPCWSTR                                  name;
} VkImportSemaphoreWin32HandleInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>semaphore</code> is the semaphore into which the payload will be
imported.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkSemaphoreImportFlagBits">VkSemaphoreImportFlagBits</a> specifying
additional parameters for the semaphore payload import operation.</p>
</li>
<li>
<p><code>handleType</code> is a <a href="capabilities.html#VkExternalSemaphoreHandleTypeFlagBits" class="xref page">VkExternalSemaphoreHandleTypeFlagBits</a> value
specifying the type of <code>handle</code>.</p>
</li>
<li>
<p><code>handle</code> is <code>NULL</code> or the external handle to import.</p>
</li>
<li>
<p><code>name</code> is <code>NULL</code> or a null-terminated UTF-16 string naming the
underlying synchronization primitive to import.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The handle types supported by <code>handleType</code> are:</p>
</div>
<table id="synchronization-semaphore-handletypes-win32" class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 6. Handle Types Supported by <code>VkImportSemaphoreWin32HandleInfoKHR</code></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Handle Type</th>
<th class="tableblock halign-left valign-top">Transference</th>
<th class="tableblock halign-left valign-top">Permanence Supported</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_OPAQUE_WIN32_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reference</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temporary,Permanent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_OPAQUE_WIN32_KMT_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reference</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temporary,Permanent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_D3D12_FENCE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reference</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temporary,Permanent</p></td>
</tr>
</tbody>
</table>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImportSemaphoreWin32HandleInfoKHR-handleType-01140" href="#VUID-VkImportSemaphoreWin32HandleInfoKHR-handleType-01140"></a> <span class="vuid">VUID-VkImportSemaphoreWin32HandleInfoKHR-handleType-01140</span><br>

<code>handleType</code> <strong>must</strong> be a value included in the
<a href="#synchronization-semaphore-handletypes-win32">Handle Types Supported by    <code>VkImportSemaphoreWin32HandleInfoKHR</code></a> table</p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreWin32HandleInfoKHR-handleType-01466" href="#VUID-VkImportSemaphoreWin32HandleInfoKHR-handleType-01466"></a> <span class="vuid">VUID-VkImportSemaphoreWin32HandleInfoKHR-handleType-01466</span><br>

If <code>handleType</code> is not
<code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_OPAQUE_WIN32_BIT</code> or
<code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_D3D12_FENCE_BIT</code>, <code>name</code>
<strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreWin32HandleInfoKHR-handleType-01467" href="#VUID-VkImportSemaphoreWin32HandleInfoKHR-handleType-01467"></a> <span class="vuid">VUID-VkImportSemaphoreWin32HandleInfoKHR-handleType-01467</span><br>

If <code>handle</code> is <code>NULL</code>, <code>name</code> <strong>must</strong> name a valid synchronization
primitive of the type specified by <code>handleType</code></p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreWin32HandleInfoKHR-handleType-01468" href="#VUID-VkImportSemaphoreWin32HandleInfoKHR-handleType-01468"></a> <span class="vuid">VUID-VkImportSemaphoreWin32HandleInfoKHR-handleType-01468</span><br>

If <code>name</code> is <code>NULL</code>, <code>handle</code> <strong>must</strong> be a valid handle of the
type specified by <code>handleType</code></p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreWin32HandleInfoKHR-handle-01469" href="#VUID-VkImportSemaphoreWin32HandleInfoKHR-handle-01469"></a> <span class="vuid">VUID-VkImportSemaphoreWin32HandleInfoKHR-handle-01469</span><br>

If <code>handle</code> is not <code>NULL</code>, <code>name</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreWin32HandleInfoKHR-handle-01542" href="#VUID-VkImportSemaphoreWin32HandleInfoKHR-handle-01542"></a> <span class="vuid">VUID-VkImportSemaphoreWin32HandleInfoKHR-handle-01542</span><br>

If <code>handle</code> is not <code>NULL</code>, it <strong>must</strong> obey any requirements listed for
<code>handleType</code> in
<a href="capabilities.html#external-semaphore-handle-types-compatibility" class="xref page">external semaphore    handle types compatibility</a></p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreWin32HandleInfoKHR-name-01543" href="#VUID-VkImportSemaphoreWin32HandleInfoKHR-name-01543"></a> <span class="vuid">VUID-VkImportSemaphoreWin32HandleInfoKHR-name-01543</span><br>

If <code>name</code> is not <code>NULL</code>, it <strong>must</strong> obey any requirements listed for
<code>handleType</code> in
<a href="capabilities.html#external-semaphore-handle-types-compatibility" class="xref page">external semaphore    handle types compatibility</a></p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreWin32HandleInfoKHR-handleType-03261" href="#VUID-VkImportSemaphoreWin32HandleInfoKHR-handleType-03261"></a> <span class="vuid">VUID-VkImportSemaphoreWin32HandleInfoKHR-handleType-03261</span><br>

If <code>handleType</code> is
<code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_OPAQUE_WIN32_BIT</code> or
<code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_OPAQUE_WIN32_KMT_BIT</code>, the
<a href="#VkSemaphoreCreateInfo">VkSemaphoreCreateInfo</a>::<code>flags</code> field <strong>must</strong> match that of the
semaphore from which <code>handle</code> or <code>name</code> was exported</p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreWin32HandleInfoKHR-handleType-03262" href="#VUID-VkImportSemaphoreWin32HandleInfoKHR-handleType-03262"></a> <span class="vuid">VUID-VkImportSemaphoreWin32HandleInfoKHR-handleType-03262</span><br>

If <code>handleType</code> is
<code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_OPAQUE_WIN32_BIT</code> or
<code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_OPAQUE_WIN32_KMT_BIT</code>, the
<a href="#VkSemaphoreTypeCreateInfo">VkSemaphoreTypeCreateInfo</a>::<code>semaphoreType</code> field <strong>must</strong> match
that of the semaphore from which <code>handle</code> or <code>name</code> was exported</p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreWin32HandleInfoKHR-flags-03322" href="#VUID-VkImportSemaphoreWin32HandleInfoKHR-flags-03322"></a> <span class="vuid">VUID-VkImportSemaphoreWin32HandleInfoKHR-flags-03322</span><br>

If <code>flags</code> contains <code>VK_SEMAPHORE_IMPORT_TEMPORARY_BIT</code>, the
<a href="#VkSemaphoreTypeCreateInfo">VkSemaphoreTypeCreateInfo</a>::<code>semaphoreType</code> field of the
semaphore from which <code>handle</code> or <code>name</code> was exported <strong>must</strong> not
be <code>VK_SEMAPHORE_TYPE_TIMELINE</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImportSemaphoreWin32HandleInfoKHR-sType-sType" href="#VUID-VkImportSemaphoreWin32HandleInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkImportSemaphoreWin32HandleInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_IMPORT_SEMAPHORE_WIN32_HANDLE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreWin32HandleInfoKHR-pNext-pNext" href="#VUID-VkImportSemaphoreWin32HandleInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkImportSemaphoreWin32HandleInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreWin32HandleInfoKHR-semaphore-parameter" href="#VUID-VkImportSemaphoreWin32HandleInfoKHR-semaphore-parameter"></a> <span class="vuid">VUID-VkImportSemaphoreWin32HandleInfoKHR-semaphore-parameter</span><br>
 <code>semaphore</code> <strong>must</strong> be a valid <a href="#VkSemaphore">VkSemaphore</a> handle</p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreWin32HandleInfoKHR-flags-parameter" href="#VUID-VkImportSemaphoreWin32HandleInfoKHR-flags-parameter"></a> <span class="vuid">VUID-VkImportSemaphoreWin32HandleInfoKHR-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkSemaphoreImportFlagBits">VkSemaphoreImportFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>semaphore</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To import a semaphore payload from a POSIX file descriptor, call:</p>
</div>
<div id="vkImportSemaphoreFdKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_semaphore_fd
VkResult vkImportSemaphoreFdKHR(
    VkDevice                                    device,
    const VkImportSemaphoreFdInfoKHR*           pImportSemaphoreFdInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that created the semaphore.</p>
</li>
<li>
<p><code>pImportSemaphoreFdInfo</code> is a pointer to a
<a href="#VkImportSemaphoreFdInfoKHR">VkImportSemaphoreFdInfoKHR</a> structure specifying the semaphore and
import parameters.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Importing a semaphore payload from a file descriptor transfers ownership of
the file descriptor from the application to the Vulkan implementation.
The application <strong>must</strong> not perform any operations on the file descriptor
after a successful import.</p>
</div>
<div class="paragraph">
<p>Applications <strong>can</strong> import the same semaphore payload into multiple instances
of Vulkan, into the same instance from which it was exported, and multiple
times into a given Vulkan instance.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkImportSemaphoreFdKHR-semaphore-01142" href="#VUID-vkImportSemaphoreFdKHR-semaphore-01142"></a> <span class="vuid">VUID-vkImportSemaphoreFdKHR-semaphore-01142</span><br>

<code>semaphore</code> <strong>must</strong> not be associated with any queue command that has
not yet completed execution on that queue</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkImportSemaphoreFdKHR-device-parameter" href="#VUID-vkImportSemaphoreFdKHR-device-parameter"></a> <span class="vuid">VUID-vkImportSemaphoreFdKHR-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkImportSemaphoreFdKHR-pImportSemaphoreFdInfo-parameter" href="#VUID-vkImportSemaphoreFdKHR-pImportSemaphoreFdInfo-parameter"></a> <span class="vuid">VUID-vkImportSemaphoreFdKHR-pImportSemaphoreFdInfo-parameter</span><br>
 <code>pImportSemaphoreFdInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkImportSemaphoreFdInfoKHR">VkImportSemaphoreFdInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_INVALID_EXTERNAL_HANDLE</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkImportSemaphoreFdInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkImportSemaphoreFdInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_semaphore_fd
typedef struct VkImportSemaphoreFdInfoKHR {
    VkStructureType                          sType;
    const void*                              pNext;
    VkSemaphore                              semaphore;
    VkSemaphoreImportFlags                   flags;
    VkExternalSemaphoreHandleTypeFlagBits    handleType;
    int                                      fd;
} VkImportSemaphoreFdInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>semaphore</code> is the semaphore into which the payload will be
imported.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkSemaphoreImportFlagBits">VkSemaphoreImportFlagBits</a> specifying
additional parameters for the semaphore payload import operation.</p>
</li>
<li>
<p><code>handleType</code> is a <a href="capabilities.html#VkExternalSemaphoreHandleTypeFlagBits" class="xref page">VkExternalSemaphoreHandleTypeFlagBits</a> value
specifying the type of <code>fd</code>.</p>
</li>
<li>
<p><code>fd</code> is the external handle to import.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The handle types supported by <code>handleType</code> are:</p>
</div>
<table id="synchronization-semaphore-handletypes-fd" class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 7. Handle Types Supported by <code>VkImportSemaphoreFdInfoKHR</code></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Handle Type</th>
<th class="tableblock halign-left valign-top">Transference</th>
<th class="tableblock halign-left valign-top">Permanence Supported</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_OPAQUE_FD_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reference</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temporary,Permanent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_SYNC_FD_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Copy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temporary</p></td>
</tr>
</tbody>
</table>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImportSemaphoreFdInfoKHR-handleType-01143" href="#VUID-VkImportSemaphoreFdInfoKHR-handleType-01143"></a> <span class="vuid">VUID-VkImportSemaphoreFdInfoKHR-handleType-01143</span><br>

<code>handleType</code> <strong>must</strong> be a value included in the
<a href="#synchronization-semaphore-handletypes-fd">Handle Types Supported by    <code>VkImportSemaphoreFdInfoKHR</code></a> table</p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreFdInfoKHR-fd-01544" href="#VUID-VkImportSemaphoreFdInfoKHR-fd-01544"></a> <span class="vuid">VUID-VkImportSemaphoreFdInfoKHR-fd-01544</span><br>

<code>fd</code> <strong>must</strong> obey any requirements listed for <code>handleType</code> in
<a href="capabilities.html#external-semaphore-handle-types-compatibility" class="xref page">external semaphore    handle types compatibility</a></p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreFdInfoKHR-handleType-03263" href="#VUID-VkImportSemaphoreFdInfoKHR-handleType-03263"></a> <span class="vuid">VUID-VkImportSemaphoreFdInfoKHR-handleType-03263</span><br>

If <code>handleType</code> is
<code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_OPAQUE_FD_BIT</code>, the
<a href="#VkSemaphoreCreateInfo">VkSemaphoreCreateInfo</a>::<code>flags</code> field <strong>must</strong> match that of the
semaphore from which <code>fd</code> was exported</p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreFdInfoKHR-handleType-07307" href="#VUID-VkImportSemaphoreFdInfoKHR-handleType-07307"></a> <span class="vuid">VUID-VkImportSemaphoreFdInfoKHR-handleType-07307</span><br>

If <code>handleType</code> refers to a handle type with copy payload
transference semantics, <code>flags</code> <strong>must</strong> contain
<code>VK_SEMAPHORE_IMPORT_TEMPORARY_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreFdInfoKHR-handleType-03264" href="#VUID-VkImportSemaphoreFdInfoKHR-handleType-03264"></a> <span class="vuid">VUID-VkImportSemaphoreFdInfoKHR-handleType-03264</span><br>

If <code>handleType</code> is
<code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_OPAQUE_FD_BIT</code>, the
<a href="#VkSemaphoreTypeCreateInfo">VkSemaphoreTypeCreateInfo</a>::<code>semaphoreType</code> field <strong>must</strong> match
that of the semaphore from which <code>fd</code> was exported</p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreFdInfoKHR-flags-03323" href="#VUID-VkImportSemaphoreFdInfoKHR-flags-03323"></a> <span class="vuid">VUID-VkImportSemaphoreFdInfoKHR-flags-03323</span><br>

If <code>flags</code> contains <code>VK_SEMAPHORE_IMPORT_TEMPORARY_BIT</code>, the
<a href="#VkSemaphoreTypeCreateInfo">VkSemaphoreTypeCreateInfo</a>::<code>semaphoreType</code> field of the
semaphore from which <code>fd</code> was exported <strong>must</strong> not be
<code>VK_SEMAPHORE_TYPE_TIMELINE</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>If <code>handleType</code> is <code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_SYNC_FD_BIT</code>,
the special value <code>-1</code> for <code>fd</code> is treated like a valid sync file
descriptor referring to an object that has already signaled.
The import operation will succeed and the <code>VkSemaphore</code> will have a
temporarily imported payload as if a valid file descriptor had been
provided.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This special behavior for importing an invalid sync file descriptor allows
easier interoperability with other system APIs which use the convention that
an invalid sync file descriptor represents work that has already completed
and does not need to be waited for.
It is consistent with the option for implementations to return a <code>-1</code> file
descriptor when exporting a
<code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_SYNC_FD_BIT</code> from a <code>VkSemaphore</code>
which is signaled.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImportSemaphoreFdInfoKHR-sType-sType" href="#VUID-VkImportSemaphoreFdInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkImportSemaphoreFdInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_IMPORT_SEMAPHORE_FD_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreFdInfoKHR-pNext-pNext" href="#VUID-VkImportSemaphoreFdInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkImportSemaphoreFdInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreFdInfoKHR-semaphore-parameter" href="#VUID-VkImportSemaphoreFdInfoKHR-semaphore-parameter"></a> <span class="vuid">VUID-VkImportSemaphoreFdInfoKHR-semaphore-parameter</span><br>
 <code>semaphore</code> <strong>must</strong> be a valid <a href="#VkSemaphore">VkSemaphore</a> handle</p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreFdInfoKHR-flags-parameter" href="#VUID-VkImportSemaphoreFdInfoKHR-flags-parameter"></a> <span class="vuid">VUID-VkImportSemaphoreFdInfoKHR-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkSemaphoreImportFlagBits">VkSemaphoreImportFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreFdInfoKHR-handleType-parameter" href="#VUID-VkImportSemaphoreFdInfoKHR-handleType-parameter"></a> <span class="vuid">VUID-VkImportSemaphoreFdInfoKHR-handleType-parameter</span><br>
 <code>handleType</code> <strong>must</strong> be a valid <a href="capabilities.html#VkExternalSemaphoreHandleTypeFlagBits" class="xref page">VkExternalSemaphoreHandleTypeFlagBits</a> value</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>semaphore</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To import a semaphore payload from a Zircon event handle, call:</p>
</div>
<div id="vkImportSemaphoreZirconHandleFUCHSIA" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_FUCHSIA_external_semaphore
VkResult vkImportSemaphoreZirconHandleFUCHSIA(
    VkDevice                                    device,
    const VkImportSemaphoreZirconHandleInfoFUCHSIA* pImportSemaphoreZirconHandleInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that created the semaphore.</p>
</li>
<li>
<p><code>pImportSemaphoreZirconHandleInfo</code> is a pointer to a
<a href="#VkImportSemaphoreZirconHandleInfoFUCHSIA">VkImportSemaphoreZirconHandleInfoFUCHSIA</a> structure specifying the
semaphore and import parameters.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Importing a semaphore payload from a Zircon event handle transfers ownership
of the handle from the application to the Vulkan implementation.
The application <strong>must</strong> not perform any operations on the handle after a
successful import.</p>
</div>
<div class="paragraph">
<p>Applications <strong>can</strong> import the same semaphore payload into multiple instances
of Vulkan, into the same instance from which it was exported, and multiple
times into a given Vulkan instance.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkImportSemaphoreZirconHandleFUCHSIA-semaphore-04764" href="#VUID-vkImportSemaphoreZirconHandleFUCHSIA-semaphore-04764"></a> <span class="vuid">VUID-vkImportSemaphoreZirconHandleFUCHSIA-semaphore-04764</span><br>

<code>semaphore</code> <strong>must</strong> not be associated with any queue command that has
not yet completed execution on that queue</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkImportSemaphoreZirconHandleFUCHSIA-device-parameter" href="#VUID-vkImportSemaphoreZirconHandleFUCHSIA-device-parameter"></a> <span class="vuid">VUID-vkImportSemaphoreZirconHandleFUCHSIA-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkImportSemaphoreZirconHandleFUCHSIA-pImportSemaphoreZirconHandleInfo-parameter" href="#VUID-vkImportSemaphoreZirconHandleFUCHSIA-pImportSemaphoreZirconHandleInfo-parameter"></a> <span class="vuid">VUID-vkImportSemaphoreZirconHandleFUCHSIA-pImportSemaphoreZirconHandleInfo-parameter</span><br>
 <code>pImportSemaphoreZirconHandleInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkImportSemaphoreZirconHandleInfoFUCHSIA">VkImportSemaphoreZirconHandleInfoFUCHSIA</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_INVALID_EXTERNAL_HANDLE</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkImportSemaphoreZirconHandleInfoFUCHSIA</code> structure is defined as:</p>
</div>
<div id="VkImportSemaphoreZirconHandleInfoFUCHSIA" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_FUCHSIA_external_semaphore
typedef struct VkImportSemaphoreZirconHandleInfoFUCHSIA {
    VkStructureType                          sType;
    const void*                              pNext;
    VkSemaphore                              semaphore;
    VkSemaphoreImportFlags                   flags;
    VkExternalSemaphoreHandleTypeFlagBits    handleType;
    zx_handle_t                              zirconHandle;
} VkImportSemaphoreZirconHandleInfoFUCHSIA;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>semaphore</code> is the semaphore into which the payload will be
imported.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkSemaphoreImportFlagBits">VkSemaphoreImportFlagBits</a> specifying
additional parameters for the semaphore payload import operation.</p>
</li>
<li>
<p><code>handleType</code> is a <a href="capabilities.html#VkExternalSemaphoreHandleTypeFlagBits" class="xref page">VkExternalSemaphoreHandleTypeFlagBits</a> value
specifying the type of <code>zirconHandle</code>.</p>
</li>
<li>
<p><code>zirconHandle</code> is the external handle to import.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The handle types supported by <code>handleType</code> are:</p>
</div>
<table id="synchronization-semaphore-handletypes-fuchsia" class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 8. Handle Types Supported by <code>VkImportSemaphoreZirconHandleInfoFUCHSIA</code></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Handle Type</th>
<th class="tableblock halign-left valign-top">Transference</th>
<th class="tableblock halign-left valign-top">Permanence Supported</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_ZIRCON_EVENT_BIT_FUCHSIA</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reference</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temporary,Permanent</p></td>
</tr>
</tbody>
</table>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-handleType-04765" href="#VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-handleType-04765"></a> <span class="vuid">VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-handleType-04765</span><br>

<code>handleType</code> <strong>must</strong> be a value included in the
<a href="#synchronization-semaphore-handletypes-fuchsia">Handle Types Supported    by <code>VkImportSemaphoreZirconHandleInfoFUCHSIA</code></a> table</p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-zirconHandle-04766" href="#VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-zirconHandle-04766"></a> <span class="vuid">VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-zirconHandle-04766</span><br>

<code>zirconHandle</code> <strong>must</strong> obey any requirements listed for
<code>handleType</code> in
<a href="capabilities.html#external-semaphore-handle-types-compatibility" class="xref page">external semaphore    handle types compatibility</a></p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-zirconHandle-04767" href="#VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-zirconHandle-04767"></a> <span class="vuid">VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-zirconHandle-04767</span><br>

<code>zirconHandle</code> <strong>must</strong> have <code>ZX_RIGHTS_BASIC</code> and
<code>ZX_RIGHTS_SIGNAL</code> rights</p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-semaphoreType-04768" href="#VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-semaphoreType-04768"></a> <span class="vuid">VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-semaphoreType-04768</span><br>

The <a href="#VkSemaphoreTypeCreateInfo">VkSemaphoreTypeCreateInfo</a>::<code>semaphoreType</code> field <strong>must</strong> not
be <code>VK_SEMAPHORE_TYPE_TIMELINE</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-sType-sType" href="#VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-sType-sType"></a> <span class="vuid">VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_IMPORT_SEMAPHORE_ZIRCON_HANDLE_INFO_FUCHSIA</code></p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-pNext-pNext" href="#VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-pNext-pNext"></a> <span class="vuid">VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-semaphore-parameter" href="#VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-semaphore-parameter"></a> <span class="vuid">VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-semaphore-parameter</span><br>
 <code>semaphore</code> <strong>must</strong> be a valid <a href="#VkSemaphore">VkSemaphore</a> handle</p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-flags-parameter" href="#VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-flags-parameter"></a> <span class="vuid">VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkSemaphoreImportFlagBits">VkSemaphoreImportFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-handleType-parameter" href="#VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-handleType-parameter"></a> <span class="vuid">VUID-VkImportSemaphoreZirconHandleInfoFUCHSIA-handleType-parameter</span><br>
 <code>handleType</code> <strong>must</strong> be a valid <a href="capabilities.html#VkExternalSemaphoreHandleTypeFlagBits" class="xref page">VkExternalSemaphoreHandleTypeFlagBits</a> value</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>semaphore</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#VkImportSemaphoreWin32HandleInfoKHR">VkImportSemaphoreWin32HandleInfoKHR</a>::<code>flags</code></p>
</li>
<li>
<p><a href="#VkImportSemaphoreFdInfoKHR">VkImportSemaphoreFdInfoKHR</a>::<code>flags</code></p>
</li>
<li>
<p><a href="#VkImportSemaphoreZirconHandleInfoFUCHSIA">VkImportSemaphoreZirconHandleInfoFUCHSIA</a>::<code>flags</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>specifying additional parameters of a semaphore import operation are:</p>
</div>
<div id="VkSemaphoreImportFlagBits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_1
typedef enum VkSemaphoreImportFlagBits {
    VK_SEMAPHORE_IMPORT_TEMPORARY_BIT = 0x00000001,
  // Provided by VK_KHR_external_semaphore
    VK_SEMAPHORE_IMPORT_TEMPORARY_BIT_KHR = VK_SEMAPHORE_IMPORT_TEMPORARY_BIT,
} VkSemaphoreImportFlagBits;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkSemaphoreImportFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_semaphore
typedef VkSemaphoreImportFlagBits VkSemaphoreImportFlagBitsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p>These bits have the following meanings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_SEMAPHORE_IMPORT_TEMPORARY_BIT</code> specifies that the semaphore
payload will be imported only temporarily, as described in
<a href="#synchronization-semaphores-importing">Importing Semaphore Payloads</a>,
regardless of the permanence of <code>handleType</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkSemaphoreImportFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_1
typedef VkFlags VkSemaphoreImportFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkSemaphoreImportFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_external_semaphore
typedef VkSemaphoreImportFlags VkSemaphoreImportFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkSemaphoreImportFlags</code> is a bitmask type for setting a mask of zero or
more <a href="#VkSemaphoreImportFlagBits">VkSemaphoreImportFlagBits</a>.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="synchronization-events"><a class="anchor" href="#synchronization-events"></a>Events</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Events are a synchronization primitive that <strong>can</strong> be used to insert a
fine-grained dependency between commands submitted to the same queue, or
between the host and a queue.
Events <strong>must</strong> not be used to insert a dependency between commands submitted
to different queues.
Events have two states - signaled and unsignaled.
An application <strong>can</strong> signal or unsignal an event either on the host or on the
device.
A device <strong>can</strong> be made to wait for an event to become signaled before
executing further operations.
No command exists to wait for an event to become signaled on the host, but
the current state of an event <strong>can</strong> be queried.</p>
</div>
<div class="paragraph">
<p>Events are represented by <code>VkEvent</code> handles:</p>
</div>
<div id="VkEvent" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkEvent)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create an event, call:</p>
</div>
<div id="vkCreateEvent" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VkResult vkCreateEvent(
    VkDevice                                    device,
    const VkEventCreateInfo*                    pCreateInfo,
    const VkAllocationCallbacks*                pAllocator,
    VkEvent*                                    pEvent);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the event.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to a <a href="#VkEventCreateInfo">VkEventCreateInfo</a> structure
containing information about how the event is to be created.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="memory.html#memory-allocation" class="xref page">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pEvent</code> is a pointer to a handle in which the resulting event
object is returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When created, the event object is in the unsignaled state.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateEvent-events-04468" href="#VUID-vkCreateEvent-events-04468"></a> <span class="vuid">VUID-vkCreateEvent-events-04468</span><br>

If the <code><a href="../appendices/extensions.html#VK_KHR_portability_subset" class="xref page">VK_KHR_portability_subset</a></code> extension is enabled, and
<a href="features.html#VkPhysicalDevicePortabilitySubsetFeaturesKHR" class="xref page">VkPhysicalDevicePortabilitySubsetFeaturesKHR</a>::<code>events</code> is
<code>VK_FALSE</code>, then the implementation does not support
<a href="#synchronization-events">events</a>, and <a href="#vkCreateEvent">vkCreateEvent</a> <strong>must</strong> not be
used</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateEvent-device-parameter" href="#VUID-vkCreateEvent-device-parameter"></a> <span class="vuid">VUID-vkCreateEvent-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateEvent-pCreateInfo-parameter" href="#VUID-vkCreateEvent-pCreateInfo-parameter"></a> <span class="vuid">VUID-vkCreateEvent-pCreateInfo-parameter</span><br>
 <code>pCreateInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkEventCreateInfo">VkEventCreateInfo</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateEvent-pAllocator-parameter" href="#VUID-vkCreateEvent-pAllocator-parameter"></a> <span class="vuid">VUID-vkCreateEvent-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong>must</strong> be a valid pointer to a valid <a href="memory.html#VkAllocationCallbacks" class="xref page">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateEvent-pEvent-parameter" href="#VUID-vkCreateEvent-pEvent-parameter"></a> <span class="vuid">VUID-vkCreateEvent-pEvent-parameter</span><br>
 <code>pEvent</code> <strong>must</strong> be a valid pointer to a <a href="#VkEvent">VkEvent</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkEventCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkEventCreateInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef struct VkEventCreateInfo {
    VkStructureType       sType;
    const void*           pNext;
    VkEventCreateFlags    flags;
} VkEventCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkEventCreateFlagBits">VkEventCreateFlagBits</a> defining
additional creation parameters.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkEventCreateInfo-pNext-06790" href="#VUID-VkEventCreateInfo-pNext-06790"></a> <span class="vuid">VUID-VkEventCreateInfo-pNext-06790</span><br>

If the <code>pNext</code> chain includes a
<a href="memory.html#VkExportMetalObjectCreateInfoEXT" class="xref page">VkExportMetalObjectCreateInfoEXT</a> structure, its
<code>exportObjectType</code> member <strong>must</strong> be
<code>VK_EXPORT_METAL_OBJECT_TYPE_METAL_SHARED_EVENT_BIT_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkEventCreateInfo-sType-sType" href="#VUID-VkEventCreateInfo-sType-sType"></a> <span class="vuid">VUID-VkEventCreateInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_EVENT_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkEventCreateInfo-pNext-pNext" href="#VUID-VkEventCreateInfo-pNext-pNext"></a> <span class="vuid">VUID-VkEventCreateInfo-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="memory.html#VkExportMetalObjectCreateInfoEXT" class="xref page">VkExportMetalObjectCreateInfoEXT</a> or <a href="memory.html#VkImportMetalSharedEventInfoEXT" class="xref page">VkImportMetalSharedEventInfoEXT</a></p>
</li>
<li>
<p><a id="VUID-VkEventCreateInfo-sType-unique" href="#VUID-VkEventCreateInfo-sType-unique"></a> <span class="vuid">VUID-VkEventCreateInfo-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique, with the exception of structures of type <a href="memory.html#VkExportMetalObjectCreateInfoEXT" class="xref page">VkExportMetalObjectCreateInfoEXT</a></p>
</li>
<li>
<p><a id="VUID-VkEventCreateInfo-flags-parameter" href="#VUID-VkEventCreateInfo-flags-parameter"></a> <span class="vuid">VUID-VkEventCreateInfo-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkEventCreateFlagBits">VkEventCreateFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkEventCreateFlagBits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef enum VkEventCreateFlagBits {
  // Provided by VK_VERSION_1_3
    VK_EVENT_CREATE_DEVICE_ONLY_BIT = 0x00000001,
  // Provided by VK_KHR_synchronization2
    VK_EVENT_CREATE_DEVICE_ONLY_BIT_KHR = VK_EVENT_CREATE_DEVICE_ONLY_BIT,
} VkEventCreateFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_EVENT_CREATE_DEVICE_ONLY_BIT</code> specifies that host event commands
will not be used with this event.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkEventCreateFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef VkFlags VkEventCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkEventCreateFlags</code> is a bitmask type for setting a mask of
<a href="#VkEventCreateFlagBits">VkEventCreateFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy an event, call:</p>
</div>
<div id="vkDestroyEvent" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkDestroyEvent(
    VkDevice                                    device,
    VkEvent                                     event,
    const VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the event.</p>
</li>
<li>
<p><code>event</code> is the handle of the event to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="memory.html#memory-allocation" class="xref page">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyEvent-event-01145" href="#VUID-vkDestroyEvent-event-01145"></a> <span class="vuid">VUID-vkDestroyEvent-event-01145</span><br>

All submitted commands that refer to <code>event</code> <strong>must</strong> have completed
execution</p>
</li>
<li>
<p><a id="VUID-vkDestroyEvent-event-01146" href="#VUID-vkDestroyEvent-event-01146"></a> <span class="vuid">VUID-vkDestroyEvent-event-01146</span><br>

If <code>VkAllocationCallbacks</code> were provided when <code>event</code> was
created, a compatible set of callbacks <strong>must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyEvent-event-01147" href="#VUID-vkDestroyEvent-event-01147"></a> <span class="vuid">VUID-vkDestroyEvent-event-01147</span><br>

If no <code>VkAllocationCallbacks</code> were provided when <code>event</code> was
created, <code>pAllocator</code> <strong>must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyEvent-device-parameter" href="#VUID-vkDestroyEvent-device-parameter"></a> <span class="vuid">VUID-vkDestroyEvent-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyEvent-event-parameter" href="#VUID-vkDestroyEvent-event-parameter"></a> <span class="vuid">VUID-vkDestroyEvent-event-parameter</span><br>
 If <code>event</code> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, <code>event</code> <strong>must</strong> be a valid <a href="#VkEvent">VkEvent</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyEvent-pAllocator-parameter" href="#VUID-vkDestroyEvent-pAllocator-parameter"></a> <span class="vuid">VUID-vkDestroyEvent-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong>must</strong> be a valid pointer to a valid <a href="memory.html#VkAllocationCallbacks" class="xref page">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyEvent-event-parent" href="#VUID-vkDestroyEvent-event-parent"></a> <span class="vuid">VUID-vkDestroyEvent-event-parent</span><br>
 If <code>event</code> is a valid handle, it <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>event</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query the state of an event from the host, call:</p>
</div>
<div id="vkGetEventStatus" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VkResult vkGetEventStatus(
    VkDevice                                    device,
    VkEvent                                     event);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the event.</p>
</li>
<li>
<p><code>event</code> is the handle of the event to query.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Upon success, <code>vkGetEventStatus</code> returns the state of the event object
with the following return codes:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 9. Event Object Status Codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Status</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_EVENT_SET</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The event specified by <code>event</code> is signaled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_EVENT_RESET</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The event specified by <code>event</code> is unsignaled.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If a <code>vkCmdSetEvent</code> or <code>vkCmdResetEvent</code> command is in a command
buffer that is in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">pending state</a>, then the
value returned by this command <strong>may</strong> immediately be out of date.</p>
</div>
<div class="paragraph">
<p>The state of an event <strong>can</strong> be updated by the host.
The state of the event is immediately changed, and subsequent calls to
<code>vkGetEventStatus</code> will return the new state.
If an event is already in the requested state, then updating it to the same
state has no effect.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetEventStatus-event-03940" href="#VUID-vkGetEventStatus-event-03940"></a> <span class="vuid">VUID-vkGetEventStatus-event-03940</span><br>

<code>event</code> <strong>must</strong> not have been created with
<code>VK_EVENT_CREATE_DEVICE_ONLY_BIT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetEventStatus-device-parameter" href="#VUID-vkGetEventStatus-device-parameter"></a> <span class="vuid">VUID-vkGetEventStatus-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetEventStatus-event-parameter" href="#VUID-vkGetEventStatus-event-parameter"></a> <span class="vuid">VUID-vkGetEventStatus-event-parameter</span><br>
 <code>event</code> <strong>must</strong> be a valid <a href="#VkEvent">VkEvent</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetEventStatus-event-parent" href="#VUID-vkGetEventStatus-event-parent"></a> <span class="vuid">VUID-vkGetEventStatus-event-parent</span><br>
 <code>event</code> <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_EVENT_SET</code></p>
</li>
<li>
<p><code>VK_EVENT_RESET</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div id="synchronization-events-signaling-host" class="openblock">
<div class="content">
<div class="paragraph">
<p>To set the state of an event to signaled from the host, call:</p>
</div>
<div id="vkSetEvent" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VkResult vkSetEvent(
    VkDevice                                    device,
    VkEvent                                     event);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the event.</p>
</li>
<li>
<p><code>event</code> is the event to set.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <a href="#vkSetEvent">vkSetEvent</a> is executed on the host, it defines an <em>event signal
operation</em> which sets the event to the signaled state.</p>
</div>
<div class="paragraph">
<p>If <code>event</code> is already in the signaled state when <a href="#vkSetEvent">vkSetEvent</a> is
executed, then <a href="#vkSetEvent">vkSetEvent</a> has no effect, and no event signal operation
occurs.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>If a command buffer is waiting for an event to be signaled from the host,
the application must signal the event before submitting the command buffer,
as described in the <a href="cmdbuffers.html#commandbuffers-submission-progress" class="xref page">queue forward progress</a> section.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkSetEvent-event-03941" href="#VUID-vkSetEvent-event-03941"></a> <span class="vuid">VUID-vkSetEvent-event-03941</span><br>

<code>event</code> <strong>must</strong> not have been created with
<code>VK_EVENT_CREATE_DEVICE_ONLY_BIT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkSetEvent-device-parameter" href="#VUID-vkSetEvent-device-parameter"></a> <span class="vuid">VUID-vkSetEvent-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkSetEvent-event-parameter" href="#VUID-vkSetEvent-event-parameter"></a> <span class="vuid">VUID-vkSetEvent-event-parameter</span><br>
 <code>event</code> <strong>must</strong> be a valid <a href="#VkEvent">VkEvent</a> handle</p>
</li>
<li>
<p><a id="VUID-vkSetEvent-event-parent" href="#VUID-vkSetEvent-event-parent"></a> <span class="vuid">VUID-vkSetEvent-event-parent</span><br>
 <code>event</code> <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>event</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div id="synchronization-events-unsignaling-host" class="openblock">
<div class="content">
<div class="paragraph">
<p>To set the state of an event to unsignaled from the host, call:</p>
</div>
<div id="vkResetEvent" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VkResult vkResetEvent(
    VkDevice                                    device,
    VkEvent                                     event);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the event.</p>
</li>
<li>
<p><code>event</code> is the event to reset.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <a href="#vkResetEvent">vkResetEvent</a> is executed on the host, it defines an <em>event
unsignal operation</em> which resets the event to the unsignaled state.</p>
</div>
<div class="paragraph">
<p>If <code>event</code> is already in the unsignaled state when <a href="#vkResetEvent">vkResetEvent</a> is
executed, then <a href="#vkResetEvent">vkResetEvent</a> has no effect, and no event unsignal
operation occurs.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetEvent-event-03821" href="#VUID-vkResetEvent-event-03821"></a> <span class="vuid">VUID-vkResetEvent-event-03821</span><br>

There <strong>must</strong> be an execution dependency between <code>vkResetEvent</code> and
the execution of any <a href="#vkCmdWaitEvents">vkCmdWaitEvents</a> that includes <code>event</code> in
its <code>pEvents</code> parameter</p>
</li>
<li>
<p><a id="VUID-vkResetEvent-event-03822" href="#VUID-vkResetEvent-event-03822"></a> <span class="vuid">VUID-vkResetEvent-event-03822</span><br>

There <strong>must</strong> be an execution dependency between <code>vkResetEvent</code> and
the execution of any <a href="#vkCmdWaitEvents2">vkCmdWaitEvents2</a> that includes <code>event</code> in
its <code>pEvents</code> parameter</p>
</li>
<li>
<p><a id="VUID-vkResetEvent-event-03823" href="#VUID-vkResetEvent-event-03823"></a> <span class="vuid">VUID-vkResetEvent-event-03823</span><br>

<code>event</code> <strong>must</strong> not have been created with
<code>VK_EVENT_CREATE_DEVICE_ONLY_BIT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetEvent-device-parameter" href="#VUID-vkResetEvent-device-parameter"></a> <span class="vuid">VUID-vkResetEvent-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkResetEvent-event-parameter" href="#VUID-vkResetEvent-event-parameter"></a> <span class="vuid">VUID-vkResetEvent-event-parameter</span><br>
 <code>event</code> <strong>must</strong> be a valid <a href="#VkEvent">VkEvent</a> handle</p>
</li>
<li>
<p><a id="VUID-vkResetEvent-event-parent" href="#VUID-vkResetEvent-event-parent"></a> <span class="vuid">VUID-vkResetEvent-event-parent</span><br>
 <code>event</code> <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>event</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The state of an event <strong>can</strong> also be updated on the device by commands
inserted in command buffers.</p>
</div>
<div id="synchronization-events-signaling-device" class="openblock">
<div class="content">
<div class="paragraph">
<p>To signal an event from a device, call:</p>
</div>
<div id="vkCmdSetEvent2" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
void vkCmdSetEvent2(
    VkCommandBuffer                             commandBuffer,
    VkEvent                                     event,
    const VkDependencyInfo*                     pDependencyInfo);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent command</p>
</div>
<div id="vkCmdSetEvent2KHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_synchronization2
void vkCmdSetEvent2KHR(
    VkCommandBuffer                             commandBuffer,
    VkEvent                                     event,
    const VkDependencyInfo*                     pDependencyInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command is
recorded.</p>
</li>
<li>
<p><code>event</code> is the event that will be signaled.</p>
</li>
<li>
<p><code>pDependencyInfo</code> is a pointer to a <a href="#VkDependencyInfo">VkDependencyInfo</a> structure
defining the first scopes of this operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <a href="#vkCmdSetEvent2">vkCmdSetEvent2</a> is submitted to a queue, it defines the first half
of memory dependencies defined by <code>pDependencyInfo</code>, as well as an event
signal operation which sets the event to the signaled state.
A memory dependency is defined between the event signal operation and
commands that occur earlier in submission order.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-scopes">synchronization scope</a> and
<a href="#synchronization-dependencies-access-scopes">access scope</a> are defined by
the union of all the memory dependencies defined by <code>pDependencyInfo</code>,
and are applied to all operations that occur earlier in
<a href="#synchronization-submission-order">submission order</a>.
<a href="#synchronization-queue-transfers">Queue family ownership transfers</a> and
<a href="#synchronization-image-layout-transitions">image layout transitions</a>
defined by <code>pDependencyInfo</code> are also included in the first scopes.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes only the event signal operation, and any
<a href="#synchronization-queue-transfers">queue family ownership transfers</a> and
<a href="#synchronization-image-layout-transitions">image layout transitions</a>
defined by <code>pDependencyInfo</code>.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-access-scopes">access scope</a>
includes only <a href="#synchronization-queue-transfers">queue family ownership transfers</a> and <a href="#synchronization-image-layout-transitions">image layout transitions</a>.</p>
</div>
<div class="paragraph">
<p>Future <a href="#vkCmdWaitEvents2">vkCmdWaitEvents2</a> commands rely on all values of each element in
<code>pDependencyInfo</code> matching exactly with those used to signal the
corresponding event.
<a href="#vkCmdWaitEvents">vkCmdWaitEvents</a> <strong>must</strong> not be used to wait on the result of a signal
operation defined by <code>vkCmdSetEvent2</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The extra information provided by <a href="#vkCmdSetEvent2">vkCmdSetEvent2</a> compared to
<a href="#vkCmdSetEvent">vkCmdSetEvent</a> allows implementations to more efficiently schedule the
operations required to satisfy the requested dependencies.
With <a href="#vkCmdSetEvent">vkCmdSetEvent</a>, the full dependency information is not known until
<a href="#vkCmdWaitEvents">vkCmdWaitEvents</a> is recorded, forcing implementations to insert the
required operations at that point and not before.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code>event</code> is already in the signaled state when <a href="#vkCmdSetEvent2">vkCmdSetEvent2</a> is
executed on the device, then <a href="#vkCmdSetEvent2">vkCmdSetEvent2</a> has no effect, no event
signal operation occurs, and no dependency is generated.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetEvent2-synchronization2-03824" href="#VUID-vkCmdSetEvent2-synchronization2-03824"></a> <span class="vuid">VUID-vkCmdSetEvent2-synchronization2-03824</span><br>

The <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature <strong>must</strong>
be enabled</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent2-dependencyFlags-03825" href="#VUID-vkCmdSetEvent2-dependencyFlags-03825"></a> <span class="vuid">VUID-vkCmdSetEvent2-dependencyFlags-03825</span><br>

The <code>dependencyFlags</code> member of <code>pDependencyInfo</code> <strong>must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent2-commandBuffer-03826" href="#VUID-vkCmdSetEvent2-commandBuffer-03826"></a> <span class="vuid">VUID-vkCmdSetEvent2-commandBuffer-03826</span><br>

The current device mask of <code>commandBuffer</code> <strong>must</strong> include exactly one
physical device</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent2-srcStageMask-03827" href="#VUID-vkCmdSetEvent2-srcStageMask-03827"></a> <span class="vuid">VUID-vkCmdSetEvent2-srcStageMask-03827</span><br>

The <code>srcStageMask</code> member of any element of the
<code>pMemoryBarriers</code>, <code>pBufferMemoryBarriers</code>, or
<code>pImageMemoryBarriers</code> members of <code>pDependencyInfo</code> <strong>must</strong> only
include pipeline stages valid for the queue family that was used to
create the command pool that <code>commandBuffer</code> was allocated from</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent2-dstStageMask-03828" href="#VUID-vkCmdSetEvent2-dstStageMask-03828"></a> <span class="vuid">VUID-vkCmdSetEvent2-dstStageMask-03828</span><br>

The <code>dstStageMask</code> member of any element of the
<code>pMemoryBarriers</code>, <code>pBufferMemoryBarriers</code>, or
<code>pImageMemoryBarriers</code> members of <code>pDependencyInfo</code> <strong>must</strong> only
include pipeline stages valid for the queue family that was used to
create the command pool that <code>commandBuffer</code> was allocated from</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetEvent2-commandBuffer-parameter" href="#VUID-vkCmdSetEvent2-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetEvent2-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent2-event-parameter" href="#VUID-vkCmdSetEvent2-event-parameter"></a> <span class="vuid">VUID-vkCmdSetEvent2-event-parameter</span><br>
 <code>event</code> <strong>must</strong> be a valid <a href="#VkEvent">VkEvent</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent2-pDependencyInfo-parameter" href="#VUID-vkCmdSetEvent2-pDependencyInfo-parameter"></a> <span class="vuid">VUID-vkCmdSetEvent2-pDependencyInfo-parameter</span><br>
 <code>pDependencyInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkDependencyInfo">VkDependencyInfo</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent2-commandBuffer-recording" href="#VUID-vkCmdSetEvent2-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetEvent2-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent2-commandBuffer-cmdpool" href="#VUID-vkCmdSetEvent2-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetEvent2-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics, compute, decode, or encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent2-renderpass" href="#VUID-vkCmdSetEvent2-renderpass"></a> <span class="vuid">VUID-vkCmdSetEvent2-renderpass</span><br>
 This command <strong>must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent2-commonparent" href="#VUID-vkCmdSetEvent2-commonparent"></a> <span class="vuid">VUID-vkCmdSetEvent2-commonparent</span><br>
 Both of <code>commandBuffer</code>, and <code>event</code> <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute<br>
Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Synchronization</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkDependencyInfo</code> structure is defined as:</p>
</div>
<div id="VkDependencyInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
typedef struct VkDependencyInfo {
    VkStructureType                  sType;
    const void*                      pNext;
    VkDependencyFlags                dependencyFlags;
    uint32_t                         memoryBarrierCount;
    const VkMemoryBarrier2*          pMemoryBarriers;
    uint32_t                         bufferMemoryBarrierCount;
    const VkBufferMemoryBarrier2*    pBufferMemoryBarriers;
    uint32_t                         imageMemoryBarrierCount;
    const VkImageMemoryBarrier2*     pImageMemoryBarriers;
} VkDependencyInfo;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkDependencyInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_synchronization2
typedef VkDependencyInfo VkDependencyInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>dependencyFlags</code> is a bitmask of <a href="#VkDependencyFlagBits">VkDependencyFlagBits</a>
specifying how execution and memory dependencies are formed.</p>
</li>
<li>
<p><code>memoryBarrierCount</code> is the length of the <code>pMemoryBarriers</code>
array.</p>
</li>
<li>
<p><code>pMemoryBarriers</code> is a pointer to an array of <a href="#VkMemoryBarrier2">VkMemoryBarrier2</a>
structures defining memory dependencies between any memory accesses.</p>
</li>
<li>
<p><code>bufferMemoryBarrierCount</code> is the length of the
<code>pBufferMemoryBarriers</code> array.</p>
</li>
<li>
<p><code>pBufferMemoryBarriers</code> is a pointer to an array of
<a href="#VkBufferMemoryBarrier2">VkBufferMemoryBarrier2</a> structures defining memory dependencies
between buffer ranges.</p>
</li>
<li>
<p><code>imageMemoryBarrierCount</code> is the length of the
<code>pImageMemoryBarriers</code> array.</p>
</li>
<li>
<p><code>pImageMemoryBarriers</code> is a pointer to an array of
<a href="#VkImageMemoryBarrier2">VkImageMemoryBarrier2</a> structures defining memory dependencies
between image subresources.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure defines a set of <a href="#synchronization-dependencies-memory">memory dependencies</a>, as well as <a href="#synchronization-queue-transfers">queue family transfer operations</a> and <a href="#synchronization-image-layout-transitions">image layout transitions</a>.</p>
</div>
<div class="paragraph">
<p>Each member of <code>pMemoryBarriers</code>, <code>pBufferMemoryBarriers</code>, and
<code>pImageMemoryBarriers</code> defines a separate
<a href="#synchronization-dependencies-memory">memory dependency</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkDependencyInfo-sType-sType" href="#VUID-VkDependencyInfo-sType-sType"></a> <span class="vuid">VUID-VkDependencyInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_DEPENDENCY_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkDependencyInfo-pNext-pNext" href="#VUID-VkDependencyInfo-pNext-pNext"></a> <span class="vuid">VUID-VkDependencyInfo-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkDependencyInfo-dependencyFlags-parameter" href="#VUID-VkDependencyInfo-dependencyFlags-parameter"></a> <span class="vuid">VUID-VkDependencyInfo-dependencyFlags-parameter</span><br>
 <code>dependencyFlags</code> <strong>must</strong> be a valid combination of <a href="#VkDependencyFlagBits">VkDependencyFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkDependencyInfo-pMemoryBarriers-parameter" href="#VUID-VkDependencyInfo-pMemoryBarriers-parameter"></a> <span class="vuid">VUID-VkDependencyInfo-pMemoryBarriers-parameter</span><br>
 If <code>memoryBarrierCount</code> is not <code>0</code>, <code>pMemoryBarriers</code> <strong>must</strong> be a valid pointer to an array of <code>memoryBarrierCount</code> valid <a href="#VkMemoryBarrier2">VkMemoryBarrier2</a> structures</p>
</li>
<li>
<p><a id="VUID-VkDependencyInfo-pBufferMemoryBarriers-parameter" href="#VUID-VkDependencyInfo-pBufferMemoryBarriers-parameter"></a> <span class="vuid">VUID-VkDependencyInfo-pBufferMemoryBarriers-parameter</span><br>
 If <code>bufferMemoryBarrierCount</code> is not <code>0</code>, <code>pBufferMemoryBarriers</code> <strong>must</strong> be a valid pointer to an array of <code>bufferMemoryBarrierCount</code> valid <a href="#VkBufferMemoryBarrier2">VkBufferMemoryBarrier2</a> structures</p>
</li>
<li>
<p><a id="VUID-VkDependencyInfo-pImageMemoryBarriers-parameter" href="#VUID-VkDependencyInfo-pImageMemoryBarriers-parameter"></a> <span class="vuid">VUID-VkDependencyInfo-pImageMemoryBarriers-parameter</span><br>
 If <code>imageMemoryBarrierCount</code> is not <code>0</code>, <code>pImageMemoryBarriers</code> <strong>must</strong> be a valid pointer to an array of <code>imageMemoryBarrierCount</code> valid <a href="#VkImageMemoryBarrier2">VkImageMemoryBarrier2</a> structures</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To set the state of an event to signaled from a device, call:</p>
</div>
<div id="vkCmdSetEvent" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkCmdSetEvent(
    VkCommandBuffer                             commandBuffer,
    VkEvent                                     event,
    VkPipelineStageFlags                        stageMask);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command is
recorded.</p>
</li>
<li>
<p><code>event</code> is the event that will be signaled.</p>
</li>
<li>
<p><code>stageMask</code> specifies the <a href="#synchronization-pipeline-stages">source    stage mask</a> used to determine the first
<a href="#synchronization-dependencies-scopes">synchronization scope</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkCmdSetEvent</code> behaves identically to <a href="#vkCmdSetEvent2">vkCmdSetEvent2</a>, except that
it does not define an access scope, and <strong>must</strong> only be used with
<a href="#vkCmdWaitEvents">vkCmdWaitEvents</a>, not <a href="#vkCmdWaitEvents2">vkCmdWaitEvents2</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-04090" href="#VUID-vkCmdSetEvent-stageMask-04090"></a> <span class="vuid">VUID-vkCmdSetEvent-stageMask-04090</span><br>

If the <a href="features.html#features-geometryShader" class="xref page"><code>geometryShader</code></a> feature is not
enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-04091" href="#VUID-vkCmdSetEvent-stageMask-04091"></a> <span class="vuid">VUID-vkCmdSetEvent-stageMask-04091</span><br>

If the <a href="features.html#features-tessellationShader" class="xref page"><code>tessellationShader</code></a> feature
is not enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-04092" href="#VUID-vkCmdSetEvent-stageMask-04092"></a> <span class="vuid">VUID-vkCmdSetEvent-stageMask-04092</span><br>

If the <a href="features.html#features-conditionalRendering" class="xref page"><code>conditionalRendering</code></a>
feature is not enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_CONDITIONAL_RENDERING_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-04093" href="#VUID-vkCmdSetEvent-stageMask-04093"></a> <span class="vuid">VUID-vkCmdSetEvent-stageMask-04093</span><br>

If the <a href="features.html#features-fragmentDensityMap" class="xref page"><code>fragmentDensityMap</code></a> feature
is not enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-04094" href="#VUID-vkCmdSetEvent-stageMask-04094"></a> <span class="vuid">VUID-vkCmdSetEvent-stageMask-04094</span><br>

If the <a href="features.html#features-transformFeedback" class="xref page"><code>transformFeedback</code></a> feature
is not enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TRANSFORM_FEEDBACK_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-04095" href="#VUID-vkCmdSetEvent-stageMask-04095"></a> <span class="vuid">VUID-vkCmdSetEvent-stageMask-04095</span><br>

If the <a href="features.html#features-meshShader" class="xref page"><code>meshShader</code></a> feature is not enabled,
<code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-04096" href="#VUID-vkCmdSetEvent-stageMask-04096"></a> <span class="vuid">VUID-vkCmdSetEvent-stageMask-04096</span><br>

If the <a href="features.html#features-taskShader" class="xref page"><code>taskShader</code></a> feature is not enabled,
<code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-07318" href="#VUID-vkCmdSetEvent-stageMask-07318"></a> <span class="vuid">VUID-vkCmdSetEvent-stageMask-07318</span><br>

If neither the <a href="features.html#features-shadingRateImage" class="xref page"><code>shadingRateImage</code></a> or
<a href="features.html#features-attachmentFragmentShadingRate" class="xref page">    <code>attachmentFragmentShadingRate</code></a> are enabled, <code>stageMask</code>
<strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-03937" href="#VUID-vkCmdSetEvent-stageMask-03937"></a> <span class="vuid">VUID-vkCmdSetEvent-stageMask-03937</span><br>

If the <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature is
not enabled, <code>stageMask</code> <strong>must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-07949" href="#VUID-vkCmdSetEvent-stageMask-07949"></a> <span class="vuid">VUID-vkCmdSetEvent-stageMask-07949</span><br>

If neither the <a href="../appendices/extensions.html#VK_NV_ray_tracing" class="xref page">VK_NV_ray_tracing</a> extension or
<a href="features.html#features-rayTracingPipeline" class="xref page"><code>rayTracingPipeline</code> feature</a> are
enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-06457" href="#VUID-vkCmdSetEvent-stageMask-06457"></a> <span class="vuid">VUID-vkCmdSetEvent-stageMask-06457</span><br>

Any pipeline stage included in <code>stageMask</code> <strong>must</strong> be supported by the
capabilities of the queue family specified by the <code>queueFamilyIndex</code>
member of the <a href="cmdbuffers.html#VkCommandPoolCreateInfo" class="xref page">VkCommandPoolCreateInfo</a> structure that was used to
create the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated
from, as specified in the <a href="#synchronization-pipeline-stages-supported">    table of supported pipeline stages</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-01149" href="#VUID-vkCmdSetEvent-stageMask-01149"></a> <span class="vuid">VUID-vkCmdSetEvent-stageMask-01149</span><br>

<code>stageMask</code> <strong>must</strong> not include <code>VK_PIPELINE_STAGE_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-commandBuffer-01152" href="#VUID-vkCmdSetEvent-commandBuffer-01152"></a> <span class="vuid">VUID-vkCmdSetEvent-commandBuffer-01152</span><br>

<code>commandBuffer</code>&#8217;s current device mask <strong>must</strong> include exactly one
physical device</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetEvent-commandBuffer-parameter" href="#VUID-vkCmdSetEvent-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetEvent-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-event-parameter" href="#VUID-vkCmdSetEvent-event-parameter"></a> <span class="vuid">VUID-vkCmdSetEvent-event-parameter</span><br>
 <code>event</code> <strong>must</strong> be a valid <a href="#VkEvent">VkEvent</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-parameter" href="#VUID-vkCmdSetEvent-stageMask-parameter"></a> <span class="vuid">VUID-vkCmdSetEvent-stageMask-parameter</span><br>
 <code>stageMask</code> <strong>must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-commandBuffer-recording" href="#VUID-vkCmdSetEvent-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetEvent-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-commandBuffer-cmdpool" href="#VUID-vkCmdSetEvent-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetEvent-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics, compute, decode, or encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-renderpass" href="#VUID-vkCmdSetEvent-renderpass"></a> <span class="vuid">VUID-vkCmdSetEvent-renderpass</span><br>
 This command <strong>must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-commonparent" href="#VUID-vkCmdSetEvent-commonparent"></a> <span class="vuid">VUID-vkCmdSetEvent-commonparent</span><br>
 Both of <code>commandBuffer</code>, and <code>event</code> <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute<br>
Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Synchronization</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="synchronization-events-unsignaling-device" class="openblock">
<div class="content">
<div class="paragraph">
<p>To unsignal the event from a device, call:</p>
</div>
<div id="vkCmdResetEvent2" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
void vkCmdResetEvent2(
    VkCommandBuffer                             commandBuffer,
    VkEvent                                     event,
    VkPipelineStageFlags2                       stageMask);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent command</p>
</div>
<div id="vkCmdResetEvent2KHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_synchronization2
void vkCmdResetEvent2KHR(
    VkCommandBuffer                             commandBuffer,
    VkEvent                                     event,
    VkPipelineStageFlags2                       stageMask);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command is
recorded.</p>
</li>
<li>
<p><code>event</code> is the event that will be unsignaled.</p>
</li>
<li>
<p><code>stageMask</code> is a <a href="#VkPipelineStageFlags2">VkPipelineStageFlags2</a> mask of pipeline stages
used to determine the first <a href="#synchronization-dependencies-scopes">    synchronization scope</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <a href="#vkCmdResetEvent2">vkCmdResetEvent2</a> is submitted to a queue, it defines an execution
dependency on commands that were submitted before it, and defines an event
unsignal operation which resets the event to the unsignaled state.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands that occur earlier in
<a href="#synchronization-submission-order">submission order</a>.
The synchronization scope is limited to operations by <code>stageMask</code> or
stages that are <a href="#synchronization-pipeline-stages-order">logically earlier</a>
than <code>stageMask</code>.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes only the event unsignal operation.</p>
</div>
<div class="paragraph">
<p>If <code>event</code> is already in the unsignaled state when
<a href="#vkCmdResetEvent2">vkCmdResetEvent2</a> is executed on the device, then this command has no
effect, no event unsignal operation occurs, and no execution dependency is
generated.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdResetEvent2-stageMask-03929" href="#VUID-vkCmdResetEvent2-stageMask-03929"></a> <span class="vuid">VUID-vkCmdResetEvent2-stageMask-03929</span><br>

If the <a href="features.html#features-geometryShader" class="xref page"><code>geometryShader</code></a> feature is not
enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-stageMask-03930" href="#VUID-vkCmdResetEvent2-stageMask-03930"></a> <span class="vuid">VUID-vkCmdResetEvent2-stageMask-03930</span><br>

If the <a href="features.html#features-tessellationShader" class="xref page"><code>tessellationShader</code></a> feature
is not enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-stageMask-03931" href="#VUID-vkCmdResetEvent2-stageMask-03931"></a> <span class="vuid">VUID-vkCmdResetEvent2-stageMask-03931</span><br>

If the <a href="features.html#features-conditionalRendering" class="xref page"><code>conditionalRendering</code></a>
feature is not enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-stageMask-03932" href="#VUID-vkCmdResetEvent2-stageMask-03932"></a> <span class="vuid">VUID-vkCmdResetEvent2-stageMask-03932</span><br>

If the <a href="features.html#features-fragmentDensityMap" class="xref page"><code>fragmentDensityMap</code></a> feature
is not enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-stageMask-03933" href="#VUID-vkCmdResetEvent2-stageMask-03933"></a> <span class="vuid">VUID-vkCmdResetEvent2-stageMask-03933</span><br>

If the <a href="features.html#features-transformFeedback" class="xref page"><code>transformFeedback</code></a> feature
is not enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-stageMask-03934" href="#VUID-vkCmdResetEvent2-stageMask-03934"></a> <span class="vuid">VUID-vkCmdResetEvent2-stageMask-03934</span><br>

If the <a href="features.html#features-meshShader" class="xref page"><code>meshShader</code></a> feature is not enabled,
<code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-stageMask-03935" href="#VUID-vkCmdResetEvent2-stageMask-03935"></a> <span class="vuid">VUID-vkCmdResetEvent2-stageMask-03935</span><br>

If the <a href="features.html#features-taskShader" class="xref page"><code>taskShader</code></a> feature is not enabled,
<code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-stageMask-07316" href="#VUID-vkCmdResetEvent2-stageMask-07316"></a> <span class="vuid">VUID-vkCmdResetEvent2-stageMask-07316</span><br>

If neither the <a href="features.html#features-shadingRateImage" class="xref page"><code>shadingRateImage</code></a> or
<a href="features.html#features-attachmentFragmentShadingRate" class="xref page">    <code>attachmentFragmentShadingRate</code></a> are enabled, <code>stageMask</code>
<strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-stageMask-04957" href="#VUID-vkCmdResetEvent2-stageMask-04957"></a> <span class="vuid">VUID-vkCmdResetEvent2-stageMask-04957</span><br>

If the <a href="features.html#features-subpassShading" class="xref page"><code>subpassShading</code></a> feature is not
enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-stageMask-04995" href="#VUID-vkCmdResetEvent2-stageMask-04995"></a> <span class="vuid">VUID-vkCmdResetEvent2-stageMask-04995</span><br>

If the <a href="features.html#features-invocationMask" class="xref page"><code>invocationMask</code></a> feature is not
enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-stageMask-07946" href="#VUID-vkCmdResetEvent2-stageMask-07946"></a> <span class="vuid">VUID-vkCmdResetEvent2-stageMask-07946</span><br>

If neither the <a href="../appendices/extensions.html#VK_NV_ray_tracing" class="xref page">VK_NV_ray_tracing</a> extension or
<a href="features.html#features-rayTracingPipeline" class="xref page"><code>rayTracingPipeline</code> feature</a> are
enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-synchronization2-03829" href="#VUID-vkCmdResetEvent2-synchronization2-03829"></a> <span class="vuid">VUID-vkCmdResetEvent2-synchronization2-03829</span><br>

The <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature <strong>must</strong>
be enabled</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-stageMask-03830" href="#VUID-vkCmdResetEvent2-stageMask-03830"></a> <span class="vuid">VUID-vkCmdResetEvent2-stageMask-03830</span><br>

<code>stageMask</code> <strong>must</strong> not include <code>VK_PIPELINE_STAGE_2_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-event-03831" href="#VUID-vkCmdResetEvent2-event-03831"></a> <span class="vuid">VUID-vkCmdResetEvent2-event-03831</span><br>

There <strong>must</strong> be an execution dependency between <code>vkCmdResetEvent2</code>
and the execution of any <a href="#vkCmdWaitEvents">vkCmdWaitEvents</a> that includes <code>event</code>
in its <code>pEvents</code> parameter</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-event-03832" href="#VUID-vkCmdResetEvent2-event-03832"></a> <span class="vuid">VUID-vkCmdResetEvent2-event-03832</span><br>

There <strong>must</strong> be an execution dependency between <code>vkCmdResetEvent2</code>
and the execution of any <a href="#vkCmdWaitEvents2">vkCmdWaitEvents2</a> that includes
<code>event</code> in its <code>pEvents</code> parameter</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-commandBuffer-03833" href="#VUID-vkCmdResetEvent2-commandBuffer-03833"></a> <span class="vuid">VUID-vkCmdResetEvent2-commandBuffer-03833</span><br>

<code>commandBuffer</code>&#8217;s current device mask <strong>must</strong> include exactly one
physical device</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdResetEvent2-commandBuffer-parameter" href="#VUID-vkCmdResetEvent2-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdResetEvent2-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-event-parameter" href="#VUID-vkCmdResetEvent2-event-parameter"></a> <span class="vuid">VUID-vkCmdResetEvent2-event-parameter</span><br>
 <code>event</code> <strong>must</strong> be a valid <a href="#VkEvent">VkEvent</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-stageMask-parameter" href="#VUID-vkCmdResetEvent2-stageMask-parameter"></a> <span class="vuid">VUID-vkCmdResetEvent2-stageMask-parameter</span><br>
 <code>stageMask</code> <strong>must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits2">VkPipelineStageFlagBits2</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-commandBuffer-recording" href="#VUID-vkCmdResetEvent2-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdResetEvent2-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-commandBuffer-cmdpool" href="#VUID-vkCmdResetEvent2-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdResetEvent2-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics, compute, decode, or encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-renderpass" href="#VUID-vkCmdResetEvent2-renderpass"></a> <span class="vuid">VUID-vkCmdResetEvent2-renderpass</span><br>
 This command <strong>must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent2-commonparent" href="#VUID-vkCmdResetEvent2-commonparent"></a> <span class="vuid">VUID-vkCmdResetEvent2-commonparent</span><br>
 Both of <code>commandBuffer</code>, and <code>event</code> <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute<br>
Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Synchronization</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To set the state of an event to unsignaled from a device, call:</p>
</div>
<div id="vkCmdResetEvent" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkCmdResetEvent(
    VkCommandBuffer                             commandBuffer,
    VkEvent                                     event,
    VkPipelineStageFlags                        stageMask);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command is
recorded.</p>
</li>
<li>
<p><code>event</code> is the event that will be unsignaled.</p>
</li>
<li>
<p><code>stageMask</code> is a bitmask of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> specifying
the <a href="#synchronization-pipeline-stages">source stage mask</a> used to
determine when the <code>event</code> is unsignaled.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkCmdResetEvent</code> behaves identically to <a href="#vkCmdResetEvent2">vkCmdResetEvent2</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-04090" href="#VUID-vkCmdResetEvent-stageMask-04090"></a> <span class="vuid">VUID-vkCmdResetEvent-stageMask-04090</span><br>

If the <a href="features.html#features-geometryShader" class="xref page"><code>geometryShader</code></a> feature is not
enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-04091" href="#VUID-vkCmdResetEvent-stageMask-04091"></a> <span class="vuid">VUID-vkCmdResetEvent-stageMask-04091</span><br>

If the <a href="features.html#features-tessellationShader" class="xref page"><code>tessellationShader</code></a> feature
is not enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-04092" href="#VUID-vkCmdResetEvent-stageMask-04092"></a> <span class="vuid">VUID-vkCmdResetEvent-stageMask-04092</span><br>

If the <a href="features.html#features-conditionalRendering" class="xref page"><code>conditionalRendering</code></a>
feature is not enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_CONDITIONAL_RENDERING_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-04093" href="#VUID-vkCmdResetEvent-stageMask-04093"></a> <span class="vuid">VUID-vkCmdResetEvent-stageMask-04093</span><br>

If the <a href="features.html#features-fragmentDensityMap" class="xref page"><code>fragmentDensityMap</code></a> feature
is not enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-04094" href="#VUID-vkCmdResetEvent-stageMask-04094"></a> <span class="vuid">VUID-vkCmdResetEvent-stageMask-04094</span><br>

If the <a href="features.html#features-transformFeedback" class="xref page"><code>transformFeedback</code></a> feature
is not enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TRANSFORM_FEEDBACK_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-04095" href="#VUID-vkCmdResetEvent-stageMask-04095"></a> <span class="vuid">VUID-vkCmdResetEvent-stageMask-04095</span><br>

If the <a href="features.html#features-meshShader" class="xref page"><code>meshShader</code></a> feature is not enabled,
<code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-04096" href="#VUID-vkCmdResetEvent-stageMask-04096"></a> <span class="vuid">VUID-vkCmdResetEvent-stageMask-04096</span><br>

If the <a href="features.html#features-taskShader" class="xref page"><code>taskShader</code></a> feature is not enabled,
<code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-07318" href="#VUID-vkCmdResetEvent-stageMask-07318"></a> <span class="vuid">VUID-vkCmdResetEvent-stageMask-07318</span><br>

If neither the <a href="features.html#features-shadingRateImage" class="xref page"><code>shadingRateImage</code></a> or
<a href="features.html#features-attachmentFragmentShadingRate" class="xref page">    <code>attachmentFragmentShadingRate</code></a> are enabled, <code>stageMask</code>
<strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-03937" href="#VUID-vkCmdResetEvent-stageMask-03937"></a> <span class="vuid">VUID-vkCmdResetEvent-stageMask-03937</span><br>

If the <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature is
not enabled, <code>stageMask</code> <strong>must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-07949" href="#VUID-vkCmdResetEvent-stageMask-07949"></a> <span class="vuid">VUID-vkCmdResetEvent-stageMask-07949</span><br>

If neither the <a href="../appendices/extensions.html#VK_NV_ray_tracing" class="xref page">VK_NV_ray_tracing</a> extension or
<a href="features.html#features-rayTracingPipeline" class="xref page"><code>rayTracingPipeline</code> feature</a> are
enabled, <code>stageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-06458" href="#VUID-vkCmdResetEvent-stageMask-06458"></a> <span class="vuid">VUID-vkCmdResetEvent-stageMask-06458</span><br>

Any pipeline stage included in <code>stageMask</code> <strong>must</strong> be supported by the
capabilities of the queue family specified by the <code>queueFamilyIndex</code>
member of the <a href="cmdbuffers.html#VkCommandPoolCreateInfo" class="xref page">VkCommandPoolCreateInfo</a> structure that was used to
create the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated
from, as specified in the <a href="#synchronization-pipeline-stages-supported">    table of supported pipeline stages</a></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-01153" href="#VUID-vkCmdResetEvent-stageMask-01153"></a> <span class="vuid">VUID-vkCmdResetEvent-stageMask-01153</span><br>

<code>stageMask</code> <strong>must</strong> not include <code>VK_PIPELINE_STAGE_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-event-03834" href="#VUID-vkCmdResetEvent-event-03834"></a> <span class="vuid">VUID-vkCmdResetEvent-event-03834</span><br>

There <strong>must</strong> be an execution dependency between <code>vkCmdResetEvent</code> and
the execution of any <a href="#vkCmdWaitEvents">vkCmdWaitEvents</a> that includes <code>event</code> in
its <code>pEvents</code> parameter</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-event-03835" href="#VUID-vkCmdResetEvent-event-03835"></a> <span class="vuid">VUID-vkCmdResetEvent-event-03835</span><br>

There <strong>must</strong> be an execution dependency between <code>vkCmdResetEvent</code> and
the execution of any <a href="#vkCmdWaitEvents2">vkCmdWaitEvents2</a> that includes <code>event</code> in
its <code>pEvents</code> parameter</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-commandBuffer-01157" href="#VUID-vkCmdResetEvent-commandBuffer-01157"></a> <span class="vuid">VUID-vkCmdResetEvent-commandBuffer-01157</span><br>

<code>commandBuffer</code>&#8217;s current device mask <strong>must</strong> include exactly one
physical device</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdResetEvent-commandBuffer-parameter" href="#VUID-vkCmdResetEvent-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdResetEvent-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-event-parameter" href="#VUID-vkCmdResetEvent-event-parameter"></a> <span class="vuid">VUID-vkCmdResetEvent-event-parameter</span><br>
 <code>event</code> <strong>must</strong> be a valid <a href="#VkEvent">VkEvent</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-parameter" href="#VUID-vkCmdResetEvent-stageMask-parameter"></a> <span class="vuid">VUID-vkCmdResetEvent-stageMask-parameter</span><br>
 <code>stageMask</code> <strong>must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-commandBuffer-recording" href="#VUID-vkCmdResetEvent-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdResetEvent-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-commandBuffer-cmdpool" href="#VUID-vkCmdResetEvent-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdResetEvent-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics, compute, decode, or encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-renderpass" href="#VUID-vkCmdResetEvent-renderpass"></a> <span class="vuid">VUID-vkCmdResetEvent-renderpass</span><br>
 This command <strong>must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-commonparent" href="#VUID-vkCmdResetEvent-commonparent"></a> <span class="vuid">VUID-vkCmdResetEvent-commonparent</span><br>
 Both of <code>commandBuffer</code>, and <code>event</code> <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute<br>
Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Synchronization</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To wait for one or more events to enter the signaled state on a device,
call:</p>
</div>
<div id="vkCmdWaitEvents2" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
void vkCmdWaitEvents2(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    eventCount,
    const VkEvent*                              pEvents,
    const VkDependencyInfo*                     pDependencyInfos);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent command</p>
</div>
<div id="vkCmdWaitEvents2KHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_synchronization2
void vkCmdWaitEvents2KHR(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    eventCount,
    const VkEvent*                              pEvents,
    const VkDependencyInfo*                     pDependencyInfos);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command is
recorded.</p>
</li>
<li>
<p><code>eventCount</code> is the length of the <code>pEvents</code> array.</p>
</li>
<li>
<p><code>pEvents</code> is a pointer to an array of <code>eventCount</code> events to
wait on.</p>
</li>
<li>
<p><code>pDependencyInfos</code> is a pointer to an array of <code>eventCount</code>
<a href="#VkDependencyInfo">VkDependencyInfo</a> structures, defining the second
<a href="#synchronization-dependencies-scopes">synchronization scope</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <code>vkCmdWaitEvents2</code> is submitted to a queue, it inserts memory
dependencies according to the elements of <code>pDependencyInfos</code> and each
corresponding element of <code>pEvents</code>.
<code>vkCmdWaitEvents2</code> <strong>must</strong> not be used to wait on event signal operations
occurring on other queues, or signal operations executed by
<a href="#vkCmdSetEvent">vkCmdSetEvent</a>.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-scopes">synchronization scope</a> and
<a href="#synchronization-dependencies-access-scopes">access scope</a> of each memory
dependency defined by any element <span class="eq">i</span> of <code>pDependencyInfos</code> are
applied to operations that occurred earlier in
<a href="#synchronization-submission-order">submission order</a> than the last event
signal operation on element <span class="eq">i</span> of <code>pEvents</code>.</p>
</div>
<div class="paragraph">
<p>Signal operations for an event at index <span class="eq">i</span> are only included if:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The event was signaled by a <a href="#vkCmdSetEvent2">vkCmdSetEvent2</a> command that occurred
earlier in <a href="#synchronization-submission-order">submission order</a> with a
<code>dependencyInfo</code> parameter exactly equal to the element of
<code>pDependencyInfos</code> at index <span class="eq">i</span> ; or</p>
</li>
<li>
<p>The event was created without <code>VK_EVENT_CREATE_DEVICE_ONLY_BIT</code>, and
the first <a href="#synchronization-dependencies-scopes">synchronization scope</a>
defined by the element of <code>pDependencyInfos</code> at index <span class="eq">i</span> only
includes host operations (<code>VK_PIPELINE_STAGE_2_HOST_BIT</code>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
and <a href="#synchronization-dependencies-access-scopes">access scope</a> of each
memory dependency defined by any element <span class="eq">i</span> of <code>pDependencyInfos</code>
are applied to operations that occurred later in
<a href="#synchronization-submission-order">submission order</a> than
<code>vkCmdWaitEvents2</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p><a href="#vkCmdWaitEvents2">vkCmdWaitEvents2</a> is used with <a href="#vkCmdSetEvent2">vkCmdSetEvent2</a> to define a memory
dependency between two sets of action commands, roughly in the same way as
pipeline barriers, but split into two commands such that work between the
two <strong>may</strong> execute unhindered.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications should be careful to avoid race conditions when using events.
There is no direct ordering guarantee between <code>vkCmdSetEvent2</code> and
<a href="#vkCmdResetEvent2">vkCmdResetEvent2</a>, <a href="#vkCmdResetEvent">vkCmdResetEvent</a>, or <a href="#vkCmdSetEvent">vkCmdSetEvent</a>.
Another execution dependency (e.g. a pipeline barrier or semaphore with
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>) is needed to prevent such a race
condition.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWaitEvents2-synchronization2-03836" href="#VUID-vkCmdWaitEvents2-synchronization2-03836"></a> <span class="vuid">VUID-vkCmdWaitEvents2-synchronization2-03836</span><br>

The <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature <strong>must</strong>
be enabled</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents2-pEvents-03837" href="#VUID-vkCmdWaitEvents2-pEvents-03837"></a> <span class="vuid">VUID-vkCmdWaitEvents2-pEvents-03837</span><br>

Members of <code>pEvents</code> <strong>must</strong> not have been signaled by
<a href="#vkCmdSetEvent">vkCmdSetEvent</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents2-pEvents-03838" href="#VUID-vkCmdWaitEvents2-pEvents-03838"></a> <span class="vuid">VUID-vkCmdWaitEvents2-pEvents-03838</span><br>

For any element <span class="eq">i</span> of <code>pEvents</code>, if that event is signaled by
<a href="#vkCmdSetEvent2">vkCmdSetEvent2</a>, that command&#8217;s <code>dependencyInfo</code> parameter
<strong>must</strong> be exactly equal to the <span class="eq">i</span>th element of
<code>pDependencyInfos</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents2-pEvents-03839" href="#VUID-vkCmdWaitEvents2-pEvents-03839"></a> <span class="vuid">VUID-vkCmdWaitEvents2-pEvents-03839</span><br>

For any element <span class="eq">i</span> of <code>pEvents</code>, if that event is signaled by
<a href="#vkSetEvent">vkSetEvent</a>, barriers in the <span class="eq">i</span>th element of
<code>pDependencyInfos</code> <strong>must</strong> include only host operations in their first
<a href="#synchronization-dependencies-scopes">synchronization scope</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents2-pEvents-03840" href="#VUID-vkCmdWaitEvents2-pEvents-03840"></a> <span class="vuid">VUID-vkCmdWaitEvents2-pEvents-03840</span><br>

For any element <span class="eq">i</span> of <code>pEvents</code>, if barriers in the <span class="eq">i</span>th
element of <code>pDependencyInfos</code> include only host operations, the
<span class="eq">i</span>th element of <code>pEvents</code> <strong>must</strong> be signaled before
<a href="#vkCmdWaitEvents2">vkCmdWaitEvents2</a> is executed</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents2-pEvents-03841" href="#VUID-vkCmdWaitEvents2-pEvents-03841"></a> <span class="vuid">VUID-vkCmdWaitEvents2-pEvents-03841</span><br>

For any element <span class="eq">i</span> of <code>pEvents</code>, if barriers in the <span class="eq">i</span>th
element of <code>pDependencyInfos</code> do not include host operations, the
<span class="eq">i</span>th element of <code>pEvents</code> <strong>must</strong> be signaled by a
corresponding <a href="#vkCmdSetEvent2">vkCmdSetEvent2</a> that occurred earlier in
<a href="#synchronization-submission-order">submission order</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents2-srcStageMask-03842" href="#VUID-vkCmdWaitEvents2-srcStageMask-03842"></a> <span class="vuid">VUID-vkCmdWaitEvents2-srcStageMask-03842</span><br>

The <code>srcStageMask</code> member of any element of the
<code>pMemoryBarriers</code>, <code>pBufferMemoryBarriers</code>, or
<code>pImageMemoryBarriers</code> members of <code>pDependencyInfos</code> <strong>must</strong>
either include only pipeline stages valid for the queue family that was
used to create the command pool that <code>commandBuffer</code> was allocated
from, or include only <code>VK_PIPELINE_STAGE_2_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents2-dstStageMask-03843" href="#VUID-vkCmdWaitEvents2-dstStageMask-03843"></a> <span class="vuid">VUID-vkCmdWaitEvents2-dstStageMask-03843</span><br>

The <code>dstStageMask</code> member of any element of the
<code>pMemoryBarriers</code>, <code>pBufferMemoryBarriers</code>, or
<code>pImageMemoryBarriers</code> members of <code>pDependencyInfos</code> <strong>must</strong> only
include pipeline stages valid for the queue family that was used to
create the command pool that <code>commandBuffer</code> was allocated from</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents2-dependencyFlags-03844" href="#VUID-vkCmdWaitEvents2-dependencyFlags-03844"></a> <span class="vuid">VUID-vkCmdWaitEvents2-dependencyFlags-03844</span><br>

If <code>vkCmdWaitEvents2</code> is being called inside a render pass instance,
the <code>srcStageMask</code> member of any element of the
<code>pMemoryBarriers</code>, <code>pBufferMemoryBarriers</code>, or
<code>pImageMemoryBarriers</code> members of <code>pDependencyInfos</code> <strong>must</strong> not
include <code>VK_PIPELINE_STAGE_2_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents2-commandBuffer-03846" href="#VUID-vkCmdWaitEvents2-commandBuffer-03846"></a> <span class="vuid">VUID-vkCmdWaitEvents2-commandBuffer-03846</span><br>

<code>commandBuffer</code>&#8217;s current device mask <strong>must</strong> include exactly one
physical device</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWaitEvents2-commandBuffer-parameter" href="#VUID-vkCmdWaitEvents2-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdWaitEvents2-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents2-pEvents-parameter" href="#VUID-vkCmdWaitEvents2-pEvents-parameter"></a> <span class="vuid">VUID-vkCmdWaitEvents2-pEvents-parameter</span><br>
 <code>pEvents</code> <strong>must</strong> be a valid pointer to an array of <code>eventCount</code> valid <a href="#VkEvent">VkEvent</a> handles</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents2-pDependencyInfos-parameter" href="#VUID-vkCmdWaitEvents2-pDependencyInfos-parameter"></a> <span class="vuid">VUID-vkCmdWaitEvents2-pDependencyInfos-parameter</span><br>
 <code>pDependencyInfos</code> <strong>must</strong> be a valid pointer to an array of <code>eventCount</code> valid <a href="#VkDependencyInfo">VkDependencyInfo</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents2-commandBuffer-recording" href="#VUID-vkCmdWaitEvents2-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdWaitEvents2-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents2-commandBuffer-cmdpool" href="#VUID-vkCmdWaitEvents2-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdWaitEvents2-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics, compute, decode, or encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents2-eventCount-arraylength" href="#VUID-vkCmdWaitEvents2-eventCount-arraylength"></a> <span class="vuid">VUID-vkCmdWaitEvents2-eventCount-arraylength</span><br>
 <code>eventCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents2-commonparent" href="#VUID-vkCmdWaitEvents2-commonparent"></a> <span class="vuid">VUID-vkCmdWaitEvents2-commonparent</span><br>
 Both of <code>commandBuffer</code>, and the elements of <code>pEvents</code> <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute<br>
Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Synchronization</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To wait for one or more events to enter the signaled state on a device,
call:</p>
</div>
<div id="vkCmdWaitEvents" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkCmdWaitEvents(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    eventCount,
    const VkEvent*                              pEvents,
    VkPipelineStageFlags                        srcStageMask,
    VkPipelineStageFlags                        dstStageMask,
    uint32_t                                    memoryBarrierCount,
    const VkMemoryBarrier*                      pMemoryBarriers,
    uint32_t                                    bufferMemoryBarrierCount,
    const VkBufferMemoryBarrier*                pBufferMemoryBarriers,
    uint32_t                                    imageMemoryBarrierCount,
    const VkImageMemoryBarrier*                 pImageMemoryBarriers);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command is
recorded.</p>
</li>
<li>
<p><code>eventCount</code> is the length of the <code>pEvents</code> array.</p>
</li>
<li>
<p><code>pEvents</code> is a pointer to an array of event object handles to wait
on.</p>
</li>
<li>
<p><code>srcStageMask</code> is a bitmask of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a>
specifying the <a href="#synchronization-pipeline-stages">source stage mask</a>.</p>
</li>
<li>
<p><code>dstStageMask</code> is a bitmask of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a>
specifying the <a href="#synchronization-pipeline-stages">destination stage    mask</a>.</p>
</li>
<li>
<p><code>memoryBarrierCount</code> is the length of the <code>pMemoryBarriers</code>
array.</p>
</li>
<li>
<p><code>pMemoryBarriers</code> is a pointer to an array of <a href="#VkMemoryBarrier">VkMemoryBarrier</a>
structures.</p>
</li>
<li>
<p><code>bufferMemoryBarrierCount</code> is the length of the
<code>pBufferMemoryBarriers</code> array.</p>
</li>
<li>
<p><code>pBufferMemoryBarriers</code> is a pointer to an array of
<a href="#VkBufferMemoryBarrier">VkBufferMemoryBarrier</a> structures.</p>
</li>
<li>
<p><code>imageMemoryBarrierCount</code> is the length of the
<code>pImageMemoryBarriers</code> array.</p>
</li>
<li>
<p><code>pImageMemoryBarriers</code> is a pointer to an array of
<a href="#VkImageMemoryBarrier">VkImageMemoryBarrier</a> structures.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkCmdWaitEvents</code> is largely similar to <a href="#vkCmdWaitEvents2">vkCmdWaitEvents2</a>, but <strong>can</strong>
only wait on signal operations defined by <a href="#vkCmdSetEvent">vkCmdSetEvent</a>.
As <a href="#vkCmdSetEvent">vkCmdSetEvent</a> does not define any access scopes,
<code>vkCmdWaitEvents</code> defines the first access scope for each event signal
operation in addition to its own access scopes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Since <a href="#vkCmdSetEvent">vkCmdSetEvent</a> does not have any dependency information beyond a
stage mask, implementations do not have the same opportunity to perform
<a href="#synchronization-dependencies-available-and-visible">availability and visibility operations</a> or <a href="#synchronization-image-layout-transitions">image layout transitions</a> in advance as they do with <a href="#vkCmdSetEvent2">vkCmdSetEvent2</a> and
<a href="#vkCmdWaitEvents2">vkCmdWaitEvents2</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When <code>vkCmdWaitEvents</code> is submitted to a queue, it defines a memory
dependency between prior event signal operations on the same queue or the
host, and subsequent commands.
<code>vkCmdWaitEvents</code> <strong>must</strong> not be used to wait on event signal operations
occurring on other queues.</p>
</div>
<div class="paragraph">
<p>The first synchronization scope only includes event signal operations that
operate on members of <code>pEvents</code>, and the operations that happened-before
the event signal operations.
Event signal operations performed by <a href="#vkCmdSetEvent">vkCmdSetEvent</a> that occur earlier
in <a href="#synchronization-submission-order">submission order</a> are included in the
first synchronization scope, if the <a href="#synchronization-pipeline-stages-order">logically latest</a> pipeline stage in their <code>stageMask</code> parameter is
<a href="#synchronization-pipeline-stages-order">logically earlier</a> than or equal
to the <a href="#synchronization-pipeline-stages-order">logically latest</a> pipeline
stage in <code>srcStageMask</code>.
Event signal operations performed by <a href="#vkSetEvent">vkSetEvent</a> are only included in
the first synchronization scope if <code>VK_PIPELINE_STAGE_HOST_BIT</code> is
included in <code>srcStageMask</code>.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands that occur later in
<a href="#synchronization-submission-order">submission order</a>.
The second synchronization scope is limited to operations on the pipeline
stages determined by the <a href="#synchronization-pipeline-stages-masks">destination stage mask</a> specified by <code>dstStageMask</code>.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to accesses in the pipeline stages determined by the
<a href="#synchronization-pipeline-stages-masks">source stage mask</a> specified by
<code>srcStageMask</code>.
Within that, the first access scope only includes the first access scopes
defined by elements of the <code>pMemoryBarriers</code>,
<code>pBufferMemoryBarriers</code> and <code>pImageMemoryBarriers</code> arrays, which
each define a set of <a href="#synchronization-memory-barriers">memory barriers</a>.
If no memory barriers are specified, then the first access scope includes no
accesses.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to accesses in the pipeline stages determined by the
<a href="#synchronization-pipeline-stages-masks">destination stage mask</a> specified
by <code>dstStageMask</code>.
Within that, the second access scope only includes the second access scopes
defined by elements of the <code>pMemoryBarriers</code>,
<code>pBufferMemoryBarriers</code> and <code>pImageMemoryBarriers</code> arrays, which
each define a set of <a href="#synchronization-memory-barriers">memory barriers</a>.
If no memory barriers are specified, then the second access scope includes
no accesses.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-04090" href="#VUID-vkCmdWaitEvents-srcStageMask-04090"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcStageMask-04090</span><br>

If the <a href="features.html#features-geometryShader" class="xref page"><code>geometryShader</code></a> feature is not
enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-04091" href="#VUID-vkCmdWaitEvents-srcStageMask-04091"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcStageMask-04091</span><br>

If the <a href="features.html#features-tessellationShader" class="xref page"><code>tessellationShader</code></a> feature
is not enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-04092" href="#VUID-vkCmdWaitEvents-srcStageMask-04092"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcStageMask-04092</span><br>

If the <a href="features.html#features-conditionalRendering" class="xref page"><code>conditionalRendering</code></a>
feature is not enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_CONDITIONAL_RENDERING_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-04093" href="#VUID-vkCmdWaitEvents-srcStageMask-04093"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcStageMask-04093</span><br>

If the <a href="features.html#features-fragmentDensityMap" class="xref page"><code>fragmentDensityMap</code></a> feature
is not enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-04094" href="#VUID-vkCmdWaitEvents-srcStageMask-04094"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcStageMask-04094</span><br>

If the <a href="features.html#features-transformFeedback" class="xref page"><code>transformFeedback</code></a> feature
is not enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TRANSFORM_FEEDBACK_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-04095" href="#VUID-vkCmdWaitEvents-srcStageMask-04095"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcStageMask-04095</span><br>

If the <a href="features.html#features-meshShader" class="xref page"><code>meshShader</code></a> feature is not enabled,
<code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-04096" href="#VUID-vkCmdWaitEvents-srcStageMask-04096"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcStageMask-04096</span><br>

If the <a href="features.html#features-taskShader" class="xref page"><code>taskShader</code></a> feature is not enabled,
<code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-07318" href="#VUID-vkCmdWaitEvents-srcStageMask-07318"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcStageMask-07318</span><br>

If neither the <a href="features.html#features-shadingRateImage" class="xref page"><code>shadingRateImage</code></a> or
<a href="features.html#features-attachmentFragmentShadingRate" class="xref page">    <code>attachmentFragmentShadingRate</code></a> are enabled, <code>srcStageMask</code>
<strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-03937" href="#VUID-vkCmdWaitEvents-srcStageMask-03937"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcStageMask-03937</span><br>

If the <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature is
not enabled, <code>srcStageMask</code> <strong>must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-07949" href="#VUID-vkCmdWaitEvents-srcStageMask-07949"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcStageMask-07949</span><br>

If neither the <a href="../appendices/extensions.html#VK_NV_ray_tracing" class="xref page">VK_NV_ray_tracing</a> extension or
<a href="features.html#features-rayTracingPipeline" class="xref page"><code>rayTracingPipeline</code> feature</a> are
enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcAccessMask-06257" href="#VUID-vkCmdWaitEvents-srcAccessMask-06257"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcAccessMask-06257</span><br>

If
the <a href="features.html#features-rayQuery" class="xref page"><code>rayQuery</code></a> feature is not enabled and
a memory barrier <code>srcAccessMask</code> includes
<code>VK_ACCESS_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>,
<code>srcStageMask</code> <strong>must</strong> not include any of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages
except <code>VK_PIPELINE_STAGE_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-04090" href="#VUID-vkCmdWaitEvents-dstStageMask-04090"></a> <span class="vuid">VUID-vkCmdWaitEvents-dstStageMask-04090</span><br>

If the <a href="features.html#features-geometryShader" class="xref page"><code>geometryShader</code></a> feature is not
enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-04091" href="#VUID-vkCmdWaitEvents-dstStageMask-04091"></a> <span class="vuid">VUID-vkCmdWaitEvents-dstStageMask-04091</span><br>

If the <a href="features.html#features-tessellationShader" class="xref page"><code>tessellationShader</code></a> feature
is not enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-04092" href="#VUID-vkCmdWaitEvents-dstStageMask-04092"></a> <span class="vuid">VUID-vkCmdWaitEvents-dstStageMask-04092</span><br>

If the <a href="features.html#features-conditionalRendering" class="xref page"><code>conditionalRendering</code></a>
feature is not enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_CONDITIONAL_RENDERING_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-04093" href="#VUID-vkCmdWaitEvents-dstStageMask-04093"></a> <span class="vuid">VUID-vkCmdWaitEvents-dstStageMask-04093</span><br>

If the <a href="features.html#features-fragmentDensityMap" class="xref page"><code>fragmentDensityMap</code></a> feature
is not enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-04094" href="#VUID-vkCmdWaitEvents-dstStageMask-04094"></a> <span class="vuid">VUID-vkCmdWaitEvents-dstStageMask-04094</span><br>

If the <a href="features.html#features-transformFeedback" class="xref page"><code>transformFeedback</code></a> feature
is not enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TRANSFORM_FEEDBACK_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-04095" href="#VUID-vkCmdWaitEvents-dstStageMask-04095"></a> <span class="vuid">VUID-vkCmdWaitEvents-dstStageMask-04095</span><br>

If the <a href="features.html#features-meshShader" class="xref page"><code>meshShader</code></a> feature is not enabled,
<code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-04096" href="#VUID-vkCmdWaitEvents-dstStageMask-04096"></a> <span class="vuid">VUID-vkCmdWaitEvents-dstStageMask-04096</span><br>

If the <a href="features.html#features-taskShader" class="xref page"><code>taskShader</code></a> feature is not enabled,
<code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-07318" href="#VUID-vkCmdWaitEvents-dstStageMask-07318"></a> <span class="vuid">VUID-vkCmdWaitEvents-dstStageMask-07318</span><br>

If neither the <a href="features.html#features-shadingRateImage" class="xref page"><code>shadingRateImage</code></a> or
<a href="features.html#features-attachmentFragmentShadingRate" class="xref page">    <code>attachmentFragmentShadingRate</code></a> are enabled, <code>dstStageMask</code>
<strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-03937" href="#VUID-vkCmdWaitEvents-dstStageMask-03937"></a> <span class="vuid">VUID-vkCmdWaitEvents-dstStageMask-03937</span><br>

If the <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature is
not enabled, <code>dstStageMask</code> <strong>must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-07949" href="#VUID-vkCmdWaitEvents-dstStageMask-07949"></a> <span class="vuid">VUID-vkCmdWaitEvents-dstStageMask-07949</span><br>

If neither the <a href="../appendices/extensions.html#VK_NV_ray_tracing" class="xref page">VK_NV_ray_tracing</a> extension or
<a href="features.html#features-rayTracingPipeline" class="xref page"><code>rayTracingPipeline</code> feature</a> are
enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstAccessMask-06257" href="#VUID-vkCmdWaitEvents-dstAccessMask-06257"></a> <span class="vuid">VUID-vkCmdWaitEvents-dstAccessMask-06257</span><br>

If
the <a href="features.html#features-rayQuery" class="xref page"><code>rayQuery</code></a> feature is not enabled and
a memory barrier <code>dstAccessMask</code> includes
<code>VK_ACCESS_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>,
<code>dstStageMask</code> <strong>must</strong> not include any of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages
except <code>VK_PIPELINE_STAGE_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcAccessMask-02815" href="#VUID-vkCmdWaitEvents-srcAccessMask-02815"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcAccessMask-02815</span><br>

The <code>srcAccessMask</code> member of each element of <code>pMemoryBarriers</code>
<strong>must</strong> only include access flags that are supported by one or more of the
pipeline stages in <code>srcStageMask</code>, as specified in the
<a href="#synchronization-access-types-supported">table of supported access    types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstAccessMask-02816" href="#VUID-vkCmdWaitEvents-dstAccessMask-02816"></a> <span class="vuid">VUID-vkCmdWaitEvents-dstAccessMask-02816</span><br>

The <code>dstAccessMask</code> member of each element of <code>pMemoryBarriers</code>
<strong>must</strong> only include access flags that are supported by one or more of the
pipeline stages in <code>dstStageMask</code>, as specified in the
<a href="#synchronization-access-types-supported">table of supported access    types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pBufferMemoryBarriers-02817" href="#VUID-vkCmdWaitEvents-pBufferMemoryBarriers-02817"></a> <span class="vuid">VUID-vkCmdWaitEvents-pBufferMemoryBarriers-02817</span><br>

For any element of <code>pBufferMemoryBarriers</code>, if its
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members are
equal, or if its <code>srcQueueFamilyIndex</code> is the queue family index
that was used to create the command pool that <code>commandBuffer</code> was
allocated from, then its <code>srcAccessMask</code> member <strong>must</strong> only contain
access flags that are supported by one or more of the pipeline stages in
<code>srcStageMask</code>, as specified in the
<a href="#synchronization-access-types-supported">table of supported access    types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pBufferMemoryBarriers-02818" href="#VUID-vkCmdWaitEvents-pBufferMemoryBarriers-02818"></a> <span class="vuid">VUID-vkCmdWaitEvents-pBufferMemoryBarriers-02818</span><br>

For any element of <code>pBufferMemoryBarriers</code>, if its
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members are
equal, or if its <code>dstQueueFamilyIndex</code> is the queue family index
that was used to create the command pool that <code>commandBuffer</code> was
allocated from, then its <code>dstAccessMask</code> member <strong>must</strong> only contain
access flags that are supported by one or more of the pipeline stages in
<code>dstStageMask</code>, as specified in the
<a href="#synchronization-access-types-supported">table of supported access    types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pImageMemoryBarriers-02819" href="#VUID-vkCmdWaitEvents-pImageMemoryBarriers-02819"></a> <span class="vuid">VUID-vkCmdWaitEvents-pImageMemoryBarriers-02819</span><br>

For any element of <code>pImageMemoryBarriers</code>, if its
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members are
equal, or if its <code>srcQueueFamilyIndex</code> is the queue family index
that was used to create the command pool that <code>commandBuffer</code> was
allocated from, then its <code>srcAccessMask</code> member <strong>must</strong> only contain
access flags that are supported by one or more of the pipeline stages in
<code>srcStageMask</code>, as specified in the
<a href="#synchronization-access-types-supported">table of supported access    types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pImageMemoryBarriers-02820" href="#VUID-vkCmdWaitEvents-pImageMemoryBarriers-02820"></a> <span class="vuid">VUID-vkCmdWaitEvents-pImageMemoryBarriers-02820</span><br>

For any element of <code>pImageMemoryBarriers</code>, if its
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members are
equal, or if its <code>dstQueueFamilyIndex</code> is the queue family index
that was used to create the command pool that <code>commandBuffer</code> was
allocated from, then its <code>dstAccessMask</code> member <strong>must</strong> only contain
access flags that are supported by one or more of the pipeline stages in
<code>dstStageMask</code>, as specified in the
<a href="#synchronization-access-types-supported">table of supported access    types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-06459" href="#VUID-vkCmdWaitEvents-srcStageMask-06459"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcStageMask-06459</span><br>

Any pipeline stage included in <code>srcStageMask</code> <strong>must</strong> be supported by
the capabilities of the queue family specified by the
<code>queueFamilyIndex</code> member of the <a href="cmdbuffers.html#VkCommandPoolCreateInfo" class="xref page">VkCommandPoolCreateInfo</a>
structure that was used to create the <code>VkCommandPool</code> that
<code>commandBuffer</code> was allocated from, as specified in the
<a href="#synchronization-pipeline-stages-supported">table of supported pipeline    stages</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-06460" href="#VUID-vkCmdWaitEvents-dstStageMask-06460"></a> <span class="vuid">VUID-vkCmdWaitEvents-dstStageMask-06460</span><br>

Any pipeline stage included in <code>dstStageMask</code> <strong>must</strong> be supported by
the capabilities of the queue family specified by the
<code>queueFamilyIndex</code> member of the <a href="cmdbuffers.html#VkCommandPoolCreateInfo" class="xref page">VkCommandPoolCreateInfo</a>
structure that was used to create the <code>VkCommandPool</code> that
<code>commandBuffer</code> was allocated from, as specified in the
<a href="#synchronization-pipeline-stages-supported">table of supported pipeline    stages</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-01158" href="#VUID-vkCmdWaitEvents-srcStageMask-01158"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcStageMask-01158</span><br>

<code>srcStageMask</code> <strong>must</strong> be the bitwise OR of the <code>stageMask</code>
parameter used in previous calls to <code>vkCmdSetEvent</code> with any of the
elements of <code>pEvents</code> and <code>VK_PIPELINE_STAGE_HOST_BIT</code> if any of
the elements of <code>pEvents</code> was set using <code>vkSetEvent</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-07308" href="#VUID-vkCmdWaitEvents-srcStageMask-07308"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcStageMask-07308</span><br>

If <code>vkCmdWaitEvents</code> is being called inside a render pass instance,
<code>srcStageMask</code> <strong>must</strong> not include <code>VK_PIPELINE_STAGE_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcQueueFamilyIndex-02803" href="#VUID-vkCmdWaitEvents-srcQueueFamilyIndex-02803"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcQueueFamilyIndex-02803</span><br>

The <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members of
any element of <code>pBufferMemoryBarriers</code> or <code>pImageMemoryBarriers</code>
<strong>must</strong> be equal</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-commandBuffer-01167" href="#VUID-vkCmdWaitEvents-commandBuffer-01167"></a> <span class="vuid">VUID-vkCmdWaitEvents-commandBuffer-01167</span><br>

<code>commandBuffer</code>&#8217;s current device mask <strong>must</strong> include exactly one
physical device</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pEvents-03847" href="#VUID-vkCmdWaitEvents-pEvents-03847"></a> <span class="vuid">VUID-vkCmdWaitEvents-pEvents-03847</span><br>

Elements of <code>pEvents</code> <strong>must</strong> not have been signaled by
<a href="#vkCmdSetEvent2">vkCmdSetEvent2</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWaitEvents-commandBuffer-parameter" href="#VUID-vkCmdWaitEvents-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdWaitEvents-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pEvents-parameter" href="#VUID-vkCmdWaitEvents-pEvents-parameter"></a> <span class="vuid">VUID-vkCmdWaitEvents-pEvents-parameter</span><br>
 <code>pEvents</code> <strong>must</strong> be a valid pointer to an array of <code>eventCount</code> valid <a href="#VkEvent">VkEvent</a> handles</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-parameter" href="#VUID-vkCmdWaitEvents-srcStageMask-parameter"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcStageMask-parameter</span><br>
 <code>srcStageMask</code> <strong>must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-parameter" href="#VUID-vkCmdWaitEvents-dstStageMask-parameter"></a> <span class="vuid">VUID-vkCmdWaitEvents-dstStageMask-parameter</span><br>
 <code>dstStageMask</code> <strong>must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pMemoryBarriers-parameter" href="#VUID-vkCmdWaitEvents-pMemoryBarriers-parameter"></a> <span class="vuid">VUID-vkCmdWaitEvents-pMemoryBarriers-parameter</span><br>
 If <code>memoryBarrierCount</code> is not <code>0</code>, <code>pMemoryBarriers</code> <strong>must</strong> be a valid pointer to an array of <code>memoryBarrierCount</code> valid <a href="#VkMemoryBarrier">VkMemoryBarrier</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pBufferMemoryBarriers-parameter" href="#VUID-vkCmdWaitEvents-pBufferMemoryBarriers-parameter"></a> <span class="vuid">VUID-vkCmdWaitEvents-pBufferMemoryBarriers-parameter</span><br>
 If <code>bufferMemoryBarrierCount</code> is not <code>0</code>, <code>pBufferMemoryBarriers</code> <strong>must</strong> be a valid pointer to an array of <code>bufferMemoryBarrierCount</code> valid <a href="#VkBufferMemoryBarrier">VkBufferMemoryBarrier</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pImageMemoryBarriers-parameter" href="#VUID-vkCmdWaitEvents-pImageMemoryBarriers-parameter"></a> <span class="vuid">VUID-vkCmdWaitEvents-pImageMemoryBarriers-parameter</span><br>
 If <code>imageMemoryBarrierCount</code> is not <code>0</code>, <code>pImageMemoryBarriers</code> <strong>must</strong> be a valid pointer to an array of <code>imageMemoryBarrierCount</code> valid <a href="#VkImageMemoryBarrier">VkImageMemoryBarrier</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-commandBuffer-recording" href="#VUID-vkCmdWaitEvents-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdWaitEvents-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-commandBuffer-cmdpool" href="#VUID-vkCmdWaitEvents-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdWaitEvents-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics, compute, decode, or encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-eventCount-arraylength" href="#VUID-vkCmdWaitEvents-eventCount-arraylength"></a> <span class="vuid">VUID-vkCmdWaitEvents-eventCount-arraylength</span><br>
 <code>eventCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-commonparent" href="#VUID-vkCmdWaitEvents-commonparent"></a> <span class="vuid">VUID-vkCmdWaitEvents-commonparent</span><br>
 Both of <code>commandBuffer</code>, and the elements of <code>pEvents</code> <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute<br>
Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Synchronization</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="synchronization-pipeline-barriers"><a class="anchor" href="#synchronization-pipeline-barriers"></a>Pipeline Barriers</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To record a pipeline barrier, call:</p>
</div>
<div id="vkCmdPipelineBarrier2" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
void vkCmdPipelineBarrier2(
    VkCommandBuffer                             commandBuffer,
    const VkDependencyInfo*                     pDependencyInfo);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent command</p>
</div>
<div id="vkCmdPipelineBarrier2KHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_synchronization2
void vkCmdPipelineBarrier2KHR(
    VkCommandBuffer                             commandBuffer,
    const VkDependencyInfo*                     pDependencyInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command is
recorded.</p>
</li>
<li>
<p><code>pDependencyInfo</code> is a pointer to a <a href="#VkDependencyInfo">VkDependencyInfo</a> structure
defining the scopes of this operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <a href="#vkCmdPipelineBarrier2">vkCmdPipelineBarrier2</a> is submitted to a queue, it defines memory
dependencies between commands that were submitted to the same queue before
it, and those submitted to the same queue after it.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-scopes">synchronization scope</a> and
<a href="#synchronization-dependencies-access-scopes">access scope</a> of each memory
dependency defined by <code>pDependencyInfo</code> are applied to operations that
occurred earlier in <a href="#synchronization-submission-order">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
and <a href="#synchronization-dependencies-access-scopes">access scope</a> of each
memory dependency defined by <code>pDependencyInfo</code> are applied to operations
that occurred later in <a href="#synchronization-submission-order">submission order</a>.</p>
</div>
<div class="paragraph">
<p>If <code>vkCmdPipelineBarrier2</code> is recorded within a render pass instance,
the synchronization scopes are limited to operations within the same subpass
, or <strong>must</strong> follow the restrictions for
<a href="#synchronization-pipeline-barriers-explicit-renderpass-tileimage">Tile Image Access Synchronization</a> if the render pass instance was started with
<a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a>
.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-None-07889" href="#VUID-vkCmdPipelineBarrier2-None-07889"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-None-07889</span><br>

If <code>vkCmdPipelineBarrier2</code> is called within a render pass instance using a
<a href="renderpass.html#VkRenderPass" class="xref page">VkRenderPass</a> object, the render pass <strong>must</strong> have been created with
at least one subpass dependency that expresses a dependency from the
current subpass to itself, does not include
<code>VK_DEPENDENCY_BY_REGION_BIT</code> if this command does not, does not
include <code>VK_DEPENDENCY_VIEW_LOCAL_BIT</code> if this command does not, and
has <a href="#synchronization-dependencies-scopes">synchronization scopes</a> and
<a href="#synchronization-dependencies-access-scopes">access scopes</a> that are
all supersets of the scopes defined in this command</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-bufferMemoryBarrierCount-01178" href="#VUID-vkCmdPipelineBarrier2-bufferMemoryBarrierCount-01178"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-bufferMemoryBarrierCount-01178</span><br>

If <code>vkCmdPipelineBarrier2</code> is called within a render pass instance using a
<a href="renderpass.html#VkRenderPass" class="xref page">VkRenderPass</a> object, it <strong>must</strong> not include any buffer memory
barriers</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-image-04073" href="#VUID-vkCmdPipelineBarrier2-image-04073"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-image-04073</span><br>

If <code>vkCmdPipelineBarrier2</code> is called within a render pass instance using a
<a href="renderpass.html#VkRenderPass" class="xref page">VkRenderPass</a> object, the <code>image</code> member of any image memory
barrier included in this command <strong>must</strong> be an attachment used in the
current subpass both as an input attachment, and as either a color,
color resolve,
or depth/stencil attachment</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-image-09373" href="#VUID-vkCmdPipelineBarrier2-image-09373"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-image-09373</span><br>

If <code>vkCmdPipelineBarrier2</code> is called within a render pass instance using a
<a href="renderpass.html#VkRenderPass" class="xref page">VkRenderPass</a> object, and the <code>image</code> member of any image
memory barrier is a color resolve attachment, the corresponding color
attachment <strong>must</strong> be <code>VK_ATTACHMENT_UNUSED</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-image-09374" href="#VUID-vkCmdPipelineBarrier2-image-09374"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-image-09374</span><br>

If <code>vkCmdPipelineBarrier2</code> is called within a render pass instance using a
<a href="renderpass.html#VkRenderPass" class="xref page">VkRenderPass</a> object, and the <code>image</code> member of any image
memory barrier is a color resolve attachment, it <strong>must</strong> have been created
with a non-zero <a href="resources.html#VkExternalFormatANDROID" class="xref page">VkExternalFormatANDROID</a>::<code>externalFormat</code>
value</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-oldLayout-01181" href="#VUID-vkCmdPipelineBarrier2-oldLayout-01181"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-oldLayout-01181</span><br>

If <code>vkCmdPipelineBarrier2</code> is called within a render pass instance, the
<code>oldLayout</code> and <code>newLayout</code> members of any image memory barrier
included in this command <strong>must</strong> be equal</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-srcQueueFamilyIndex-01182" href="#VUID-vkCmdPipelineBarrier2-srcQueueFamilyIndex-01182"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-srcQueueFamilyIndex-01182</span><br>

If <code>vkCmdPipelineBarrier2</code> is called within a render pass instance, the
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members of any
memory barrier included in this command <strong>must</strong> be equal</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-None-07890" href="#VUID-vkCmdPipelineBarrier2-None-07890"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-None-07890</span><br>

If <code>vkCmdPipelineBarrier2</code> is called within a render pass instance, and the
source stage masks of any memory barriers include
<a href="#synchronization-framebuffer-regions">framebuffer-space stages</a>,
destination stage masks of all memory barriers <strong>must</strong> only include
<a href="#synchronization-framebuffer-regions">framebuffer-space stages</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-dependencyFlags-07891" href="#VUID-vkCmdPipelineBarrier2-dependencyFlags-07891"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-dependencyFlags-07891</span><br>

If <code>vkCmdPipelineBarrier2</code> is called within a render pass instance, and and the
source stage masks of any memory barriers include
<a href="#synchronization-framebuffer-regions">framebuffer-space stages</a>, then
<code>dependencyFlags</code> <strong>must</strong> include <code>VK_DEPENDENCY_BY_REGION_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-None-07892" href="#VUID-vkCmdPipelineBarrier2-None-07892"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-None-07892</span><br>

If <code>vkCmdPipelineBarrier2</code> is called within a render pass instance, the source
and destination stage masks of any memory barriers <strong>must</strong> only include
graphics pipeline stages</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-dependencyFlags-01186" href="#VUID-vkCmdPipelineBarrier2-dependencyFlags-01186"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-dependencyFlags-01186</span><br>

If <code>vkCmdPipelineBarrier2</code> is called outside of a render pass instance, the
dependency flags <strong>must</strong> not include <code>VK_DEPENDENCY_VIEW_LOCAL_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-None-07893" href="#VUID-vkCmdPipelineBarrier2-None-07893"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-None-07893</span><br>

If <code>vkCmdPipelineBarrier2</code> is called inside a render pass instance, and there is
more than one view in the current subpass, dependency flags <strong>must</strong>
include <code>VK_DEPENDENCY_VIEW_LOCAL_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-shaderTileImageColorReadAccess-08718" href="#VUID-vkCmdPipelineBarrier2-shaderTileImageColorReadAccess-08718"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-shaderTileImageColorReadAccess-08718</span><br>

If <code>vkCmdPipelineBarrier2</code> is called within a render pass instance
and none of the <a href="features.html#features-shaderTileImageColorReadAccess" class="xref page">    <code>shaderTileImageColorReadAccess</code></a>,
<a href="features.html#features-shaderTileImageDepthReadAccess" class="xref page">    <code>shaderTileImageDepthReadAccess</code></a>,
<a href="features.html#features-shaderTileImageStencilReadAccess" class="xref page">    <code>shaderTileImageStencilReadAccess</code></a> features are enabled,
the render pass <strong>must</strong> not have been started with
<a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-None-08719" href="#VUID-vkCmdPipelineBarrier2-None-08719"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-None-08719</span><br>

If <code>vkCmdPipelineBarrier2</code> is called within a render pass instance started with
<a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a>, it <strong>must</strong> adhere to the restrictions in
<a href="#synchronization-pipeline-barriers-explicit-renderpass-tileimage">    Explicit Render Pass Tile Image Access Synchronization</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-synchronization2-03848" href="#VUID-vkCmdPipelineBarrier2-synchronization2-03848"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-synchronization2-03848</span><br>

The <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature <strong>must</strong>
be enabled</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-srcStageMask-03849" href="#VUID-vkCmdPipelineBarrier2-srcStageMask-03849"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-srcStageMask-03849</span><br>

The <code>srcStageMask</code> member of any element of the
<code>pMemoryBarriers</code>, <code>pBufferMemoryBarriers</code>, or
<code>pImageMemoryBarriers</code> members of <code>pDependencyInfo</code> <strong>must</strong> only
include pipeline stages valid for the queue family that was used to
create the command pool that <code>commandBuffer</code> was allocated from</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-dstStageMask-03850" href="#VUID-vkCmdPipelineBarrier2-dstStageMask-03850"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-dstStageMask-03850</span><br>

The <code>dstStageMask</code> member of any element of the
<code>pMemoryBarriers</code>, <code>pBufferMemoryBarriers</code>, or
<code>pImageMemoryBarriers</code> members of <code>pDependencyInfo</code> <strong>must</strong> only
include pipeline stages valid for the queue family that was used to
create the command pool that <code>commandBuffer</code> was allocated from</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-commandBuffer-parameter" href="#VUID-vkCmdPipelineBarrier2-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-pDependencyInfo-parameter" href="#VUID-vkCmdPipelineBarrier2-pDependencyInfo-parameter"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-pDependencyInfo-parameter</span><br>
 <code>pDependencyInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkDependencyInfo">VkDependencyInfo</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-commandBuffer-recording" href="#VUID-vkCmdPipelineBarrier2-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier2-commandBuffer-cmdpool" href="#VUID-vkCmdPipelineBarrier2-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdPipelineBarrier2-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support transfer, graphics, compute, decode, or encode operations</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transfer<br>
Graphics<br>
Compute<br>
Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Synchronization</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To record a pipeline barrier, call:</p>
</div>
<div id="vkCmdPipelineBarrier" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkCmdPipelineBarrier(
    VkCommandBuffer                             commandBuffer,
    VkPipelineStageFlags                        srcStageMask,
    VkPipelineStageFlags                        dstStageMask,
    VkDependencyFlags                           dependencyFlags,
    uint32_t                                    memoryBarrierCount,
    const VkMemoryBarrier*                      pMemoryBarriers,
    uint32_t                                    bufferMemoryBarrierCount,
    const VkBufferMemoryBarrier*                pBufferMemoryBarriers,
    uint32_t                                    imageMemoryBarrierCount,
    const VkImageMemoryBarrier*                 pImageMemoryBarriers);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command is
recorded.</p>
</li>
<li>
<p><code>srcStageMask</code> is a bitmask of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a>
specifying the <a href="#synchronization-pipeline-stages-masks">source stages</a>.</p>
</li>
<li>
<p><code>dstStageMask</code> is a bitmask of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a>
specifying the <a href="#synchronization-pipeline-stages-masks">destination    stages</a>.</p>
</li>
<li>
<p><code>dependencyFlags</code> is a bitmask of <a href="#VkDependencyFlagBits">VkDependencyFlagBits</a>
specifying how execution and memory dependencies are formed.</p>
</li>
<li>
<p><code>memoryBarrierCount</code> is the length of the <code>pMemoryBarriers</code>
array.</p>
</li>
<li>
<p><code>pMemoryBarriers</code> is a pointer to an array of <a href="#VkMemoryBarrier">VkMemoryBarrier</a>
structures.</p>
</li>
<li>
<p><code>bufferMemoryBarrierCount</code> is the length of the
<code>pBufferMemoryBarriers</code> array.</p>
</li>
<li>
<p><code>pBufferMemoryBarriers</code> is a pointer to an array of
<a href="#VkBufferMemoryBarrier">VkBufferMemoryBarrier</a> structures.</p>
</li>
<li>
<p><code>imageMemoryBarrierCount</code> is the length of the
<code>pImageMemoryBarriers</code> array.</p>
</li>
<li>
<p><code>pImageMemoryBarriers</code> is a pointer to an array of
<a href="#VkImageMemoryBarrier">VkImageMemoryBarrier</a> structures.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkCmdPipelineBarrier</code> operates almost identically to
<a href="#vkCmdPipelineBarrier2">vkCmdPipelineBarrier2</a>, except that the scopes and barriers are defined
as direct parameters rather than being defined by an <a href="#VkDependencyInfo">VkDependencyInfo</a>.</p>
</div>
<div class="paragraph">
<p>When <a href="#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a> is submitted to a queue, it defines a memory
dependency between commands that were submitted to the same queue before it,
and those submitted to the same queue after it.</p>
</div>
<div class="paragraph">
<p>If <a href="#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a> was recorded outside a render pass instance,
the first <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands that occur earlier in
<a href="#synchronization-submission-order">submission order</a>.
If <a href="#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a> was recorded inside a render pass instance,
the first synchronization scope includes only commands that occur earlier in
<a href="#synchronization-submission-order">submission order</a> within the same
subpass.
In either case, the first synchronization scope is limited to operations on
the pipeline stages determined by the
<a href="#synchronization-pipeline-stages-masks">source stage mask</a> specified by
<code>srcStageMask</code>.</p>
</div>
<div class="paragraph">
<p>If <a href="#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a> was recorded outside a render pass instance,
the second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands that occur later in
<a href="#synchronization-submission-order">submission order</a>.
If <a href="#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a> was recorded inside a render pass instance,
the second synchronization scope includes only commands that occur later in
<a href="#synchronization-submission-order">submission order</a> within the same
subpass.
In either case, the second synchronization scope is limited to operations on
the pipeline stages determined by the
<a href="#synchronization-pipeline-stages-masks">destination stage mask</a> specified
by <code>dstStageMask</code>.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to accesses in the pipeline stages determined by the
<a href="#synchronization-pipeline-stages-masks">source stage mask</a> specified by
<code>srcStageMask</code>.
Within that, the first access scope only includes the first access scopes
defined by elements of the <code>pMemoryBarriers</code>,
<code>pBufferMemoryBarriers</code> and <code>pImageMemoryBarriers</code> arrays, which
each define a set of <a href="#synchronization-memory-barriers">memory barriers</a>.
If no memory barriers are specified, then the first access scope includes no
accesses.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to accesses in the pipeline stages determined by the
<a href="#synchronization-pipeline-stages-masks">destination stage mask</a> specified
by <code>dstStageMask</code>.
Within that, the second access scope only includes the second access scopes
defined by elements of the <code>pMemoryBarriers</code>,
<code>pBufferMemoryBarriers</code> and <code>pImageMemoryBarriers</code> arrays, which
each define a set of <a href="#synchronization-memory-barriers">memory barriers</a>.
If no memory barriers are specified, then the second access scope includes
no accesses.</p>
</div>
<div class="paragraph">
<p>If <code>dependencyFlags</code> includes <code>VK_DEPENDENCY_BY_REGION_BIT</code>, then
any dependency between <a href="#synchronization-framebuffer-regions">framebuffer-space</a> pipeline stages is
<a href="#synchronization-framebuffer-regions">framebuffer-local</a> - otherwise it is
<a href="#synchronization-framebuffer-regions">framebuffer-global</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-04090" href="#VUID-vkCmdPipelineBarrier-srcStageMask-04090"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcStageMask-04090</span><br>

If the <a href="features.html#features-geometryShader" class="xref page"><code>geometryShader</code></a> feature is not
enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-04091" href="#VUID-vkCmdPipelineBarrier-srcStageMask-04091"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcStageMask-04091</span><br>

If the <a href="features.html#features-tessellationShader" class="xref page"><code>tessellationShader</code></a> feature
is not enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-04092" href="#VUID-vkCmdPipelineBarrier-srcStageMask-04092"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcStageMask-04092</span><br>

If the <a href="features.html#features-conditionalRendering" class="xref page"><code>conditionalRendering</code></a>
feature is not enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_CONDITIONAL_RENDERING_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-04093" href="#VUID-vkCmdPipelineBarrier-srcStageMask-04093"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcStageMask-04093</span><br>

If the <a href="features.html#features-fragmentDensityMap" class="xref page"><code>fragmentDensityMap</code></a> feature
is not enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-04094" href="#VUID-vkCmdPipelineBarrier-srcStageMask-04094"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcStageMask-04094</span><br>

If the <a href="features.html#features-transformFeedback" class="xref page"><code>transformFeedback</code></a> feature
is not enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TRANSFORM_FEEDBACK_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-04095" href="#VUID-vkCmdPipelineBarrier-srcStageMask-04095"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcStageMask-04095</span><br>

If the <a href="features.html#features-meshShader" class="xref page"><code>meshShader</code></a> feature is not enabled,
<code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-04096" href="#VUID-vkCmdPipelineBarrier-srcStageMask-04096"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcStageMask-04096</span><br>

If the <a href="features.html#features-taskShader" class="xref page"><code>taskShader</code></a> feature is not enabled,
<code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-07318" href="#VUID-vkCmdPipelineBarrier-srcStageMask-07318"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcStageMask-07318</span><br>

If neither the <a href="features.html#features-shadingRateImage" class="xref page"><code>shadingRateImage</code></a> or
<a href="features.html#features-attachmentFragmentShadingRate" class="xref page">    <code>attachmentFragmentShadingRate</code></a> are enabled, <code>srcStageMask</code>
<strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-03937" href="#VUID-vkCmdPipelineBarrier-srcStageMask-03937"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcStageMask-03937</span><br>

If the <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature is
not enabled, <code>srcStageMask</code> <strong>must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-07949" href="#VUID-vkCmdPipelineBarrier-srcStageMask-07949"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcStageMask-07949</span><br>

If neither the <a href="../appendices/extensions.html#VK_NV_ray_tracing" class="xref page">VK_NV_ray_tracing</a> extension or
<a href="features.html#features-rayTracingPipeline" class="xref page"><code>rayTracingPipeline</code> feature</a> are
enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcAccessMask-06257" href="#VUID-vkCmdPipelineBarrier-srcAccessMask-06257"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcAccessMask-06257</span><br>

If
the <a href="features.html#features-rayQuery" class="xref page"><code>rayQuery</code></a> feature is not enabled and
a memory barrier <code>srcAccessMask</code> includes
<code>VK_ACCESS_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>,
<code>srcStageMask</code> <strong>must</strong> not include any of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages
except <code>VK_PIPELINE_STAGE_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-04090" href="#VUID-vkCmdPipelineBarrier-dstStageMask-04090"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dstStageMask-04090</span><br>

If the <a href="features.html#features-geometryShader" class="xref page"><code>geometryShader</code></a> feature is not
enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-04091" href="#VUID-vkCmdPipelineBarrier-dstStageMask-04091"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dstStageMask-04091</span><br>

If the <a href="features.html#features-tessellationShader" class="xref page"><code>tessellationShader</code></a> feature
is not enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-04092" href="#VUID-vkCmdPipelineBarrier-dstStageMask-04092"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dstStageMask-04092</span><br>

If the <a href="features.html#features-conditionalRendering" class="xref page"><code>conditionalRendering</code></a>
feature is not enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_CONDITIONAL_RENDERING_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-04093" href="#VUID-vkCmdPipelineBarrier-dstStageMask-04093"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dstStageMask-04093</span><br>

If the <a href="features.html#features-fragmentDensityMap" class="xref page"><code>fragmentDensityMap</code></a> feature
is not enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-04094" href="#VUID-vkCmdPipelineBarrier-dstStageMask-04094"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dstStageMask-04094</span><br>

If the <a href="features.html#features-transformFeedback" class="xref page"><code>transformFeedback</code></a> feature
is not enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TRANSFORM_FEEDBACK_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-04095" href="#VUID-vkCmdPipelineBarrier-dstStageMask-04095"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dstStageMask-04095</span><br>

If the <a href="features.html#features-meshShader" class="xref page"><code>meshShader</code></a> feature is not enabled,
<code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-04096" href="#VUID-vkCmdPipelineBarrier-dstStageMask-04096"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dstStageMask-04096</span><br>

If the <a href="features.html#features-taskShader" class="xref page"><code>taskShader</code></a> feature is not enabled,
<code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-07318" href="#VUID-vkCmdPipelineBarrier-dstStageMask-07318"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dstStageMask-07318</span><br>

If neither the <a href="features.html#features-shadingRateImage" class="xref page"><code>shadingRateImage</code></a> or
<a href="features.html#features-attachmentFragmentShadingRate" class="xref page">    <code>attachmentFragmentShadingRate</code></a> are enabled, <code>dstStageMask</code>
<strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-03937" href="#VUID-vkCmdPipelineBarrier-dstStageMask-03937"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dstStageMask-03937</span><br>

If the <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature is
not enabled, <code>dstStageMask</code> <strong>must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-07949" href="#VUID-vkCmdPipelineBarrier-dstStageMask-07949"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dstStageMask-07949</span><br>

If neither the <a href="../appendices/extensions.html#VK_NV_ray_tracing" class="xref page">VK_NV_ray_tracing</a> extension or
<a href="features.html#features-rayTracingPipeline" class="xref page"><code>rayTracingPipeline</code> feature</a> are
enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstAccessMask-06257" href="#VUID-vkCmdPipelineBarrier-dstAccessMask-06257"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dstAccessMask-06257</span><br>

If
the <a href="features.html#features-rayQuery" class="xref page"><code>rayQuery</code></a> feature is not enabled and
a memory barrier <code>dstAccessMask</code> includes
<code>VK_ACCESS_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>,
<code>dstStageMask</code> <strong>must</strong> not include any of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages
except <code>VK_PIPELINE_STAGE_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcAccessMask-02815" href="#VUID-vkCmdPipelineBarrier-srcAccessMask-02815"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcAccessMask-02815</span><br>

The <code>srcAccessMask</code> member of each element of <code>pMemoryBarriers</code>
<strong>must</strong> only include access flags that are supported by one or more of the
pipeline stages in <code>srcStageMask</code>, as specified in the
<a href="#synchronization-access-types-supported">table of supported access    types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstAccessMask-02816" href="#VUID-vkCmdPipelineBarrier-dstAccessMask-02816"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dstAccessMask-02816</span><br>

The <code>dstAccessMask</code> member of each element of <code>pMemoryBarriers</code>
<strong>must</strong> only include access flags that are supported by one or more of the
pipeline stages in <code>dstStageMask</code>, as specified in the
<a href="#synchronization-access-types-supported">table of supported access    types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pBufferMemoryBarriers-02817" href="#VUID-vkCmdPipelineBarrier-pBufferMemoryBarriers-02817"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-pBufferMemoryBarriers-02817</span><br>

For any element of <code>pBufferMemoryBarriers</code>, if its
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members are
equal, or if its <code>srcQueueFamilyIndex</code> is the queue family index
that was used to create the command pool that <code>commandBuffer</code> was
allocated from, then its <code>srcAccessMask</code> member <strong>must</strong> only contain
access flags that are supported by one or more of the pipeline stages in
<code>srcStageMask</code>, as specified in the
<a href="#synchronization-access-types-supported">table of supported access    types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pBufferMemoryBarriers-02818" href="#VUID-vkCmdPipelineBarrier-pBufferMemoryBarriers-02818"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-pBufferMemoryBarriers-02818</span><br>

For any element of <code>pBufferMemoryBarriers</code>, if its
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members are
equal, or if its <code>dstQueueFamilyIndex</code> is the queue family index
that was used to create the command pool that <code>commandBuffer</code> was
allocated from, then its <code>dstAccessMask</code> member <strong>must</strong> only contain
access flags that are supported by one or more of the pipeline stages in
<code>dstStageMask</code>, as specified in the
<a href="#synchronization-access-types-supported">table of supported access    types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pImageMemoryBarriers-02819" href="#VUID-vkCmdPipelineBarrier-pImageMemoryBarriers-02819"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-pImageMemoryBarriers-02819</span><br>

For any element of <code>pImageMemoryBarriers</code>, if its
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members are
equal, or if its <code>srcQueueFamilyIndex</code> is the queue family index
that was used to create the command pool that <code>commandBuffer</code> was
allocated from, then its <code>srcAccessMask</code> member <strong>must</strong> only contain
access flags that are supported by one or more of the pipeline stages in
<code>srcStageMask</code>, as specified in the
<a href="#synchronization-access-types-supported">table of supported access    types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pImageMemoryBarriers-02820" href="#VUID-vkCmdPipelineBarrier-pImageMemoryBarriers-02820"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-pImageMemoryBarriers-02820</span><br>

For any element of <code>pImageMemoryBarriers</code>, if its
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members are
equal, or if its <code>dstQueueFamilyIndex</code> is the queue family index
that was used to create the command pool that <code>commandBuffer</code> was
allocated from, then its <code>dstAccessMask</code> member <strong>must</strong> only contain
access flags that are supported by one or more of the pipeline stages in
<code>dstStageMask</code>, as specified in the
<a href="#synchronization-access-types-supported">table of supported access    types</a></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-None-07889" href="#VUID-vkCmdPipelineBarrier-None-07889"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-None-07889</span><br>

If <code>vkCmdPipelineBarrier</code> is called within a render pass instance using a
<a href="renderpass.html#VkRenderPass" class="xref page">VkRenderPass</a> object, the render pass <strong>must</strong> have been created with
at least one subpass dependency that expresses a dependency from the
current subpass to itself, does not include
<code>VK_DEPENDENCY_BY_REGION_BIT</code> if this command does not, does not
include <code>VK_DEPENDENCY_VIEW_LOCAL_BIT</code> if this command does not, and
has <a href="#synchronization-dependencies-scopes">synchronization scopes</a> and
<a href="#synchronization-dependencies-access-scopes">access scopes</a> that are
all supersets of the scopes defined in this command</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-bufferMemoryBarrierCount-01178" href="#VUID-vkCmdPipelineBarrier-bufferMemoryBarrierCount-01178"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-bufferMemoryBarrierCount-01178</span><br>

If <code>vkCmdPipelineBarrier</code> is called within a render pass instance using a
<a href="renderpass.html#VkRenderPass" class="xref page">VkRenderPass</a> object, it <strong>must</strong> not include any buffer memory
barriers</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-image-04073" href="#VUID-vkCmdPipelineBarrier-image-04073"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-image-04073</span><br>

If <code>vkCmdPipelineBarrier</code> is called within a render pass instance using a
<a href="renderpass.html#VkRenderPass" class="xref page">VkRenderPass</a> object, the <code>image</code> member of any image memory
barrier included in this command <strong>must</strong> be an attachment used in the
current subpass both as an input attachment, and as either a color,
color resolve,
or depth/stencil attachment</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-image-09373" href="#VUID-vkCmdPipelineBarrier-image-09373"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-image-09373</span><br>

If <code>vkCmdPipelineBarrier</code> is called within a render pass instance using a
<a href="renderpass.html#VkRenderPass" class="xref page">VkRenderPass</a> object, and the <code>image</code> member of any image
memory barrier is a color resolve attachment, the corresponding color
attachment <strong>must</strong> be <code>VK_ATTACHMENT_UNUSED</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-image-09374" href="#VUID-vkCmdPipelineBarrier-image-09374"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-image-09374</span><br>

If <code>vkCmdPipelineBarrier</code> is called within a render pass instance using a
<a href="renderpass.html#VkRenderPass" class="xref page">VkRenderPass</a> object, and the <code>image</code> member of any image
memory barrier is a color resolve attachment, it <strong>must</strong> have been created
with a non-zero <a href="resources.html#VkExternalFormatANDROID" class="xref page">VkExternalFormatANDROID</a>::<code>externalFormat</code>
value</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-oldLayout-01181" href="#VUID-vkCmdPipelineBarrier-oldLayout-01181"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-oldLayout-01181</span><br>

If <code>vkCmdPipelineBarrier</code> is called within a render pass instance, the
<code>oldLayout</code> and <code>newLayout</code> members of any image memory barrier
included in this command <strong>must</strong> be equal</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcQueueFamilyIndex-01182" href="#VUID-vkCmdPipelineBarrier-srcQueueFamilyIndex-01182"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcQueueFamilyIndex-01182</span><br>

If <code>vkCmdPipelineBarrier</code> is called within a render pass instance, the
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members of any
memory barrier included in this command <strong>must</strong> be equal</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-None-07890" href="#VUID-vkCmdPipelineBarrier-None-07890"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-None-07890</span><br>

If <code>vkCmdPipelineBarrier</code> is called within a render pass instance, and the
source stage masks of any memory barriers include
<a href="#synchronization-framebuffer-regions">framebuffer-space stages</a>,
destination stage masks of all memory barriers <strong>must</strong> only include
<a href="#synchronization-framebuffer-regions">framebuffer-space stages</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dependencyFlags-07891" href="#VUID-vkCmdPipelineBarrier-dependencyFlags-07891"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dependencyFlags-07891</span><br>

If <code>vkCmdPipelineBarrier</code> is called within a render pass instance, and and the
source stage masks of any memory barriers include
<a href="#synchronization-framebuffer-regions">framebuffer-space stages</a>, then
<code>dependencyFlags</code> <strong>must</strong> include <code>VK_DEPENDENCY_BY_REGION_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-None-07892" href="#VUID-vkCmdPipelineBarrier-None-07892"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-None-07892</span><br>

If <code>vkCmdPipelineBarrier</code> is called within a render pass instance, the source
and destination stage masks of any memory barriers <strong>must</strong> only include
graphics pipeline stages</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dependencyFlags-01186" href="#VUID-vkCmdPipelineBarrier-dependencyFlags-01186"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dependencyFlags-01186</span><br>

If <code>vkCmdPipelineBarrier</code> is called outside of a render pass instance, the
dependency flags <strong>must</strong> not include <code>VK_DEPENDENCY_VIEW_LOCAL_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-None-07893" href="#VUID-vkCmdPipelineBarrier-None-07893"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-None-07893</span><br>

If <code>vkCmdPipelineBarrier</code> is called inside a render pass instance, and there is
more than one view in the current subpass, dependency flags <strong>must</strong>
include <code>VK_DEPENDENCY_VIEW_LOCAL_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-shaderTileImageColorReadAccess-08718" href="#VUID-vkCmdPipelineBarrier-shaderTileImageColorReadAccess-08718"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-shaderTileImageColorReadAccess-08718</span><br>

If <code>vkCmdPipelineBarrier</code> is called within a render pass instance
and none of the <a href="features.html#features-shaderTileImageColorReadAccess" class="xref page">    <code>shaderTileImageColorReadAccess</code></a>,
<a href="features.html#features-shaderTileImageDepthReadAccess" class="xref page">    <code>shaderTileImageDepthReadAccess</code></a>,
<a href="features.html#features-shaderTileImageStencilReadAccess" class="xref page">    <code>shaderTileImageStencilReadAccess</code></a> features are enabled,
the render pass <strong>must</strong> not have been started with
<a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-None-08719" href="#VUID-vkCmdPipelineBarrier-None-08719"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-None-08719</span><br>

If <code>vkCmdPipelineBarrier</code> is called within a render pass instance started with
<a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a>, it <strong>must</strong> adhere to the restrictions in
<a href="#synchronization-pipeline-barriers-explicit-renderpass-tileimage">    Explicit Render Pass Tile Image Access Synchronization</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-06461" href="#VUID-vkCmdPipelineBarrier-srcStageMask-06461"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcStageMask-06461</span><br>

Any pipeline stage included in <code>srcStageMask</code> <strong>must</strong> be supported by
the capabilities of the queue family specified by the
<code>queueFamilyIndex</code> member of the <a href="cmdbuffers.html#VkCommandPoolCreateInfo" class="xref page">VkCommandPoolCreateInfo</a>
structure that was used to create the <code>VkCommandPool</code> that
<code>commandBuffer</code> was allocated from, as specified in the
<a href="#synchronization-pipeline-stages-supported">table of supported pipeline    stages</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-06462" href="#VUID-vkCmdPipelineBarrier-dstStageMask-06462"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dstStageMask-06462</span><br>

Any pipeline stage included in <code>dstStageMask</code> <strong>must</strong> be supported by
the capabilities of the queue family specified by the
<code>queueFamilyIndex</code> member of the <a href="cmdbuffers.html#VkCommandPoolCreateInfo" class="xref page">VkCommandPoolCreateInfo</a>
structure that was used to create the <code>VkCommandPool</code> that
<code>commandBuffer</code> was allocated from, as specified in the
<a href="#synchronization-pipeline-stages-supported">table of supported pipeline    stages</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-commandBuffer-parameter" href="#VUID-vkCmdPipelineBarrier-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-parameter" href="#VUID-vkCmdPipelineBarrier-srcStageMask-parameter"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcStageMask-parameter</span><br>
 <code>srcStageMask</code> <strong>must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-parameter" href="#VUID-vkCmdPipelineBarrier-dstStageMask-parameter"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dstStageMask-parameter</span><br>
 <code>dstStageMask</code> <strong>must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dependencyFlags-parameter" href="#VUID-vkCmdPipelineBarrier-dependencyFlags-parameter"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dependencyFlags-parameter</span><br>
 <code>dependencyFlags</code> <strong>must</strong> be a valid combination of <a href="#VkDependencyFlagBits">VkDependencyFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pMemoryBarriers-parameter" href="#VUID-vkCmdPipelineBarrier-pMemoryBarriers-parameter"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-pMemoryBarriers-parameter</span><br>
 If <code>memoryBarrierCount</code> is not <code>0</code>, <code>pMemoryBarriers</code> <strong>must</strong> be a valid pointer to an array of <code>memoryBarrierCount</code> valid <a href="#VkMemoryBarrier">VkMemoryBarrier</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pBufferMemoryBarriers-parameter" href="#VUID-vkCmdPipelineBarrier-pBufferMemoryBarriers-parameter"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-pBufferMemoryBarriers-parameter</span><br>
 If <code>bufferMemoryBarrierCount</code> is not <code>0</code>, <code>pBufferMemoryBarriers</code> <strong>must</strong> be a valid pointer to an array of <code>bufferMemoryBarrierCount</code> valid <a href="#VkBufferMemoryBarrier">VkBufferMemoryBarrier</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pImageMemoryBarriers-parameter" href="#VUID-vkCmdPipelineBarrier-pImageMemoryBarriers-parameter"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-pImageMemoryBarriers-parameter</span><br>
 If <code>imageMemoryBarrierCount</code> is not <code>0</code>, <code>pImageMemoryBarriers</code> <strong>must</strong> be a valid pointer to an array of <code>imageMemoryBarrierCount</code> valid <a href="#VkImageMemoryBarrier">VkImageMemoryBarrier</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-commandBuffer-recording" href="#VUID-vkCmdPipelineBarrier-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-commandBuffer-cmdpool" href="#VUID-vkCmdPipelineBarrier-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support transfer, graphics, compute, decode, or encode operations</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transfer<br>
Graphics<br>
Compute<br>
Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Synchronization</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in <code>vkCmdPipelineBarrier</code>::<code>dependencyFlags</code>,
specifying how execution and memory dependencies are formed, are:</p>
</div>
<div id="VkDependencyFlagBits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef enum VkDependencyFlagBits {
    VK_DEPENDENCY_BY_REGION_BIT = 0x00000001,
  // Provided by VK_VERSION_1_1
    VK_DEPENDENCY_DEVICE_GROUP_BIT = 0x00000004,
  // Provided by VK_VERSION_1_1
    VK_DEPENDENCY_VIEW_LOCAL_BIT = 0x00000002,
  // Provided by VK_EXT_attachment_feedback_loop_layout
    VK_DEPENDENCY_FEEDBACK_LOOP_BIT_EXT = 0x00000008,
  // Provided by VK_KHR_multiview
    VK_DEPENDENCY_VIEW_LOCAL_BIT_KHR = VK_DEPENDENCY_VIEW_LOCAL_BIT,
  // Provided by VK_KHR_device_group
    VK_DEPENDENCY_DEVICE_GROUP_BIT_KHR = VK_DEPENDENCY_DEVICE_GROUP_BIT,
} VkDependencyFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_DEPENDENCY_BY_REGION_BIT</code> specifies that dependencies will be
<a href="#synchronization-framebuffer-regions">framebuffer-local</a>.</p>
</li>
<li>
<p><code>VK_DEPENDENCY_VIEW_LOCAL_BIT</code> specifies that dependencies will be
<a href="#synchronization-view-local-dependencies">view-local</a>.</p>
</li>
<li>
<p><code>VK_DEPENDENCY_DEVICE_GROUP_BIT</code> specifies that dependencies are
<a href="#synchronization-device-local-dependencies">non-device-local</a>.</p>
</li>
<li>
<p><code>VK_DEPENDENCY_FEEDBACK_LOOP_BIT_EXT</code> specifies that the render pass
will write to and read from the same image using the
<code>VK_IMAGE_LAYOUT_ATTACHMENT_FEEDBACK_LOOP_OPTIMAL_EXT</code> layout.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkDependencyFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef VkFlags VkDependencyFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkDependencyFlags</code> is a bitmask type for setting a mask of zero or more
<a href="#VkDependencyFlagBits">VkDependencyFlagBits</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-pipeline-barriers-explicit-renderpass-tileimage"><a class="anchor" href="#synchronization-pipeline-barriers-explicit-renderpass-tileimage"></a>Explicit Render Pass Tile Image Access Synchronization</h3>
<div class="paragraph">
<p>A fragment shader <strong>can</strong> declare <code>NonCoherentColorAttachmentReadEXT</code>,
<code>NonCoherentDepthAttachmentReadEXT</code>, or
<code>NonCoherentStencilAttachmentReadEXT</code> execution modes to enable
non-coherent tile image reads for color, depth, or stencil, respectively.
When non-coherent tile image reads are enabled, writes via color, depth and
stencil attachments are not automatically made visible to the corresponding
attachment reads via tile images.
For the writes to be made visible, an explicit memory dependency <strong>must</strong> be
inserted between when the attachment is written to and when it is read from
by later fragments.
Such memory dependencies <strong>must</strong> be inserted every time a fragment will read
values at a particular sample (x, y, layer, sample) coordinate, if those
values have been written since the most recent pipeline barrier; or since
the start of the render pass instance, if there have been no pipeline
barriers since the start of the render pass instance.
When such memory dependencies are used the values at all sample locations
inside the fragment area are made visible, regardless of coverage.</p>
</div>
<div class="paragraph">
<p>To insert a memory dependency for explicit render pass tile image
synchronization, call <a href="#vkCmdPipelineBarrier2">vkCmdPipelineBarrier2</a> inside a render pass
instance started with <a href="renderpass.html#vkCmdBeginRendering" class="xref page">vkCmdBeginRendering</a>.
The following restrictions apply for such pipeline barriers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>dependencyFlags</code> <strong>must</strong> include <code>VK_DEPENDENCY_BY_REGION_BIT</code>.</p>
</li>
<li>
<p>The pipeline barriers <strong>can</strong> only include memory barriers.
That is, buffer memory barriers and image memory barriers <strong>must</strong> not be
used.</p>
</li>
<li>
<p>The stages in <a href="#VkMemoryBarrier2">VkMemoryBarrier2</a>::<code>srcStageMask</code> and
<a href="#VkMemoryBarrier2">VkMemoryBarrier2</a>::<code>dstStageMask</code> are restricted to framebuffer
space stages.</p>
</li>
<li>
<p>The access types in <a href="#VkMemoryBarrier2">VkMemoryBarrier2</a>::<code>srcAccessMask</code> and
<a href="#VkMemoryBarrier2">VkMemoryBarrier2</a>::<code>dstAccessMask</code> are restricted to the
following types: <code>VK_ACCESS_2_COLOR_ATTACHMENT_READ_BIT</code>,
<code>VK_ACCESS_2_COLOR_ATTACHMENT_WRITE_BIT</code>,
<code>VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_READ_BIT</code>, and
<code>VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT</code>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="synchronization-memory-barriers"><a class="anchor" href="#synchronization-memory-barriers"></a>Memory Barriers</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Memory barriers</em> are used to explicitly control access to buffer and image
subresource ranges.
Memory barriers are used to <a href="#synchronization-queue-transfers">transfer ownership between queue families</a>,
<a href="#synchronization-image-layout-transitions">change image layouts</a>, and
define <a href="#synchronization-dependencies-available-and-visible">availability and visibility operations</a>.
They explicitly define the <a href="#synchronization-access-types">access types</a>
and buffer and image subresource ranges that are included in the
<a href="#synchronization-dependencies-access-scopes">access scopes</a> of a memory
dependency that is created by a synchronization command that includes them.</p>
</div>
<div class="sect2">
<h3 id="synchronization-global-memory-barriers"><a class="anchor" href="#synchronization-global-memory-barriers"></a>Global Memory Barriers</h3>
<div class="paragraph">
<p>Global memory barriers apply to memory accesses involving all memory objects
that exist at the time of its execution.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMemoryBarrier2</code> structure is defined as:</p>
</div>
<div id="VkMemoryBarrier2" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
typedef struct VkMemoryBarrier2 {
    VkStructureType          sType;
    const void*              pNext;
    VkPipelineStageFlags2    srcStageMask;
    VkAccessFlags2           srcAccessMask;
    VkPipelineStageFlags2    dstStageMask;
    VkAccessFlags2           dstAccessMask;
} VkMemoryBarrier2;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkMemoryBarrier2KHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_synchronization2
typedef VkMemoryBarrier2 VkMemoryBarrier2KHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>srcStageMask</code> is a <a href="#VkPipelineStageFlags2">VkPipelineStageFlags2</a> mask of pipeline
stages to be included in the <a href="#synchronization-dependencies-scopes">    first synchronization scope</a>.</p>
</li>
<li>
<p><code>srcAccessMask</code> is a <a href="#VkAccessFlags2">VkAccessFlags2</a> mask of access flags to be
included in the <a href="#synchronization-dependencies-access-scopes">first    access scope</a>.</p>
</li>
<li>
<p><code>dstStageMask</code> is a <a href="#VkPipelineStageFlags2">VkPipelineStageFlags2</a> mask of pipeline
stages to be included in the <a href="#synchronization-dependencies-scopes">    second synchronization scope</a>.</p>
</li>
<li>
<p><code>dstAccessMask</code> is a <a href="#VkAccessFlags2">VkAccessFlags2</a> mask of access flags to be
included in the <a href="#synchronization-dependencies-access-scopes">second    access scope</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure defines a <a href="#synchronization-dependencies-memory">memory dependency</a> affecting all device memory.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-scopes">synchronization scope</a> and
<a href="#synchronization-dependencies-access-scopes">access scope</a> described by
this structure include only operations and memory accesses specified by
<code>srcStageMask</code> and <code>srcAccessMask</code>.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
and <a href="#synchronization-dependencies-access-scopes">access scope</a> described
by this structure include only operations and memory accesses specified by
<code>dstStageMask</code> and <code>dstAccessMask</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcStageMask-03929" href="#VUID-VkMemoryBarrier2-srcStageMask-03929"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcStageMask-03929</span><br>

If the <a href="features.html#features-geometryShader" class="xref page"><code>geometryShader</code></a> feature is not
enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcStageMask-03930" href="#VUID-VkMemoryBarrier2-srcStageMask-03930"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcStageMask-03930</span><br>

If the <a href="features.html#features-tessellationShader" class="xref page"><code>tessellationShader</code></a> feature
is not enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcStageMask-03931" href="#VUID-VkMemoryBarrier2-srcStageMask-03931"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcStageMask-03931</span><br>

If the <a href="features.html#features-conditionalRendering" class="xref page"><code>conditionalRendering</code></a>
feature is not enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcStageMask-03932" href="#VUID-VkMemoryBarrier2-srcStageMask-03932"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcStageMask-03932</span><br>

If the <a href="features.html#features-fragmentDensityMap" class="xref page"><code>fragmentDensityMap</code></a> feature
is not enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcStageMask-03933" href="#VUID-VkMemoryBarrier2-srcStageMask-03933"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcStageMask-03933</span><br>

If the <a href="features.html#features-transformFeedback" class="xref page"><code>transformFeedback</code></a> feature
is not enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcStageMask-03934" href="#VUID-VkMemoryBarrier2-srcStageMask-03934"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcStageMask-03934</span><br>

If the <a href="features.html#features-meshShader" class="xref page"><code>meshShader</code></a> feature is not enabled,
<code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcStageMask-03935" href="#VUID-VkMemoryBarrier2-srcStageMask-03935"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcStageMask-03935</span><br>

If the <a href="features.html#features-taskShader" class="xref page"><code>taskShader</code></a> feature is not enabled,
<code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcStageMask-07316" href="#VUID-VkMemoryBarrier2-srcStageMask-07316"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcStageMask-07316</span><br>

If neither the <a href="features.html#features-shadingRateImage" class="xref page"><code>shadingRateImage</code></a> or
<a href="features.html#features-attachmentFragmentShadingRate" class="xref page">    <code>attachmentFragmentShadingRate</code></a> are enabled, <code>srcStageMask</code>
<strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcStageMask-04957" href="#VUID-VkMemoryBarrier2-srcStageMask-04957"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcStageMask-04957</span><br>

If the <a href="features.html#features-subpassShading" class="xref page"><code>subpassShading</code></a> feature is not
enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcStageMask-04995" href="#VUID-VkMemoryBarrier2-srcStageMask-04995"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcStageMask-04995</span><br>

If the <a href="features.html#features-invocationMask" class="xref page"><code>invocationMask</code></a> feature is not
enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcStageMask-07946" href="#VUID-VkMemoryBarrier2-srcStageMask-07946"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcStageMask-07946</span><br>

If neither the <a href="../appendices/extensions.html#VK_NV_ray_tracing" class="xref page">VK_NV_ray_tracing</a> extension or
<a href="features.html#features-rayTracingPipeline" class="xref page"><code>rayTracingPipeline</code> feature</a> are
enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03900" href="#VUID-VkMemoryBarrier2-srcAccessMask-03900"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03900</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_INDIRECT_COMMAND_READ_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03901" href="#VUID-VkMemoryBarrier2-srcAccessMask-03901"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03901</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_INDEX_READ_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_INDEX_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_VERTEX_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03902" href="#VUID-VkMemoryBarrier2-srcAccessMask-03902"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03902</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_VERTEX_ATTRIBUTE_READ_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_VERTEX_ATTRIBUTE_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_VERTEX_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03903" href="#VUID-VkMemoryBarrier2-srcAccessMask-03903"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03903</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_INPUT_ATTACHMENT_READ_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code>,
<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03904" href="#VUID-VkMemoryBarrier2-srcAccessMask-03904"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03904</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_UNIFORM_READ_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03905" href="#VUID-VkMemoryBarrier2-srcAccessMask-03905"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03905</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_SAMPLED_READ_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03906" href="#VUID-VkMemoryBarrier2-srcAccessMask-03906"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03906</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_STORAGE_READ_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03907" href="#VUID-VkMemoryBarrier2-srcAccessMask-03907"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03907</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_STORAGE_WRITE_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-07454" href="#VUID-VkMemoryBarrier2-srcAccessMask-07454"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-07454</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_SHADER_READ_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code>,
or one of the <code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03909" href="#VUID-VkMemoryBarrier2-srcAccessMask-03909"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03909</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_SHADER_WRITE_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03910" href="#VUID-VkMemoryBarrier2-srcAccessMask-03910"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03910</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_COLOR_ATTACHMENT_READ_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code>
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03911" href="#VUID-VkMemoryBarrier2-srcAccessMask-03911"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03911</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_COLOR_ATTACHMENT_WRITE_BIT</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code>
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03912" href="#VUID-VkMemoryBarrier2-srcAccessMask-03912"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03912</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_READ_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03913" href="#VUID-VkMemoryBarrier2-srcAccessMask-03913"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03913</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03914" href="#VUID-VkMemoryBarrier2-srcAccessMask-03914"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03914</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_TRANSFER_READ_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COPY_BIT</code>,
<code>VK_PIPELINE_STAGE_2_BLIT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_RESOLVE_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_TRANSFER_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
or <code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03915" href="#VUID-VkMemoryBarrier2-srcAccessMask-03915"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03915</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_TRANSFER_WRITE_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COPY_BIT</code>,
<code>VK_PIPELINE_STAGE_2_BLIT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_RESOLVE_BIT</code>,
<code>VK_PIPELINE_STAGE_2_CLEAR_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_TRANSFER_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
or <code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03916" href="#VUID-VkMemoryBarrier2-srcAccessMask-03916"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03916</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_HOST_READ_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03917" href="#VUID-VkMemoryBarrier2-srcAccessMask-03917"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03917</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_HOST_WRITE_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03918" href="#VUID-VkMemoryBarrier2-srcAccessMask-03918"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03918</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_CONDITIONAL_RENDERING_READ_BIT_EXT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03919" href="#VUID-VkMemoryBarrier2-srcAccessMask-03919"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03919</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_FRAGMENT_DENSITY_MAP_READ_BIT_EXT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03920" href="#VUID-VkMemoryBarrier2-srcAccessMask-03920"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03920</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_TRANSFORM_FEEDBACK_WRITE_BIT_EXT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-04747" href="#VUID-VkMemoryBarrier2-srcAccessMask-04747"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-04747</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_TRANSFORM_FEEDBACK_COUNTER_READ_BIT_EXT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03922" href="#VUID-VkMemoryBarrier2-srcAccessMask-03922"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03922</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_TRANSFORM_FEEDBACK_COUNTER_WRITE_BIT_EXT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03923" href="#VUID-VkMemoryBarrier2-srcAccessMask-03923"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03923</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_SHADING_RATE_IMAGE_READ_BIT_NV</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_SHADING_RATE_IMAGE_BIT_NV</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-04994" href="#VUID-VkMemoryBarrier2-srcAccessMask-04994"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-04994</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_INVOCATION_MASK_READ_BIT_HUAWEI</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03924" href="#VUID-VkMemoryBarrier2-srcAccessMask-03924"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03924</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_COMMAND_PREPROCESS_READ_BIT_NV</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COMMAND_PREPROCESS_BIT_NV</code> or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03925" href="#VUID-VkMemoryBarrier2-srcAccessMask-03925"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03925</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_COMMAND_PREPROCESS_WRITE_BIT_NV</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COMMAND_PREPROCESS_BIT_NV</code> or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03926" href="#VUID-VkMemoryBarrier2-srcAccessMask-03926"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03926</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_COLOR_ATTACHMENT_READ_NONCOHERENT_BIT_EXT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code>
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03927" href="#VUID-VkMemoryBarrier2-srcAccessMask-03927"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03927</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-03928" href="#VUID-VkMemoryBarrier2-srcAccessMask-03928"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-03928</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_ACCELERATION_STRUCTURE_WRITE_BIT_KHR</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code> or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-06256" href="#VUID-VkMemoryBarrier2-srcAccessMask-06256"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-06256</span><br>

If
the <a href="features.html#features-rayQuery" class="xref page"><code>rayQuery</code></a> feature is not enabled and
<code>srcAccessMask</code> includes
<code>VK_ACCESS_2_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>,
<code>srcStageMask</code> <strong>must</strong> not include any of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages
except <code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-07272" href="#VUID-VkMemoryBarrier2-srcAccessMask-07272"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-07272</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_BINDING_TABLE_READ_BIT_KHR</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code> or
<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-04858" href="#VUID-VkMemoryBarrier2-srcAccessMask-04858"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-04858</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_DECODE_READ_BIT_KHR</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-04859" href="#VUID-VkMemoryBarrier2-srcAccessMask-04859"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-04859</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_DECODE_WRITE_BIT_KHR</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-04860" href="#VUID-VkMemoryBarrier2-srcAccessMask-04860"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-04860</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_ENCODE_READ_BIT_KHR</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-04861" href="#VUID-VkMemoryBarrier2-srcAccessMask-04861"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-04861</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_ENCODE_WRITE_BIT_KHR</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-07455" href="#VUID-VkMemoryBarrier2-srcAccessMask-07455"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-07455</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_OPTICAL_FLOW_READ_BIT_NV</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_OPTICAL_FLOW_BIT_NV</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-07456" href="#VUID-VkMemoryBarrier2-srcAccessMask-07456"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-07456</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_OPTICAL_FLOW_WRITE_BIT_NV</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_OPTICAL_FLOW_BIT_NV</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-07457" href="#VUID-VkMemoryBarrier2-srcAccessMask-07457"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-07457</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_MICROMAP_WRITE_BIT_EXT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-07458" href="#VUID-VkMemoryBarrier2-srcAccessMask-07458"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-07458</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_MICROMAP_READ_BIT_EXT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code> or
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-08118" href="#VUID-VkMemoryBarrier2-srcAccessMask-08118"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-08118</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_DESCRIPTOR_BUFFER_READ_BIT_EXT</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstStageMask-03929" href="#VUID-VkMemoryBarrier2-dstStageMask-03929"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstStageMask-03929</span><br>

If the <a href="features.html#features-geometryShader" class="xref page"><code>geometryShader</code></a> feature is not
enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstStageMask-03930" href="#VUID-VkMemoryBarrier2-dstStageMask-03930"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstStageMask-03930</span><br>

If the <a href="features.html#features-tessellationShader" class="xref page"><code>tessellationShader</code></a> feature
is not enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstStageMask-03931" href="#VUID-VkMemoryBarrier2-dstStageMask-03931"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstStageMask-03931</span><br>

If the <a href="features.html#features-conditionalRendering" class="xref page"><code>conditionalRendering</code></a>
feature is not enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstStageMask-03932" href="#VUID-VkMemoryBarrier2-dstStageMask-03932"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstStageMask-03932</span><br>

If the <a href="features.html#features-fragmentDensityMap" class="xref page"><code>fragmentDensityMap</code></a> feature
is not enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstStageMask-03933" href="#VUID-VkMemoryBarrier2-dstStageMask-03933"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstStageMask-03933</span><br>

If the <a href="features.html#features-transformFeedback" class="xref page"><code>transformFeedback</code></a> feature
is not enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstStageMask-03934" href="#VUID-VkMemoryBarrier2-dstStageMask-03934"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstStageMask-03934</span><br>

If the <a href="features.html#features-meshShader" class="xref page"><code>meshShader</code></a> feature is not enabled,
<code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstStageMask-03935" href="#VUID-VkMemoryBarrier2-dstStageMask-03935"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstStageMask-03935</span><br>

If the <a href="features.html#features-taskShader" class="xref page"><code>taskShader</code></a> feature is not enabled,
<code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstStageMask-07316" href="#VUID-VkMemoryBarrier2-dstStageMask-07316"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstStageMask-07316</span><br>

If neither the <a href="features.html#features-shadingRateImage" class="xref page"><code>shadingRateImage</code></a> or
<a href="features.html#features-attachmentFragmentShadingRate" class="xref page">    <code>attachmentFragmentShadingRate</code></a> are enabled, <code>dstStageMask</code>
<strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstStageMask-04957" href="#VUID-VkMemoryBarrier2-dstStageMask-04957"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstStageMask-04957</span><br>

If the <a href="features.html#features-subpassShading" class="xref page"><code>subpassShading</code></a> feature is not
enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstStageMask-04995" href="#VUID-VkMemoryBarrier2-dstStageMask-04995"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstStageMask-04995</span><br>

If the <a href="features.html#features-invocationMask" class="xref page"><code>invocationMask</code></a> feature is not
enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstStageMask-07946" href="#VUID-VkMemoryBarrier2-dstStageMask-07946"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstStageMask-07946</span><br>

If neither the <a href="../appendices/extensions.html#VK_NV_ray_tracing" class="xref page">VK_NV_ray_tracing</a> extension or
<a href="features.html#features-rayTracingPipeline" class="xref page"><code>rayTracingPipeline</code> feature</a> are
enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03900" href="#VUID-VkMemoryBarrier2-dstAccessMask-03900"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03900</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_INDIRECT_COMMAND_READ_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03901" href="#VUID-VkMemoryBarrier2-dstAccessMask-03901"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03901</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_INDEX_READ_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_INDEX_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_VERTEX_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03902" href="#VUID-VkMemoryBarrier2-dstAccessMask-03902"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03902</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_VERTEX_ATTRIBUTE_READ_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_VERTEX_ATTRIBUTE_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_VERTEX_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03903" href="#VUID-VkMemoryBarrier2-dstAccessMask-03903"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03903</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_INPUT_ATTACHMENT_READ_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code>,
<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03904" href="#VUID-VkMemoryBarrier2-dstAccessMask-03904"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03904</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_UNIFORM_READ_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03905" href="#VUID-VkMemoryBarrier2-dstAccessMask-03905"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03905</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_SAMPLED_READ_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03906" href="#VUID-VkMemoryBarrier2-dstAccessMask-03906"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03906</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_STORAGE_READ_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03907" href="#VUID-VkMemoryBarrier2-dstAccessMask-03907"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03907</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_STORAGE_WRITE_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-07454" href="#VUID-VkMemoryBarrier2-dstAccessMask-07454"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-07454</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_SHADER_READ_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code>,
or one of the <code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03909" href="#VUID-VkMemoryBarrier2-dstAccessMask-03909"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03909</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_SHADER_WRITE_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03910" href="#VUID-VkMemoryBarrier2-dstAccessMask-03910"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03910</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_COLOR_ATTACHMENT_READ_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code>
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03911" href="#VUID-VkMemoryBarrier2-dstAccessMask-03911"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03911</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_COLOR_ATTACHMENT_WRITE_BIT</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code>
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03912" href="#VUID-VkMemoryBarrier2-dstAccessMask-03912"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03912</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_READ_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03913" href="#VUID-VkMemoryBarrier2-dstAccessMask-03913"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03913</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03914" href="#VUID-VkMemoryBarrier2-dstAccessMask-03914"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03914</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_TRANSFER_READ_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COPY_BIT</code>,
<code>VK_PIPELINE_STAGE_2_BLIT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_RESOLVE_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_TRANSFER_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
or <code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03915" href="#VUID-VkMemoryBarrier2-dstAccessMask-03915"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03915</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_TRANSFER_WRITE_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COPY_BIT</code>,
<code>VK_PIPELINE_STAGE_2_BLIT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_RESOLVE_BIT</code>,
<code>VK_PIPELINE_STAGE_2_CLEAR_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_TRANSFER_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
or <code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03916" href="#VUID-VkMemoryBarrier2-dstAccessMask-03916"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03916</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_HOST_READ_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03917" href="#VUID-VkMemoryBarrier2-dstAccessMask-03917"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03917</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_HOST_WRITE_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03918" href="#VUID-VkMemoryBarrier2-dstAccessMask-03918"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03918</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_CONDITIONAL_RENDERING_READ_BIT_EXT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03919" href="#VUID-VkMemoryBarrier2-dstAccessMask-03919"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03919</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_FRAGMENT_DENSITY_MAP_READ_BIT_EXT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03920" href="#VUID-VkMemoryBarrier2-dstAccessMask-03920"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03920</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_TRANSFORM_FEEDBACK_WRITE_BIT_EXT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-04747" href="#VUID-VkMemoryBarrier2-dstAccessMask-04747"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-04747</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_TRANSFORM_FEEDBACK_COUNTER_READ_BIT_EXT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03922" href="#VUID-VkMemoryBarrier2-dstAccessMask-03922"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03922</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_TRANSFORM_FEEDBACK_COUNTER_WRITE_BIT_EXT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03923" href="#VUID-VkMemoryBarrier2-dstAccessMask-03923"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03923</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_SHADING_RATE_IMAGE_READ_BIT_NV</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_SHADING_RATE_IMAGE_BIT_NV</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-04994" href="#VUID-VkMemoryBarrier2-dstAccessMask-04994"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-04994</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_INVOCATION_MASK_READ_BIT_HUAWEI</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03924" href="#VUID-VkMemoryBarrier2-dstAccessMask-03924"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03924</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_COMMAND_PREPROCESS_READ_BIT_NV</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COMMAND_PREPROCESS_BIT_NV</code> or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03925" href="#VUID-VkMemoryBarrier2-dstAccessMask-03925"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03925</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_COMMAND_PREPROCESS_WRITE_BIT_NV</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COMMAND_PREPROCESS_BIT_NV</code> or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03926" href="#VUID-VkMemoryBarrier2-dstAccessMask-03926"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03926</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_COLOR_ATTACHMENT_READ_NONCOHERENT_BIT_EXT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code>
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03927" href="#VUID-VkMemoryBarrier2-dstAccessMask-03927"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03927</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-03928" href="#VUID-VkMemoryBarrier2-dstAccessMask-03928"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-03928</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_ACCELERATION_STRUCTURE_WRITE_BIT_KHR</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code> or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-06256" href="#VUID-VkMemoryBarrier2-dstAccessMask-06256"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-06256</span><br>

If
the <a href="features.html#features-rayQuery" class="xref page"><code>rayQuery</code></a> feature is not enabled and
<code>dstAccessMask</code> includes
<code>VK_ACCESS_2_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>,
<code>dstStageMask</code> <strong>must</strong> not include any of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages
except <code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-07272" href="#VUID-VkMemoryBarrier2-dstAccessMask-07272"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-07272</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_BINDING_TABLE_READ_BIT_KHR</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code> or
<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-04858" href="#VUID-VkMemoryBarrier2-dstAccessMask-04858"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-04858</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_DECODE_READ_BIT_KHR</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-04859" href="#VUID-VkMemoryBarrier2-dstAccessMask-04859"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-04859</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_DECODE_WRITE_BIT_KHR</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-04860" href="#VUID-VkMemoryBarrier2-dstAccessMask-04860"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-04860</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_ENCODE_READ_BIT_KHR</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-04861" href="#VUID-VkMemoryBarrier2-dstAccessMask-04861"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-04861</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_ENCODE_WRITE_BIT_KHR</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-07455" href="#VUID-VkMemoryBarrier2-dstAccessMask-07455"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-07455</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_OPTICAL_FLOW_READ_BIT_NV</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_OPTICAL_FLOW_BIT_NV</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-07456" href="#VUID-VkMemoryBarrier2-dstAccessMask-07456"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-07456</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_OPTICAL_FLOW_WRITE_BIT_NV</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_OPTICAL_FLOW_BIT_NV</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-07457" href="#VUID-VkMemoryBarrier2-dstAccessMask-07457"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-07457</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_MICROMAP_WRITE_BIT_EXT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-07458" href="#VUID-VkMemoryBarrier2-dstAccessMask-07458"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-07458</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_MICROMAP_READ_BIT_EXT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code> or
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-08118" href="#VUID-VkMemoryBarrier2-dstAccessMask-08118"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-08118</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_DESCRIPTOR_BUFFER_READ_BIT_EXT</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryBarrier2-sType-sType" href="#VUID-VkMemoryBarrier2-sType-sType"></a> <span class="vuid">VUID-VkMemoryBarrier2-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_MEMORY_BARRIER_2</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcStageMask-parameter" href="#VUID-VkMemoryBarrier2-srcStageMask-parameter"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcStageMask-parameter</span><br>
 <code>srcStageMask</code> <strong>must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits2">VkPipelineStageFlagBits2</a> values</p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-srcAccessMask-parameter" href="#VUID-VkMemoryBarrier2-srcAccessMask-parameter"></a> <span class="vuid">VUID-VkMemoryBarrier2-srcAccessMask-parameter</span><br>
 <code>srcAccessMask</code> <strong>must</strong> be a valid combination of <a href="#VkAccessFlagBits2">VkAccessFlagBits2</a> values</p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstStageMask-parameter" href="#VUID-VkMemoryBarrier2-dstStageMask-parameter"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstStageMask-parameter</span><br>
 <code>dstStageMask</code> <strong>must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits2">VkPipelineStageFlagBits2</a> values</p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier2-dstAccessMask-parameter" href="#VUID-VkMemoryBarrier2-dstAccessMask-parameter"></a> <span class="vuid">VUID-VkMemoryBarrier2-dstAccessMask-parameter</span><br>
 <code>dstAccessMask</code> <strong>must</strong> be a valid combination of <a href="#VkAccessFlagBits2">VkAccessFlagBits2</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMemoryBarrier</code> structure is defined as:</p>
</div>
<div id="VkMemoryBarrier" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef struct VkMemoryBarrier {
    VkStructureType    sType;
    const void*        pNext;
    VkAccessFlags      srcAccessMask;
    VkAccessFlags      dstAccessMask;
} VkMemoryBarrier;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>srcAccessMask</code> is a bitmask of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> specifying a
<a href="#synchronization-access-masks">source access mask</a>.</p>
</li>
<li>
<p><code>dstAccessMask</code> is a bitmask of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> specifying a
<a href="#synchronization-access-masks">destination access mask</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to access types in the <a href="#synchronization-access-masks">source access mask</a> specified by <code>srcAccessMask</code>.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to access types in the <a href="#synchronization-access-masks">destination access mask</a> specified by <code>dstAccessMask</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryBarrier-sType-sType" href="#VUID-VkMemoryBarrier-sType-sType"></a> <span class="vuid">VUID-VkMemoryBarrier-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_MEMORY_BARRIER</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier-pNext-pNext" href="#VUID-VkMemoryBarrier-pNext-pNext"></a> <span class="vuid">VUID-VkMemoryBarrier-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier-srcAccessMask-parameter" href="#VUID-VkMemoryBarrier-srcAccessMask-parameter"></a> <span class="vuid">VUID-VkMemoryBarrier-srcAccessMask-parameter</span><br>
 <code>srcAccessMask</code> <strong>must</strong> be a valid combination of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier-dstAccessMask-parameter" href="#VUID-VkMemoryBarrier-dstAccessMask-parameter"></a> <span class="vuid">VUID-VkMemoryBarrier-dstAccessMask-parameter</span><br>
 <code>dstAccessMask</code> <strong>must</strong> be a valid combination of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-buffer-memory-barriers"><a class="anchor" href="#synchronization-buffer-memory-barriers"></a>Buffer Memory Barriers</h3>
<div class="paragraph">
<p>Buffer memory barriers only apply to memory accesses involving a specific
buffer range.
That is, a memory dependency formed from a buffer memory barrier is
<a href="#synchronization-dependencies-access-scopes">scoped</a> to access via the
specified buffer range.
Buffer memory barriers <strong>can</strong> also be used to define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> for the
specified buffer range.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkBufferMemoryBarrier2</code> structure is defined as:</p>
</div>
<div id="VkBufferMemoryBarrier2" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
typedef struct VkBufferMemoryBarrier2 {
    VkStructureType          sType;
    const void*              pNext;
    VkPipelineStageFlags2    srcStageMask;
    VkAccessFlags2           srcAccessMask;
    VkPipelineStageFlags2    dstStageMask;
    VkAccessFlags2           dstAccessMask;
    uint32_t                 srcQueueFamilyIndex;
    uint32_t                 dstQueueFamilyIndex;
    VkBuffer                 buffer;
    VkDeviceSize             offset;
    VkDeviceSize             size;
} VkBufferMemoryBarrier2;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkBufferMemoryBarrier2KHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_synchronization2
typedef VkBufferMemoryBarrier2 VkBufferMemoryBarrier2KHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>srcStageMask</code> is a <a href="#VkPipelineStageFlags2">VkPipelineStageFlags2</a> mask of pipeline
stages to be included in the <a href="#synchronization-dependencies-scopes">    first synchronization scope</a>.</p>
</li>
<li>
<p><code>srcAccessMask</code> is a <a href="#VkAccessFlags2">VkAccessFlags2</a> mask of access flags to be
included in the <a href="#synchronization-dependencies-access-scopes">first    access scope</a>.</p>
</li>
<li>
<p><code>dstStageMask</code> is a <a href="#VkPipelineStageFlags2">VkPipelineStageFlags2</a> mask of pipeline
stages to be included in the <a href="#synchronization-dependencies-scopes">    second synchronization scope</a>.</p>
</li>
<li>
<p><code>dstAccessMask</code> is a <a href="#VkAccessFlags2">VkAccessFlags2</a> mask of access flags to be
included in the <a href="#synchronization-dependencies-access-scopes">second    access scope</a>.</p>
</li>
<li>
<p><code>srcQueueFamilyIndex</code> is the source queue family for a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a>.</p>
</li>
<li>
<p><code>dstQueueFamilyIndex</code> is the destination queue family for a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a>.</p>
</li>
<li>
<p><code>buffer</code> is a handle to the buffer whose backing memory is affected
by the barrier.</p>
</li>
<li>
<p><code>offset</code> is an offset in bytes into the backing memory for
<code>buffer</code>; this is relative to the base offset as bound to the buffer
(see <a href="resources.html#vkBindBufferMemory" class="xref page">vkBindBufferMemory</a>).</p>
</li>
<li>
<p><code>size</code> is a size in bytes of the affected area of backing memory for
<code>buffer</code>, or <code>VK_WHOLE_SIZE</code> to use the range from <code>offset</code>
to the end of the buffer.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure defines a <a href="#synchronization-dependencies-memory">memory dependency</a> limited to a range of a buffer, and <strong>can</strong> define a
<a href="#synchronization-queue-transfers">queue family transfer operation</a> for
that range.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-scopes">synchronization scope</a> and
<a href="#synchronization-dependencies-access-scopes">access scope</a> described by
this structure include only operations and memory accesses specified by
<code>srcStageMask</code> and <code>srcAccessMask</code>.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
and <a href="#synchronization-dependencies-access-scopes">access scope</a> described
by this structure include only operations and memory accesses specified by
<code>dstStageMask</code> and <code>dstAccessMask</code>.</p>
</div>
<div class="paragraph">
<p>Both <a href="#synchronization-dependencies-access-scopes">access scopes</a> are
limited to only memory accesses to <code>buffer</code> in the range defined by
<code>offset</code> and <code>size</code>.</p>
</div>
<div class="paragraph">
<p>If <code>buffer</code> was created with <code>VK_SHARING_MODE_EXCLUSIVE</code>, and
<code>srcQueueFamilyIndex</code> is not equal to <code>dstQueueFamilyIndex</code>, this
memory barrier defines a <a href="#synchronization-queue-transfers">queue family transfer operation</a>.
When executed on a queue in the family identified by
<code>srcQueueFamilyIndex</code>, this barrier defines a
<a href="#synchronization-queue-transfers-release">queue family release operation</a>
for the specified buffer range, and the second synchronization and access
scopes do not synchronize operations on that queue.
When executed on a queue in the family identified by
<code>dstQueueFamilyIndex</code>, this barrier defines a
<a href="#synchronization-queue-transfers-acquire">queue family acquire operation</a>
for the specified buffer range, and the first synchronization and access
scopes do not synchronize operations on that queue.</p>
</div>
<div class="paragraph">
<p>A <a href="#synchronization-queue-transfers">queue family transfer operation</a> is
also defined if the values are not equal, and either is one of the special
queue family values reserved for external memory ownership transfers, as
described in <a href="#synchronization-queue-transfers">Queue Family Ownership Transfer</a>.
A <a href="#synchronization-queue-transfers-release">queue family release operation</a> is defined when <code>dstQueueFamilyIndex</code> is one of those
values, and a <a href="#synchronization-queue-transfers-acquire">queue family acquire operation</a> is defined when <code>srcQueueFamilyIndex</code> is one of
those values.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcStageMask-03929" href="#VUID-VkBufferMemoryBarrier2-srcStageMask-03929"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcStageMask-03929</span><br>

If the <a href="features.html#features-geometryShader" class="xref page"><code>geometryShader</code></a> feature is not
enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcStageMask-03930" href="#VUID-VkBufferMemoryBarrier2-srcStageMask-03930"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcStageMask-03930</span><br>

If the <a href="features.html#features-tessellationShader" class="xref page"><code>tessellationShader</code></a> feature
is not enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcStageMask-03931" href="#VUID-VkBufferMemoryBarrier2-srcStageMask-03931"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcStageMask-03931</span><br>

If the <a href="features.html#features-conditionalRendering" class="xref page"><code>conditionalRendering</code></a>
feature is not enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcStageMask-03932" href="#VUID-VkBufferMemoryBarrier2-srcStageMask-03932"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcStageMask-03932</span><br>

If the <a href="features.html#features-fragmentDensityMap" class="xref page"><code>fragmentDensityMap</code></a> feature
is not enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcStageMask-03933" href="#VUID-VkBufferMemoryBarrier2-srcStageMask-03933"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcStageMask-03933</span><br>

If the <a href="features.html#features-transformFeedback" class="xref page"><code>transformFeedback</code></a> feature
is not enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcStageMask-03934" href="#VUID-VkBufferMemoryBarrier2-srcStageMask-03934"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcStageMask-03934</span><br>

If the <a href="features.html#features-meshShader" class="xref page"><code>meshShader</code></a> feature is not enabled,
<code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcStageMask-03935" href="#VUID-VkBufferMemoryBarrier2-srcStageMask-03935"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcStageMask-03935</span><br>

If the <a href="features.html#features-taskShader" class="xref page"><code>taskShader</code></a> feature is not enabled,
<code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcStageMask-07316" href="#VUID-VkBufferMemoryBarrier2-srcStageMask-07316"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcStageMask-07316</span><br>

If neither the <a href="features.html#features-shadingRateImage" class="xref page"><code>shadingRateImage</code></a> or
<a href="features.html#features-attachmentFragmentShadingRate" class="xref page">    <code>attachmentFragmentShadingRate</code></a> are enabled, <code>srcStageMask</code>
<strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcStageMask-04957" href="#VUID-VkBufferMemoryBarrier2-srcStageMask-04957"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcStageMask-04957</span><br>

If the <a href="features.html#features-subpassShading" class="xref page"><code>subpassShading</code></a> feature is not
enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcStageMask-04995" href="#VUID-VkBufferMemoryBarrier2-srcStageMask-04995"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcStageMask-04995</span><br>

If the <a href="features.html#features-invocationMask" class="xref page"><code>invocationMask</code></a> feature is not
enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcStageMask-07946" href="#VUID-VkBufferMemoryBarrier2-srcStageMask-07946"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcStageMask-07946</span><br>

If neither the <a href="../appendices/extensions.html#VK_NV_ray_tracing" class="xref page">VK_NV_ray_tracing</a> extension or
<a href="features.html#features-rayTracingPipeline" class="xref page"><code>rayTracingPipeline</code> feature</a> are
enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03900" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03900"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03900</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_INDIRECT_COMMAND_READ_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03901" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03901"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03901</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_INDEX_READ_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_INDEX_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_VERTEX_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03902" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03902"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03902</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_VERTEX_ATTRIBUTE_READ_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_VERTEX_ATTRIBUTE_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_VERTEX_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03903" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03903"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03903</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_INPUT_ATTACHMENT_READ_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code>,
<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03904" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03904"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03904</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_UNIFORM_READ_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03905" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03905"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03905</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_SAMPLED_READ_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03906" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03906"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03906</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_STORAGE_READ_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03907" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03907"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03907</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_STORAGE_WRITE_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-07454" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-07454"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-07454</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_SHADER_READ_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code>,
or one of the <code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03909" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03909"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03909</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_SHADER_WRITE_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03910" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03910"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03910</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_COLOR_ATTACHMENT_READ_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code>
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03911" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03911"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03911</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_COLOR_ATTACHMENT_WRITE_BIT</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code>
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03912" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03912"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03912</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_READ_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03913" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03913"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03913</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03914" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03914"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03914</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_TRANSFER_READ_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COPY_BIT</code>,
<code>VK_PIPELINE_STAGE_2_BLIT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_RESOLVE_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_TRANSFER_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
or <code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03915" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03915"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03915</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_TRANSFER_WRITE_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COPY_BIT</code>,
<code>VK_PIPELINE_STAGE_2_BLIT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_RESOLVE_BIT</code>,
<code>VK_PIPELINE_STAGE_2_CLEAR_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_TRANSFER_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
or <code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03916" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03916"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03916</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_HOST_READ_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03917" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03917"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03917</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_HOST_WRITE_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03918" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03918"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03918</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_CONDITIONAL_RENDERING_READ_BIT_EXT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03919" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03919"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03919</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_FRAGMENT_DENSITY_MAP_READ_BIT_EXT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03920" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03920"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03920</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_TRANSFORM_FEEDBACK_WRITE_BIT_EXT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-04747" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-04747"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-04747</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_TRANSFORM_FEEDBACK_COUNTER_READ_BIT_EXT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03922" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03922"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03922</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_TRANSFORM_FEEDBACK_COUNTER_WRITE_BIT_EXT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03923" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03923"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03923</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_SHADING_RATE_IMAGE_READ_BIT_NV</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_SHADING_RATE_IMAGE_BIT_NV</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-04994" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-04994"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-04994</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_INVOCATION_MASK_READ_BIT_HUAWEI</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03924" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03924"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03924</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_COMMAND_PREPROCESS_READ_BIT_NV</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COMMAND_PREPROCESS_BIT_NV</code> or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03925" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03925"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03925</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_COMMAND_PREPROCESS_WRITE_BIT_NV</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COMMAND_PREPROCESS_BIT_NV</code> or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03926" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03926"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03926</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_COLOR_ATTACHMENT_READ_NONCOHERENT_BIT_EXT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code>
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03927" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03927"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03927</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-03928" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-03928"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-03928</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_ACCELERATION_STRUCTURE_WRITE_BIT_KHR</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code> or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-06256" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-06256"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-06256</span><br>

If
the <a href="features.html#features-rayQuery" class="xref page"><code>rayQuery</code></a> feature is not enabled and
<code>srcAccessMask</code> includes
<code>VK_ACCESS_2_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>,
<code>srcStageMask</code> <strong>must</strong> not include any of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages
except <code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-07272" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-07272"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-07272</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_BINDING_TABLE_READ_BIT_KHR</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code> or
<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-04858" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-04858"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-04858</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_DECODE_READ_BIT_KHR</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-04859" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-04859"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-04859</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_DECODE_WRITE_BIT_KHR</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-04860" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-04860"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-04860</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_ENCODE_READ_BIT_KHR</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-04861" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-04861"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-04861</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_ENCODE_WRITE_BIT_KHR</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-07455" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-07455"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-07455</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_OPTICAL_FLOW_READ_BIT_NV</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_OPTICAL_FLOW_BIT_NV</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-07456" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-07456"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-07456</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_OPTICAL_FLOW_WRITE_BIT_NV</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_OPTICAL_FLOW_BIT_NV</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-07457" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-07457"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-07457</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_MICROMAP_WRITE_BIT_EXT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-07458" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-07458"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-07458</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_MICROMAP_READ_BIT_EXT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code> or
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-08118" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-08118"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-08118</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_DESCRIPTOR_BUFFER_READ_BIT_EXT</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstStageMask-03929" href="#VUID-VkBufferMemoryBarrier2-dstStageMask-03929"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstStageMask-03929</span><br>

If the <a href="features.html#features-geometryShader" class="xref page"><code>geometryShader</code></a> feature is not
enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstStageMask-03930" href="#VUID-VkBufferMemoryBarrier2-dstStageMask-03930"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstStageMask-03930</span><br>

If the <a href="features.html#features-tessellationShader" class="xref page"><code>tessellationShader</code></a> feature
is not enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstStageMask-03931" href="#VUID-VkBufferMemoryBarrier2-dstStageMask-03931"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstStageMask-03931</span><br>

If the <a href="features.html#features-conditionalRendering" class="xref page"><code>conditionalRendering</code></a>
feature is not enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstStageMask-03932" href="#VUID-VkBufferMemoryBarrier2-dstStageMask-03932"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstStageMask-03932</span><br>

If the <a href="features.html#features-fragmentDensityMap" class="xref page"><code>fragmentDensityMap</code></a> feature
is not enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstStageMask-03933" href="#VUID-VkBufferMemoryBarrier2-dstStageMask-03933"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstStageMask-03933</span><br>

If the <a href="features.html#features-transformFeedback" class="xref page"><code>transformFeedback</code></a> feature
is not enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstStageMask-03934" href="#VUID-VkBufferMemoryBarrier2-dstStageMask-03934"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstStageMask-03934</span><br>

If the <a href="features.html#features-meshShader" class="xref page"><code>meshShader</code></a> feature is not enabled,
<code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstStageMask-03935" href="#VUID-VkBufferMemoryBarrier2-dstStageMask-03935"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstStageMask-03935</span><br>

If the <a href="features.html#features-taskShader" class="xref page"><code>taskShader</code></a> feature is not enabled,
<code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstStageMask-07316" href="#VUID-VkBufferMemoryBarrier2-dstStageMask-07316"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstStageMask-07316</span><br>

If neither the <a href="features.html#features-shadingRateImage" class="xref page"><code>shadingRateImage</code></a> or
<a href="features.html#features-attachmentFragmentShadingRate" class="xref page">    <code>attachmentFragmentShadingRate</code></a> are enabled, <code>dstStageMask</code>
<strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstStageMask-04957" href="#VUID-VkBufferMemoryBarrier2-dstStageMask-04957"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstStageMask-04957</span><br>

If the <a href="features.html#features-subpassShading" class="xref page"><code>subpassShading</code></a> feature is not
enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstStageMask-04995" href="#VUID-VkBufferMemoryBarrier2-dstStageMask-04995"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstStageMask-04995</span><br>

If the <a href="features.html#features-invocationMask" class="xref page"><code>invocationMask</code></a> feature is not
enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstStageMask-07946" href="#VUID-VkBufferMemoryBarrier2-dstStageMask-07946"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstStageMask-07946</span><br>

If neither the <a href="../appendices/extensions.html#VK_NV_ray_tracing" class="xref page">VK_NV_ray_tracing</a> extension or
<a href="features.html#features-rayTracingPipeline" class="xref page"><code>rayTracingPipeline</code> feature</a> are
enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03900" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03900"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03900</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_INDIRECT_COMMAND_READ_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03901" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03901"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03901</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_INDEX_READ_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_INDEX_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_VERTEX_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03902" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03902"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03902</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_VERTEX_ATTRIBUTE_READ_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_VERTEX_ATTRIBUTE_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_VERTEX_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03903" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03903"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03903</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_INPUT_ATTACHMENT_READ_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code>,
<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03904" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03904"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03904</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_UNIFORM_READ_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03905" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03905"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03905</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_SAMPLED_READ_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03906" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03906"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03906</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_STORAGE_READ_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03907" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03907"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03907</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_STORAGE_WRITE_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-07454" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-07454"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-07454</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_SHADER_READ_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code>,
or one of the <code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03909" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03909"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03909</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_SHADER_WRITE_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03910" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03910"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03910</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_COLOR_ATTACHMENT_READ_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code>
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03911" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03911"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03911</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_COLOR_ATTACHMENT_WRITE_BIT</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code>
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03912" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03912"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03912</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_READ_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03913" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03913"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03913</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03914" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03914"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03914</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_TRANSFER_READ_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COPY_BIT</code>,
<code>VK_PIPELINE_STAGE_2_BLIT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_RESOLVE_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_TRANSFER_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
or <code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03915" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03915"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03915</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_TRANSFER_WRITE_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COPY_BIT</code>,
<code>VK_PIPELINE_STAGE_2_BLIT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_RESOLVE_BIT</code>,
<code>VK_PIPELINE_STAGE_2_CLEAR_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_TRANSFER_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
or <code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03916" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03916"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03916</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_HOST_READ_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03917" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03917"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03917</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_HOST_WRITE_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03918" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03918"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03918</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_CONDITIONAL_RENDERING_READ_BIT_EXT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03919" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03919"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03919</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_FRAGMENT_DENSITY_MAP_READ_BIT_EXT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03920" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03920"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03920</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_TRANSFORM_FEEDBACK_WRITE_BIT_EXT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-04747" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-04747"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-04747</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_TRANSFORM_FEEDBACK_COUNTER_READ_BIT_EXT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03922" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03922"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03922</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_TRANSFORM_FEEDBACK_COUNTER_WRITE_BIT_EXT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03923" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03923"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03923</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_SHADING_RATE_IMAGE_READ_BIT_NV</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_SHADING_RATE_IMAGE_BIT_NV</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-04994" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-04994"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-04994</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_INVOCATION_MASK_READ_BIT_HUAWEI</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03924" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03924"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03924</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_COMMAND_PREPROCESS_READ_BIT_NV</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COMMAND_PREPROCESS_BIT_NV</code> or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03925" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03925"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03925</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_COMMAND_PREPROCESS_WRITE_BIT_NV</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COMMAND_PREPROCESS_BIT_NV</code> or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03926" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03926"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03926</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_COLOR_ATTACHMENT_READ_NONCOHERENT_BIT_EXT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code>
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03927" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03927"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03927</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-03928" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-03928"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-03928</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_ACCELERATION_STRUCTURE_WRITE_BIT_KHR</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code> or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-06256" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-06256"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-06256</span><br>

If
the <a href="features.html#features-rayQuery" class="xref page"><code>rayQuery</code></a> feature is not enabled and
<code>dstAccessMask</code> includes
<code>VK_ACCESS_2_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>,
<code>dstStageMask</code> <strong>must</strong> not include any of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages
except <code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-07272" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-07272"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-07272</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_BINDING_TABLE_READ_BIT_KHR</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code> or
<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-04858" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-04858"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-04858</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_DECODE_READ_BIT_KHR</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-04859" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-04859"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-04859</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_DECODE_WRITE_BIT_KHR</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-04860" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-04860"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-04860</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_ENCODE_READ_BIT_KHR</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-04861" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-04861"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-04861</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_ENCODE_WRITE_BIT_KHR</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-07455" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-07455"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-07455</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_OPTICAL_FLOW_READ_BIT_NV</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_OPTICAL_FLOW_BIT_NV</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-07456" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-07456"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-07456</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_OPTICAL_FLOW_WRITE_BIT_NV</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_OPTICAL_FLOW_BIT_NV</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-07457" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-07457"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-07457</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_MICROMAP_WRITE_BIT_EXT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-07458" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-07458"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-07458</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_MICROMAP_READ_BIT_EXT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code> or
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-08118" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-08118"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-08118</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_DESCRIPTOR_BUFFER_READ_BIT_EXT</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-offset-01187" href="#VUID-VkBufferMemoryBarrier2-offset-01187"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-offset-01187</span><br>

<code>offset</code> <strong>must</strong> be less than the size of <code>buffer</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-size-01188" href="#VUID-VkBufferMemoryBarrier2-size-01188"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-size-01188</span><br>

If <code>size</code> is not equal to <code>VK_WHOLE_SIZE</code>, <code>size</code> <strong>must</strong> be
greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-size-01189" href="#VUID-VkBufferMemoryBarrier2-size-01189"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-size-01189</span><br>

If <code>size</code> is not equal to <code>VK_WHOLE_SIZE</code>, <code>size</code> <strong>must</strong> be
less than or equal to than the size of <code>buffer</code> minus <code>offset</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-buffer-01931" href="#VUID-VkBufferMemoryBarrier2-buffer-01931"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-buffer-01931</span><br>

If <code>buffer</code> is non-sparse then it <strong>must</strong> be bound completely and
contiguously to a single <code>VkDeviceMemory</code> object</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-buffer-09095" href="#VUID-VkBufferMemoryBarrier2-buffer-09095"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-buffer-09095</span><br>

If <code>buffer</code> was created with a sharing mode of
<code>VK_SHARING_MODE_EXCLUSIVE</code>, and <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> are not equal, <code>srcQueueFamilyIndex</code> <strong>must</strong>
be
<code>VK_QUEUE_FAMILY_EXTERNAL</code>,
<code>VK_QUEUE_FAMILY_FOREIGN_EXT</code>,
or
a valid queue family</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-buffer-09096" href="#VUID-VkBufferMemoryBarrier2-buffer-09096"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-buffer-09096</span><br>

If <code>buffer</code> was created with a sharing mode of
<code>VK_SHARING_MODE_EXCLUSIVE</code>, and <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> are not equal, <code>dstQueueFamilyIndex</code> <strong>must</strong>
be
<code>VK_QUEUE_FAMILY_EXTERNAL</code>,
<code>VK_QUEUE_FAMILY_FOREIGN_EXT</code>,
or
a valid queue family</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcQueueFamilyIndex-04087" href="#VUID-VkBufferMemoryBarrier2-srcQueueFamilyIndex-04087"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcQueueFamilyIndex-04087</span><br>

If <code>srcQueueFamilyIndex</code> is not equal to <code>dstQueueFamilyIndex</code>,
at least one of <code>srcQueueFamilyIndex</code> or <code>dstQueueFamilyIndex</code>
<strong>must</strong> not be <code>VK_QUEUE_FAMILY_EXTERNAL</code>
or <code>VK_QUEUE_FAMILY_FOREIGN_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-None-09097" href="#VUID-VkBufferMemoryBarrier2-None-09097"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-None-09097</span><br>

    
If
    the <a href="../appendices/extensions.html#VK_KHR_external_memory" class="xref page">VK_KHR_external_memory</a> extension is not enabled,
and
    the value of <a href="initialization.html#VkApplicationInfo" class="xref page">VkApplicationInfo</a>::<code>apiVersion</code> used to create
    the <a href="initialization.html#VkInstance" class="xref page">VkInstance</a> is not greater than or equal to Version 1.1,
    <code>srcQueueFamilyIndex</code> <strong>must</strong> not be <code>VK_QUEUE_FAMILY_EXTERNAL</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-None-09098" href="#VUID-VkBufferMemoryBarrier2-None-09098"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-None-09098</span><br>

    
If
    the <a href="../appendices/extensions.html#VK_KHR_external_memory" class="xref page">VK_KHR_external_memory</a> extension is not enabled,
and
    the value of <a href="initialization.html#VkApplicationInfo" class="xref page">VkApplicationInfo</a>::<code>apiVersion</code> used to create
    the <a href="initialization.html#VkInstance" class="xref page">VkInstance</a> is not greater than or equal to Version 1.1,
    <code>dstQueueFamilyIndex</code> <strong>must</strong> not be <code>VK_QUEUE_FAMILY_EXTERNAL</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcQueueFamilyIndex-09099" href="#VUID-VkBufferMemoryBarrier2-srcQueueFamilyIndex-09099"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcQueueFamilyIndex-09099</span><br>

If the <a href="../appendices/extensions.html#VK_EXT_queue_family_foreign" class="xref page">VK_EXT_queue_family_foreign</a> extension is not enabled
<code>srcQueueFamilyIndex</code> <strong>must</strong> not be <code>VK_QUEUE_FAMILY_FOREIGN_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstQueueFamilyIndex-09100" href="#VUID-VkBufferMemoryBarrier2-dstQueueFamilyIndex-09100"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstQueueFamilyIndex-09100</span><br>

If the <a href="../appendices/extensions.html#VK_EXT_queue_family_foreign" class="xref page">VK_EXT_queue_family_foreign</a> extension is not enabled
<code>dstQueueFamilyIndex</code> <strong>must</strong> not be <code>VK_QUEUE_FAMILY_FOREIGN_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcStageMask-03851" href="#VUID-VkBufferMemoryBarrier2-srcStageMask-03851"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcStageMask-03851</span><br>

If either <code>srcStageMask</code> or <code>dstStageMask</code> includes
<code>VK_PIPELINE_STAGE_2_HOST_BIT</code>, <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> <strong>must</strong> be equal</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-sType-sType" href="#VUID-VkBufferMemoryBarrier2-sType-sType"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_BUFFER_MEMORY_BARRIER_2</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-pNext-pNext" href="#VUID-VkBufferMemoryBarrier2-pNext-pNext"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code> or a pointer to a valid instance of <a href="#VkExternalMemoryAcquireUnmodifiedEXT">VkExternalMemoryAcquireUnmodifiedEXT</a></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-sType-unique" href="#VUID-VkBufferMemoryBarrier2-sType-unique"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcStageMask-parameter" href="#VUID-VkBufferMemoryBarrier2-srcStageMask-parameter"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcStageMask-parameter</span><br>
 <code>srcStageMask</code> <strong>must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits2">VkPipelineStageFlagBits2</a> values</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-srcAccessMask-parameter" href="#VUID-VkBufferMemoryBarrier2-srcAccessMask-parameter"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-srcAccessMask-parameter</span><br>
 <code>srcAccessMask</code> <strong>must</strong> be a valid combination of <a href="#VkAccessFlagBits2">VkAccessFlagBits2</a> values</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstStageMask-parameter" href="#VUID-VkBufferMemoryBarrier2-dstStageMask-parameter"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstStageMask-parameter</span><br>
 <code>dstStageMask</code> <strong>must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits2">VkPipelineStageFlagBits2</a> values</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-dstAccessMask-parameter" href="#VUID-VkBufferMemoryBarrier2-dstAccessMask-parameter"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-dstAccessMask-parameter</span><br>
 <code>dstAccessMask</code> <strong>must</strong> be a valid combination of <a href="#VkAccessFlagBits2">VkAccessFlagBits2</a> values</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier2-buffer-parameter" href="#VUID-VkBufferMemoryBarrier2-buffer-parameter"></a> <span class="vuid">VUID-VkBufferMemoryBarrier2-buffer-parameter</span><br>
 <code>buffer</code> <strong>must</strong> be a valid <a href="resources.html#VkBuffer" class="xref page">VkBuffer</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkBufferMemoryBarrier</code> structure is defined as:</p>
</div>
<div id="VkBufferMemoryBarrier" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef struct VkBufferMemoryBarrier {
    VkStructureType    sType;
    const void*        pNext;
    VkAccessFlags      srcAccessMask;
    VkAccessFlags      dstAccessMask;
    uint32_t           srcQueueFamilyIndex;
    uint32_t           dstQueueFamilyIndex;
    VkBuffer           buffer;
    VkDeviceSize       offset;
    VkDeviceSize       size;
} VkBufferMemoryBarrier;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>srcAccessMask</code> is a bitmask of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> specifying a
<a href="#synchronization-access-masks">source access mask</a>.</p>
</li>
<li>
<p><code>dstAccessMask</code> is a bitmask of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> specifying a
<a href="#synchronization-access-masks">destination access mask</a>.</p>
</li>
<li>
<p><code>srcQueueFamilyIndex</code> is the source queue family for a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a>.</p>
</li>
<li>
<p><code>dstQueueFamilyIndex</code> is the destination queue family for a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a>.</p>
</li>
<li>
<p><code>buffer</code> is a handle to the buffer whose backing memory is affected
by the barrier.</p>
</li>
<li>
<p><code>offset</code> is an offset in bytes into the backing memory for
<code>buffer</code>; this is relative to the base offset as bound to the buffer
(see <a href="resources.html#vkBindBufferMemory" class="xref page">vkBindBufferMemory</a>).</p>
</li>
<li>
<p><code>size</code> is a size in bytes of the affected area of backing memory for
<code>buffer</code>, or <code>VK_WHOLE_SIZE</code> to use the range from <code>offset</code>
to the end of the buffer.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to access to memory through the specified buffer range, via access
types in the <a href="#synchronization-access-masks">source access mask</a> specified
by <code>srcAccessMask</code>.
If <code>srcAccessMask</code> includes <code>VK_ACCESS_HOST_WRITE_BIT</code>, a
<a href="#synchronization-dependencies-available-and-visible">memory domain operation</a> is performed where available memory in the host domain is also
made available to the device domain.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to access to memory through the specified buffer range, via access
types in the <a href="#synchronization-access-masks">destination access mask</a>
specified by <code>dstAccessMask</code>.
If <code>dstAccessMask</code> includes <code>VK_ACCESS_HOST_WRITE_BIT</code> or
<code>VK_ACCESS_HOST_READ_BIT</code>, a
<a href="#synchronization-dependencies-available-and-visible">memory domain operation</a> is performed where available memory in the device domain is also
made available to the host domain.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>When <code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code> is used, available memory in
host domain is automatically made visible to host domain, and any host write
is automatically made available to host domain.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code>srcQueueFamilyIndex</code> is not equal to <code>dstQueueFamilyIndex</code>, and
<code>srcQueueFamilyIndex</code> is equal to the current queue family, then the
memory barrier defines a <a href="#synchronization-queue-transfers-release">queue family release operation</a> for the specified buffer range, and the second
access scope includes no access, as if <code>dstAccessMask</code> was <code>0</code>.</p>
</div>
<div class="paragraph">
<p>If <code>dstQueueFamilyIndex</code> is not equal to <code>srcQueueFamilyIndex</code>, and
<code>dstQueueFamilyIndex</code> is equal to the current queue family, then the
memory barrier defines a <a href="#synchronization-queue-transfers-acquire">queue family acquire operation</a> for the specified buffer range, and the first
access scope includes no access, as if <code>srcAccessMask</code> was <code>0</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-offset-01187" href="#VUID-VkBufferMemoryBarrier-offset-01187"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-offset-01187</span><br>

<code>offset</code> <strong>must</strong> be less than the size of <code>buffer</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-size-01188" href="#VUID-VkBufferMemoryBarrier-size-01188"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-size-01188</span><br>

If <code>size</code> is not equal to <code>VK_WHOLE_SIZE</code>, <code>size</code> <strong>must</strong> be
greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-size-01189" href="#VUID-VkBufferMemoryBarrier-size-01189"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-size-01189</span><br>

If <code>size</code> is not equal to <code>VK_WHOLE_SIZE</code>, <code>size</code> <strong>must</strong> be
less than or equal to than the size of <code>buffer</code> minus <code>offset</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-buffer-01931" href="#VUID-VkBufferMemoryBarrier-buffer-01931"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-buffer-01931</span><br>

If <code>buffer</code> is non-sparse then it <strong>must</strong> be bound completely and
contiguously to a single <code>VkDeviceMemory</code> object</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-buffer-09095" href="#VUID-VkBufferMemoryBarrier-buffer-09095"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-buffer-09095</span><br>

If <code>buffer</code> was created with a sharing mode of
<code>VK_SHARING_MODE_EXCLUSIVE</code>, and <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> are not equal, <code>srcQueueFamilyIndex</code> <strong>must</strong>
be
<code>VK_QUEUE_FAMILY_EXTERNAL</code>,
<code>VK_QUEUE_FAMILY_FOREIGN_EXT</code>,
or
a valid queue family</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-buffer-09096" href="#VUID-VkBufferMemoryBarrier-buffer-09096"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-buffer-09096</span><br>

If <code>buffer</code> was created with a sharing mode of
<code>VK_SHARING_MODE_EXCLUSIVE</code>, and <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> are not equal, <code>dstQueueFamilyIndex</code> <strong>must</strong>
be
<code>VK_QUEUE_FAMILY_EXTERNAL</code>,
<code>VK_QUEUE_FAMILY_FOREIGN_EXT</code>,
or
a valid queue family</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-srcQueueFamilyIndex-04087" href="#VUID-VkBufferMemoryBarrier-srcQueueFamilyIndex-04087"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-srcQueueFamilyIndex-04087</span><br>

If <code>srcQueueFamilyIndex</code> is not equal to <code>dstQueueFamilyIndex</code>,
at least one of <code>srcQueueFamilyIndex</code> or <code>dstQueueFamilyIndex</code>
<strong>must</strong> not be <code>VK_QUEUE_FAMILY_EXTERNAL</code>
or <code>VK_QUEUE_FAMILY_FOREIGN_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-None-09097" href="#VUID-VkBufferMemoryBarrier-None-09097"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-None-09097</span><br>

    
If
    the <a href="../appendices/extensions.html#VK_KHR_external_memory" class="xref page">VK_KHR_external_memory</a> extension is not enabled,
and
    the value of <a href="initialization.html#VkApplicationInfo" class="xref page">VkApplicationInfo</a>::<code>apiVersion</code> used to create
    the <a href="initialization.html#VkInstance" class="xref page">VkInstance</a> is not greater than or equal to Version 1.1,
    <code>srcQueueFamilyIndex</code> <strong>must</strong> not be <code>VK_QUEUE_FAMILY_EXTERNAL</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-None-09098" href="#VUID-VkBufferMemoryBarrier-None-09098"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-None-09098</span><br>

    
If
    the <a href="../appendices/extensions.html#VK_KHR_external_memory" class="xref page">VK_KHR_external_memory</a> extension is not enabled,
and
    the value of <a href="initialization.html#VkApplicationInfo" class="xref page">VkApplicationInfo</a>::<code>apiVersion</code> used to create
    the <a href="initialization.html#VkInstance" class="xref page">VkInstance</a> is not greater than or equal to Version 1.1,
    <code>dstQueueFamilyIndex</code> <strong>must</strong> not be <code>VK_QUEUE_FAMILY_EXTERNAL</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-srcQueueFamilyIndex-09099" href="#VUID-VkBufferMemoryBarrier-srcQueueFamilyIndex-09099"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-srcQueueFamilyIndex-09099</span><br>

If the <a href="../appendices/extensions.html#VK_EXT_queue_family_foreign" class="xref page">VK_EXT_queue_family_foreign</a> extension is not enabled
<code>srcQueueFamilyIndex</code> <strong>must</strong> not be <code>VK_QUEUE_FAMILY_FOREIGN_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-dstQueueFamilyIndex-09100" href="#VUID-VkBufferMemoryBarrier-dstQueueFamilyIndex-09100"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-dstQueueFamilyIndex-09100</span><br>

If the <a href="../appendices/extensions.html#VK_EXT_queue_family_foreign" class="xref page">VK_EXT_queue_family_foreign</a> extension is not enabled
<code>dstQueueFamilyIndex</code> <strong>must</strong> not be <code>VK_QUEUE_FAMILY_FOREIGN_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-None-09049" href="#VUID-VkBufferMemoryBarrier-None-09049"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-None-09049</span><br>

If
the <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature is not
enabled, and
<code>buffer</code> was created with a sharing mode of
<code>VK_SHARING_MODE_CONCURRENT</code>, at least one of
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> <strong>must</strong> be
<code>VK_QUEUE_FAMILY_IGNORED</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-None-09050" href="#VUID-VkBufferMemoryBarrier-None-09050"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-None-09050</span><br>

If
the <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature is not
enabled, and
<code>buffer</code> was created with a sharing mode of
<code>VK_SHARING_MODE_CONCURRENT</code>, <code>srcQueueFamilyIndex</code> <strong>must</strong> be
<code>VK_QUEUE_FAMILY_IGNORED</code>
or <code>VK_QUEUE_FAMILY_EXTERNAL</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-None-09051" href="#VUID-VkBufferMemoryBarrier-None-09051"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-None-09051</span><br>

If
the <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature is not
enabled, and
<code>buffer</code> was created with a sharing mode of
<code>VK_SHARING_MODE_CONCURRENT</code>, <code>dstQueueFamilyIndex</code> <strong>must</strong> be
<code>VK_QUEUE_FAMILY_IGNORED</code>
or <code>VK_QUEUE_FAMILY_EXTERNAL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-sType-sType" href="#VUID-VkBufferMemoryBarrier-sType-sType"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_BUFFER_MEMORY_BARRIER</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-pNext-pNext" href="#VUID-VkBufferMemoryBarrier-pNext-pNext"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code> or a pointer to a valid instance of <a href="#VkExternalMemoryAcquireUnmodifiedEXT">VkExternalMemoryAcquireUnmodifiedEXT</a></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-sType-unique" href="#VUID-VkBufferMemoryBarrier-sType-unique"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-buffer-parameter" href="#VUID-VkBufferMemoryBarrier-buffer-parameter"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-buffer-parameter</span><br>
 <code>buffer</code> <strong>must</strong> be a valid <a href="resources.html#VkBuffer" class="xref page">VkBuffer</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>VK_WHOLE_SIZE</code> is a special value indicating that the entire remaining
length of a buffer following a given <code>offset</code> should be used.
It <strong>can</strong> be specified for <a href="#VkBufferMemoryBarrier">VkBufferMemoryBarrier</a>::<code>size</code> and other
structures.</p>
</div>
<div id="VK_WHOLE_SIZE" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">#define VK_WHOLE_SIZE                     (~0ULL)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-image-memory-barriers"><a class="anchor" href="#synchronization-image-memory-barriers"></a>Image Memory Barriers</h3>
<div class="paragraph">
<p>Image memory barriers only apply to memory accesses involving a specific
image subresource range.
That is, a memory dependency formed from an image memory barrier is
<a href="#synchronization-dependencies-access-scopes">scoped</a> to access via the
specified image subresource range.
Image memory barriers <strong>can</strong> also be used to define
<a href="#synchronization-image-layout-transitions">image layout transitions</a> or a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> for the
specified image subresource range.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkImageMemoryBarrier2</code> structure is defined as:</p>
</div>
<div id="VkImageMemoryBarrier2" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
typedef struct VkImageMemoryBarrier2 {
    VkStructureType            sType;
    const void*                pNext;
    VkPipelineStageFlags2      srcStageMask;
    VkAccessFlags2             srcAccessMask;
    VkPipelineStageFlags2      dstStageMask;
    VkAccessFlags2             dstAccessMask;
    VkImageLayout              oldLayout;
    VkImageLayout              newLayout;
    uint32_t                   srcQueueFamilyIndex;
    uint32_t                   dstQueueFamilyIndex;
    VkImage                    image;
    VkImageSubresourceRange    subresourceRange;
} VkImageMemoryBarrier2;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkImageMemoryBarrier2KHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_synchronization2
typedef VkImageMemoryBarrier2 VkImageMemoryBarrier2KHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>srcStageMask</code> is a <a href="#VkPipelineStageFlags2">VkPipelineStageFlags2</a> mask of pipeline
stages to be included in the <a href="#synchronization-dependencies-scopes">    first synchronization scope</a>.</p>
</li>
<li>
<p><code>srcAccessMask</code> is a <a href="#VkAccessFlags2">VkAccessFlags2</a> mask of access flags to be
included in the <a href="#synchronization-dependencies-access-scopes">first    access scope</a>.</p>
</li>
<li>
<p><code>dstStageMask</code> is a <a href="#VkPipelineStageFlags2">VkPipelineStageFlags2</a> mask of pipeline
stages to be included in the <a href="#synchronization-dependencies-scopes">    second synchronization scope</a>.</p>
</li>
<li>
<p><code>dstAccessMask</code> is a <a href="#VkAccessFlags2">VkAccessFlags2</a> mask of access flags to be
included in the <a href="#synchronization-dependencies-access-scopes">second    access scope</a>.</p>
</li>
<li>
<p><code>oldLayout</code> is the old layout in an
<a href="#synchronization-image-layout-transitions">image layout transition</a>.</p>
</li>
<li>
<p><code>newLayout</code> is the new layout in an
<a href="#synchronization-image-layout-transitions">image layout transition</a>.</p>
</li>
<li>
<p><code>srcQueueFamilyIndex</code> is the source queue family for a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a>.</p>
</li>
<li>
<p><code>dstQueueFamilyIndex</code> is the destination queue family for a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a>.</p>
</li>
<li>
<p><code>image</code> is a handle to the image affected by this barrier.</p>
</li>
<li>
<p><code>subresourceRange</code> describes the <a href="resources.html#resources-image-views" class="xref page">image    subresource range</a> within <code>image</code> that is affected by this barrier.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure defines a <a href="#synchronization-dependencies-memory">memory dependency</a> limited to an image subresource range, and <strong>can</strong> define a
<a href="#synchronization-queue-transfers">queue family transfer operation</a> and
<a href="#synchronization-image-layout-transitions">image layout transition</a> for
that subresource range.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-scopes">synchronization scope</a> and
<a href="#synchronization-dependencies-access-scopes">access scope</a> described by
this structure include only operations and memory accesses specified by
<code>srcStageMask</code> and <code>srcAccessMask</code>.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
and <a href="#synchronization-dependencies-access-scopes">access scope</a> described
by this structure include only operations and memory accesses specified by
<code>dstStageMask</code> and <code>dstAccessMask</code>.</p>
</div>
<div class="paragraph">
<p>Both <a href="#synchronization-dependencies-access-scopes">access scopes</a> are
limited to only memory accesses to <code>image</code> in the subresource range
defined by <code>subresourceRange</code>.</p>
</div>
<div class="paragraph">
<p>If <code>image</code> was created with <code>VK_SHARING_MODE_EXCLUSIVE</code>, and
<code>srcQueueFamilyIndex</code> is not equal to <code>dstQueueFamilyIndex</code>, this
memory barrier defines a <a href="#synchronization-queue-transfers">queue family transfer operation</a>.
When executed on a queue in the family identified by
<code>srcQueueFamilyIndex</code>, this barrier defines a
<a href="#synchronization-queue-transfers-release">queue family release operation</a>
for the specified image subresource range, and the second synchronization
and access scopes do not synchronize operations on that queue.
When executed on a queue in the family identified by
<code>dstQueueFamilyIndex</code>, this barrier defines a
<a href="#synchronization-queue-transfers-acquire">queue family acquire operation</a>
for the specified image subresource range, and the first synchronization and
access scopes do not synchronize operations on that queue.</p>
</div>
<div class="paragraph">
<p>A <a href="#synchronization-queue-transfers">queue family transfer operation</a> is
also defined if the values are not equal, and either is one of the special
queue family values reserved for external memory ownership transfers, as
described in <a href="#synchronization-queue-transfers">Queue Family Ownership Transfer</a>.
A <a href="#synchronization-queue-transfers-release">queue family release operation</a> is defined when <code>dstQueueFamilyIndex</code> is one of those
values, and a <a href="#synchronization-queue-transfers-acquire">queue family acquire operation</a> is defined when <code>srcQueueFamilyIndex</code> is one of
those values.</p>
</div>
<div class="paragraph">
<p>If <code>oldLayout</code> is not equal to <code>newLayout</code>, then the memory barrier
defines an <a href="#synchronization-image-layout-transitions">image layout transition</a> for the specified image subresource range.
If this memory barrier defines a <a href="#synchronization-queue-transfers">queue family transfer operation</a>, the layout transition is only executed once
between the queues.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>When the old and new layout are equal, the layout values are ignored - data
is preserved no matter what values are specified, or what layout the image
is currently in.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code>image</code> has a multi-planar format and the image is <em>disjoint</em>, then
including <code>VK_IMAGE_ASPECT_COLOR_BIT</code> in the <code>aspectMask</code> member of
<code>subresourceRange</code> is equivalent to including
<code>VK_IMAGE_ASPECT_PLANE_0_BIT</code>, <code>VK_IMAGE_ASPECT_PLANE_1_BIT</code>, and
(for three-plane formats only) <code>VK_IMAGE_ASPECT_PLANE_2_BIT</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcStageMask-03929" href="#VUID-VkImageMemoryBarrier2-srcStageMask-03929"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcStageMask-03929</span><br>

If the <a href="features.html#features-geometryShader" class="xref page"><code>geometryShader</code></a> feature is not
enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcStageMask-03930" href="#VUID-VkImageMemoryBarrier2-srcStageMask-03930"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcStageMask-03930</span><br>

If the <a href="features.html#features-tessellationShader" class="xref page"><code>tessellationShader</code></a> feature
is not enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcStageMask-03931" href="#VUID-VkImageMemoryBarrier2-srcStageMask-03931"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcStageMask-03931</span><br>

If the <a href="features.html#features-conditionalRendering" class="xref page"><code>conditionalRendering</code></a>
feature is not enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcStageMask-03932" href="#VUID-VkImageMemoryBarrier2-srcStageMask-03932"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcStageMask-03932</span><br>

If the <a href="features.html#features-fragmentDensityMap" class="xref page"><code>fragmentDensityMap</code></a> feature
is not enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcStageMask-03933" href="#VUID-VkImageMemoryBarrier2-srcStageMask-03933"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcStageMask-03933</span><br>

If the <a href="features.html#features-transformFeedback" class="xref page"><code>transformFeedback</code></a> feature
is not enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcStageMask-03934" href="#VUID-VkImageMemoryBarrier2-srcStageMask-03934"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcStageMask-03934</span><br>

If the <a href="features.html#features-meshShader" class="xref page"><code>meshShader</code></a> feature is not enabled,
<code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcStageMask-03935" href="#VUID-VkImageMemoryBarrier2-srcStageMask-03935"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcStageMask-03935</span><br>

If the <a href="features.html#features-taskShader" class="xref page"><code>taskShader</code></a> feature is not enabled,
<code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcStageMask-07316" href="#VUID-VkImageMemoryBarrier2-srcStageMask-07316"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcStageMask-07316</span><br>

If neither the <a href="features.html#features-shadingRateImage" class="xref page"><code>shadingRateImage</code></a> or
<a href="features.html#features-attachmentFragmentShadingRate" class="xref page">    <code>attachmentFragmentShadingRate</code></a> are enabled, <code>srcStageMask</code>
<strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcStageMask-04957" href="#VUID-VkImageMemoryBarrier2-srcStageMask-04957"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcStageMask-04957</span><br>

If the <a href="features.html#features-subpassShading" class="xref page"><code>subpassShading</code></a> feature is not
enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcStageMask-04995" href="#VUID-VkImageMemoryBarrier2-srcStageMask-04995"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcStageMask-04995</span><br>

If the <a href="features.html#features-invocationMask" class="xref page"><code>invocationMask</code></a> feature is not
enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcStageMask-07946" href="#VUID-VkImageMemoryBarrier2-srcStageMask-07946"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcStageMask-07946</span><br>

If neither the <a href="../appendices/extensions.html#VK_NV_ray_tracing" class="xref page">VK_NV_ray_tracing</a> extension or
<a href="features.html#features-rayTracingPipeline" class="xref page"><code>rayTracingPipeline</code> feature</a> are
enabled, <code>srcStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03900" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03900"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03900</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_INDIRECT_COMMAND_READ_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03901" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03901"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03901</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_INDEX_READ_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_INDEX_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_VERTEX_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03902" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03902"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03902</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_VERTEX_ATTRIBUTE_READ_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_VERTEX_ATTRIBUTE_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_VERTEX_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03903" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03903"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03903</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_INPUT_ATTACHMENT_READ_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code>,
<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03904" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03904"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03904</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_UNIFORM_READ_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03905" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03905"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03905</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_SAMPLED_READ_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03906" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03906"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03906</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_STORAGE_READ_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03907" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03907"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03907</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_STORAGE_WRITE_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-07454" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-07454"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-07454</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_SHADER_READ_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code>,
or one of the <code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03909" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03909"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03909</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_SHADER_WRITE_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03910" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03910"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03910</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_COLOR_ATTACHMENT_READ_BIT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code>
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03911" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03911"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03911</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_COLOR_ATTACHMENT_WRITE_BIT</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code>
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03912" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03912"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03912</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_READ_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03913" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03913"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03913</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03914" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03914"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03914</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_TRANSFER_READ_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COPY_BIT</code>,
<code>VK_PIPELINE_STAGE_2_BLIT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_RESOLVE_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_TRANSFER_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
or <code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03915" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03915"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03915</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_TRANSFER_WRITE_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COPY_BIT</code>,
<code>VK_PIPELINE_STAGE_2_BLIT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_RESOLVE_BIT</code>,
<code>VK_PIPELINE_STAGE_2_CLEAR_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_TRANSFER_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
or <code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03916" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03916"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03916</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_HOST_READ_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03917" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03917"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03917</span><br>

If <code>srcAccessMask</code> includes <code>VK_ACCESS_2_HOST_WRITE_BIT</code>,
<code>srcStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03918" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03918"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03918</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_CONDITIONAL_RENDERING_READ_BIT_EXT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03919" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03919"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03919</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_FRAGMENT_DENSITY_MAP_READ_BIT_EXT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03920" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03920"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03920</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_TRANSFORM_FEEDBACK_WRITE_BIT_EXT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-04747" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-04747"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-04747</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_TRANSFORM_FEEDBACK_COUNTER_READ_BIT_EXT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03922" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03922"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03922</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_TRANSFORM_FEEDBACK_COUNTER_WRITE_BIT_EXT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03923" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03923"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03923</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_SHADING_RATE_IMAGE_READ_BIT_NV</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_SHADING_RATE_IMAGE_BIT_NV</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-04994" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-04994"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-04994</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_INVOCATION_MASK_READ_BIT_HUAWEI</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03924" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03924"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03924</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_COMMAND_PREPROCESS_READ_BIT_NV</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COMMAND_PREPROCESS_BIT_NV</code> or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03925" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03925"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03925</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_COMMAND_PREPROCESS_WRITE_BIT_NV</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COMMAND_PREPROCESS_BIT_NV</code> or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03926" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03926"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03926</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_COLOR_ATTACHMENT_READ_NONCOHERENT_BIT_EXT</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code>
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03927" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03927"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03927</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-03928" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-03928"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-03928</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_ACCELERATION_STRUCTURE_WRITE_BIT_KHR</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code> or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-06256" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-06256"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-06256</span><br>

If
the <a href="features.html#features-rayQuery" class="xref page"><code>rayQuery</code></a> feature is not enabled and
<code>srcAccessMask</code> includes
<code>VK_ACCESS_2_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>,
<code>srcStageMask</code> <strong>must</strong> not include any of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages
except <code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-07272" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-07272"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-07272</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_BINDING_TABLE_READ_BIT_KHR</code>,
<code>srcStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code> or
<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-04858" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-04858"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-04858</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_DECODE_READ_BIT_KHR</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-04859" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-04859"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-04859</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_DECODE_WRITE_BIT_KHR</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-04860" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-04860"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-04860</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_ENCODE_READ_BIT_KHR</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-04861" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-04861"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-04861</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_ENCODE_WRITE_BIT_KHR</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-07455" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-07455"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-07455</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_OPTICAL_FLOW_READ_BIT_NV</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_OPTICAL_FLOW_BIT_NV</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-07456" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-07456"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-07456</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_OPTICAL_FLOW_WRITE_BIT_NV</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_OPTICAL_FLOW_BIT_NV</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-07457" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-07457"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-07457</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_MICROMAP_WRITE_BIT_EXT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-07458" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-07458"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-07458</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_MICROMAP_READ_BIT_EXT</code>, <code>srcStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code> or
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-08118" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-08118"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-08118</span><br>

If <code>srcAccessMask</code> includes
<code>VK_ACCESS_2_DESCRIPTOR_BUFFER_READ_BIT_EXT</code>, <code>srcStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstStageMask-03929" href="#VUID-VkImageMemoryBarrier2-dstStageMask-03929"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstStageMask-03929</span><br>

If the <a href="features.html#features-geometryShader" class="xref page"><code>geometryShader</code></a> feature is not
enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstStageMask-03930" href="#VUID-VkImageMemoryBarrier2-dstStageMask-03930"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstStageMask-03930</span><br>

If the <a href="features.html#features-tessellationShader" class="xref page"><code>tessellationShader</code></a> feature
is not enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstStageMask-03931" href="#VUID-VkImageMemoryBarrier2-dstStageMask-03931"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstStageMask-03931</span><br>

If the <a href="features.html#features-conditionalRendering" class="xref page"><code>conditionalRendering</code></a>
feature is not enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstStageMask-03932" href="#VUID-VkImageMemoryBarrier2-dstStageMask-03932"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstStageMask-03932</span><br>

If the <a href="features.html#features-fragmentDensityMap" class="xref page"><code>fragmentDensityMap</code></a> feature
is not enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstStageMask-03933" href="#VUID-VkImageMemoryBarrier2-dstStageMask-03933"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstStageMask-03933</span><br>

If the <a href="features.html#features-transformFeedback" class="xref page"><code>transformFeedback</code></a> feature
is not enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstStageMask-03934" href="#VUID-VkImageMemoryBarrier2-dstStageMask-03934"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstStageMask-03934</span><br>

If the <a href="features.html#features-meshShader" class="xref page"><code>meshShader</code></a> feature is not enabled,
<code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstStageMask-03935" href="#VUID-VkImageMemoryBarrier2-dstStageMask-03935"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstStageMask-03935</span><br>

If the <a href="features.html#features-taskShader" class="xref page"><code>taskShader</code></a> feature is not enabled,
<code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstStageMask-07316" href="#VUID-VkImageMemoryBarrier2-dstStageMask-07316"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstStageMask-07316</span><br>

If neither the <a href="features.html#features-shadingRateImage" class="xref page"><code>shadingRateImage</code></a> or
<a href="features.html#features-attachmentFragmentShadingRate" class="xref page">    <code>attachmentFragmentShadingRate</code></a> are enabled, <code>dstStageMask</code>
<strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstStageMask-04957" href="#VUID-VkImageMemoryBarrier2-dstStageMask-04957"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstStageMask-04957</span><br>

If the <a href="features.html#features-subpassShading" class="xref page"><code>subpassShading</code></a> feature is not
enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstStageMask-04995" href="#VUID-VkImageMemoryBarrier2-dstStageMask-04995"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstStageMask-04995</span><br>

If the <a href="features.html#features-invocationMask" class="xref page"><code>invocationMask</code></a> feature is not
enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstStageMask-07946" href="#VUID-VkImageMemoryBarrier2-dstStageMask-07946"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstStageMask-07946</span><br>

If neither the <a href="../appendices/extensions.html#VK_NV_ray_tracing" class="xref page">VK_NV_ray_tracing</a> extension or
<a href="features.html#features-rayTracingPipeline" class="xref page"><code>rayTracingPipeline</code> feature</a> are
enabled, <code>dstStageMask</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03900" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03900"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03900</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_INDIRECT_COMMAND_READ_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03901" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03901"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03901</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_INDEX_READ_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_INDEX_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_VERTEX_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03902" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03902"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03902</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_VERTEX_ATTRIBUTE_READ_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_VERTEX_ATTRIBUTE_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_VERTEX_INPUT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03903" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03903"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03903</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_INPUT_ATTACHMENT_READ_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADER_BIT</code>,
<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03904" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03904"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03904</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_UNIFORM_READ_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03905" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03905"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03905</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_SAMPLED_READ_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03906" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03906"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03906</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_STORAGE_READ_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03907" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03907"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03907</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_STORAGE_WRITE_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-07454" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-07454"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-07454</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_SHADER_READ_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code>,
or one of the <code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03909" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03909"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03909</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_SHADER_WRITE_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03910" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03910"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03910</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_COLOR_ATTACHMENT_READ_BIT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code>
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03911" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03911"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03911</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_COLOR_ATTACHMENT_WRITE_BIT</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code>
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03912" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03912"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03912</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_READ_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03913" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03913"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03913</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_EARLY_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_LATE_FRAGMENT_TESTS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03914" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03914"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03914</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_TRANSFER_READ_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COPY_BIT</code>,
<code>VK_PIPELINE_STAGE_2_BLIT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_RESOLVE_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_TRANSFER_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
or <code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03915" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03915"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03915</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_TRANSFER_WRITE_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COPY_BIT</code>,
<code>VK_PIPELINE_STAGE_2_BLIT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_RESOLVE_BIT</code>,
<code>VK_PIPELINE_STAGE_2_CLEAR_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_TRANSFER_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
or <code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03916" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03916"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03916</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_HOST_READ_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03917" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03917"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03917</span><br>

If <code>dstAccessMask</code> includes <code>VK_ACCESS_2_HOST_WRITE_BIT</code>,
<code>dstStageMask</code> <strong>must</strong> include <code>VK_PIPELINE_STAGE_2_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03918" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03918"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03918</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_CONDITIONAL_RENDERING_READ_BIT_EXT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03919" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03919"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03919</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_FRAGMENT_DENSITY_MAP_READ_BIT_EXT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03920" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03920"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03920</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_TRANSFORM_FEEDBACK_WRITE_BIT_EXT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-04747" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-04747"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-04747</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_TRANSFORM_FEEDBACK_COUNTER_READ_BIT_EXT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_DRAW_INDIRECT_BIT</code>,
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03922" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03922"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03922</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_TRANSFORM_FEEDBACK_COUNTER_WRITE_BIT_EXT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03923" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03923"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03923</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_SHADING_RATE_IMAGE_READ_BIT_NV</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_SHADING_RATE_IMAGE_BIT_NV</code>,
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-04994" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-04994"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-04994</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_INVOCATION_MASK_READ_BIT_HUAWEI</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03924" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03924"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03924</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_COMMAND_PREPROCESS_READ_BIT_NV</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COMMAND_PREPROCESS_BIT_NV</code> or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03925" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03925"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03925</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_COMMAND_PREPROCESS_WRITE_BIT_NV</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_COMMAND_PREPROCESS_BIT_NV</code> or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03926" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03926"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03926</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_COLOR_ATTACHMENT_READ_NONCOHERENT_BIT_EXT</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_COLOR_ATTACHMENT_OUTPUT_BIT</code>
<code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>, or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03927" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03927"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03927</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-03928" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-03928"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-03928</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_ACCELERATION_STRUCTURE_WRITE_BIT_KHR</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_COPY_BIT_KHR</code>,
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code> or
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-06256" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-06256"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-06256</span><br>

If
the <a href="features.html#features-rayQuery" class="xref page"><code>rayQuery</code></a> feature is not enabled and
<code>dstAccessMask</code> includes
<code>VK_ACCESS_2_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>,
<code>dstStageMask</code> <strong>must</strong> not include any of the
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages
except <code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-07272" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-07272"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-07272</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_SHADER_BINDING_TABLE_READ_BIT_KHR</code>,
<code>dstStageMask</code> <strong>must</strong> include
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code> or
<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-04858" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-04858"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-04858</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_DECODE_READ_BIT_KHR</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-04859" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-04859"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-04859</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_DECODE_WRITE_BIT_KHR</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-04860" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-04860"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-04860</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_ENCODE_READ_BIT_KHR</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-04861" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-04861"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-04861</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_VIDEO_ENCODE_WRITE_BIT_KHR</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-07455" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-07455"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-07455</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_OPTICAL_FLOW_READ_BIT_NV</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_OPTICAL_FLOW_BIT_NV</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-07456" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-07456"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-07456</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_OPTICAL_FLOW_WRITE_BIT_NV</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_OPTICAL_FLOW_BIT_NV</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-07457" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-07457"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-07457</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_MICROMAP_WRITE_BIT_EXT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-07458" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-07458"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-07458</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_MICROMAP_READ_BIT_EXT</code>, <code>dstStageMask</code> <strong>must</strong>
include <code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code> or
<code>VK_PIPELINE_STAGE_2_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-08118" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-08118"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-08118</span><br>

If <code>dstAccessMask</code> includes
<code>VK_ACCESS_2_DESCRIPTOR_BUFFER_READ_BIT_EXT</code>, <code>dstStageMask</code>
<strong>must</strong> include <code>VK_PIPELINE_STAGE_2_ALL_GRAPHICS_BIT</code>,
<code>VK_PIPELINE_STAGE_2_ALL_COMMANDS_BIT</code>, or one of
<code>VK_PIPELINE_STAGE_*_SHADER_BIT</code> stages</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-oldLayout-01208" href="#VUID-VkImageMemoryBarrier2-oldLayout-01208"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-oldLayout-01208</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL</code> then <code>image</code> <strong>must</strong>
have been created with <code>VK_IMAGE_USAGE_COLOR_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-oldLayout-01209" href="#VUID-VkImageMemoryBarrier2-oldLayout-01209"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-oldLayout-01209</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_DEPTH_STENCIL_ATTACHMENT_OPTIMAL</code> then <code>image</code>
<strong>must</strong> have been created with
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-oldLayout-01210" href="#VUID-VkImageMemoryBarrier2-oldLayout-01210"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-oldLayout-01210</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_DEPTH_STENCIL_READ_ONLY_OPTIMAL</code> then <code>image</code>
<strong>must</strong> have been created with
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-oldLayout-01211" href="#VUID-VkImageMemoryBarrier2-oldLayout-01211"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-oldLayout-01211</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_SHADER_READ_ONLY_OPTIMAL</code> then <code>image</code> <strong>must</strong>
have been created with <code>VK_IMAGE_USAGE_SAMPLED_BIT</code> or
<code>VK_IMAGE_USAGE_INPUT_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-oldLayout-01212" href="#VUID-VkImageMemoryBarrier2-oldLayout-01212"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-oldLayout-01212</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_TRANSFER_SRC_OPTIMAL</code> then <code>image</code> <strong>must</strong> have
been created with <code>VK_IMAGE_USAGE_TRANSFER_SRC_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-oldLayout-01213" href="#VUID-VkImageMemoryBarrier2-oldLayout-01213"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-oldLayout-01213</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_TRANSFER_DST_OPTIMAL</code> then <code>image</code> <strong>must</strong> have
been created with <code>VK_IMAGE_USAGE_TRANSFER_DST_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-oldLayout-01197" href="#VUID-VkImageMemoryBarrier2-oldLayout-01197"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-oldLayout-01197</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
<code>oldLayout</code> <strong>must</strong> be <code>VK_IMAGE_LAYOUT_UNDEFINED</code> or the current
layout of the image subresources affected by the barrier</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-newLayout-01198" href="#VUID-VkImageMemoryBarrier2-newLayout-01198"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-newLayout-01198</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
<code>newLayout</code> <strong>must</strong> not be <code>VK_IMAGE_LAYOUT_UNDEFINED</code> or
<code>VK_IMAGE_LAYOUT_PREINITIALIZED</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-oldLayout-01658" href="#VUID-VkImageMemoryBarrier2-oldLayout-01658"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-oldLayout-01658</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_DEPTH_READ_ONLY_STENCIL_ATTACHMENT_OPTIMAL</code> then
<code>image</code> <strong>must</strong> have been created with
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-oldLayout-01659" href="#VUID-VkImageMemoryBarrier2-oldLayout-01659"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-oldLayout-01659</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_DEPTH_ATTACHMENT_STENCIL_READ_ONLY_OPTIMAL</code> then
<code>image</code> <strong>must</strong> have been created with
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-04065" href="#VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-04065"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-04065</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_DEPTH_READ_ONLY_OPTIMAL</code> then <code>image</code> <strong>must</strong>
have been created with at least one of
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code>,
<code>VK_IMAGE_USAGE_SAMPLED_BIT</code>, or
<code>VK_IMAGE_USAGE_INPUT_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-04066" href="#VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-04066"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-04066</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_DEPTH_ATTACHMENT_OPTIMAL</code> then <code>image</code> <strong>must</strong>
have been created with <code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code>
set</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-04067" href="#VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-04067"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-04067</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_STENCIL_READ_ONLY_OPTIMAL</code> then <code>image</code> <strong>must</strong>
have been created with at least one of
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code>,
<code>VK_IMAGE_USAGE_SAMPLED_BIT</code>, or
<code>VK_IMAGE_USAGE_INPUT_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-04068" href="#VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-04068"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-04068</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_STENCIL_ATTACHMENT_OPTIMAL</code> then <code>image</code> <strong>must</strong>
have been created with <code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code>
set</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-synchronization2-07793" href="#VUID-VkImageMemoryBarrier2-synchronization2-07793"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-synchronization2-07793</span><br>

If the <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature is
not enabled, <code>oldLayout</code> <strong>must</strong> not be
<code>VK_IMAGE_LAYOUT_ATTACHMENT_OPTIMAL_KHR</code> or
<code>VK_IMAGE_LAYOUT_READ_ONLY_OPTIMAL_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-synchronization2-07794" href="#VUID-VkImageMemoryBarrier2-synchronization2-07794"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-synchronization2-07794</span><br>

If the <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature is
not enabled, <code>newLayout</code> <strong>must</strong> not be
<code>VK_IMAGE_LAYOUT_ATTACHMENT_OPTIMAL_KHR</code> or
<code>VK_IMAGE_LAYOUT_READ_ONLY_OPTIMAL_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-03938" href="#VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-03938"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-03938</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_ATTACHMENT_OPTIMAL</code>, <code>image</code> <strong>must</strong> have been
created with <code>VK_IMAGE_USAGE_COLOR_ATTACHMENT_BIT</code> or
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-03939" href="#VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-03939"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-03939</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_READ_ONLY_OPTIMAL</code>, <code>image</code> <strong>must</strong> have been
created with at least one of
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code>,
<code>VK_IMAGE_USAGE_SAMPLED_BIT</code>, or
<code>VK_IMAGE_USAGE_INPUT_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-oldLayout-02088" href="#VUID-VkImageMemoryBarrier2-oldLayout-02088"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-oldLayout-02088</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_FRAGMENT_SHADING_RATE_ATTACHMENT_OPTIMAL_KHR</code> then
<code>image</code> <strong>must</strong> have been created with
<code>VK_IMAGE_USAGE_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code> set</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-image-09117" href="#VUID-VkImageMemoryBarrier2-image-09117"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-image-09117</span><br>

If <code>image</code> was created with a sharing mode of
<code>VK_SHARING_MODE_EXCLUSIVE</code>, and <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> are not equal, <code>srcQueueFamilyIndex</code> <strong>must</strong>
be
<code>VK_QUEUE_FAMILY_EXTERNAL</code>,
<code>VK_QUEUE_FAMILY_FOREIGN_EXT</code>,
or
a valid queue family</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-image-09118" href="#VUID-VkImageMemoryBarrier2-image-09118"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-image-09118</span><br>

If <code>image</code> was created with a sharing mode of
<code>VK_SHARING_MODE_EXCLUSIVE</code>, and <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> are not equal, <code>dstQueueFamilyIndex</code> <strong>must</strong>
be
<code>VK_QUEUE_FAMILY_EXTERNAL</code>,
<code>VK_QUEUE_FAMILY_FOREIGN_EXT</code>,
or
a valid queue family</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-04070" href="#VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-04070"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-04070</span><br>

If <code>srcQueueFamilyIndex</code> is not equal to <code>dstQueueFamilyIndex</code>,
at least one of <code>srcQueueFamilyIndex</code> or <code>dstQueueFamilyIndex</code>
<strong>must</strong> not be <code>VK_QUEUE_FAMILY_EXTERNAL</code>
or <code>VK_QUEUE_FAMILY_FOREIGN_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-None-09119" href="#VUID-VkImageMemoryBarrier2-None-09119"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-None-09119</span><br>

    
If
    the <a href="../appendices/extensions.html#VK_KHR_external_memory" class="xref page">VK_KHR_external_memory</a> extension is not enabled,
and
    the value of <a href="initialization.html#VkApplicationInfo" class="xref page">VkApplicationInfo</a>::<code>apiVersion</code> used to create
    the <a href="initialization.html#VkInstance" class="xref page">VkInstance</a> is not greater than or equal to Version 1.1,
    <code>srcQueueFamilyIndex</code> <strong>must</strong> not be <code>VK_QUEUE_FAMILY_EXTERNAL</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-None-09120" href="#VUID-VkImageMemoryBarrier2-None-09120"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-None-09120</span><br>

    
If
    the <a href="../appendices/extensions.html#VK_KHR_external_memory" class="xref page">VK_KHR_external_memory</a> extension is not enabled,
and
    the value of <a href="initialization.html#VkApplicationInfo" class="xref page">VkApplicationInfo</a>::<code>apiVersion</code> used to create
    the <a href="initialization.html#VkInstance" class="xref page">VkInstance</a> is not greater than or equal to Version 1.1,
    <code>dstQueueFamilyIndex</code> <strong>must</strong> not be <code>VK_QUEUE_FAMILY_EXTERNAL</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-09121" href="#VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-09121"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-09121</span><br>

If the <a href="../appendices/extensions.html#VK_EXT_queue_family_foreign" class="xref page">VK_EXT_queue_family_foreign</a> extension is not enabled
<code>srcQueueFamilyIndex</code> <strong>must</strong> not be <code>VK_QUEUE_FAMILY_FOREIGN_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstQueueFamilyIndex-09122" href="#VUID-VkImageMemoryBarrier2-dstQueueFamilyIndex-09122"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstQueueFamilyIndex-09122</span><br>

If the <a href="../appendices/extensions.html#VK_EXT_queue_family_foreign" class="xref page">VK_EXT_queue_family_foreign</a> extension is not enabled
<code>dstQueueFamilyIndex</code> <strong>must</strong> not be <code>VK_QUEUE_FAMILY_FOREIGN_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07120" href="#VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07120"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07120</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_SRC_KHR</code> then <code>image</code> <strong>must</strong> have
been created with <code>VK_IMAGE_USAGE_VIDEO_DECODE_SRC_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07121" href="#VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07121"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07121</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_DST_KHR</code> then <code>image</code> <strong>must</strong> have
been created with <code>VK_IMAGE_USAGE_VIDEO_DECODE_DST_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07122" href="#VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07122"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07122</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_DPB_KHR</code> then <code>image</code> <strong>must</strong> have
been created with <code>VK_IMAGE_USAGE_VIDEO_DECODE_DPB_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07123" href="#VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07123"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07123</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_VIDEO_ENCODE_SRC_KHR</code> then <code>image</code> <strong>must</strong> have
been created with <code>VK_IMAGE_USAGE_VIDEO_ENCODE_SRC_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07124" href="#VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07124"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07124</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_VIDEO_ENCODE_DST_KHR</code> then <code>image</code> <strong>must</strong> have
been created with <code>VK_IMAGE_USAGE_VIDEO_ENCODE_DST_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07125" href="#VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07125"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07125</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_VIDEO_ENCODE_DPB_KHR</code> then <code>image</code> <strong>must</strong> have
been created with <code>VK_IMAGE_USAGE_VIDEO_ENCODE_DPB_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07006" href="#VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07006"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcQueueFamilyIndex-07006</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_ATTACHMENT_FEEDBACK_LOOP_OPTIMAL_EXT</code> then
<code>image</code> <strong>must</strong> have been created with either the
<code>VK_IMAGE_USAGE_COLOR_ATTACHMENT_BIT</code> or
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code> usage bits, and the
<code>VK_IMAGE_USAGE_INPUT_ATTACHMENT_BIT</code> or
<code>VK_IMAGE_USAGE_SAMPLED_BIT</code> usage bits, and the
<code>VK_IMAGE_USAGE_ATTACHMENT_FEEDBACK_LOOP_BIT_EXT</code> usage bit</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-attachmentFeedbackLoopLayout-07313" href="#VUID-VkImageMemoryBarrier2-attachmentFeedbackLoopLayout-07313"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-attachmentFeedbackLoopLayout-07313</span><br>

If the <a href="features.html#features-attachmentFeedbackLoopLayout" class="xref page">    <code>attachmentFeedbackLoopLayout</code></a> feature is not enabled,
<code>newLayout</code> <strong>must</strong> not be
<code>VK_IMAGE_LAYOUT_ATTACHMENT_FEEDBACK_LOOP_OPTIMAL_EXT</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-subresourceRange-01486" href="#VUID-VkImageMemoryBarrier2-subresourceRange-01486"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-subresourceRange-01486</span><br>

<code>subresourceRange.baseMipLevel</code> <strong>must</strong> be less than the
<code>mipLevels</code> specified in <a href="resources.html#VkImageCreateInfo" class="xref page">VkImageCreateInfo</a> when <code>image</code>
was created</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-subresourceRange-01724" href="#VUID-VkImageMemoryBarrier2-subresourceRange-01724"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-subresourceRange-01724</span><br>

If <code>subresourceRange.levelCount</code> is not
<code>VK_REMAINING_MIP_LEVELS</code>, <span class="eq"><code>subresourceRange.baseMipLevel</code>
+  <code>subresourceRange.levelCount</code></span> <strong>must</strong> be less than or equal to
the <code>mipLevels</code> specified in <a href="resources.html#VkImageCreateInfo" class="xref page">VkImageCreateInfo</a> when
<code>image</code> was created</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-subresourceRange-01488" href="#VUID-VkImageMemoryBarrier2-subresourceRange-01488"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-subresourceRange-01488</span><br>

<code>subresourceRange.baseArrayLayer</code> <strong>must</strong> be less than the
<code>arrayLayers</code> specified in <a href="resources.html#VkImageCreateInfo" class="xref page">VkImageCreateInfo</a> when <code>image</code>
was created</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-subresourceRange-01725" href="#VUID-VkImageMemoryBarrier2-subresourceRange-01725"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-subresourceRange-01725</span><br>

If <code>subresourceRange.layerCount</code> is not
<code>VK_REMAINING_ARRAY_LAYERS</code>,
<span class="eq"><code>subresourceRange.baseArrayLayer</code> + 
<code>subresourceRange.layerCount</code></span> <strong>must</strong> be less than or equal to the
<code>arrayLayers</code> specified in <a href="resources.html#VkImageCreateInfo" class="xref page">VkImageCreateInfo</a> when <code>image</code>
was created</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-image-01932" href="#VUID-VkImageMemoryBarrier2-image-01932"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-image-01932</span><br>

If <code>image</code> is non-sparse then it <strong>must</strong> be bound completely and
contiguously to a single <code>VkDeviceMemory</code> object</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-image-09241" href="#VUID-VkImageMemoryBarrier2-image-09241"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-image-09241</span><br>

If <code>image</code> has a color format that is single-plane, then the
<code>aspectMask</code> member of <code>subresourceRange</code> <strong>must</strong> be
<code>VK_IMAGE_ASPECT_COLOR_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-image-09242" href="#VUID-VkImageMemoryBarrier2-image-09242"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-image-09242</span><br>

If <code>image</code> has a color format and is not <em>disjoint</em>, then the
<code>aspectMask</code> member of <code>subresourceRange</code> <strong>must</strong> be
<code>VK_IMAGE_ASPECT_COLOR_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-image-01672" href="#VUID-VkImageMemoryBarrier2-image-01672"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-image-01672</span><br>

If <code>image</code> has a multi-planar format and the image is <em>disjoint</em>,
then the <code>aspectMask</code> member of <code>subresourceRange</code> <strong>must</strong> include
at least one <a href="formats.html#formats-planes-image-aspect" class="xref page">multi-planar aspect mask</a>
bit or <code>VK_IMAGE_ASPECT_COLOR_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-image-03319" href="#VUID-VkImageMemoryBarrier2-image-03319"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-image-03319</span><br>

If <code>image</code> has a depth/stencil format with both depth and stencil
and the <a href="features.html#features-separateDepthStencilLayouts" class="xref page">    <code>separateDepthStencilLayouts</code></a> feature is enabled, then the
<code>aspectMask</code> member of <code>subresourceRange</code> <strong>must</strong> include either
or both <code>VK_IMAGE_ASPECT_DEPTH_BIT</code> and
<code>VK_IMAGE_ASPECT_STENCIL_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-image-03320" href="#VUID-VkImageMemoryBarrier2-image-03320"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-image-03320</span><br>

If <code>image</code> has a depth/stencil format with both depth and stencil
and the <a href="features.html#features-separateDepthStencilLayouts" class="xref page">    <code>separateDepthStencilLayouts</code></a> feature is not enabled, then the
<code>aspectMask</code> member of <code>subresourceRange</code> <strong>must</strong> include both
<code>VK_IMAGE_ASPECT_DEPTH_BIT</code> and <code>VK_IMAGE_ASPECT_STENCIL_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-aspectMask-08702" href="#VUID-VkImageMemoryBarrier2-aspectMask-08702"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-aspectMask-08702</span><br>

If the <code>aspectMask</code> member of <code>subresourceRange</code> includes
<code>VK_IMAGE_ASPECT_DEPTH_BIT</code>, <code>oldLayout</code> and <code>newLayout</code>
<strong>must</strong> not be one of <code>VK_IMAGE_LAYOUT_STENCIL_ATTACHMENT_OPTIMAL</code> or
<code>VK_IMAGE_LAYOUT_STENCIL_READ_ONLY_OPTIMAL</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-aspectMask-08703" href="#VUID-VkImageMemoryBarrier2-aspectMask-08703"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-aspectMask-08703</span><br>

If the <code>aspectMask</code> member of <code>subresourceRange</code> includes
<code>VK_IMAGE_ASPECT_STENCIL_BIT</code>, <code>oldLayout</code> and <code>newLayout</code>
<strong>must</strong> not be one of <code>VK_IMAGE_LAYOUT_DEPTH_ATTACHMENT_OPTIMAL</code> or
<code>VK_IMAGE_LAYOUT_DEPTH_READ_ONLY_OPTIMAL</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcStageMask-03854" href="#VUID-VkImageMemoryBarrier2-srcStageMask-03854"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcStageMask-03854</span><br>

If either <code>srcStageMask</code> or <code>dstStageMask</code> includes
<code>VK_PIPELINE_STAGE_2_HOST_BIT</code>, <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> <strong>must</strong> be equal</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcStageMask-03855" href="#VUID-VkImageMemoryBarrier2-srcStageMask-03855"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcStageMask-03855</span><br>

If <code>srcStageMask</code> includes <code>VK_PIPELINE_STAGE_2_HOST_BIT</code>, and
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
<code>oldLayout</code> <strong>must</strong> be one of <code>VK_IMAGE_LAYOUT_PREINITIALIZED</code>,
<code>VK_IMAGE_LAYOUT_UNDEFINED</code>, or <code>VK_IMAGE_LAYOUT_GENERAL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-sType-sType" href="#VUID-VkImageMemoryBarrier2-sType-sType"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_IMAGE_MEMORY_BARRIER_2</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-pNext-pNext" href="#VUID-VkImageMemoryBarrier2-pNext-pNext"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="#VkExternalMemoryAcquireUnmodifiedEXT">VkExternalMemoryAcquireUnmodifiedEXT</a> or <a href="primsrast.html#VkSampleLocationsInfoEXT" class="xref page">VkSampleLocationsInfoEXT</a></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-sType-unique" href="#VUID-VkImageMemoryBarrier2-sType-unique"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcStageMask-parameter" href="#VUID-VkImageMemoryBarrier2-srcStageMask-parameter"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcStageMask-parameter</span><br>
 <code>srcStageMask</code> <strong>must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits2">VkPipelineStageFlagBits2</a> values</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-srcAccessMask-parameter" href="#VUID-VkImageMemoryBarrier2-srcAccessMask-parameter"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-srcAccessMask-parameter</span><br>
 <code>srcAccessMask</code> <strong>must</strong> be a valid combination of <a href="#VkAccessFlagBits2">VkAccessFlagBits2</a> values</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstStageMask-parameter" href="#VUID-VkImageMemoryBarrier2-dstStageMask-parameter"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstStageMask-parameter</span><br>
 <code>dstStageMask</code> <strong>must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits2">VkPipelineStageFlagBits2</a> values</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-dstAccessMask-parameter" href="#VUID-VkImageMemoryBarrier2-dstAccessMask-parameter"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-dstAccessMask-parameter</span><br>
 <code>dstAccessMask</code> <strong>must</strong> be a valid combination of <a href="#VkAccessFlagBits2">VkAccessFlagBits2</a> values</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-oldLayout-parameter" href="#VUID-VkImageMemoryBarrier2-oldLayout-parameter"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-oldLayout-parameter</span><br>
 <code>oldLayout</code> <strong>must</strong> be a valid <a href="resources.html#VkImageLayout" class="xref page">VkImageLayout</a> value</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-newLayout-parameter" href="#VUID-VkImageMemoryBarrier2-newLayout-parameter"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-newLayout-parameter</span><br>
 <code>newLayout</code> <strong>must</strong> be a valid <a href="resources.html#VkImageLayout" class="xref page">VkImageLayout</a> value</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-image-parameter" href="#VUID-VkImageMemoryBarrier2-image-parameter"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-image-parameter</span><br>
 <code>image</code> <strong>must</strong> be a valid <a href="resources.html#VkImage" class="xref page">VkImage</a> handle</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier2-subresourceRange-parameter" href="#VUID-VkImageMemoryBarrier2-subresourceRange-parameter"></a> <span class="vuid">VUID-VkImageMemoryBarrier2-subresourceRange-parameter</span><br>
 <code>subresourceRange</code> <strong>must</strong> be a valid <a href="resources.html#VkImageSubresourceRange" class="xref page">VkImageSubresourceRange</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkImageMemoryBarrier</code> structure is defined as:</p>
</div>
<div id="VkImageMemoryBarrier" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef struct VkImageMemoryBarrier {
    VkStructureType            sType;
    const void*                pNext;
    VkAccessFlags              srcAccessMask;
    VkAccessFlags              dstAccessMask;
    VkImageLayout              oldLayout;
    VkImageLayout              newLayout;
    uint32_t                   srcQueueFamilyIndex;
    uint32_t                   dstQueueFamilyIndex;
    VkImage                    image;
    VkImageSubresourceRange    subresourceRange;
} VkImageMemoryBarrier;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>srcAccessMask</code> is a bitmask of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> specifying a
<a href="#synchronization-access-masks">source access mask</a>.</p>
</li>
<li>
<p><code>dstAccessMask</code> is a bitmask of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> specifying a
<a href="#synchronization-access-masks">destination access mask</a>.</p>
</li>
<li>
<p><code>oldLayout</code> is the old layout in an
<a href="#synchronization-image-layout-transitions">image layout transition</a>.</p>
</li>
<li>
<p><code>newLayout</code> is the new layout in an
<a href="#synchronization-image-layout-transitions">image layout transition</a>.</p>
</li>
<li>
<p><code>srcQueueFamilyIndex</code> is the source queue family for a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a>.</p>
</li>
<li>
<p><code>dstQueueFamilyIndex</code> is the destination queue family for a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a>.</p>
</li>
<li>
<p><code>image</code> is a handle to the image affected by this barrier.</p>
</li>
<li>
<p><code>subresourceRange</code> describes the <a href="resources.html#resources-image-views" class="xref page">image    subresource range</a> within <code>image</code> that is affected by this barrier.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to access to memory through the specified image subresource range,
via access types in the <a href="#synchronization-access-masks">source access mask</a>
specified by <code>srcAccessMask</code>.
If <code>srcAccessMask</code> includes <code>VK_ACCESS_HOST_WRITE_BIT</code>, memory
writes performed by that access type are also made visible, as that access
type is not performed through a resource.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to access to memory through the specified image subresource range,
via access types in the <a href="#synchronization-access-masks">destination access mask</a> specified by <code>dstAccessMask</code>.
If <code>dstAccessMask</code> includes <code>VK_ACCESS_HOST_WRITE_BIT</code> or
<code>VK_ACCESS_HOST_READ_BIT</code>, available memory writes are also made visible
to accesses of those types, as those access types are not performed through
a resource.</p>
</div>
<div class="paragraph">
<p>If <code>srcQueueFamilyIndex</code> is not equal to <code>dstQueueFamilyIndex</code>, and
<code>srcQueueFamilyIndex</code> is equal to the current queue family, then the
memory barrier defines a <a href="#synchronization-queue-transfers-release">queue family release operation</a> for the specified image subresource range, and
the second access scope includes no access, as if <code>dstAccessMask</code> was
<code>0</code>.</p>
</div>
<div class="paragraph">
<p>If <code>dstQueueFamilyIndex</code> is not equal to <code>srcQueueFamilyIndex</code>, and
<code>dstQueueFamilyIndex</code> is equal to the current queue family, then the
memory barrier defines a <a href="#synchronization-queue-transfers-acquire">queue family acquire operation</a> for the specified image subresource range, and
the first access scope includes no access, as if <code>srcAccessMask</code> was
<code>0</code>.</p>
</div>
<div class="paragraph">
<p>If the <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature is not
enabled or <code>oldLayout</code> is not equal to <code>newLayout</code>,
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a> for
the specified image subresource range.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>If the <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature is
enabled, when the old and new layout are equal, the layout values are
ignored - data is preserved no matter what values are specified, or what
layout the image is currently in.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code>image</code> has a multi-planar format and the image is <em>disjoint</em>, then
including <code>VK_IMAGE_ASPECT_COLOR_BIT</code> in the <code>aspectMask</code> member of
<code>subresourceRange</code> is equivalent to including
<code>VK_IMAGE_ASPECT_PLANE_0_BIT</code>, <code>VK_IMAGE_ASPECT_PLANE_1_BIT</code>, and
(for three-plane formats only) <code>VK_IMAGE_ASPECT_PLANE_2_BIT</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01208" href="#VUID-VkImageMemoryBarrier-oldLayout-01208"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-01208</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL</code> then <code>image</code> <strong>must</strong>
have been created with <code>VK_IMAGE_USAGE_COLOR_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01209" href="#VUID-VkImageMemoryBarrier-oldLayout-01209"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-01209</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_DEPTH_STENCIL_ATTACHMENT_OPTIMAL</code> then <code>image</code>
<strong>must</strong> have been created with
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01210" href="#VUID-VkImageMemoryBarrier-oldLayout-01210"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-01210</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_DEPTH_STENCIL_READ_ONLY_OPTIMAL</code> then <code>image</code>
<strong>must</strong> have been created with
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01211" href="#VUID-VkImageMemoryBarrier-oldLayout-01211"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-01211</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_SHADER_READ_ONLY_OPTIMAL</code> then <code>image</code> <strong>must</strong>
have been created with <code>VK_IMAGE_USAGE_SAMPLED_BIT</code> or
<code>VK_IMAGE_USAGE_INPUT_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01212" href="#VUID-VkImageMemoryBarrier-oldLayout-01212"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-01212</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_TRANSFER_SRC_OPTIMAL</code> then <code>image</code> <strong>must</strong> have
been created with <code>VK_IMAGE_USAGE_TRANSFER_SRC_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01213" href="#VUID-VkImageMemoryBarrier-oldLayout-01213"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-01213</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_TRANSFER_DST_OPTIMAL</code> then <code>image</code> <strong>must</strong> have
been created with <code>VK_IMAGE_USAGE_TRANSFER_DST_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01197" href="#VUID-VkImageMemoryBarrier-oldLayout-01197"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-01197</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
<code>oldLayout</code> <strong>must</strong> be <code>VK_IMAGE_LAYOUT_UNDEFINED</code> or the current
layout of the image subresources affected by the barrier</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-newLayout-01198" href="#VUID-VkImageMemoryBarrier-newLayout-01198"></a> <span class="vuid">VUID-VkImageMemoryBarrier-newLayout-01198</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
<code>newLayout</code> <strong>must</strong> not be <code>VK_IMAGE_LAYOUT_UNDEFINED</code> or
<code>VK_IMAGE_LAYOUT_PREINITIALIZED</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01658" href="#VUID-VkImageMemoryBarrier-oldLayout-01658"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-01658</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_DEPTH_READ_ONLY_STENCIL_ATTACHMENT_OPTIMAL</code> then
<code>image</code> <strong>must</strong> have been created with
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01659" href="#VUID-VkImageMemoryBarrier-oldLayout-01659"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-01659</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_DEPTH_ATTACHMENT_STENCIL_READ_ONLY_OPTIMAL</code> then
<code>image</code> <strong>must</strong> have been created with
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-04065" href="#VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-04065"></a> <span class="vuid">VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-04065</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_DEPTH_READ_ONLY_OPTIMAL</code> then <code>image</code> <strong>must</strong>
have been created with at least one of
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code>,
<code>VK_IMAGE_USAGE_SAMPLED_BIT</code>, or
<code>VK_IMAGE_USAGE_INPUT_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-04066" href="#VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-04066"></a> <span class="vuid">VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-04066</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_DEPTH_ATTACHMENT_OPTIMAL</code> then <code>image</code> <strong>must</strong>
have been created with <code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code>
set</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-04067" href="#VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-04067"></a> <span class="vuid">VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-04067</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_STENCIL_READ_ONLY_OPTIMAL</code> then <code>image</code> <strong>must</strong>
have been created with at least one of
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code>,
<code>VK_IMAGE_USAGE_SAMPLED_BIT</code>, or
<code>VK_IMAGE_USAGE_INPUT_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-04068" href="#VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-04068"></a> <span class="vuid">VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-04068</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_STENCIL_ATTACHMENT_OPTIMAL</code> then <code>image</code> <strong>must</strong>
have been created with <code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code>
set</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-synchronization2-07793" href="#VUID-VkImageMemoryBarrier-synchronization2-07793"></a> <span class="vuid">VUID-VkImageMemoryBarrier-synchronization2-07793</span><br>

If the <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature is
not enabled, <code>oldLayout</code> <strong>must</strong> not be
<code>VK_IMAGE_LAYOUT_ATTACHMENT_OPTIMAL_KHR</code> or
<code>VK_IMAGE_LAYOUT_READ_ONLY_OPTIMAL_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-synchronization2-07794" href="#VUID-VkImageMemoryBarrier-synchronization2-07794"></a> <span class="vuid">VUID-VkImageMemoryBarrier-synchronization2-07794</span><br>

If the <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature is
not enabled, <code>newLayout</code> <strong>must</strong> not be
<code>VK_IMAGE_LAYOUT_ATTACHMENT_OPTIMAL_KHR</code> or
<code>VK_IMAGE_LAYOUT_READ_ONLY_OPTIMAL_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-03938" href="#VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-03938"></a> <span class="vuid">VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-03938</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_ATTACHMENT_OPTIMAL</code>, <code>image</code> <strong>must</strong> have been
created with <code>VK_IMAGE_USAGE_COLOR_ATTACHMENT_BIT</code> or
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-03939" href="#VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-03939"></a> <span class="vuid">VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-03939</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_READ_ONLY_OPTIMAL</code>, <code>image</code> <strong>must</strong> have been
created with at least one of
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code>,
<code>VK_IMAGE_USAGE_SAMPLED_BIT</code>, or
<code>VK_IMAGE_USAGE_INPUT_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-02088" href="#VUID-VkImageMemoryBarrier-oldLayout-02088"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-02088</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_FRAGMENT_SHADING_RATE_ATTACHMENT_OPTIMAL_KHR</code> then
<code>image</code> <strong>must</strong> have been created with
<code>VK_IMAGE_USAGE_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code> set</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-09117" href="#VUID-VkImageMemoryBarrier-image-09117"></a> <span class="vuid">VUID-VkImageMemoryBarrier-image-09117</span><br>

If <code>image</code> was created with a sharing mode of
<code>VK_SHARING_MODE_EXCLUSIVE</code>, and <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> are not equal, <code>srcQueueFamilyIndex</code> <strong>must</strong>
be
<code>VK_QUEUE_FAMILY_EXTERNAL</code>,
<code>VK_QUEUE_FAMILY_FOREIGN_EXT</code>,
or
a valid queue family</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-09118" href="#VUID-VkImageMemoryBarrier-image-09118"></a> <span class="vuid">VUID-VkImageMemoryBarrier-image-09118</span><br>

If <code>image</code> was created with a sharing mode of
<code>VK_SHARING_MODE_EXCLUSIVE</code>, and <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> are not equal, <code>dstQueueFamilyIndex</code> <strong>must</strong>
be
<code>VK_QUEUE_FAMILY_EXTERNAL</code>,
<code>VK_QUEUE_FAMILY_FOREIGN_EXT</code>,
or
a valid queue family</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-04070" href="#VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-04070"></a> <span class="vuid">VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-04070</span><br>

If <code>srcQueueFamilyIndex</code> is not equal to <code>dstQueueFamilyIndex</code>,
at least one of <code>srcQueueFamilyIndex</code> or <code>dstQueueFamilyIndex</code>
<strong>must</strong> not be <code>VK_QUEUE_FAMILY_EXTERNAL</code>
or <code>VK_QUEUE_FAMILY_FOREIGN_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-None-09119" href="#VUID-VkImageMemoryBarrier-None-09119"></a> <span class="vuid">VUID-VkImageMemoryBarrier-None-09119</span><br>

    
If
    the <a href="../appendices/extensions.html#VK_KHR_external_memory" class="xref page">VK_KHR_external_memory</a> extension is not enabled,
and
    the value of <a href="initialization.html#VkApplicationInfo" class="xref page">VkApplicationInfo</a>::<code>apiVersion</code> used to create
    the <a href="initialization.html#VkInstance" class="xref page">VkInstance</a> is not greater than or equal to Version 1.1,
    <code>srcQueueFamilyIndex</code> <strong>must</strong> not be <code>VK_QUEUE_FAMILY_EXTERNAL</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-None-09120" href="#VUID-VkImageMemoryBarrier-None-09120"></a> <span class="vuid">VUID-VkImageMemoryBarrier-None-09120</span><br>

    
If
    the <a href="../appendices/extensions.html#VK_KHR_external_memory" class="xref page">VK_KHR_external_memory</a> extension is not enabled,
and
    the value of <a href="initialization.html#VkApplicationInfo" class="xref page">VkApplicationInfo</a>::<code>apiVersion</code> used to create
    the <a href="initialization.html#VkInstance" class="xref page">VkInstance</a> is not greater than or equal to Version 1.1,
    <code>dstQueueFamilyIndex</code> <strong>must</strong> not be <code>VK_QUEUE_FAMILY_EXTERNAL</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-09121" href="#VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-09121"></a> <span class="vuid">VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-09121</span><br>

If the <a href="../appendices/extensions.html#VK_EXT_queue_family_foreign" class="xref page">VK_EXT_queue_family_foreign</a> extension is not enabled
<code>srcQueueFamilyIndex</code> <strong>must</strong> not be <code>VK_QUEUE_FAMILY_FOREIGN_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-dstQueueFamilyIndex-09122" href="#VUID-VkImageMemoryBarrier-dstQueueFamilyIndex-09122"></a> <span class="vuid">VUID-VkImageMemoryBarrier-dstQueueFamilyIndex-09122</span><br>

If the <a href="../appendices/extensions.html#VK_EXT_queue_family_foreign" class="xref page">VK_EXT_queue_family_foreign</a> extension is not enabled
<code>dstQueueFamilyIndex</code> <strong>must</strong> not be <code>VK_QUEUE_FAMILY_FOREIGN_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07120" href="#VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07120"></a> <span class="vuid">VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07120</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_SRC_KHR</code> then <code>image</code> <strong>must</strong> have
been created with <code>VK_IMAGE_USAGE_VIDEO_DECODE_SRC_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07121" href="#VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07121"></a> <span class="vuid">VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07121</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_DST_KHR</code> then <code>image</code> <strong>must</strong> have
been created with <code>VK_IMAGE_USAGE_VIDEO_DECODE_DST_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07122" href="#VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07122"></a> <span class="vuid">VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07122</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_DPB_KHR</code> then <code>image</code> <strong>must</strong> have
been created with <code>VK_IMAGE_USAGE_VIDEO_DECODE_DPB_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07123" href="#VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07123"></a> <span class="vuid">VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07123</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_VIDEO_ENCODE_SRC_KHR</code> then <code>image</code> <strong>must</strong> have
been created with <code>VK_IMAGE_USAGE_VIDEO_ENCODE_SRC_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07124" href="#VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07124"></a> <span class="vuid">VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07124</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_VIDEO_ENCODE_DST_KHR</code> then <code>image</code> <strong>must</strong> have
been created with <code>VK_IMAGE_USAGE_VIDEO_ENCODE_DST_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07125" href="#VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07125"></a> <span class="vuid">VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07125</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_VIDEO_ENCODE_DPB_KHR</code> then <code>image</code> <strong>must</strong> have
been created with <code>VK_IMAGE_USAGE_VIDEO_ENCODE_DPB_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07006" href="#VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07006"></a> <span class="vuid">VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-07006</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_ATTACHMENT_FEEDBACK_LOOP_OPTIMAL_EXT</code> then
<code>image</code> <strong>must</strong> have been created with either the
<code>VK_IMAGE_USAGE_COLOR_ATTACHMENT_BIT</code> or
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code> usage bits, and the
<code>VK_IMAGE_USAGE_INPUT_ATTACHMENT_BIT</code> or
<code>VK_IMAGE_USAGE_SAMPLED_BIT</code> usage bits, and the
<code>VK_IMAGE_USAGE_ATTACHMENT_FEEDBACK_LOOP_BIT_EXT</code> usage bit</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-attachmentFeedbackLoopLayout-07313" href="#VUID-VkImageMemoryBarrier-attachmentFeedbackLoopLayout-07313"></a> <span class="vuid">VUID-VkImageMemoryBarrier-attachmentFeedbackLoopLayout-07313</span><br>

If the <a href="features.html#features-attachmentFeedbackLoopLayout" class="xref page">    <code>attachmentFeedbackLoopLayout</code></a> feature is not enabled,
<code>newLayout</code> <strong>must</strong> not be
<code>VK_IMAGE_LAYOUT_ATTACHMENT_FEEDBACK_LOOP_OPTIMAL_EXT</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImageMemoryBarrier-subresourceRange-01486" href="#VUID-VkImageMemoryBarrier-subresourceRange-01486"></a> <span class="vuid">VUID-VkImageMemoryBarrier-subresourceRange-01486</span><br>

<code>subresourceRange.baseMipLevel</code> <strong>must</strong> be less than the
<code>mipLevels</code> specified in <a href="resources.html#VkImageCreateInfo" class="xref page">VkImageCreateInfo</a> when <code>image</code>
was created</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-subresourceRange-01724" href="#VUID-VkImageMemoryBarrier-subresourceRange-01724"></a> <span class="vuid">VUID-VkImageMemoryBarrier-subresourceRange-01724</span><br>

If <code>subresourceRange.levelCount</code> is not
<code>VK_REMAINING_MIP_LEVELS</code>, <span class="eq"><code>subresourceRange.baseMipLevel</code>
+  <code>subresourceRange.levelCount</code></span> <strong>must</strong> be less than or equal to
the <code>mipLevels</code> specified in <a href="resources.html#VkImageCreateInfo" class="xref page">VkImageCreateInfo</a> when
<code>image</code> was created</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-subresourceRange-01488" href="#VUID-VkImageMemoryBarrier-subresourceRange-01488"></a> <span class="vuid">VUID-VkImageMemoryBarrier-subresourceRange-01488</span><br>

<code>subresourceRange.baseArrayLayer</code> <strong>must</strong> be less than the
<code>arrayLayers</code> specified in <a href="resources.html#VkImageCreateInfo" class="xref page">VkImageCreateInfo</a> when <code>image</code>
was created</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-subresourceRange-01725" href="#VUID-VkImageMemoryBarrier-subresourceRange-01725"></a> <span class="vuid">VUID-VkImageMemoryBarrier-subresourceRange-01725</span><br>

If <code>subresourceRange.layerCount</code> is not
<code>VK_REMAINING_ARRAY_LAYERS</code>,
<span class="eq"><code>subresourceRange.baseArrayLayer</code> + 
<code>subresourceRange.layerCount</code></span> <strong>must</strong> be less than or equal to the
<code>arrayLayers</code> specified in <a href="resources.html#VkImageCreateInfo" class="xref page">VkImageCreateInfo</a> when <code>image</code>
was created</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-01932" href="#VUID-VkImageMemoryBarrier-image-01932"></a> <span class="vuid">VUID-VkImageMemoryBarrier-image-01932</span><br>

If <code>image</code> is non-sparse then it <strong>must</strong> be bound completely and
contiguously to a single <code>VkDeviceMemory</code> object</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-09241" href="#VUID-VkImageMemoryBarrier-image-09241"></a> <span class="vuid">VUID-VkImageMemoryBarrier-image-09241</span><br>

If <code>image</code> has a color format that is single-plane, then the
<code>aspectMask</code> member of <code>subresourceRange</code> <strong>must</strong> be
<code>VK_IMAGE_ASPECT_COLOR_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-09242" href="#VUID-VkImageMemoryBarrier-image-09242"></a> <span class="vuid">VUID-VkImageMemoryBarrier-image-09242</span><br>

If <code>image</code> has a color format and is not <em>disjoint</em>, then the
<code>aspectMask</code> member of <code>subresourceRange</code> <strong>must</strong> be
<code>VK_IMAGE_ASPECT_COLOR_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-01672" href="#VUID-VkImageMemoryBarrier-image-01672"></a> <span class="vuid">VUID-VkImageMemoryBarrier-image-01672</span><br>

If <code>image</code> has a multi-planar format and the image is <em>disjoint</em>,
then the <code>aspectMask</code> member of <code>subresourceRange</code> <strong>must</strong> include
at least one <a href="formats.html#formats-planes-image-aspect" class="xref page">multi-planar aspect mask</a>
bit or <code>VK_IMAGE_ASPECT_COLOR_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-03319" href="#VUID-VkImageMemoryBarrier-image-03319"></a> <span class="vuid">VUID-VkImageMemoryBarrier-image-03319</span><br>

If <code>image</code> has a depth/stencil format with both depth and stencil
and the <a href="features.html#features-separateDepthStencilLayouts" class="xref page">    <code>separateDepthStencilLayouts</code></a> feature is enabled, then the
<code>aspectMask</code> member of <code>subresourceRange</code> <strong>must</strong> include either
or both <code>VK_IMAGE_ASPECT_DEPTH_BIT</code> and
<code>VK_IMAGE_ASPECT_STENCIL_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-03320" href="#VUID-VkImageMemoryBarrier-image-03320"></a> <span class="vuid">VUID-VkImageMemoryBarrier-image-03320</span><br>

If <code>image</code> has a depth/stencil format with both depth and stencil
and the <a href="features.html#features-separateDepthStencilLayouts" class="xref page">    <code>separateDepthStencilLayouts</code></a> feature is not enabled, then the
<code>aspectMask</code> member of <code>subresourceRange</code> <strong>must</strong> include both
<code>VK_IMAGE_ASPECT_DEPTH_BIT</code> and <code>VK_IMAGE_ASPECT_STENCIL_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-aspectMask-08702" href="#VUID-VkImageMemoryBarrier-aspectMask-08702"></a> <span class="vuid">VUID-VkImageMemoryBarrier-aspectMask-08702</span><br>

If the <code>aspectMask</code> member of <code>subresourceRange</code> includes
<code>VK_IMAGE_ASPECT_DEPTH_BIT</code>, <code>oldLayout</code> and <code>newLayout</code>
<strong>must</strong> not be one of <code>VK_IMAGE_LAYOUT_STENCIL_ATTACHMENT_OPTIMAL</code> or
<code>VK_IMAGE_LAYOUT_STENCIL_READ_ONLY_OPTIMAL</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-aspectMask-08703" href="#VUID-VkImageMemoryBarrier-aspectMask-08703"></a> <span class="vuid">VUID-VkImageMemoryBarrier-aspectMask-08703</span><br>

If the <code>aspectMask</code> member of <code>subresourceRange</code> includes
<code>VK_IMAGE_ASPECT_STENCIL_BIT</code>, <code>oldLayout</code> and <code>newLayout</code>
<strong>must</strong> not be one of <code>VK_IMAGE_LAYOUT_DEPTH_ATTACHMENT_OPTIMAL</code> or
<code>VK_IMAGE_LAYOUT_DEPTH_READ_ONLY_OPTIMAL</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-None-09052" href="#VUID-VkImageMemoryBarrier-None-09052"></a> <span class="vuid">VUID-VkImageMemoryBarrier-None-09052</span><br>

If
the <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature is not
enabled, and
<code>image</code> was created with a sharing mode of
<code>VK_SHARING_MODE_CONCURRENT</code>, at least one of
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> <strong>must</strong> be
<code>VK_QUEUE_FAMILY_IGNORED</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-None-09053" href="#VUID-VkImageMemoryBarrier-None-09053"></a> <span class="vuid">VUID-VkImageMemoryBarrier-None-09053</span><br>

If
the <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature is not
enabled, and
<code>image</code> was created with a sharing mode of
<code>VK_SHARING_MODE_CONCURRENT</code>, <code>srcQueueFamilyIndex</code> <strong>must</strong> be
<code>VK_QUEUE_FAMILY_IGNORED</code>
or <code>VK_QUEUE_FAMILY_EXTERNAL</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-None-09054" href="#VUID-VkImageMemoryBarrier-None-09054"></a> <span class="vuid">VUID-VkImageMemoryBarrier-None-09054</span><br>

If
the <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature is not
enabled, and
<code>image</code> was created with a sharing mode of
<code>VK_SHARING_MODE_CONCURRENT</code>, <code>dstQueueFamilyIndex</code> <strong>must</strong> be
<code>VK_QUEUE_FAMILY_IGNORED</code>
or <code>VK_QUEUE_FAMILY_EXTERNAL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImageMemoryBarrier-sType-sType" href="#VUID-VkImageMemoryBarrier-sType-sType"></a> <span class="vuid">VUID-VkImageMemoryBarrier-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_IMAGE_MEMORY_BARRIER</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-pNext-pNext" href="#VUID-VkImageMemoryBarrier-pNext-pNext"></a> <span class="vuid">VUID-VkImageMemoryBarrier-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="#VkExternalMemoryAcquireUnmodifiedEXT">VkExternalMemoryAcquireUnmodifiedEXT</a> or <a href="primsrast.html#VkSampleLocationsInfoEXT" class="xref page">VkSampleLocationsInfoEXT</a></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-sType-unique" href="#VUID-VkImageMemoryBarrier-sType-unique"></a> <span class="vuid">VUID-VkImageMemoryBarrier-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-parameter" href="#VUID-VkImageMemoryBarrier-oldLayout-parameter"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-parameter</span><br>
 <code>oldLayout</code> <strong>must</strong> be a valid <a href="resources.html#VkImageLayout" class="xref page">VkImageLayout</a> value</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-newLayout-parameter" href="#VUID-VkImageMemoryBarrier-newLayout-parameter"></a> <span class="vuid">VUID-VkImageMemoryBarrier-newLayout-parameter</span><br>
 <code>newLayout</code> <strong>must</strong> be a valid <a href="resources.html#VkImageLayout" class="xref page">VkImageLayout</a> value</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-parameter" href="#VUID-VkImageMemoryBarrier-image-parameter"></a> <span class="vuid">VUID-VkImageMemoryBarrier-image-parameter</span><br>
 <code>image</code> <strong>must</strong> be a valid <a href="resources.html#VkImage" class="xref page">VkImage</a> handle</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-subresourceRange-parameter" href="#VUID-VkImageMemoryBarrier-subresourceRange-parameter"></a> <span class="vuid">VUID-VkImageMemoryBarrier-subresourceRange-parameter</span><br>
 <code>subresourceRange</code> <strong>must</strong> be a valid <a href="resources.html#VkImageSubresourceRange" class="xref page">VkImageSubresourceRange</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To facilitate usage of images whose memory is initialized on the host,
Vulkan allows image layout transitions to be performed by the host as well,
albeit supporting limited layouts.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To perform an image layout transition on the host, call:</p>
</div>
<div id="vkTransitionImageLayoutEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_host_image_copy
VkResult vkTransitionImageLayoutEXT(
    VkDevice                                    device,
    uint32_t                                    transitionCount,
    const VkHostImageLayoutTransitionInfoEXT*   pTransitions);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device which owns <code>pTransitions</code>[i].<code>image</code>.</p>
</li>
<li>
<p><code>transitionCount</code> is the number of image layout transitions to
perform.</p>
</li>
<li>
<p><code>pTransitions</code> is a pointer to an array of
<a href="#VkHostImageLayoutTransitionInfoEXT">VkHostImageLayoutTransitionInfoEXT</a> structures specifying the image
and <a href="resources.html#resources-image-views" class="xref page">subresource ranges</a> within them to
transition.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkTransitionImageLayoutEXT-device-parameter" href="#VUID-vkTransitionImageLayoutEXT-device-parameter"></a> <span class="vuid">VUID-vkTransitionImageLayoutEXT-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkTransitionImageLayoutEXT-pTransitions-parameter" href="#VUID-vkTransitionImageLayoutEXT-pTransitions-parameter"></a> <span class="vuid">VUID-vkTransitionImageLayoutEXT-pTransitions-parameter</span><br>
 <code>pTransitions</code> <strong>must</strong> be a valid pointer to an array of <code>transitionCount</code> valid <a href="#VkHostImageLayoutTransitionInfoEXT">VkHostImageLayoutTransitionInfoEXT</a> structures</p>
</li>
<li>
<p><a id="VUID-vkTransitionImageLayoutEXT-transitionCount-arraylength" href="#VUID-vkTransitionImageLayoutEXT-transitionCount-arraylength"></a> <span class="vuid">VUID-vkTransitionImageLayoutEXT-transitionCount-arraylength</span><br>
 <code>transitionCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_INITIALIZATION_FAILED</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_MEMORY_MAP_FAILED</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkHostImageLayoutTransitionInfoEXT</code> structure is defined as:</p>
</div>
<div id="VkHostImageLayoutTransitionInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_host_image_copy
typedef struct VkHostImageLayoutTransitionInfoEXT {
    VkStructureType            sType;
    const void*                pNext;
    VkImage                    image;
    VkImageLayout              oldLayout;
    VkImageLayout              newLayout;
    VkImageSubresourceRange    subresourceRange;
} VkHostImageLayoutTransitionInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>image</code> is a handle to the image affected by this layout transition.</p>
</li>
<li>
<p><code>oldLayout</code> is the old layout in an
<a href="#synchronization-image-layout-transitions">image layout transition</a>.</p>
</li>
<li>
<p><code>newLayout</code> is the new layout in an
<a href="#synchronization-image-layout-transitions">image layout transition</a>.</p>
</li>
<li>
<p><code>subresourceRange</code> describes the <a href="resources.html#resources-image-views" class="xref page">image    subresource range</a> within <code>image</code> that is affected by this layout
transition.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkTransitionImageLayoutEXT</code> does not check whether the device memory
associated with an image is currently in use before performing the layout
transition.
The application <strong>must</strong> guarantee that any previously submitted command that
reads from or writes to this subresource has completed before the host
performs the layout transition.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Image layout transitions performed on the host do not require queue family
ownership transfers as the physical layout of the image will not vary
between queue families for the layouts supported by this function.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-image-09055" href="#VUID-VkHostImageLayoutTransitionInfoEXT-image-09055"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-image-09055</span><br>

<code>image</code> <strong>must</strong> have been created with
<code>VK_IMAGE_USAGE_HOST_TRANSFER_BIT_EXT</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-subresourceRange-01486" href="#VUID-VkHostImageLayoutTransitionInfoEXT-subresourceRange-01486"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-subresourceRange-01486</span><br>

<code>subresourceRange.baseMipLevel</code> <strong>must</strong> be less than the
<code>mipLevels</code> specified in <a href="resources.html#VkImageCreateInfo" class="xref page">VkImageCreateInfo</a> when <code>image</code>
was created</p>
</li>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-subresourceRange-01724" href="#VUID-VkHostImageLayoutTransitionInfoEXT-subresourceRange-01724"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-subresourceRange-01724</span><br>

If <code>subresourceRange.levelCount</code> is not
<code>VK_REMAINING_MIP_LEVELS</code>, <span class="eq"><code>subresourceRange.baseMipLevel</code>
+  <code>subresourceRange.levelCount</code></span> <strong>must</strong> be less than or equal to
the <code>mipLevels</code> specified in <a href="resources.html#VkImageCreateInfo" class="xref page">VkImageCreateInfo</a> when
<code>image</code> was created</p>
</li>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-subresourceRange-01488" href="#VUID-VkHostImageLayoutTransitionInfoEXT-subresourceRange-01488"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-subresourceRange-01488</span><br>

<code>subresourceRange.baseArrayLayer</code> <strong>must</strong> be less than the
<code>arrayLayers</code> specified in <a href="resources.html#VkImageCreateInfo" class="xref page">VkImageCreateInfo</a> when <code>image</code>
was created</p>
</li>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-subresourceRange-01725" href="#VUID-VkHostImageLayoutTransitionInfoEXT-subresourceRange-01725"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-subresourceRange-01725</span><br>

If <code>subresourceRange.layerCount</code> is not
<code>VK_REMAINING_ARRAY_LAYERS</code>,
<span class="eq"><code>subresourceRange.baseArrayLayer</code> + 
<code>subresourceRange.layerCount</code></span> <strong>must</strong> be less than or equal to the
<code>arrayLayers</code> specified in <a href="resources.html#VkImageCreateInfo" class="xref page">VkImageCreateInfo</a> when <code>image</code>
was created</p>
</li>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-image-01932" href="#VUID-VkHostImageLayoutTransitionInfoEXT-image-01932"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-image-01932</span><br>

If <code>image</code> is non-sparse then it <strong>must</strong> be bound completely and
contiguously to a single <code>VkDeviceMemory</code> object</p>
</li>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-image-09241" href="#VUID-VkHostImageLayoutTransitionInfoEXT-image-09241"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-image-09241</span><br>

If <code>image</code> has a color format that is single-plane, then the
<code>aspectMask</code> member of <code>subresourceRange</code> <strong>must</strong> be
<code>VK_IMAGE_ASPECT_COLOR_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-image-09242" href="#VUID-VkHostImageLayoutTransitionInfoEXT-image-09242"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-image-09242</span><br>

If <code>image</code> has a color format and is not <em>disjoint</em>, then the
<code>aspectMask</code> member of <code>subresourceRange</code> <strong>must</strong> be
<code>VK_IMAGE_ASPECT_COLOR_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-image-01672" href="#VUID-VkHostImageLayoutTransitionInfoEXT-image-01672"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-image-01672</span><br>

If <code>image</code> has a multi-planar format and the image is <em>disjoint</em>,
then the <code>aspectMask</code> member of <code>subresourceRange</code> <strong>must</strong> include
at least one <a href="formats.html#formats-planes-image-aspect" class="xref page">multi-planar aspect mask</a>
bit or <code>VK_IMAGE_ASPECT_COLOR_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-image-03319" href="#VUID-VkHostImageLayoutTransitionInfoEXT-image-03319"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-image-03319</span><br>

If <code>image</code> has a depth/stencil format with both depth and stencil
and the <a href="features.html#features-separateDepthStencilLayouts" class="xref page">    <code>separateDepthStencilLayouts</code></a> feature is enabled, then the
<code>aspectMask</code> member of <code>subresourceRange</code> <strong>must</strong> include either
or both <code>VK_IMAGE_ASPECT_DEPTH_BIT</code> and
<code>VK_IMAGE_ASPECT_STENCIL_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-image-03320" href="#VUID-VkHostImageLayoutTransitionInfoEXT-image-03320"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-image-03320</span><br>

If <code>image</code> has a depth/stencil format with both depth and stencil
and the <a href="features.html#features-separateDepthStencilLayouts" class="xref page">    <code>separateDepthStencilLayouts</code></a> feature is not enabled, then the
<code>aspectMask</code> member of <code>subresourceRange</code> <strong>must</strong> include both
<code>VK_IMAGE_ASPECT_DEPTH_BIT</code> and <code>VK_IMAGE_ASPECT_STENCIL_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-aspectMask-08702" href="#VUID-VkHostImageLayoutTransitionInfoEXT-aspectMask-08702"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-aspectMask-08702</span><br>

If the <code>aspectMask</code> member of <code>subresourceRange</code> includes
<code>VK_IMAGE_ASPECT_DEPTH_BIT</code>, <code>oldLayout</code> and <code>newLayout</code>
<strong>must</strong> not be one of <code>VK_IMAGE_LAYOUT_STENCIL_ATTACHMENT_OPTIMAL</code> or
<code>VK_IMAGE_LAYOUT_STENCIL_READ_ONLY_OPTIMAL</code></p>
</li>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-aspectMask-08703" href="#VUID-VkHostImageLayoutTransitionInfoEXT-aspectMask-08703"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-aspectMask-08703</span><br>

If the <code>aspectMask</code> member of <code>subresourceRange</code> includes
<code>VK_IMAGE_ASPECT_STENCIL_BIT</code>, <code>oldLayout</code> and <code>newLayout</code>
<strong>must</strong> not be one of <code>VK_IMAGE_LAYOUT_DEPTH_ATTACHMENT_OPTIMAL</code> or
<code>VK_IMAGE_LAYOUT_DEPTH_READ_ONLY_OPTIMAL</code></p>
</li>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-oldLayout-09229" href="#VUID-VkHostImageLayoutTransitionInfoEXT-oldLayout-09229"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-oldLayout-09229</span><br>

<code>oldLayout</code> <strong>must</strong> be either <code>VK_IMAGE_LAYOUT_UNDEFINED</code> or the
current layout of the image subresources as specified in
<code>subresourceRange</code></p>
</li>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-oldLayout-09230" href="#VUID-VkHostImageLayoutTransitionInfoEXT-oldLayout-09230"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-oldLayout-09230</span><br>

If <code>oldLayout</code> is not <code>VK_IMAGE_LAYOUT_UNDEFINED</code> or
<code>VK_IMAGE_LAYOUT_PREINITIALIZED</code>, it <strong>must</strong> be one of the layouts in
<a href="limits.html#VkPhysicalDeviceHostImageCopyPropertiesEXT" class="xref page">VkPhysicalDeviceHostImageCopyPropertiesEXT</a>::<code>pCopySrcLayouts</code></p>
</li>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-newLayout-09057" href="#VUID-VkHostImageLayoutTransitionInfoEXT-newLayout-09057"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-newLayout-09057</span><br>

<code>newLayout</code> <strong>must</strong> be one of the layouts in
<a href="limits.html#VkPhysicalDeviceHostImageCopyPropertiesEXT" class="xref page">VkPhysicalDeviceHostImageCopyPropertiesEXT</a>::<code>pCopyDstLayouts</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-sType-sType" href="#VUID-VkHostImageLayoutTransitionInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_HOST_IMAGE_LAYOUT_TRANSITION_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-pNext-pNext" href="#VUID-VkHostImageLayoutTransitionInfoEXT-pNext-pNext"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-image-parameter" href="#VUID-VkHostImageLayoutTransitionInfoEXT-image-parameter"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-image-parameter</span><br>
 <code>image</code> <strong>must</strong> be a valid <a href="resources.html#VkImage" class="xref page">VkImage</a> handle</p>
</li>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-oldLayout-parameter" href="#VUID-VkHostImageLayoutTransitionInfoEXT-oldLayout-parameter"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-oldLayout-parameter</span><br>
 <code>oldLayout</code> <strong>must</strong> be a valid <a href="resources.html#VkImageLayout" class="xref page">VkImageLayout</a> value</p>
</li>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-newLayout-parameter" href="#VUID-VkHostImageLayoutTransitionInfoEXT-newLayout-parameter"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-newLayout-parameter</span><br>
 <code>newLayout</code> <strong>must</strong> be a valid <a href="resources.html#VkImageLayout" class="xref page">VkImageLayout</a> value</p>
</li>
<li>
<p><a id="VUID-VkHostImageLayoutTransitionInfoEXT-subresourceRange-parameter" href="#VUID-VkHostImageLayoutTransitionInfoEXT-subresourceRange-parameter"></a> <span class="vuid">VUID-VkHostImageLayoutTransitionInfoEXT-subresourceRange-parameter</span><br>
 <code>subresourceRange</code> <strong>must</strong> be a valid <a href="resources.html#VkImageSubresourceRange" class="xref page">VkImageSubresourceRange</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-queue-transfers"><a class="anchor" href="#synchronization-queue-transfers"></a>Queue Family Ownership Transfer</h3>
<div class="paragraph">
<p>Resources created with a <a href="resources.html#VkSharingMode" class="xref page">VkSharingMode</a> of
<code>VK_SHARING_MODE_EXCLUSIVE</code> <strong>must</strong> have their ownership explicitly
transferred from one queue family to another in order to access their
content in a well-defined manner on a queue in a different queue family.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The special queue family index <code>VK_QUEUE_FAMILY_IGNORED</code> indicates that
a queue family parameter or member is ignored.</p>
</div>
<div id="VK_QUEUE_FAMILY_IGNORED" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">#define VK_QUEUE_FAMILY_IGNORED           (~0U)</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Resources shared with external APIs or instances using external memory <strong>must</strong>
also explicitly manage ownership transfers between local and external queues
(or equivalent constructs in external APIs) regardless of the
<a href="resources.html#VkSharingMode" class="xref page">VkSharingMode</a> specified when creating them.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The special queue family index <code>VK_QUEUE_FAMILY_EXTERNAL</code> represents any
queue external to the resource&#8217;s current Vulkan instance, as long as the
queue uses the same underlying
device group or
physical device, and the same driver version as the resource&#8217;s
<a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a>, as indicated by
<a href="devsandqueues.html#VkPhysicalDeviceIDProperties" class="xref page">VkPhysicalDeviceIDProperties</a>::<code>deviceUUID</code> and
<a href="devsandqueues.html#VkPhysicalDeviceIDProperties" class="xref page">VkPhysicalDeviceIDProperties</a>::<code>driverUUID</code>.</p>
</div>
<div id="VK_QUEUE_FAMILY_EXTERNAL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">#define VK_QUEUE_FAMILY_EXTERNAL          (~1U)</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VK_QUEUE_FAMILY_EXTERNAL_KHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">#define VK_QUEUE_FAMILY_EXTERNAL_KHR      VK_QUEUE_FAMILY_EXTERNAL</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The special queue family index <code>VK_QUEUE_FAMILY_FOREIGN_EXT</code> represents
any queue external to the resource&#8217;s current Vulkan instance, regardless of
the queue&#8217;s underlying physical device or driver version.
This includes, for example, queues for fixed-function image processing
devices, media codec devices, and display devices, as well as all queues
that use the same underlying
device group or
physical device, and the same driver version as the resource&#8217;s
<a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a>.</p>
</div>
<div id="VK_QUEUE_FAMILY_FOREIGN_EXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">#define VK_QUEUE_FAMILY_FOREIGN_EXT       (~2U)</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If memory dependencies are correctly expressed between uses of such a
resource between two queues in different families, but no ownership transfer
is defined, the contents of that resource are <strong>undefined</strong> for any read
accesses performed by the second queue family.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>If an application does not need the contents of a resource to remain valid
when transferring from one queue family to another, then the ownership
transfer <strong>should</strong> be skipped.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications should expect transfers to/from
<code>VK_QUEUE_FAMILY_FOREIGN_EXT</code> to be more expensive than transfers
to/from <code>VK_QUEUE_FAMILY_EXTERNAL_KHR</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A queue family ownership transfer consists of two distinct parts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Release exclusive ownership from the source queue family</p>
</li>
<li>
<p>Acquire exclusive ownership for the destination queue family</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>An application <strong>must</strong> ensure that these operations occur in the correct order
by defining an execution dependency between them, e.g. using a semaphore.</p>
</div>
<div class="paragraph">
<p><a id="synchronization-queue-transfers-release"></a> A <em>release operation</em> is used to
release exclusive ownership of a range of a buffer or image subresource
range.
A release operation is defined by executing a
<a href="#synchronization-buffer-memory-barriers">buffer memory barrier</a> (for a
buffer range) or an <a href="#synchronization-image-memory-barriers">image memory barrier</a> (for an image subresource range) using a pipeline barrier command,
on a queue from the source queue family.
The <code>srcQueueFamilyIndex</code> parameter of the barrier <strong>must</strong> be set to the
source queue family index, and the <code>dstQueueFamilyIndex</code> parameter to
the destination queue family index.
<code>dstAccessMask</code> is ignored for such a barrier, such that no visibility
operation is executed - the value of this mask does not affect the validity
of the barrier.
The release operation happens-after the availability operation, and
happens-before operations specified in the second synchronization scope of
the calling command.</p>
</div>
<div class="paragraph">
<p><a id="synchronization-queue-transfers-acquire"></a> An <em>acquire operation</em> is used
to acquire exclusive ownership of a range of a buffer or image subresource
range.
An acquire operation is defined by executing a
<a href="#synchronization-buffer-memory-barriers">buffer memory barrier</a> (for a
buffer range) or an <a href="#synchronization-image-memory-barriers">image memory barrier</a> (for an image subresource range) using a pipeline barrier command,
on a queue from the destination queue family.
The buffer range or image subresource range specified in an acquire
operation <strong>must</strong> match exactly that of a previous release operation.
The <code>srcQueueFamilyIndex</code> parameter of the barrier <strong>must</strong> be set to the
source queue family index, and the <code>dstQueueFamilyIndex</code> parameter to
the destination queue family index.
<code>srcAccessMask</code> is ignored for such a barrier, such that no availability
operation is executed - the value of this mask does not affect the validity
of the barrier.
The acquire operation happens-after operations in the first synchronization
scope of the calling command, and happens-before the visibility operation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Whilst it is not invalid to provide destination or source access masks for
memory barriers used for release or acquire operations, respectively, they
have no practical effect.
Access after a release operation has <strong>undefined</strong> results, and so visibility
for those accesses has no practical effect.
Similarly, write access before an acquire operation will produce <strong>undefined</strong>
results for future access, so availability of those writes has no practical
use.
In an earlier version of the specification, these were required to match on
both sides - but this was subsequently relaxed.
These masks <strong>should</strong> be set to 0.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the transfer is via an image memory barrier, and an
<a href="#synchronization-image-layout-transitions">image layout transition</a> is
desired, then the values of <code>oldLayout</code> and <code>newLayout</code> in the
<em>release operation</em>'s memory barrier <strong>must</strong> be equal to values of
<code>oldLayout</code> and <code>newLayout</code> in the <em>acquire operation</em>'s memory
barrier.
Although the image layout transition is submitted twice, it will only be
executed once.
A layout transition specified in this way happens-after the <em>release
operation</em> and happens-before the <em>acquire operation</em>.</p>
</div>
<div class="paragraph">
<p>If the values of <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> are
equal, no ownership transfer is performed, and the barrier operates as if
they were both set to <code>VK_QUEUE_FAMILY_IGNORED</code>.</p>
</div>
<div class="paragraph">
<p>Queue family ownership transfers <strong>may</strong> perform read and write accesses on all
memory bound to the image subresource or buffer range, so applications <strong>must</strong>
ensure that all memory writes have been made
<a href="#synchronization-dependencies-available-and-visible">available</a> before a
queue family ownership transfer is executed.
Available memory is automatically made visible to queue family release and
acquire operations, and writes performed by those operations are
automatically made available.</p>
</div>
<div class="paragraph">
<p>Once a queue family has acquired ownership of a buffer range or image
subresource range of a <code>VK_SHARING_MODE_EXCLUSIVE</code> resource, its
contents are <strong>undefined</strong> to other queue families unless ownership is
transferred.
The contents of any portion of another resource which aliases memory that is
bound to the transferred buffer or image subresource range are <strong>undefined</strong>
after a release or acquire operation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Because <a href="#synchronization-events">events</a> <strong>cannot</strong> be used directly for
inter-queue synchronization, and because <a href="#vkCmdSetEvent">vkCmdSetEvent</a> does not have
the queue family index or memory barrier parameters needed by a <em>release
operation</em>, the release and acquire operations of a queue family ownership
transfer <strong>can</strong> only be performed using <a href="#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>An <em>acquire operation</em> <strong>may</strong> have a performance penalty when acquiring
ownership of a subresource range from one of the special queue families
reserved for external memory ownership transfers described above.
The application <strong>can</strong> reduce the performance penalty in some cases by adding
a <a href="#VkExternalMemoryAcquireUnmodifiedEXT">VkExternalMemoryAcquireUnmodifiedEXT</a> structure to the <code>pNext</code>
chain of the <em>acquire operation</em>'s memory barrier structure.</p>
</div>
<div class="paragraph">
<p>The <code>VkExternalMemoryAcquireUnmodifiedEXT</code> structure is defined as:</p>
</div>
<div id="VkExternalMemoryAcquireUnmodifiedEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_external_memory_acquire_unmodified
typedef struct VkExternalMemoryAcquireUnmodifiedEXT {
    VkStructureType    sType;
    const void*        pNext;
    VkBool32           acquireUnmodifiedMemory;
} VkExternalMemoryAcquireUnmodifiedEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>acquireUnmodifiedMemory</code> specifies, if <code>VK_TRUE</code>, that no range
of <a href="memory.html#VkDeviceMemory" class="xref page">VkDeviceMemory</a> bound to the resource of the memory barrier&#8217;s
subresource range was modified at any time since the resource&#8217;s most
recent release of ownership to the queue family specified by the memory
barrier&#8217;s <code>srcQueueFamilyIndex</code>.
If <code>VK_FALSE</code>, it specifies nothing.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the application releases ownership of the subresource range to one of the
special queue families reserved for external memory ownership transfers with
a memory barrier structure, and later re-acquires ownership from the same
queue family with a memory barrier structure, and if no range of
<a href="memory.html#VkDeviceMemory" class="xref page">VkDeviceMemory</a> bound to the resource was modified at any time between
the <em>release operation</em> and the <em>acquire operation</em>, then the application
<strong>should</strong> add a <a href="#VkExternalMemoryAcquireUnmodifiedEXT">VkExternalMemoryAcquireUnmodifiedEXT</a> structure to the
<code>pNext</code> chain of the <em>acquire operation</em>'s memory barrier structure
because this <strong>may</strong> reduce the performance penalty.</p>
</div>
<div class="paragraph">
<p>This struct is ignored if <code>acquireUnmodifiedMemory</code> is <code>VK_FALSE</code>.
In particular, <code>VK_FALSE</code> does <em>not</em> specify that memory was modified.</p>
</div>
<div class="paragraph">
<p>This struct is ignored if the memory barrier&#8217;s <code>srcQueueFamilyIndex</code> is
not a special queue family reserved for external memory ownership transfers.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The method by which the application determines whether memory was modified
between the <em>release operation</em> and <em>acquire operation</em> is outside the scope
of Vulkan.</p>
</div>
<div class="paragraph">
<p>For any Vulkan operation that accesses a resource, the application <strong>must</strong> not
assume the implementation accesses the resource&#8217;s memory as read-only, even
for <em>apparently</em> read-only operations such as transfer commands and shader
reads.</p>
</div>
<div class="paragraph">
<p>The validity of
<a href="#VkExternalMemoryAcquireUnmodifiedEXT">VkExternalMemoryAcquireUnmodifiedEXT</a>::<code>acquireUnmodifiedMemory</code> is
independent of memory ranges outside the ranges of <a href="memory.html#VkDeviceMemory" class="xref page">VkDeviceMemory</a>
bound to the resource.
In particular, it is independent of any implementation-private memory
associated with the resource.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkExternalMemoryAcquireUnmodifiedEXT-acquireUnmodifiedMemory-08922" href="#VUID-VkExternalMemoryAcquireUnmodifiedEXT-acquireUnmodifiedMemory-08922"></a> <span class="vuid">VUID-VkExternalMemoryAcquireUnmodifiedEXT-acquireUnmodifiedMemory-08922</span><br>

If <code>acquireUnmodifiedMemory</code> is <code>VK_TRUE</code>, and the memory
barrier&#8217;s <code>srcQueueFamilyIndex</code> is a special queue family reserved
for external memory ownership transfers (as described in
<a href="#synchronization-queue-transfers">Queue Family Ownership Transfer</a>), then each range of
<a href="memory.html#VkDeviceMemory" class="xref page">VkDeviceMemory</a> bound to the resource <strong>must</strong> have remained
unmodified during all time since the resource&#8217;s most recent release of
ownership to the queue family.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkExternalMemoryAcquireUnmodifiedEXT-sType-sType" href="#VUID-VkExternalMemoryAcquireUnmodifiedEXT-sType-sType"></a> <span class="vuid">VUID-VkExternalMemoryAcquireUnmodifiedEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_EXTERNAL_MEMORY_ACQUIRE_UNMODIFIED_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="synchronization-wait-idle"><a class="anchor" href="#synchronization-wait-idle"></a>Wait Idle Operations</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To wait on the host for the completion of outstanding queue operations for a
given queue, call:</p>
</div>
<div id="vkQueueWaitIdle" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VkResult vkQueueWaitIdle(
    VkQueue                                     queue);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>queue</code> is the queue on which to wait.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkQueueWaitIdle</code> is equivalent to having submitted a valid fence to
every previously executed <a href="devsandqueues.html#devsandqueues-submission" class="xref page">queue submission command</a> that accepts a fence, then waiting for all of those fences to
signal using <a href="#vkWaitForFences">vkWaitForFences</a> with an infinite timeout and
<code>waitAll</code> set to <code>VK_TRUE</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkQueueWaitIdle-queue-parameter" href="#VUID-vkQueueWaitIdle-queue-parameter"></a> <span class="vuid">VUID-vkQueueWaitIdle-queue-parameter</span><br>
 <code>queue</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkQueue" class="xref page">VkQueue</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>queue</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To wait on the host for the completion of outstanding queue operations for
all queues on a given logical device, call:</p>
</div>
<div id="vkDeviceWaitIdle" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VkResult vkDeviceWaitIdle(
    VkDevice                                    device);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device to idle.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkDeviceWaitIdle</code> is equivalent to calling <code>vkQueueWaitIdle</code> for
all queues owned by <code>device</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDeviceWaitIdle-device-parameter" href="#VUID-vkDeviceWaitIdle-device-parameter"></a> <span class="vuid">VUID-vkDeviceWaitIdle-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to all <code>VkQueue</code> objects created from <code>device</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="synchronization-submission-host-writes"><a class="anchor" href="#synchronization-submission-host-writes"></a>Host Write Ordering Guarantees</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When batches of command buffers are submitted to a queue via a
<a href="devsandqueues.html#devsandqueues-submission" class="xref page">queue submission command</a>, it defines a memory
dependency with prior host operations, and execution of command buffers
submitted to the queue.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes execution of <a href="cmdbuffers.html#vkQueueSubmit" class="xref page">vkQueueSubmit</a> on the host and anything that
happened-before it, as defined by the host memory model.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Some systems allow writes that do not directly integrate with the host
memory model; these have to be synchronized by the application manually.
One example of this is non-temporal store instructions on x86; to ensure
these happen-before submission, applications should call <code>_mm_sfence()</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands submitted in the same <a href="devsandqueues.html#devsandqueues-submission" class="xref page">queue submission</a>, and all commands that occur later in
<a href="#synchronization-submission-order">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-access-scopes">access scope</a>
includes all host writes to mappable device memory that are available to the
host memory domain.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-access-scopes">access scope</a>
includes all memory access performed by the device.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="synchronization-device-group"><a class="anchor" href="#synchronization-device-group"></a>Synchronization and Multiple Physical Devices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If a logical device includes more than one physical device, then fences,
semaphores, and events all still have a single instance of the signaled
state.</p>
</div>
<div class="paragraph">
<p>A fence becomes signaled when all physical devices complete the necessary
queue operations.</p>
</div>
<div class="paragraph">
<p>Semaphore wait and signal operations all include a device index that is the
sole physical device that performs the operation.
These indices are provided in the <a href="cmdbuffers.html#VkDeviceGroupSubmitInfo" class="xref page">VkDeviceGroupSubmitInfo</a>
and <a href="sparsemem.html#VkDeviceGroupBindSparseInfo" class="xref page">VkDeviceGroupBindSparseInfo</a>
structures.
Semaphores are not exclusively owned by any physical device.
For example, a semaphore can be signaled by one physical device and then
waited on by a different physical device.</p>
</div>
<div class="paragraph">
<p>An event <strong>can</strong> only be waited on by the same physical device that signaled it
(or the host).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="calibrated-timestamps"><a class="anchor" href="#calibrated-timestamps"></a>Calibrated timestamps</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>In order to be able to correlate the time a particular operation took place
at on timelines of different time domains (e.g. a device operation vs. a
host operation), Vulkan allows querying calibrated timestamps from multiple
time domains.</p>
</div>
<div class="paragraph">
<p>To query calibrated timestamps from a set of time domains, call:</p>
</div>
<div id="vkGetCalibratedTimestampsEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_calibrated_timestamps
VkResult vkGetCalibratedTimestampsEXT(
    VkDevice                                    device,
    uint32_t                                    timestampCount,
    const VkCalibratedTimestampInfoEXT*         pTimestampInfos,
    uint64_t*                                   pTimestamps,
    uint64_t*                                   pMaxDeviation);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device used to perform the query.</p>
</li>
<li>
<p><code>timestampCount</code> is the number of timestamps to query.</p>
</li>
<li>
<p><code>pTimestampInfos</code> is a pointer to an array of <code>timestampCount</code>
<a href="#VkCalibratedTimestampInfoEXT">VkCalibratedTimestampInfoEXT</a> structures, describing the time
domains the calibrated timestamps should be captured from.</p>
</li>
<li>
<p><code>pTimestamps</code> is a pointer to an array of <code>timestampCount</code>
64-bit unsigned integer values in which the requested calibrated
timestamp values are returned.</p>
</li>
<li>
<p><code>pMaxDeviation</code> is a pointer to a 64-bit unsigned integer value in
which the strictly positive maximum deviation, in nanoseconds, of the
calibrated timestamp values is returned.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The maximum deviation <strong>may</strong> vary between calls to
<code>vkGetCalibratedTimestampsEXT</code> even for the same set of time domains due
to implementation and platform specific reasons.
It is the application&#8217;s responsibility to assess whether the returned
maximum deviation makes the timestamp values suitable for any particular
purpose and <strong>can</strong> choose to re-issue the timestamp calibration call pursuing
a lower deviation value.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Calibrated timestamp values <strong>can</strong> be extrapolated to estimate future
coinciding timestamp values, however, depending on the nature of the time
domains and other properties of the platform extrapolating values over a
sufficiently long period of time <strong>may</strong> no longer be accurate enough to fit
any particular purpose, so applications are expected to re-calibrate the
timestamps on a regular basis.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetCalibratedTimestampsEXT-timeDomain-09246" href="#VUID-vkGetCalibratedTimestampsEXT-timeDomain-09246"></a> <span class="vuid">VUID-vkGetCalibratedTimestampsEXT-timeDomain-09246</span><br>

The <code>timeDomain</code> value of each <a href="#VkCalibratedTimestampInfoEXT">VkCalibratedTimestampInfoEXT</a> in
<code>pTimestampInfos</code> <strong>must</strong> be unique</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetCalibratedTimestampsEXT-device-parameter" href="#VUID-vkGetCalibratedTimestampsEXT-device-parameter"></a> <span class="vuid">VUID-vkGetCalibratedTimestampsEXT-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetCalibratedTimestampsEXT-pTimestampInfos-parameter" href="#VUID-vkGetCalibratedTimestampsEXT-pTimestampInfos-parameter"></a> <span class="vuid">VUID-vkGetCalibratedTimestampsEXT-pTimestampInfos-parameter</span><br>
 <code>pTimestampInfos</code> <strong>must</strong> be a valid pointer to an array of <code>timestampCount</code> valid <a href="#VkCalibratedTimestampInfoEXT">VkCalibratedTimestampInfoEXT</a> structures</p>
</li>
<li>
<p><a id="VUID-vkGetCalibratedTimestampsEXT-pTimestamps-parameter" href="#VUID-vkGetCalibratedTimestampsEXT-pTimestamps-parameter"></a> <span class="vuid">VUID-vkGetCalibratedTimestampsEXT-pTimestamps-parameter</span><br>
 <code>pTimestamps</code> <strong>must</strong> be a valid pointer to an array of <code>timestampCount</code> <code>uint64_t</code> values</p>
</li>
<li>
<p><a id="VUID-vkGetCalibratedTimestampsEXT-pMaxDeviation-parameter" href="#VUID-vkGetCalibratedTimestampsEXT-pMaxDeviation-parameter"></a> <span class="vuid">VUID-vkGetCalibratedTimestampsEXT-pMaxDeviation-parameter</span><br>
 <code>pMaxDeviation</code> <strong>must</strong> be a valid pointer to a <code>uint64_t</code> value</p>
</li>
<li>
<p><a id="VUID-vkGetCalibratedTimestampsEXT-timestampCount-arraylength" href="#VUID-vkGetCalibratedTimestampsEXT-timestampCount-arraylength"></a> <span class="vuid">VUID-vkGetCalibratedTimestampsEXT-timestampCount-arraylength</span><br>
 <code>timestampCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkCalibratedTimestampInfoEXT</code> structure is defined as:</p>
</div>
<div id="VkCalibratedTimestampInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_calibrated_timestamps
typedef struct VkCalibratedTimestampInfoEXT {
    VkStructureType    sType;
    const void*        pNext;
    VkTimeDomainEXT    timeDomain;
} VkCalibratedTimestampInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>timeDomain</code> is a <a href="#VkTimeDomainEXT">VkTimeDomainEXT</a> value specifying the time
domain from which the calibrated timestamp value should be returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCalibratedTimestampInfoEXT-timeDomain-02354" href="#VUID-VkCalibratedTimestampInfoEXT-timeDomain-02354"></a> <span class="vuid">VUID-VkCalibratedTimestampInfoEXT-timeDomain-02354</span><br>

<code>timeDomain</code> <strong>must</strong> be one of the <a href="#VkTimeDomainEXT">VkTimeDomainEXT</a> values
returned by <a href="capabilities.html#vkGetPhysicalDeviceCalibrateableTimeDomainsEXT" class="xref page">vkGetPhysicalDeviceCalibrateableTimeDomainsEXT</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCalibratedTimestampInfoEXT-sType-sType" href="#VUID-VkCalibratedTimestampInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkCalibratedTimestampInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_CALIBRATED_TIMESTAMP_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkCalibratedTimestampInfoEXT-pNext-pNext" href="#VUID-VkCalibratedTimestampInfoEXT-pNext-pNext"></a> <span class="vuid">VUID-VkCalibratedTimestampInfoEXT-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkCalibratedTimestampInfoEXT-timeDomain-parameter" href="#VUID-VkCalibratedTimestampInfoEXT-timeDomain-parameter"></a> <span class="vuid">VUID-VkCalibratedTimestampInfoEXT-timeDomain-parameter</span><br>
 <code>timeDomain</code> <strong>must</strong> be a valid <a href="#VkTimeDomainEXT">VkTimeDomainEXT</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The set of supported time domains consists of:</p>
</div>
<div id="VkTimeDomainEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_calibrated_timestamps
typedef enum VkTimeDomainEXT {
    VK_TIME_DOMAIN_DEVICE_EXT = 0,
    VK_TIME_DOMAIN_CLOCK_MONOTONIC_EXT = 1,
    VK_TIME_DOMAIN_CLOCK_MONOTONIC_RAW_EXT = 2,
    VK_TIME_DOMAIN_QUERY_PERFORMANCE_COUNTER_EXT = 3,
} VkTimeDomainEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_TIME_DOMAIN_DEVICE_EXT</code> specifies the device time domain.
Timestamp values in this time domain use the same units and are
comparable with device timestamp values captured using
<a href="queries.html#vkCmdWriteTimestamp" class="xref page">vkCmdWriteTimestamp</a>
or <a href="queries.html#vkCmdWriteTimestamp2" class="xref page">vkCmdWriteTimestamp2</a>
and are defined to be incrementing according to the
<a href="limits.html#limits-timestampPeriod" class="xref page"><code>timestampPeriod</code></a> of the device.</p>
</li>
<li>
<p><code>VK_TIME_DOMAIN_CLOCK_MONOTONIC_EXT</code> specifies the CLOCK_MONOTONIC
time domain available on POSIX platforms.
Timestamp values in this time domain are in units of nanoseconds and are
comparable with platform timestamp values captured using the POSIX
clock_gettime API as computed by this example:</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>An implementation supporting <code><a href="../appendices/extensions.html#VK_EXT_calibrated_timestamps" class="xref page">VK_EXT_calibrated_timestamps</a></code> will use
the same time domain for all its <a href="devsandqueues.html#VkQueue" class="xref page">VkQueue</a> so that timestamp values
reported for <code>VK_TIME_DOMAIN_DEVICE_EXT</code> can be matched to any timestamp
captured through <a href="queries.html#vkCmdWriteTimestamp" class="xref page">vkCmdWriteTimestamp</a>
or <a href="queries.html#vkCmdWriteTimestamp2" class="xref page">vkCmdWriteTimestamp2</a>
.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c hljs" data-lang="c">struct timespec tv;
clock_gettime(CLOCK_MONOTONIC, &amp;tv);
return tv.tv_nsec + tv.tv_sec*1000000000ull;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_TIME_DOMAIN_CLOCK_MONOTONIC_RAW_EXT</code> specifies the
CLOCK_MONOTONIC_RAW time domain available on POSIX platforms.
Timestamp values in this time domain are in units of nanoseconds and are
comparable with platform timestamp values captured using the POSIX
clock_gettime API as computed by this example:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c hljs" data-lang="c">struct timespec tv;
clock_gettime(CLOCK_MONOTONIC_RAW, &amp;tv);
return tv.tv_nsec + tv.tv_sec*1000000000ull;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_TIME_DOMAIN_QUERY_PERFORMANCE_COUNTER_EXT</code> specifies the
performance counter (QPC) time domain available on Windows.
Timestamp values in this time domain are in the same units as those
provided by the Windows QueryPerformanceCounter API and are comparable
with platform timestamp values captured using that API as computed by
this example:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c hljs" data-lang="c">LARGE_INTEGER counter;
QueryPerformanceCounter(&amp;counter);
return counter.QuadPart;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
    <!--
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
    -->
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Video Coding :: Vulkan Documentation Project</title>
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="apple-touch-icon" sizes="180x180" href="../../../_/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../_/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../_/img/favicon-16x16.png">
    <link rel="manifest" href="../../../_/static/site.webmanifest">
    <link rel="mask-icon" href="../../../_/img/safari-pinned-tab.svg" color="#a41e22">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../.."><img class="navbar-item" alt="Vulkan White Label" src="../../../_/Vulkan_Docs.svg" /></a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field has-filter">
          <label for="search-input"></label>
          <input id="search-input" type="text" placeholder="Search the docs">
          <label class="filter checkbox">
            <input type="checkbox" data-facet-filter="component:spec" checked> In this component
          </label>
        </div>
      </div>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <!-- <a class="navbar-item" href="#">Home</a> -->
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Specs</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../spec/latest/chapters/introduction.html">Vulkan 1.3</a>
            <a class="navbar-item" href="https://registry.khronos.org/OpenGL/specs/gl/GLSLangSpec.4.60.html">GLSL</a>
            <a class="navbar-item" href="../../../guide/latest/hlsl.html">HLSL</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Education</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../features/latest/features/index.html">Vulkan Feature Descriptions</a>
            <a class="navbar-item" href="../../../guide/latest/index.html">Vulkan Guide</a>
            <a class="navbar-item" href="../../../samples/latest/README.html">Vulkan Samples</a>
            <a class="navbar-item" href="../../../tutorial/latest/index.html">Vulkan Tutorial</a>
            <a class="navbar-item" href="https://www.youtube.com/c/vulkan">YouTube</a>
            <a class="navbar-item" href="https://vulkan.org">More Info at Vulkan.org</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Feedback</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="https://github.com/KhronosGroup/Vulkan-Site/issues/new/choose" target="_blank">Report a Problem</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Community</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="https://discord.gg/vulkan">Vulkan Discord</a>
            <a class="navbar-item" href="https://reddit.com/r/vulkan">Reddit</a>
            <a class="navbar-item" href="https://stackoverflow.com/questions/tagged/vulkan">Stack Overflow</a>
            <a class="navbar-item" href="https://fosstodon.org/@vulkan">Mastodon</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="spec" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">Vulkan Specification</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fundamentals.html">Fundamentals</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="initialization.html">Initialization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="devsandqueues.html">Devices and Queues</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cmdbuffers.html">Command Buffers</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="synchronization.html">Synchronization and Cache Control</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="renderpass.html">Render Pass</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="shaders.html">Shaders</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="pipelines.html">Pipelines</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="memory.html">Memory Allocation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="resources.html">Resource Creation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="samplers.html">Samplers</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="descriptorsets.html">Resource Descriptors</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="interfaces.html">Shader Interfaces</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="textures.html">Image Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fragmentdensitymapops.html">Fragment Density Map Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="queries.html">Queries</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="clears.html">Clear Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="copies.html">Copy Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="drawing.html">Drawing Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fxvertex.html">Fixed-Function Vertex Processing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="tessellation.html">Tessellation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="geometry.html">Geometry Shading</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_mesh_shader/mesh.html">Mesh Shading</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_HUAWEI_cluster_culling_shader/clusterculling.html">Cluster Culling Shading</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="vertexpostproc.html">Fixed-Function Vertex Post-Processing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="primsrast.html">Rasterization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fragops.html">Fragment Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="framebuffer.html">The Framebuffer</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dispatch.html">Dispatching Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="device_generated_commands/generatedcommands.html">Device-Generated Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="sparsemem.html">Sparse Resources</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_KHR_surface/wsi.html">Window System Integration (WSI)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_KHR_deferred_host_operations/deferred_host_operations.html">Deferred Host Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_EXT_private_data.html">Private Data</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="accelstructures.html">Acceleration Structures</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_EXT_opacity_micromap/micromaps.html">Micromap</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="raytraversal.html">Ray Traversal</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="raytracing.html">Ray Tracing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_memory_decompression.html">Memory Decompression</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="videocoding.html">Video Coding</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_optical_flow/optical_flow.html">Optical Flow</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="executiongraphs.html">Execution Graphs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="extensions.html">Extending Vulkan</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="features.html">Features</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="limits.html">Limits</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="formats.html">Formats</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="capabilities.html">Additional Capabilities</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="debugging.html">Debugging</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/spirvenv.html">Vulkan Environment for SPIR-V</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/memorymodel.html">Memory Model</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/compressedtex.html">Compressed Image Formats</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/versions.html">Core Revisions (Informative)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/extensions.html">Layers &amp; Extensions (Informative)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/roadmap.html">Vulkan Roadmap Milestones</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/boilerplate.html">API Boilerplate</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/invariance.html">Invariance</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/glossary.html">Lexicon</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/credits.html">Credits (Informative)</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Vulkan Specification</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../../../tutorial/latest/00_Introduction.html">Khronos Vulkan Tutorial</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../tutorial/latest/00_Introduction.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../features/latest/features/index.html">Vulkan Feature Descriptions</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../features/latest/features/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../guide/latest/index.html">Vulkan Guide</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../guide/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../samples/latest/README.html">Vulkan Samples</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../samples/latest/README.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <div class="title"><a href="../index.html">Vulkan Specification</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Vulkan Specification</a></li>
    <li><a href="videocoding.html">Video Coding</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Video Coding</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Vulkan implementations <strong>may</strong> expose one or more queue families supporting
video coding operations.
These operations are performed by recording them into a command buffer
within a <a href="#video-coding-scope">video coding scope</a>, and submitting them to
queues with compatible video coding capabilities.</p>
</div>
<div class="paragraph">
<p>The Vulkan video functionalities are designed to be made available through a
set of APIs built on top of each other, consisting of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A core API providing common video coding functionalities,</p>
</li>
<li>
<p>APIs providing codec-independent video decode and video encode related
functionalities, respectively,</p>
</li>
<li>
<p>Additional codec-specific APIs built on top of those.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This chapter details the fundamental components and operations of these.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="video-picture-resources"><a class="anchor" href="#video-picture-resources"></a>Video Picture Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the context of video coding, multidimensional arrays of image data that
<strong>can</strong> be used as the source or target of video coding operations are referred
to as <em>video picture resources</em>.
They <strong>may</strong> store additional metadata that includes implementation-private
information used during the execution of video coding operations, as
discussed later.</p>
</div>
<div class="paragraph">
<p>Video picture resources are backed by <a href="resources.html#VkImage" class="xref page">VkImage</a> objects.
Individual subregions of <a href="resources.html#VkImageView" class="xref page">VkImageView</a> objects created from such
resources <strong>can</strong> be used as
<a href="#reconstructed-picture">reconstructed pictures</a>, and/or
<a href="#reference-picture">reference pictures</a>.</p>
</div>
<div class="paragraph">
<p>The parameters of a video picture resource are specified using a
<code>VkVideoPictureResourceInfoKHR</code> structure.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoPictureResourceInfoKHR</code> structure is defined as:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/structs/VkVideoPictureResourceInfoKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>codedOffset</code> is the offset in texels of the image subregion to use.</p>
</li>
<li>
<p><code>codedExtent</code> is the size in pixels of the coded image data.</p>
</li>
<li>
<p><code>baseArrayLayer</code> is the array layer of the image view specified in
<code>imageViewBinding</code> to use as the video picture resource.</p>
</li>
<li>
<p><code>imageViewBinding</code> is an image view representing the video picture
resource.</p>
</li>
</ul>
</div>
<div id="video-image-subresource-reference" class="paragraph">
<p>The image subresource referred to by such a structure is defined as the
image array layer index specified in <code>baseArrayLayer</code> relative to the
image subresource range the image view specified in <code>imageViewBinding</code>
was created with.</p>
</div>
<div class="paragraph">
<p>The meaning of the <code>codedOffset</code> and <code>codedExtent</code> depends on the
command and context the video picture resource is used in, as well as on the
used <a href="#video-profiles">video profile</a> and corresponding codec-specific
semantics, as described later.</p>
</div>
<div id="video-picture-resource-uniqueness" class="paragraph">
<p>A video picture resource is uniquely defined by the image subresource
referred to by an instance of this structure, together with the
<code>codedOffset</code> and <code>codedExtent</code> members that identify the image
subregion within the image subresource referenced corresponding to the video
picture resource according to the particular codec-specific semantics.</p>
</div>
<div class="paragraph">
<p>Accesses to image data within a video picture resource happen at the
granularity indicated by
<code>VkVideoCapabilitiesKHR</code>::<code>pictureAccessGranularity</code>, as returned by
<code>vkGetPhysicalDeviceVideoCapabilitiesKHR</code> for the used <a href="#video-profiles">video profile</a>.
As a result, given an effective image subregion corresponding to a video
picture resource, the actual image subregion accessed <strong>may</strong> be larger than
that as it <strong>may</strong> include additional padding texels due to the picture access
granularity.
Any writes performed by video coding operations to such padding texels will
result in <strong>undefined</strong> texel values.</p>
</div>
<div id="video-picture-resource-matching" class="paragraph">
<p>Two video picture resources match if they refer to the same image
subresource and they specify identical <code>codedOffset</code> and
<code>codedExtent</code> values.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoPictureResourceInfoKHR-baseArrayLayer-07175" href="#VUID-VkVideoPictureResourceInfoKHR-baseArrayLayer-07175"></a> <span class="vuid">VUID-VkVideoPictureResourceInfoKHR-baseArrayLayer-07175</span><br>

<code>baseArrayLayer</code> <strong>must</strong> be less than the
<a href="resources.html#VkImageViewCreateInfo" class="xref page">VkImageViewCreateInfo</a>::<code>subresourceRange.layerCount</code> specified
when the image view <code>imageViewBinding</code> was created</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/structs/VkVideoPictureResourceInfoKHR.adoc[]</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dpb"><a class="anchor" href="#dpb"></a>Decoded Picture Buffer</h2>
<div class="sectionbody">
<div id="reconstructed-picture" class="paragraph">
<p>An integral part of video coding pipelines is the reconstruction of pictures
from a compressed video bitstream.
A <em>reconstructed picture</em> is a <a href="#video-picture-resources">video picture resource</a> resulting from this process.</p>
</div>
<div id="reference-picture" class="paragraph">
<p>Such reconstructed pictures <strong>can</strong> be used as <em>reference pictures</em> in
subsequent video coding operations to provide predictions of the values of
samples of subsequently decoded or encoded pictures.
The correct use of such reconstructed pictures as reference pictures is
driven by the video compression standard, the implementation, and the
application-specific use cases.</p>
</div>
<div id="active-reference-pictures" class="paragraph">
<p>The list of reference pictures used to provide such predictions within a
single video coding operation is referred to as the list of <em>active
reference pictures</em>.</p>
</div>
<div class="paragraph">
<p>The <em>decoded picture buffer (DPB)</em> is an indexed data structure that
maintains the set of reference pictures available to be used in video coding
operations.
<a id="dpb-slot"></a> Individual indexed entries of the DPB are referred to as the
<em>decoded picture buffer (DPB) slots</em>.
<a id="dpb-capacity"></a> The range of valid DPB slot indices is between zero and
<code>N-1</code>, where <code>N</code> is the capacity of the DPB.
Each DPB slot <strong>can</strong> refer to a reference picture containing a <em>video frame</em>
.</p>
</div>
<div id="dpb-state-and-backing-store" class="paragraph">
<p>In Vulkan, the state and the backing store of the DPB is separated as
follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The state of individual DPB slots is maintained by <a href="#video-session">video    session</a> objects.</p>
</li>
<li>
<p>The backing store of DPB slots is provided by subregions of
<a href="resources.html#VkImage" class="xref page">VkImage</a> objects used as <a href="#video-picture-resources">video picture    resources</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, the implementation <strong>may</strong> also maintain opaque metadata
associated with DPB slots, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="reference-metadata"></a> <em>Reference picture metadata</em> corresponding to the
video picture resource associated with the DPB slot.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Such metadata <strong>may</strong> be stored by the implementation as part of the DPB slot
state maintained by the video session, or as part of the video picture
resource backing the DPB slot.</p>
</div>
<div class="paragraph">
<p>Any metadata stored in the video picture resources backing DPB slots are
independent of the video session used to store it, hence such video picture
resources <strong>can</strong> be shared with other video sessions.
Correspondingly, any metadata that is dependent on the video session will
always be stored as part of the DPB slot state maintained by that video
session.</p>
</div>
<div class="paragraph">
<p>The responsibility of managing the DPB is split between the application and
the implementation as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The application maintains the association between <a href="#dpb-slot">DPB slot</a>
indices and corresponding <a href="#video-picture-resources">video picture    resources</a>.</p>
</li>
<li>
<p>The implementation maintains global and per-slot opaque
<a href="#reference-metadata">reference picture metadata</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, the application is also responsible for managing the mapping
between the codec-specific picture IDs and DPB slots, and any other
codec-specific states unless otherwise specified.</p>
</div>
<div class="sect2">
<h3 id="dpb-slot-states"><a class="anchor" href="#dpb-slot-states"></a>DPB Slot States</h3>
<div class="paragraph">
<p>At a given time, each DPB slot is either in <em>active</em> or <em>inactive</em> state.
Initially, all DPB slots managed by a <a href="#video-session">video session</a> are in
<em>inactive</em> state.</p>
</div>
<div class="paragraph">
<p>A DPB slot <strong>can</strong> be <em>activated</em> by using it as the target of picture
reconstruction in a video coding operation with the reconstructed picture
requested to be set up as a reference picture, according to the
codec-specific semantics, changing its state to <em>active</em> and associating it
with a <em>picture reference</em> to the <a href="#reconstructed-picture">reconstructed pictures</a>.</p>
</div>
<div class="paragraph">
<p>Some video coding standards allow multiple picture references to be
associated with a single DPB slot.
In this case the state of the individual picture references <strong>can</strong> be
independently updated.</p>
</div>
<div class="paragraph">
<p>As part of reference picture setup, the implementation <strong>may</strong> also generate
<a href="#reference-metadata">reference picture metadata</a>.
Such reference picture metadata is specific to each picture reference
associated with the DPB slot.</p>
</div>
<div class="paragraph">
<p>If such a video coding operation completes successfully, the activated DPB
slot will have a <em>valid picture reference</em> and the <a href="#reconstructed-picture">reconstructed picture</a> is associated with the DPB slot.
However, if any data provided as input to such a video coding operation is
not compliant with the video compression standard used, that video coding
operation <strong>may</strong> complete unsuccessfully, in which case the activated DPB slot
will have an <em>invalid picture reference</em>.</p>
</div>
<div class="paragraph">
<p>The application <strong>can</strong> use <a href="queries.html#queries" class="xref page">queries</a> to get feedback about the
outcome of video coding operations and use the resulting
<code>VkQueryResultStatusKHR</code> value to determine whether the video coding
operation completed successfully (result status is positive) or
unsuccessfully (result status is negative).</p>
</div>
<div class="paragraph">
<p>Using a <a href="#reference-picture">reference picture</a> associated with a DPB slot
that has an <em>invalid picture reference</em> as an <a href="#active-reference-pictures">active reference picture</a> in subsequent video coding operations is legal,
however, the contents of the outputs of such operations are <strong>undefined</strong>, and
any DPB slots activated by such video coding operations will also have an
<em>invalid picture reference</em>.
This is true even if such video coding operations <strong>may</strong> otherwise complete
successfully.</p>
</div>
<div class="paragraph">
<p>A DPB slot <strong>can</strong> also be <em>deactivated</em> by the application, changing its state
to <em>inactive</em> and invalidating any picture references and
<a href="#reference-metadata">reference picture metadata</a> associated with the DPB
slot.</p>
</div>
<div class="paragraph">
<p>If an already active DPB slot is used as the target of picture
reconstruction in a video coding operation, but the decoded picture is not
requested to be set up as a reference picture, according to the
codec-specific semantics, no reference picture setup happens and the
corresponding picture reference and <a href="#reference-metadata">reference picture metadata</a> is invalidated within the DPB slot.
If the DPB slot no longer has any associated picture references after such
an operation, the DPB slot is implicitly deactivated.</p>
</div>
<div class="paragraph">
<p>A DPB slot <strong>can</strong> be activated with a new frame even if it is already active.
In this case all previous associations of the DPB slots with
<a href="#reference-picture">reference pictures</a> are replaced with an association
with the <a href="#reconstructed-picture">reconstructed picture</a> used to activate
it.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="video-profiles"><a class="anchor" href="#video-profiles"></a>Video Profiles</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoProfileInfoKHR</code> structure is defined as follows:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/structs/VkVideoProfileInfoKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>videoCodecOperation</code> is a <code>VkVideoCodecOperationFlagBitsKHR</code>
value specifying a video codec operation.</p>
</li>
<li>
<p><code>chromaSubsampling</code> is a bitmask of
<code>VkVideoChromaSubsamplingFlagBitsKHR</code> specifying video chroma
subsampling information.</p>
</li>
<li>
<p><code>lumaBitDepth</code> is a bitmask of
<code>VkVideoComponentBitDepthFlagBitsKHR</code> specifying video luma bit
depth information.</p>
</li>
<li>
<p><code>chromaBitDepth</code> is a bitmask of
<code>VkVideoComponentBitDepthFlagBitsKHR</code> specifying video chroma bit
depth information.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Video profiles are provided as input to video capability queries such as
<code>vkGetPhysicalDeviceVideoCapabilitiesKHR</code> or
<code>vkGetPhysicalDeviceVideoFormatPropertiesKHR</code>, as well as when creating
resources to be used by video coding operations such as images, buffers,
query pools, and video sessions.</p>
</div>
<div class="paragraph">
<p>The full description of a video profile is specified by an instance of this
structure, and the codec-specific and auxiliary structures provided in its
<code>pNext</code> chain.</p>
</div>
<div id="video-profile-error-codes" class="paragraph">
<p>When this structure is specified as an input parameter to
<code>vkGetPhysicalDeviceVideoCapabilitiesKHR</code>, or through the
<code>pProfiles</code> member of a <code>VkVideoProfileListInfoKHR</code> structure in the
<code>pNext</code> chain of the input parameter of a query command such as
<code>vkGetPhysicalDeviceVideoFormatPropertiesKHR</code> or
<a href="capabilities.html#vkGetPhysicalDeviceImageFormatProperties2" class="xref page">vkGetPhysicalDeviceImageFormatProperties2</a>, the following error codes
indicate specific causes of the failure of the query operation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_VIDEO_PICTURE_LAYOUT_NOT_SUPPORTED_KHR</code> indicates that the
requested video picture layout
is not supported.</p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_OPERATION_NOT_SUPPORTED_KHR</code> indicates that
a video profile operation specified by <code>videoCodecOperation</code> is not
supported.</p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_FORMAT_NOT_SUPPORTED_KHR</code> indicates that
video format parameters specified by <code>chromaSubsampling</code>,
<code>lumaBitDepth</code>, or <code>chromaBitDepth</code> are not supported.</p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_CODEC_NOT_SUPPORTED_KHR</code> indicates that the
codec-specific parameters corresponding to the video codec operation are
not supported.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-chromaSubsampling-07013" href="#VUID-VkVideoProfileInfoKHR-chromaSubsampling-07013"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-chromaSubsampling-07013</span><br>

<code>chromaSubsampling</code> <strong>must</strong> have a single bit set</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-lumaBitDepth-07014" href="#VUID-VkVideoProfileInfoKHR-lumaBitDepth-07014"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-lumaBitDepth-07014</span><br>

<code>lumaBitDepth</code> <strong>must</strong> have a single bit set</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-chromaSubsampling-07015" href="#VUID-VkVideoProfileInfoKHR-chromaSubsampling-07015"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-chromaSubsampling-07015</span><br>

If <code>chromaSubsampling</code> is not
<code>VK_VIDEO_CHROMA_SUBSAMPLING_MONOCHROME_BIT_KHR</code>, then
<code>chromaBitDepth</code> <strong>must</strong> have a single bit set</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/structs/VkVideoProfileInfoKHR.adoc[]</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <code>VkVideoProfileInfoKHR</code>::<code>videoCodecOperation</code>,
specifying the type of video coding operation and video compression standard
used by a video profile, are:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/enums/VkVideoCodecOperationFlagBitsKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_CODEC_OPERATION_NONE_KHR</code> indicates no support for any
video codec operations.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/flags/VkVideoCodecOperationFlagsKHR.adoc[]</p>
</div>
<div class="paragraph">
<p><code>VkVideoCodecOperationFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <code>VkVideoCodecOperationFlagBitsKHR</code>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The video format chroma subsampling is defined with the following enums:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/enums/VkVideoChromaSubsamplingFlagBitsKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_CHROMA_SUBSAMPLING_MONOCHROME_BIT_KHR</code> specifies that the
format is monochrome.</p>
</li>
<li>
<p><code>VK_VIDEO_CHROMA_SUBSAMPLING_420_BIT_KHR</code> specified that the format
is 4:2:0 chroma subsampled, i.e. the two chroma components are sampled
horizontally and vertically at half the sample rate of the luma
component.</p>
</li>
<li>
<p><code>VK_VIDEO_CHROMA_SUBSAMPLING_422_BIT_KHR</code> - the format is 4:2:2
chroma subsampled, i.e. the two chroma components are sampled
horizontally at half the sample rate of luma component.</p>
</li>
<li>
<p><code>VK_VIDEO_CHROMA_SUBSAMPLING_444_BIT_KHR</code> - the format is 4:4:4
chroma sampled, i.e. all three components of the Y′C<sub>B</sub>C<sub>R</sub> format are
sampled at the same rate, thus there is no chroma subsampling.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Chroma subsampling is described in more detail in the
<a href="textures.html#textures-chroma-reconstruction" class="xref page">Chroma Reconstruction</a> section.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/flags/VkVideoChromaSubsamplingFlagsKHR.adoc[]</p>
</div>
<div class="paragraph">
<p><code>VkVideoChromaSubsamplingFlagsKHR</code> is a bitmask type for setting a mask
of zero or more <code>VkVideoChromaSubsamplingFlagBitsKHR</code>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values for the video format component bit depth are:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/enums/VkVideoComponentBitDepthFlagBitsKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_COMPONENT_BIT_DEPTH_8_BIT_KHR</code> specifies a component bit
depth of 8 bits.</p>
</li>
<li>
<p><code>VK_VIDEO_COMPONENT_BIT_DEPTH_10_BIT_KHR</code> specifies a component bit
depth of 10 bits.</p>
</li>
<li>
<p><code>VK_VIDEO_COMPONENT_BIT_DEPTH_12_BIT_KHR</code> specifies a component bit
depth of 12 bits.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/flags/VkVideoComponentBitDepthFlagsKHR.adoc[]</p>
</div>
<div class="paragraph">
<p><code>VkVideoComponentBitDepthFlagsKHR</code> is a bitmask type for setting a mask
of zero or more <code>VkVideoComponentBitDepthFlagBitsKHR</code>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoProfileListInfoKHR</code> structure is defined as:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/structs/VkVideoProfileListInfoKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>profileCount</code> is the number of elements in the <code>pProfiles</code>
array.</p>
</li>
<li>
<p><code>pProfiles</code> is a pointer to an array of <code>VkVideoProfileInfoKHR</code>
structures.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Video transcoding is an example of a use case that necessitates the
specification of multiple profiles in various contexts.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When the application provides a video decode profile and one or more video
encode profiles in the profile list, the implementation ensures that any
capabilitities returned or resources created are suitable for the video
transcoding use cases without the need for manual data transformations.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoProfileListInfoKHR-pProfiles-06813" href="#VUID-VkVideoProfileListInfoKHR-pProfiles-06813"></a> <span class="vuid">VUID-VkVideoProfileListInfoKHR-pProfiles-06813</span><br>

<code>pProfiles</code> <strong>must</strong> not contain more than one element whose
<code>videoCodecOperation</code> member specifies a decode operation</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/structs/VkVideoProfileListInfoKHR.adoc[]</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="video-capabilities"><a class="anchor" href="#video-capabilities"></a>Video Capabilities</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="video-coding-capabilities"><a class="anchor" href="#video-coding-capabilities"></a>Video Coding Capabilities</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query video coding capabilities for a specific video profile, call:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/protos/vkGetPhysicalDeviceVideoCapabilitiesKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>physicalDevice</code> is the physical device from which to query the
video decode or encode capabilities.</p>
</li>
<li>
<p><code>pVideoProfile</code> is a pointer to a <code>VkVideoProfileInfoKHR</code>
structure.</p>
</li>
<li>
<p><code>pCapabilities</code> is a pointer to a <code>VkVideoCapabilitiesKHR</code>
structure in which the capabilities are returned.</p>
</li>
</ul>
</div>
<div id="video-profile-support" class="paragraph">
<p>If the <a href="#video-profiles">video profile</a> described by <code>pVideoProfile</code> is
supported by the implementation, then this command returns <code>VK_SUCCESS</code>
and <code>pCapabilities</code> is filled with the capabilities supported with the
specified video profile.
Otherwise, one of the <a href="#video-profile-error-codes">video-profile-specific error codes</a> are returned.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>

</div>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/protos/vkGetPhysicalDeviceVideoCapabilitiesKHR.adoc[]</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoCapabilitiesKHR</code> structure is defined as:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/structs/VkVideoCapabilitiesKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <code>VkVideoCapabilityFlagBitsKHR</code>
specifying capability flags.</p>
</li>
<li>
<p><code>minBitstreamBufferOffsetAlignment</code> is the minimum alignment for
bitstream buffer offsets.</p>
</li>
<li>
<p><code>minBitstreamBufferSizeAlignment</code> is the minimum alignment for
bitstream buffer range sizes.</p>
</li>
<li>
<p><code>pictureAccessGranularity</code> is the granularity at which image access
to video picture resources happen.</p>
</li>
<li>
<p><code>minCodedExtent</code> is the minimum width and height of the coded
frames.</p>
</li>
<li>
<p><code>maxCodedExtent</code> is the maximum width and height of the coded
frames.</p>
</li>
<li>
<p><code>maxDpbSlots</code> is the maximum number of <a href="#dpb-slot">DPB slots</a>
supported by a single video session.</p>
</li>
<li>
<p><code>maxActiveReferencePictures</code> is the maximum number of
<a href="#active-reference-pictures">active reference pictures</a> a single video
coding operation <strong>can</strong> use.</p>
</li>
<li>
<p><a id="video-std-header-version"></a> <code>stdHeaderVersion</code> is a
<a href="extensions.html#VkExtensionProperties" class="xref page">VkExtensionProperties</a> structure reporting the Video Std header
name and version supported for the video profile.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/structs/VkVideoCapabilitiesKHR.adoc[]</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in <code>VkVideoCapabilitiesKHR</code>::<code>flags</code> are:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/enums/VkVideoCapabilityFlagBitsKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_CAPABILITY_PROTECTED_CONTENT_BIT_KHR</code> indicates that video
sessions support producing and consuming protected content.</p>
</li>
<li>
<p><a id="separate-reference-images"></a>
<code>VK_VIDEO_CAPABILITY_SEPARATE_REFERENCE_IMAGES_BIT_KHR</code> indicates
that the <a href="#video-picture-resources">video picture resources</a> associated
with the <a href="#dpb-slot">DPB slots</a> of a video session <strong>can</strong> be backed by
separate <code>VkImage</code> objects.
If this capability flag is not present, then all DPB slots of a video
session <strong>must</strong> be associated with video picture resources backed by the
same <code>VkImage</code> object (e.g. using different layers of the same
image).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/flags/VkVideoCapabilityFlagsKHR.adoc[]</p>
</div>
<div class="paragraph">
<p><code>VkVideoCapabilityFlagsKHR</code> is a bitmask type for setting a mask of zero
or more <code>VkVideoCapabilityFlagBitsKHR</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="video-format-capabilities"><a class="anchor" href="#video-format-capabilities"></a>Video Format Capabilities</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To enumerate the supported output, input and DPB image formats and
corresponding capabilities for a specific video profile, call:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/protos/vkGetPhysicalDeviceVideoFormatPropertiesKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>physicalDevice</code> is the physical device from which to query the
video format properties.</p>
</li>
<li>
<p><code>pVideoFormatInfo</code> is a pointer to a
<code>VkPhysicalDeviceVideoFormatInfoKHR</code> structure specifying the usage
and video profiles for which supported image formats and capabilities
are returned.</p>
</li>
<li>
<p><code>pVideoFormatPropertyCount</code> is a pointer to an integer related to
the number of video format properties available or queried, as described
below.</p>
</li>
<li>
<p><code>pVideoFormatProperties</code> is a pointer to an array of
<code>VkVideoFormatPropertiesKHR</code> structures in which supported image
formats and capabilities are returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>pVideoFormatProperties</code> is <code>NULL</code>, then the number of video format
properties supported for the given <code>physicalDevice</code> is returned in
<code>pVideoFormatPropertyCount</code>.
Otherwise, <code>pVideoFormatPropertyCount</code> <strong>must</strong> point to a variable set by
the application to the number of elements in the
<code>pVideoFormatProperties</code> array, and on return the variable is
overwritten with the number of values actually written to
<code>pVideoFormatProperties</code>.
If the value of <code>pVideoFormatPropertyCount</code> is less than the number of
video format properties supported, at most <code>pVideoFormatPropertyCount</code>
values will be written to <code>pVideoFormatProperties</code>, and
<code>VK_INCOMPLETE</code> will be returned instead of <code>VK_SUCCESS</code>, to
indicate that not all the available values were returned.</p>
</div>
<div class="paragraph">
<p>Video format properties are always queried with respect to a specific set of
video profiles.
These are specified by chaining the <code>VkVideoProfileListInfoKHR</code>
structure to <code>pVideoFormatInfo</code>.</p>
</div>
<div class="paragraph">
<p>For most use cases, the images are used by a single video session and a
single video profile is provided.
For a use case such as video transcoding, where a decode session output
image <strong>can</strong> be used as encode input in one or more encode sessions, multiple
video profiles corresponding to the video sessions that will share the image
<strong>must</strong> be provided.</p>
</div>
<div class="paragraph">
<p>If any of the <a href="#video-profiles">video profiles</a> specified via
<code>VkVideoProfileListInfoKHR</code>::<code>pProfiles</code> are not supported, then
this command returns one of the <a href="#video-profile-error-codes">video-profile-specific error codes</a>.
Furthermore, if <code>VkPhysicalDeviceVideoFormatInfoKHR</code>::<code>imageUsage</code>
includes any image usage flags not supported by the specified video
profiles, then this command returns
<code>VK_ERROR_IMAGE_USAGE_NOT_SUPPORTED_KHR</code>.</p>
</div>
<div class="paragraph">
<p>The <code>imageUsage</code> member of the <code>VkPhysicalDeviceVideoFormatInfoKHR</code>
structure specifies the expected video usage flags that the returned video
formats <strong>must</strong> support.
Correspondingly, the <code>imageUsageFlags</code> member of each
<code>VkVideoFormatPropertiesKHR</code> structure returned will contain at least
the same set of image usage flags.</p>
</div>
<div class="paragraph">
<p>If the implementation supports using video input, output, or DPB images of a
particular format in operations other than video decode/encode then the
<code>imageUsageFlags</code> member of the corresponding
<code>VkVideoFormatPropertiesKHR</code> structure returned will include additional
image usage flags indicating that.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For most use cases, only decode or encode related usage flags are going to
be specified.
For a use case such as transcode, if the image were to be shared between
decode and encode session(s), then both decode and encode related usage
flags <strong>can</strong> be set.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Multiple <code>VkVideoFormatPropertiesKHR</code> entries <strong>may</strong> be returned with the
same <code>format</code> member with different <code>componentMapping</code>,
<code>imageType</code>, or <code>imageTiling</code> values, as described later.</p>
</div>
<div class="paragraph">
<p>In addition, a different set of <code>VkVideoFormatPropertiesKHR</code> entries
<strong>may</strong> be returned depending on the <code>imageUsage</code> member of the
<code>VkPhysicalDeviceVideoFormatInfoKHR</code> structure, even for the same set of
video profiles, for example, based on whether encode input, encode DPB,
decode output, and/or decode DPB usage is requested.</p>
</div>
<div class="paragraph">
<p>The application <strong>can</strong> select the parameters returned in the
<code>VkVideoFormatPropertiesKHR</code> entries and use compatible parameters when
creating the input, output, and DPB images.
The implementation will report all image creation and usage flags that are
valid for images used with the requested video profiles but applications
<strong>should</strong> create images only with those that are necessary for the particular
use case.</p>
</div>
<div class="paragraph">
<p>Before creating an image, the application <strong>can</strong> obtain the complete set of
supported image format features by calling
<a href="capabilities.html#vkGetPhysicalDeviceImageFormatProperties2" class="xref page">vkGetPhysicalDeviceImageFormatProperties2</a> using parameters derived
from the members of one of the reported <code>VkVideoFormatPropertiesKHR</code>
entries and adding the same <code>VkVideoProfileListInfoKHR</code> structure to the
<code>pNext</code> chain of <a href="capabilities.html#VkPhysicalDeviceImageFormatInfo2" class="xref page">VkPhysicalDeviceImageFormatInfo2</a>.</p>
</div>
<div class="paragraph">
<p>The following applies to all <code>VkVideoFormatPropertiesKHR</code> entries
returned by <code>vkGetPhysicalDeviceVideoFormatPropertiesKHR</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="formats.html#vkGetPhysicalDeviceFormatProperties2" class="xref page">vkGetPhysicalDeviceFormatProperties2</a> <strong>must</strong> succeed when called
with <code>VkVideoFormatPropertiesKHR</code>::<code>format</code></p>
</li>
<li>
<p>If <code>VkVideoFormatPropertiesKHR</code>::<code>imageTiling</code> is
<code>VK_IMAGE_TILING_OPTIMAL</code>, then the <code>optimalTilingFeatures</code>
returned by <a href="formats.html#vkGetPhysicalDeviceFormatProperties2" class="xref page">vkGetPhysicalDeviceFormatProperties2</a> <strong>must</strong> include all
format features required by the image usage flags reported in
<code>VkVideoFormatPropertiesKHR</code>::<code>imageUsageFlags</code> for the format,
as indicated in the <a href="formats.html#format-feature-dependent-usage-flags" class="xref page">Format    Feature Dependent Usage Flags</a> section.</p>
</li>
<li>
<p>If <code>VkVideoFormatPropertiesKHR</code>::<code>imageTiling</code> is
<code>VK_IMAGE_TILING_LINEAR</code>, then the <code>linearTilingFeatures</code>
returned by <a href="formats.html#vkGetPhysicalDeviceFormatProperties2" class="xref page">vkGetPhysicalDeviceFormatProperties2</a> <strong>must</strong> include all
format features required by the image usage flags reported in
<code>VkVideoFormatPropertiesKHR</code>::<code>imageUsageFlags</code> for the format,
as indicated in the <a href="formats.html#format-feature-dependent-usage-flags" class="xref page">Format    Feature Dependent Usage Flags</a> section.</p>
</li>
<li>
<p><a href="capabilities.html#vkGetPhysicalDeviceImageFormatProperties2" class="xref page">vkGetPhysicalDeviceImageFormatProperties2</a> <strong>must</strong> succeed when
called with a <a href="capabilities.html#VkPhysicalDeviceImageFormatInfo2" class="xref page">VkPhysicalDeviceImageFormatInfo2</a> structure
containing the following information:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>pNext</code> chain including the same
<code>VkVideoProfileListInfoKHR</code> structure used to call
<code>vkGetPhysicalDeviceVideoFormatPropertiesKHR</code>.</p>
</li>
<li>
<p><code>format</code> set to the value of
<code>VkVideoFormatPropertiesKHR</code>::<code>format</code>.</p>
</li>
<li>
<p><code>type</code> set to the value of
<code>VkVideoFormatPropertiesKHR</code>::<code>imageType</code>.</p>
</li>
<li>
<p><code>tiling</code> set to the value of
<code>VkVideoFormatPropertiesKHR</code>::<code>imageTiling</code>.</p>
</li>
<li>
<p><code>usage</code> set to the value of
<code>VkVideoFormatPropertiesKHR</code>::<code>imageUsageFlags</code>.</p>
</li>
<li>
<p><code>flags</code> set to the value of
<code>VkVideoFormatPropertiesKHR</code>::<code>imageCreateFlags</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>componentMapping</code> member of <code>VkVideoFormatPropertiesKHR</code>
defines the ordering of the Y′C<sub>B</sub>C<sub>R</sub> color channels from the perspective of
the video codec operations specified in <code>VkVideoProfileListInfoKHR</code>.
For example, if the implementation produces video decode output with the
format <code>VK_FORMAT_G8_B8R8_2PLANE_420_UNORM</code> where the blue and red
chrominance channels are swapped then the <code>componentMapping</code> member of
the corresponding <code>VkVideoFormatPropertiesKHR</code> structure will have the
following member values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">components.r = VK_COMPONENT_SWIZZLE_B;        // Cb component
components.g = VK_COMPONENT_SWIZZLE_IDENTITY; // Y component
components.b = VK_COMPONENT_SWIZZLE_R;        // Cr component
components.a = VK_COMPONENT_SWIZZLE_IDENTITY; // unused, defaults to 1.0</code></pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pNext-06812" href="#VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pNext-06812"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pNext-06812</span><br>

The <code>pNext</code> chain of <code>pVideoFormatInfo</code> <strong>must</strong> include a
<code>VkVideoProfileListInfoKHR</code> structure with <code>profileCount</code>
greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/protos/vkGetPhysicalDeviceVideoFormatPropertiesKHR.adoc[]</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPhysicalDeviceVideoFormatInfoKHR</code> structure is defined as:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/structs/VkPhysicalDeviceVideoFormatInfoKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>imageUsage</code> is a bitmask of <a href="resources.html#VkImageUsageFlagBits" class="xref page">VkImageUsageFlagBits</a> specifying
the intended usage of the video images.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/structs/VkPhysicalDeviceVideoFormatInfoKHR.adoc[]</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoFormatPropertiesKHR</code> structure is defined as:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/structs/VkVideoFormatPropertiesKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>format</code> is a <a href="formats.html#VkFormat" class="xref page">VkFormat</a> that specifies the format that <strong>can</strong> be
used with the specified video profiles and image usages.</p>
</li>
<li>
<p><code>componentMapping</code> defines the color channel order used for the
format.
<code>format</code> along with <code>componentMapping</code> describe how the color
channels are ordered when producing video decoder output or are expected
to be ordered in video encoder input, when applicable.
If the <code>format</code> reported does not require component swizzling then
all members of <code>componentMapping</code> will be set to
<code>VK_COMPONENT_SWIZZLE_IDENTITY</code>.</p>
</li>
<li>
<p><code>imageCreateFlags</code> is a bitmask of <a href="resources.html#VkImageCreateFlagBits" class="xref page">VkImageCreateFlagBits</a>
specifying the supported image creation flags for the format.</p>
</li>
<li>
<p><code>imageType</code> is a <a href="resources.html#VkImageType" class="xref page">VkImageType</a> that specifies the image type the
format <strong>can</strong> be used with.</p>
</li>
<li>
<p><code>imageTiling</code> is a <a href="resources.html#VkImageTiling" class="xref page">VkImageTiling</a> that specifies the image
tiling the format <strong>can</strong> be used with.</p>
</li>
<li>
<p><code>imageUsageFlags</code> is a bitmask of <a href="resources.html#VkImageUsageFlagBits" class="xref page">VkImageUsageFlagBits</a>
specifying the supported image usage flags for the format.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/structs/VkVideoFormatPropertiesKHR.adoc[]</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="video-session"><a class="anchor" href="#video-session"></a>Video Sessions</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Video sessions are objects that represent and maintain the state needed to
perform video decode or encode operations using a specific video profile.</p>
</div>
<div class="paragraph">
<p>Video sessions are represented by <code>VkVideoSessionKHR</code> handles:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/handles/VkVideoSessionKHR.adoc[]</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="video-session-creation"><a class="anchor" href="#video-session-creation"></a>Creating a Video Session</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a video session object, call:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/protos/vkCreateVideoSessionKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the video session.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to a <code>VkVideoSessionCreateInfoKHR</code>
structure containing parameters to be used to create the video session.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="memory.html#memory-allocation" class="xref page">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pVideoSession</code> is a pointer to a <code>VkVideoSessionKHR</code> handle in
which the resulting video session object is returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The resulting video session object is said to be created with the video
codec operation specified in
<code>pCreateInfo-&gt;pVideoProfile&#8594;videoCodecOperation</code>.</p>
</div>
<div class="paragraph">
<p>The name and version of the codec-specific Video Std header to be used with
the video session is specified by the <a href="extensions.html#VkExtensionProperties" class="xref page">VkExtensionProperties</a> structure
pointed to by <code>pCreateInfo-&gt;pStdHeaderVersion</code>.
If a non-existent or unsupported Video Std header version is specified in
<code>pCreateInfo-&gt;pStdHeaderVersion&#8594;specVersion</code>, then this command returns
<code>VK_ERROR_VIDEO_STD_VERSION_NOT_SUPPORTED_KHR</code>.</p>
</div>
<div id="video-session-uninitialized" class="paragraph">
<p>Video session objects are created in <em>uninitialized</em> state.
In order to transition the video session into <em>initial</em> state, the
application <strong>must</strong> issue a <code>vkCmdControlVideoCodingKHR</code> command with
<code>VkVideoCodingControlInfoKHR</code>::<code>flags</code> including
<code>VK_VIDEO_CODING_CONTROL_RESET_BIT_KHR</code>.</p>
</div>
<div class="paragraph">
<p>Video session objects also maintain the
<a href="#dpb-state-and-backing-store">state</a> of the DPB.
The number of DPB slots usable with the created video session is specified
in <code>pCreateInfo-&gt;maxDpbSlots</code>, and each slot is initially in the
<a href="#dpb-slot-states">inactive state</a>.</p>
</div>
<div class="paragraph">
<p>Each <a href="#dpb-slot">DPB slot</a> maintained by the created video session <strong>can</strong>
refer to a <a href="#reference-picture">reference picture</a> representing a video
frame.</p>
</div>
<div class="paragraph">
<p>The created video session <strong>can</strong> be used to perform video coding operations
using video frames up to the maximum size specified in
<code>pCreateInfo-&gt;maxCodedExtent</code>.
The minimum frame size allowed is implicitly derived from
<code>VkVideoCapabilitiesKHR</code>::<code>minCodedExtent</code>, as returned by
<code>vkGetPhysicalDeviceVideoCapabilitiesKHR</code> for the video profile
specified by <code>pCreateInfo-&gt;pVideoProfile</code>.
Accordingly, the created video session is said to be created with a
<code>minCodedExtent</code> equal to that.</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/protos/vkCreateVideoSessionKHR.adoc[]</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoSessionCreateInfoKHR</code> structure is defined as:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/structs/VkVideoSessionCreateInfoKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>queueFamilyIndex</code> is the index of the queue family the created
video session will be used with.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <code>VkVideoSessionCreateFlagBitsKHR</code>
specifying creation flags.</p>
</li>
<li>
<p><code>pVideoProfile</code> is a pointer to a <code>VkVideoProfileInfoKHR</code>
structure specifying the video profile the created video session will be
used with.</p>
</li>
<li>
<p><code>pictureFormat</code> is the image format the created video session will
be used with.</p>
</li>
<li>
<p><code>maxCodedExtent</code> is the maximum width and height of the coded frames
the created video session will be used with.</p>
</li>
<li>
<p><code>referencePictureFormat</code> is the image format of
<a href="#reference-picture">reference pictures</a> stored in the <a href="#dpb">DPB</a> the
created video session will be used with.</p>
</li>
<li>
<p><code>maxDpbSlots</code> is the maximum number of <a href="#dpb-slot">DPB Slots</a> that
<strong>can</strong> be used with the created video session.</p>
</li>
<li>
<p><code>maxActiveReferencePictures</code> is the maximum number of
<a href="#active-reference-pictures">active reference pictures</a> that <strong>can</strong> be
used in a single video coding operation using the created video session.</p>
</li>
<li>
<p><code>pStdHeaderVersion</code> is a pointer to a <a href="extensions.html#VkExtensionProperties" class="xref page">VkExtensionProperties</a>
structure requesting the Video Std header version to use for the
<code>videoCodecOperation</code> specified in <code>pVideoProfile</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-protectedMemory-07189" href="#VUID-VkVideoSessionCreateInfoKHR-protectedMemory-07189"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-protectedMemory-07189</span><br>

If the <a href="features.html#features-protectedMemory" class="xref page"><code>protectedMemory</code></a> feature is
not enabled or if <code>VkVideoCapabilitiesKHR</code>::<code>flags</code> does not
include <code>VK_VIDEO_CAPABILITY_PROTECTED_CONTENT_BIT_KHR</code>, as returned
by <code>vkGetPhysicalDeviceVideoCapabilitiesKHR</code> for the video profile
specified by <code>pVideoProfile</code>, then <code>flags</code> <strong>must</strong> not include
<code>VK_VIDEO_SESSION_CREATE_PROTECTED_CONTENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-04845" href="#VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-04845"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-04845</span><br>

<code>pVideoProfile</code> <strong>must</strong> be a <a href="#video-profile-support">supported video    profile</a></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-maxDpbSlots-04847" href="#VUID-VkVideoSessionCreateInfoKHR-maxDpbSlots-04847"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-maxDpbSlots-04847</span><br>

<code>maxDpbSlots</code> <strong>must</strong> be less than or equal to
<code>VkVideoCapabilitiesKHR</code>::<code>maxDpbSlots</code>, as returned by
<code>vkGetPhysicalDeviceVideoCapabilitiesKHR</code> for the video profile
specified by <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-maxActiveReferencePictures-04849" href="#VUID-VkVideoSessionCreateInfoKHR-maxActiveReferencePictures-04849"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-maxActiveReferencePictures-04849</span><br>

<code>maxActiveReferencePictures</code> <strong>must</strong> be less than or equal to
<code>VkVideoCapabilitiesKHR</code>::<code>maxActiveReferencePictures</code>, as
returned by <code>vkGetPhysicalDeviceVideoCapabilitiesKHR</code> for the video
profile specified by <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-maxDpbSlots-04850" href="#VUID-VkVideoSessionCreateInfoKHR-maxDpbSlots-04850"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-maxDpbSlots-04850</span><br>

If either <code>maxDpbSlots</code> or <code>maxActiveReferencePictures</code> is <code>0</code>,
then both <strong>must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-maxCodedExtent-04851" href="#VUID-VkVideoSessionCreateInfoKHR-maxCodedExtent-04851"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-maxCodedExtent-04851</span><br>

<code>maxCodedExtent</code> <strong>must</strong> be between
<code>VkVideoCapabilitiesKHR</code>::<code>minCodedExtent</code> and
<code>VkVideoCapabilitiesKHR</code>::<code>maxCodedExtent</code>, inclusive, as
returned by <code>vkGetPhysicalDeviceVideoCapabilitiesKHR</code> for the video
profile specified by <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-07190" href="#VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-07190"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-07190</span><br>

<code>pStdHeaderVersion-&gt;extensionName</code> <strong>must</strong> match
<code>VkVideoCapabilitiesKHR</code>::<code>stdHeaderVersion.extensionName</code>, as
returned by <code>vkGetPhysicalDeviceVideoCapabilitiesKHR</code> for the video
profile specified by <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-07191" href="#VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-07191"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-07191</span><br>

<code>pStdHeaderVersion-&gt;specVersion</code> <strong>must</strong> be less than or equal to
<code>VkVideoCapabilitiesKHR</code>::<code>stdHeaderVersion.specVersion</code>, as
returned by <code>vkGetPhysicalDeviceVideoCapabilitiesKHR</code> for the video
profile specified by <code>pVideoProfile</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/structs/VkVideoSessionCreateInfoKHR.adoc[]</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in <code>VkVideoSessionCreateInfoKHR</code>::<code>flags</code>
are:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/enums/VkVideoSessionCreateFlagBitsKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_SESSION_CREATE_PROTECTED_CONTENT_BIT_KHR</code> specifies that
the video session uses protected video content.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/flags/VkVideoSessionCreateFlagsKHR.adoc[]</p>
</div>
<div class="paragraph">
<p><code>VkVideoSessionCreateFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <code>VkVideoSessionCreateFlagBitsKHR</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="video-session-destruction"><a class="anchor" href="#video-session-destruction"></a>Destroying a Video Session</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a video session, call:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/protos/vkDestroyVideoSessionKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the video session.</p>
</li>
<li>
<p><code>videoSession</code> is the video session to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="memory.html#memory-allocation" class="xref page">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyVideoSessionKHR-videoSession-07192" href="#VUID-vkDestroyVideoSessionKHR-videoSession-07192"></a> <span class="vuid">VUID-vkDestroyVideoSessionKHR-videoSession-07192</span><br>

All submitted commands that refer to <code>videoSession</code> <strong>must</strong> have
completed execution</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionKHR-videoSession-07193" href="#VUID-vkDestroyVideoSessionKHR-videoSession-07193"></a> <span class="vuid">VUID-vkDestroyVideoSessionKHR-videoSession-07193</span><br>

If <code>VkAllocationCallbacks</code> were provided when <code>videoSession</code> was
created, a compatible set of callbacks <strong>must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionKHR-videoSession-07194" href="#VUID-vkDestroyVideoSessionKHR-videoSession-07194"></a> <span class="vuid">VUID-vkDestroyVideoSessionKHR-videoSession-07194</span><br>

If no <code>VkAllocationCallbacks</code> were provided when <code>videoSession</code>
was created, <code>pAllocator</code> <strong>must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/protos/vkDestroyVideoSessionKHR.adoc[]</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="video-session-memory-association"><a class="anchor" href="#video-session-memory-association"></a>Video Session Memory Association</h3>
<div class="paragraph">
<p>After creating a video session object, and before the object <strong>can</strong> be used to
record video coding operations into command buffers using it, the
application <strong>must</strong> allocate and bind device memory to the video session.
Device memory is allocated separately (see <a href="memory.html#memory-device" class="xref page">Device Memory</a>) and then
associated with the video session.</p>
</div>
<div class="paragraph">
<p>Video sessions <strong>may</strong> have multiple memory bindings identified by unique
unsigned integer values.
Appropriate device memory <strong>must</strong> be bound to each such memory binding before
using the video session to record command buffer commands with it.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To determine the memory requirements for a video session object, call:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/protos/vkGetVideoSessionMemoryRequirementsKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the video session.</p>
</li>
<li>
<p><code>videoSession</code> is the video session to query.</p>
</li>
<li>
<p><code>pMemoryRequirementsCount</code> is a pointer to an integer related to the
number of memory binding requirements available or queried, as described
below.</p>
</li>
<li>
<p><code>pMemoryRequirements</code> is <code>NULL</code> or a pointer to an array of
<code>VkVideoSessionMemoryRequirementsKHR</code> structures in which the memory
binding requirements of the video session are returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>pMemoryRequirements</code> is <code>NULL</code>, then the number of memory bindings
required for the video session is returned in
<code>pMemoryRequirementsCount</code>.
Otherwise, <code>pMemoryRequirementsCount</code> <strong>must</strong> point to a variable set by
the application to the number of elements in the <code>pMemoryRequirements</code>
array, and on return the variable is overwritten with the number of memory
binding requirements actually written to <code>pMemoryRequirements</code>.
If <code>pMemoryRequirementsCount</code> is less than the number of memory bindings
required for the video session, then at most <code>pMemoryRequirementsCount</code>
elements will be written to <code>pMemoryRequirements</code>, and
<code>VK_INCOMPLETE</code> will be returned, instead of <code>VK_SUCCESS</code>, to
indicate that not all required memory binding requirements were returned.</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/protos/vkGetVideoSessionMemoryRequirementsKHR.adoc[]</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoSessionMemoryRequirementsKHR</code> structure is defined as:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/structs/VkVideoSessionMemoryRequirementsKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>memoryBindIndex</code> is the index of the memory binding.</p>
</li>
<li>
<p><code>memoryRequirements</code> is a <a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a> structure in
which the requested memory binding requirements for the binding index
specified by <code>memoryBindIndex</code> are returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/structs/VkVideoSessionMemoryRequirementsKHR.adoc[]</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To attach memory to a video session object, call:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/protos/vkBindVideoSessionMemoryKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the video session.</p>
</li>
<li>
<p><code>videoSession</code> is the video session to be bound with device memory.</p>
</li>
<li>
<p><code>bindSessionMemoryInfoCount</code> is the number of elements in
<code>pBindSessionMemoryInfos</code>.</p>
</li>
<li>
<p><code>pBindSessionMemoryInfos</code> is a pointer to an array of
<code>bindSessionMemoryInfoCount</code> <code>VkBindVideoSessionMemoryInfoKHR</code>
structures specifying memory regions to be bound to specific memory
bindings of the video session.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The valid usage statements below refer to the <a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a>
structure corresponding to a specific element of
<code>pBindSessionMemoryInfos</code>, which is defined as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the <code>memoryBindIndex</code> member of the element of
<code>pBindSessionMemoryInfos</code> in question matches the
<code>memoryBindIndex</code> member of one of the elements returned in
<code>pMemoryRequirements</code> when
<code>vkGetVideoSessionMemoryRequirementsKHR</code> is called with the same
<code>videoSession</code> and with <code>pMemoryRequirementsCount</code> equal to
<code>bindSessionMemoryInfoCount</code>, then the <code>memoryRequirements</code>
member of that element of <code>pMemoryRequirements</code> is the
<a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a> structure corresponding to the element of
<code>pBindSessionMemoryInfos</code> in question.</p>
</li>
<li>
<p>Otherwise the element of <code>pBindSessionMemoryInfos</code> in question is
said to not have a corresponding <a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a> structure.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-videoSession-07195" href="#VUID-vkBindVideoSessionMemoryKHR-videoSession-07195"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-videoSession-07195</span><br>

The memory binding of <code>videoSession</code> identified by the
<code>memoryBindIndex</code> member of any element of
<code>pBindSessionMemoryInfos</code> <strong>must</strong> not already be backed by a memory
object</p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-memoryBindIndex-07196" href="#VUID-vkBindVideoSessionMemoryKHR-memoryBindIndex-07196"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-memoryBindIndex-07196</span><br>

The <code>memoryBindIndex</code> member of each element of
<code>pBindSessionMemoryInfos</code> <strong>must</strong> be unique within
<code>pBindSessionMemoryInfos</code></p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07197" href="#VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07197"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07197</span><br>

Each element of <code>pBindSessionMemoryInfos</code> <strong>must</strong> have a corresponding
<a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a> structure</p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07198" href="#VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07198"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07198</span><br>

If an element of <code>pBindSessionMemoryInfos</code> has a corresponding
<a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a> structure, then the <code>memory</code> member of
that element of <code>pBindSessionMemoryInfos</code> <strong>must</strong> have been allocated
using one of the memory types allowed in the <code>memoryTypeBits</code> member
of the corresponding <a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a> structure</p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07199" href="#VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07199"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07199</span><br>

If an element of <code>pBindSessionMemoryInfos</code> has a corresponding
<a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a> structure, then the <code>memoryOffset</code> member
of that element of <code>pBindSessionMemoryInfos</code> <strong>must</strong> be an integer
multiple of the <code>alignment</code> member of the corresponding
<a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a> structure</p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07200" href="#VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07200"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07200</span><br>

If an element of <code>pBindSessionMemoryInfos</code> has a corresponding
<a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a> structure, then the <code>memorySize</code> member
of that element of <code>pBindSessionMemoryInfos</code> <strong>must</strong> equal the
<code>size</code> member of the corresponding <a href="resources.html#VkMemoryRequirements" class="xref page">VkMemoryRequirements</a>
structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/protos/vkBindVideoSessionMemoryKHR.adoc[]</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkBindVideoSessionMemoryInfoKHR</code> structure is defined as:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/structs/VkBindVideoSessionMemoryInfoKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>memoryBindIndex</code> is the memory binding index to bind memory to.</p>
</li>
<li>
<p><code>memory</code> is the allocated device memory to be bound to the video
session&#8217;s memory binding with index <code>memoryBindIndex</code>.</p>
</li>
<li>
<p><code>memoryOffset</code> is the start offset of the region of <code>memory</code>
which is to be bound.</p>
</li>
<li>
<p><code>memorySize</code> is the size in bytes of the region of <code>memory</code>,
starting from <code>memoryOffset</code> bytes, to be bound.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBindVideoSessionMemoryInfoKHR-memoryOffset-07201" href="#VUID-VkBindVideoSessionMemoryInfoKHR-memoryOffset-07201"></a> <span class="vuid">VUID-VkBindVideoSessionMemoryInfoKHR-memoryOffset-07201</span><br>

<code>memoryOffset</code> <strong>must</strong> be less than the size of <code>memory</code></p>
</li>
<li>
<p><a id="VUID-VkBindVideoSessionMemoryInfoKHR-memorySize-07202" href="#VUID-VkBindVideoSessionMemoryInfoKHR-memorySize-07202"></a> <span class="vuid">VUID-VkBindVideoSessionMemoryInfoKHR-memorySize-07202</span><br>

<code>memorySize</code> <strong>must</strong> be less than or equal to the size of <code>memory</code>
minus <code>memoryOffset</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/structs/VkBindVideoSessionMemoryInfoKHR.adoc[]</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="video-profile-compatibility"><a class="anchor" href="#video-profile-compatibility"></a>Video Profile Compatibility</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Resources and query pools used with a particular video session <strong>must</strong> be
compatible with the <a href="#video-profiles">video profile</a> the video session was
created with.</p>
</div>
<div class="paragraph">
<p>A <a href="resources.html#VkBuffer" class="xref page">VkBuffer</a> is compatible with a video profile if it was created with
the <a href="resources.html#VkBufferCreateInfo" class="xref page">VkBufferCreateInfo</a>::<code>pNext</code> chain including a
<code>VkVideoProfileListInfoKHR</code> structure with its <code>pProfiles</code> member
containing an element matching the <code>VkVideoProfileInfoKHR</code> structure
chain describing the video profile, and
<a href="resources.html#VkBufferCreateInfo" class="xref page">VkBufferCreateInfo</a>::<code>usage</code> including at least one bit specific to
video coding usage.</p>
</div>
<div class="paragraph">
<p>A <a href="resources.html#VkImage" class="xref page">VkImage</a> is compatible with a video profile if it was created with
the <a href="resources.html#VkImageCreateInfo" class="xref page">VkImageCreateInfo</a>::<code>pNext</code> chain including a
<code>VkVideoProfileListInfoKHR</code> structure with its <code>pProfiles</code> member
containing an element matching the <code>VkVideoProfileInfoKHR</code> structure
chain describing the video profile, and <a href="resources.html#VkImageCreateInfo" class="xref page">VkImageCreateInfo</a>::<code>usage</code>
including at least one bit specific to video coding usage.</p>
</div>
<div class="paragraph">
<p>A <a href="resources.html#VkImageView" class="xref page">VkImageView</a> is compatible with a video profile if the <a href="resources.html#VkImage" class="xref page">VkImage</a>
it was created from is also compatible with that video profile.</p>
</div>
<div class="paragraph">
<p>A <a href="queries.html#VkQueryPool" class="xref page">VkQueryPool</a> is compatible with a video profile if it was created
with the <a href="queries.html#VkQueryPoolCreateInfo" class="xref page">VkQueryPoolCreateInfo</a>::<code>pNext</code> chain including a
<code>VkVideoProfileInfoKHR</code> structure chain describing the same video
profile, and <a href="queries.html#VkQueryPoolCreateInfo" class="xref page">VkQueryPoolCreateInfo</a>::<code>queryType</code> having one of the
following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="video-session-parameters"><a class="anchor" href="#video-session-parameters"></a>Video Session Parameters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Video session parameters objects <strong>can</strong> store preprocessed codec-specific
parameters used with a compatible video session, and enable reducing the
number of parameters needed to be provided and processed by the
implementation while recording video coding operations into command buffers.</p>
</div>
<div class="paragraph">
<p>Parameters stored in such objects are <em>immutable</em> to facilitate the
concurrent use of the stored parameters in multiple threads.
At the same time, new parameters <strong>can</strong> be added to existing objects using the
<code>vkUpdateVideoSessionParametersKHR</code> command.</p>
</div>
<div class="paragraph">
<p>In order to support concurrent use of the stored immutable parameters while
also allowing the video session parameters object to be extended with new
parameters, each video session parameters object maintains an <em>update
sequence counter</em> that is set to <code>0</code> at object creation time and <strong>must</strong> be
incremented by each subsequent update operation.</p>
</div>
<div class="paragraph">
<p>Certain video sequences that adhere to particular video compression
standards permit updating previously supplied parameters.
If a parameter update is necessary, the application has the following
options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Cache the set of parameters on the application side and create a new
video session parameters object adding all the parameters with
appropriate changes, as necessary; or</p>
</li>
<li>
<p>Create a new video session parameters object providing only the updated
parameters and the previously used object as the template, which ensures
that parameters not specified at creation time will be copied unmodified
from the template object.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The actual types of parameters that <strong>can</strong> be stored and the capacity for
individual parameter types, and the methods of initializing, updating, and
referring to individual parameters are specific to the video codec operation
the video session parameters object was created with.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Video session parameters are represented by
<code>VkVideoSessionParametersKHR</code> handles:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/handles/VkVideoSessionParametersKHR.adoc[]</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="creating-video-session-parameters"><a class="anchor" href="#creating-video-session-parameters"></a>Creating Video Session Parameters</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a video session parameters object, call:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/protos/vkCreateVideoSessionParametersKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the video session
parameters object.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to
<code>VkVideoSessionParametersCreateInfoKHR</code> structure containing
parameters to be used to create the video session parameters object.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="memory.html#memory-allocation" class="xref page">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pVideoSessionParameters</code> is a pointer to a
<code>VkVideoSessionParametersKHR</code> handle in which the resulting video
session parameters object is returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The resulting video session parameters object is said to be created with the
video codec operation <code>pCreateInfo-&gt;videoSession</code> was created with.</p>
</div>
<div class="paragraph">
<p>If <code>pCreateInfo-&gt;videoSessionParametersTemplate</code> is not
<code>VK_NULL_HANDLE</code>, then it will be used as a template for constructing
the new video session parameters object.
This happens by first adding any parameters according to the additional
creation parameters provided in the <code>pCreateInfo-&gt;pNext</code> chain, followed
by adding any parameters from the template object that have a key that does
not match the key of any of the already added parameters.</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/protos/vkCreateVideoSessionParametersKHR.adoc[]</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoSessionParametersCreateInfoKHR</code> structure is defined as:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/structs/VkVideoSessionParametersCreateInfoKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>videoSessionParametersTemplate</code> is <code>VK_NULL_HANDLE</code> or a valid
handle to a <code>VkVideoSessionParametersKHR</code> object used as a template
for constructing the new video session parameters object.</p>
</li>
<li>
<p><code>videoSession</code> is the video session object against which the video
session parameters object is going to be created.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Limiting values are defined below that are referenced by the relevant valid
usage statements of this structure.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-04855" href="#VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-04855"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-04855</span><br>

If <code>videoSessionParametersTemplate</code> is not <code>VK_NULL_HANDLE</code>, it
<strong>must</strong> have been created against <code>videoSession</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/structs/VkVideoSessionParametersCreateInfoKHR.adoc[]</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/flags/VkVideoSessionParametersCreateFlagsKHR.adoc[]</p>
</div>
<div class="paragraph">
<p><code>VkVideoSessionParametersCreateFlagsKHR</code> is a bitmask type for setting a
mask, but is currently reserved for future use.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="destroying-video-session-parameters"><a class="anchor" href="#destroying-video-session-parameters"></a>Destroying Video Session Parameters</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a video session parameters object, call:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/protos/vkDestroyVideoSessionParametersKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the video session
parameters object.</p>
</li>
<li>
<p><code>videoSessionParameters</code> is the video session parameters object to
destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="memory.html#memory-allocation" class="xref page">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07212" href="#VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07212"></a> <span class="vuid">VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07212</span><br>

All submitted commands that refer to <code>videoSessionParameters</code> <strong>must</strong>
have completed execution</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07213" href="#VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07213"></a> <span class="vuid">VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07213</span><br>

If <code>VkAllocationCallbacks</code> were provided when
<code>videoSessionParameters</code> was created, a compatible set of callbacks
<strong>must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07214" href="#VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07214"></a> <span class="vuid">VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07214</span><br>

If no <code>VkAllocationCallbacks</code> were provided when
<code>videoSessionParameters</code> was created, <code>pAllocator</code> <strong>must</strong> be
<code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/protos/vkDestroyVideoSessionParametersKHR.adoc[]</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="video-session-parameters-update"><a class="anchor" href="#video-session-parameters-update"></a>Updating Video Session Parameters</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To update video session parameters object with new parameters, call:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/protos/vkUpdateVideoSessionParametersKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that updates the video session
parameters.</p>
</li>
<li>
<p><code>videoSessionParameters</code> is the video session parameters object to
update.</p>
</li>
<li>
<p><code>pUpdateInfo</code> is a pointer to a
<code>VkVideoSessionParametersUpdateInfoKHR</code> structure specifying the
parameter update information.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After a successful call to this command, the
<a href="#video-session-parameters">update sequence counter</a> of
<code>videoSessionParameters</code> is changed to the value specified in
<code>pUpdateInfo-&gt;updateSequenceCount</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As each update issued to a video session parameters object needs to specify
the next available update sequence count value, concurrent updates of the
same video session parameters object are inherently disallowed.
However, recording video coding operations to command buffers referring to
parameters previously added to the video session parameters object is
allowed, even if there is a concurrent update in progress adding some new
entries to the object.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-pUpdateInfo-07215" href="#VUID-vkUpdateVideoSessionParametersKHR-pUpdateInfo-07215"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-pUpdateInfo-07215</span><br>

<code>pUpdateInfo-&gt;updateSequenceCount</code> <strong>must</strong> equal the current
<a href="#video-session-parameters">update sequence counter</a> of
<code>videoSessionParameters</code> plus one</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/protos/vkUpdateVideoSessionParametersKHR.adoc[]</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoSessionParametersUpdateInfoKHR</code> structure is defined as:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/structs/VkVideoSessionParametersUpdateInfoKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>updateSequenceCount</code> is the new <a href="#video-session-parameters">update    sequence count</a> to set for the video session parameters object.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/structs/VkVideoSessionParametersUpdateInfoKHR.adoc[]</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="video-coding-scope"><a class="anchor" href="#video-coding-scope"></a>Video Coding Scope</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Applications <strong>can</strong> record video coding commands for a video session only
within a video coding scope.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To begin a video coding scope, call:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/protos/vkCmdBeginVideoCodingKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer in which to record the
command.</p>
</li>
<li>
<p><code>pBeginInfo</code> is a pointer to a <code>VkVideoBeginCodingInfoKHR</code>
structure specifying the parameters of the video coding scope, including
the video session and video session parameters object to use.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After beginning a video coding scope, the video session object specified in
<code>pBeginInfo-&gt;videoSession</code> is <em>bound</em> to the command buffer, and the
command buffer is ready to record video coding operations.
Similarly, if <code>pBeginInfo-&gt;videoSessionParameters</code> is not
<code>VK_NULL_HANDLE</code>, it is also <em>bound</em> to the command buffer, and video
coding operations <strong>can</strong> refer to the codec-specific parameters stored in it.</p>
</div>
<div id="bound-reference-picture-resources" class="paragraph">
<p>This command also establishes the set of <em>bound reference picture resources</em>
that <strong>can</strong> be used as <a href="#reconstructed-picture">reconstructed pictures</a> or
<a href="#reference-picture">reference pictures</a> within the video coding scope.
Each element of this set consists of a <a href="#video-picture-resources">video picture resource</a> and the <a href="#dpb-slot">DPB slot</a> index associated with it,
if there is one.</p>
</div>
<div class="paragraph">
<p>The set of bound reference picture resources is immutable within a video
coding scope, however, the DPB slot index associated with any of the bound
reference picture resources <strong>can</strong> change during the video coding scope in
response to video coding operations.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoReferenceSlotInfoKHR</code> structures provided as the elements of
<code>pBeginInfo-&gt;pReferenceSlots</code> are interpreted by this command as
follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If <code>slotIndex</code> is non-negative and <code>pPictureResource</code> is not
<code>NULL</code>, then the <a href="#video-picture-resources">video picture resource</a>
defined by the <code>VkVideoPictureResourceInfoKHR</code> structure pointed to
by <code>pPictureResource</code> is added to the set of bound reference picture
resources and is associated with the DPB slot index specified in
<code>slotIndex</code>.</p>
</li>
<li>
<p>If <code>slotIndex</code> is non-negative and <code>pPictureResource</code> is <code>NULL</code>,
then the DPB slot with index <code>slotIndex</code> is <a href="#dpb-slot-states">    deactivated</a> by this command.</p>
</li>
<li>
<p>If <code>slotIndex</code> is negative and <code>pPictureResource</code> is not <code>NULL</code>,
then the <a href="#video-picture-resources">video picture resource</a> defined by
the <code>VkVideoPictureResourceInfoKHR</code> structure pointed to by
<code>pPictureResource</code> is added to the set of bound reference picture
resources without an associated DPB slot.
Such a picture resource <strong>can</strong> be subsequently used as a
<a href="#reconstructed-picture">reconstructed picture</a> to associate it with a
DPB slot.</p>
</li>
<li>
<p>If <code>slotIndex</code> is negative and <code>pPictureResource</code> is <code>NULL</code>,
then the element is ignored.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All non-negative <code>slotIndex</code> values specified in the elements of
<code>pBeginInfo-&gt;pReferenceSlots</code> <strong>must</strong> identify DPB slots of the video
session that are in the <a href="#dpb-slot-states">active state</a> at the time this
command is executed on the device.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The application does not have to specify an entry in
<code>pBeginInfo-&gt;pReferenceSlots</code> corresponding to all active DPB slots of
the video session, but only for those which are intended to be used in the
video coding scope.
This way the application can avoid any potential runtime cost associated
with binding the corresponding picture resources to the command buffer.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07231" href="#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07231"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07231</span><br>

The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from
<strong>must</strong> support the video codec operation <code>pBeginInfo-&gt;videoSession</code>
was created with, as returned by
<a href="devsandqueues.html#vkGetPhysicalDeviceQueueFamilyProperties2" class="xref page">vkGetPhysicalDeviceQueueFamilyProperties2</a> in
<code>VkQueueFamilyVideoPropertiesKHR</code>::<code>videoCodecOperations</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-None-07232" href="#VUID-vkCmdBeginVideoCodingKHR-None-07232"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-None-07232</span><br>

There <strong>must</strong> be no <a href="queries.html#queries-operation-active" class="xref page">active</a> queries</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07233" href="#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07233"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07233</span><br>

If <code>commandBuffer</code> is an unprotected command buffer and
<a href="devsandqueues.html#limits-protectedNoFault" class="xref page"><code>protectedNoFault</code></a> is not supported,
then <code>pBeginInfo-&gt;videoSession</code> <strong>must</strong> not have been created with
<code>VK_VIDEO_SESSION_CREATE_PROTECTED_CONTENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07234" href="#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07234"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07234</span><br>

If <code>commandBuffer</code> is a protected command buffer and
<a href="devsandqueues.html#limits-protectedNoFault" class="xref page"><code>protectedNoFault</code></a> is not supported,
then <code>pBeginInfo-&gt;videoSession</code> <strong>must</strong> have been created with
<code>VK_VIDEO_SESSION_CREATE_PROTECTED_CONTENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07235" href="#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07235"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07235</span><br>

If <code>commandBuffer</code> is an unprotected command buffer,
<a href="devsandqueues.html#limits-protectedNoFault" class="xref page"><code>protectedNoFault</code></a> is not supported,
and the <code>pPictureResource</code> member of any element of
<code>pBeginInfo-&gt;pReferenceSlots</code> is not <code>NULL</code>, then
<code>pPictureResource-&gt;imageViewBinding</code> for that element <strong>must</strong> not
specify an image view created from a protected image</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07236" href="#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07236"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07236</span><br>

If <code>commandBuffer</code> is a protected command buffer
<a href="devsandqueues.html#limits-protectedNoFault" class="xref page"><code>protectedNoFault</code></a> is not supported,
and the <code>pPictureResource</code> member of any element of
<code>pBeginInfo-&gt;pReferenceSlots</code> is not <code>NULL</code>, then
<code>pPictureResource-&gt;imageViewBinding</code> for that element <strong>must</strong> specify
an image view created from a protected image</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-slotIndex-07239" href="#VUID-vkCmdBeginVideoCodingKHR-slotIndex-07239"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-slotIndex-07239</span><br>

If the <code>slotIndex</code> member of any element of
<code>pBeginInfo-&gt;pReferenceSlots</code> is not negative, then it <strong>must</strong> specify
the index of a DPB slot that is in the <a href="#dpb-slot-states">active state</a>
in <code>pBeginInfo-&gt;videoSession</code> at the time the command is executed on
the device</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-pPictureResource-07265" href="#VUID-vkCmdBeginVideoCodingKHR-pPictureResource-07265"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-pPictureResource-07265</span><br>

Each video picture resource specified by any non-<code>NULL</code>
<code>pPictureResource</code> member specified in the elements of
<code>pBeginInfo-&gt;pReferenceSlots</code> for which <code>slotIndex</code> is not
negative <strong>must</strong> <a href="#video-picture-resource-matching">match</a> one of the
video picture resources currently associated with the DPB slot index of
<code>pBeginInfo-&gt;videoSession</code> specified by <code>slotIndex</code> at the time
the command is executed on the device</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/protos/vkCmdBeginVideoCodingKHR.adoc[]</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoBeginCodingInfoKHR</code> structure is defined as:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/structs/VkVideoBeginCodingInfoKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>videoSession</code> is the video session object to be bound for the
processing of the video commands.</p>
</li>
<li>
<p><code>videoSessionParameters</code> is <code>VK_NULL_HANDLE</code> or a handle of a
<code>VkVideoSessionParametersKHR</code> object to be used for the processing
of the video commands.
If <code>VK_NULL_HANDLE</code>, then no video session parameters object is
bound for the duration of the video coding scope.</p>
</li>
<li>
<p><code>referenceSlotCount</code> is the number of elements in the
<code>pReferenceSlots</code> array.</p>
</li>
<li>
<p><code>pReferenceSlots</code> is a pointer to an array of
<code>VkVideoReferenceSlotInfoKHR</code> structures specifying the information
used to determine the set of <a href="#bound-reference-picture-resources">bound    reference picture resources</a> for the video coding scope and their
initial association with <a href="#dpb-slot">DPB slot</a> indices.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Limiting values are defined below that are referenced by the relevant valid
usage statements of this structure.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Let <code>VkOffset2D codedOffsetGranularity</code> be the minimum alignment
requirement for the coded offset of video picture resources.
Unless otherwise defined, the value of the <code>x</code> and <code>y</code> members
of <code>codedOffsetGranularity</code> are <code>0</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSession-07237" href="#VUID-VkVideoBeginCodingInfoKHR-videoSession-07237"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSession-07237</span><br>

<code>videoSession</code> <strong>must</strong> have memory bound to all of its memory bindings
returned by <code>vkGetVideoSessionMemoryRequirementsKHR</code> for
<code>videoSession</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-slotIndex-04856" href="#VUID-VkVideoBeginCodingInfoKHR-slotIndex-04856"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-slotIndex-04856</span><br>

Each non-negative <code>VkVideoReferenceSlotInfoKHR</code>::<code>slotIndex</code>
specified in the elements of <code>pReferenceSlots</code> <strong>must</strong> be less than
the <code>VkVideoSessionCreateInfoKHR</code>::<code>maxDpbSlots</code> specified when
<code>videoSession</code> was created</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07238" href="#VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07238"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07238</span><br>

Each video picture resource corresponding to any non-<code>NULL</code>
<code>pPictureResource</code> member specified in the elements of
<code>pReferenceSlots</code> <strong>must</strong> be <a href="#video-picture-resource-uniqueness">    unique</a> within <code>pReferenceSlots</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07240" href="#VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07240"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07240</span><br>

If the <code>pPictureResource</code> member of any element of
<code>pReferenceSlots</code> is not <code>NULL</code>, then the image view specified in
<code>pPictureResource-&gt;imageViewBinding</code> for that element <strong>must</strong> be
<a href="#video-profile-compatibility">compatible</a> with the video profile
<code>videoSession</code> was created with</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07241" href="#VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07241"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07241</span><br>

If the <code>pPictureResource</code> member of any element of
<code>pReferenceSlots</code> is not <code>NULL</code>, then the format of the image view
specified in <code>pPictureResource-&gt;imageViewBinding</code> for that element
<strong>must</strong> match the
<code>VkVideoSessionCreateInfoKHR</code>::<code>referencePictureFormat</code>
<code>videoSession</code> was created with</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07242" href="#VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07242"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07242</span><br>

If the <code>pPictureResource</code> member of any element of
<code>pReferenceSlots</code> is not <code>NULL</code>, then its <code>codedOffset</code> member
<strong>must</strong> be an integer multiple of <code>codedOffsetGranularity</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07243" href="#VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07243"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07243</span><br>

If the <code>pPictureResource</code> member of any element of
<code>pReferenceSlots</code> is not <code>NULL</code>, then its <code>codedExtent</code> member
<strong>must</strong> be between <code>minCodedExtent</code> and <code>maxCodedExtent</code>,
inclusive, <code>videoSession</code> was created with</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-flags-07244" href="#VUID-VkVideoBeginCodingInfoKHR-flags-07244"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-flags-07244</span><br>

If <code>VkVideoCapabilitiesKHR</code>::<code>flags</code> does not include
<code>VK_VIDEO_CAPABILITY_SEPARATE_REFERENCE_IMAGES_BIT_KHR</code>, as returned
by <code>vkGetPhysicalDeviceVideoCapabilitiesKHR</code> for the video profile
<code>videoSession</code> was created with, then
<code>pPictureResource-&gt;imageViewBinding</code> of all elements of
<code>pReferenceSlots</code> with a non-<code>NULL</code> <code>pPictureResource</code> member
<strong>must</strong> specify image views created from the same image</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-04857" href="#VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-04857"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-04857</span><br>

If <code>videoSessionParameters</code> is not <code>VK_NULL_HANDLE</code>, it <strong>must</strong>
have been created with <code>videoSession</code> specified in
<code>VkVideoSessionParametersCreateInfoKHR</code>::<code>videoSession</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/structs/VkVideoBeginCodingInfoKHR.adoc[]</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/flags/VkVideoBeginCodingFlagsKHR.adoc[]</p>
</div>
<div class="paragraph">
<p><code>VkVideoBeginCodingFlagsKHR</code> is a bitmask type for setting a mask, but
is currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoReferenceSlotInfoKHR</code> structure is defined as:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/structs/VkVideoReferenceSlotInfoKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>slotIndex</code> is the index of the <a href="#dpb-slot">DPB slot</a> or a negative
integer value.</p>
</li>
<li>
<p><code>pPictureResource</code> is <code>NULL</code> or a pointer to a
<code>VkVideoPictureResourceInfoKHR</code> structure describing the
<a href="#video-picture-resources">video picture resource</a> associated with the
DPB slot index specified by <code>slotIndex</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/structs/VkVideoReferenceSlotInfoKHR.adoc[]</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To end a video coding scope, call:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/protos/vkCmdEndVideoCodingKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer in which to record the
command.</p>
</li>
<li>
<p><code>pEndCodingInfo</code> is a pointer to a <code>VkVideoEndCodingInfoKHR</code>
structure specifying the parameters for ending the video coding scope.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After ending a video coding scope, the video session object, the optional
video session parameters object, and all
<a href="#bound-reference-picture-resources">reference picture resources</a>
previously bound by the corresponding <code>vkCmdBeginVideoCodingKHR</code> command
are <em>unbound</em>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdEndVideoCodingKHR-None-07251" href="#VUID-vkCmdEndVideoCodingKHR-None-07251"></a> <span class="vuid">VUID-vkCmdEndVideoCodingKHR-None-07251</span><br>

There <strong>must</strong> be no <a href="queries.html#queries-operation-active" class="xref page">active</a> queries</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/protos/vkCmdEndVideoCodingKHR.adoc[]</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEndCodingInfoKHR</code> structure is defined as:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/structs/VkVideoEndCodingInfoKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/structs/VkVideoEndCodingInfoKHR.adoc[]</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/flags/VkVideoEndCodingFlagsKHR.adoc[]</p>
</div>
<div class="paragraph">
<p><code>VkVideoEndCodingFlagsKHR</code> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="video-coding-control"><a class="anchor" href="#video-coding-control"></a>Video Coding Control</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To apply dynamic controls to the currently bound video session object, call:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/protos/vkCmdControlVideoCodingKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer in which to record the
command.</p>
</li>
<li>
<p><code>pCodingControlInfo</code> is a pointer to a
<code>VkVideoCodingControlInfoKHR</code> structure specifying the control
parameters.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The control parameters provided in this call are applied to the video
session at the time the command executes on the device and are in effect
until a subsequent call to this command with the same video session bound
changes the corresponding control parameters.</p>
</div>
<div class="paragraph">
<p>A newly created video session <strong>must</strong> be reset before performing video coding
operations using it by including <code>VK_VIDEO_CODING_CONTROL_RESET_BIT_KHR</code>
in <code>pCodingControlInfo-&gt;flags</code>.
The reset operation also returns all DPB slots of the video session to the
<a href="#dpb-slot-states">inactive state</a>.
Correspondingly, any DPB slot index associated with the
<a href="#bound-reference-picture-resources">bound reference picture resources</a> is
removed.</p>
</div>
<div class="paragraph">
<p>After video coding operations are performed using a video session, the reset
operation <strong>can</strong> be used to return the video session to the same <em>initial</em>
state as after the reset of a newly created video session.
This <strong>can</strong> be used, for example, when different video sequences are needed to
be processed with the same video session object.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdControlVideoCodingKHR-flags-07017" href="#VUID-vkCmdControlVideoCodingKHR-flags-07017"></a> <span class="vuid">VUID-vkCmdControlVideoCodingKHR-flags-07017</span><br>

If <code>pCodingControlInfo-&gt;flags</code> does not include
<code>VK_VIDEO_CODING_CONTROL_RESET_BIT_KHR</code>, then the bound video
session <strong>must</strong> not be in <a href="#video-session-uninitialized">uninitialized</a>
state at the time the command is executed on the device</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/protos/vkCmdControlVideoCodingKHR.adoc[]</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoCodingControlInfoKHR</code> structure is defined as:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/structs/VkVideoCodingControlInfoKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <code>VkVideoCodingControlFlagsKHR</code>
specifying control flags.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>

</div>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/validity/structs/VkVideoCodingControlInfoKHR.adoc[]</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in <code>VkVideoCodingControlInfoKHR</code>::<code>flags</code>,
specifying the video coding control parameters to be modified, are:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/enums/VkVideoCodingControlFlagBitsKHR.adoc[]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_CODING_CONTROL_RESET_BIT_KHR</code> indicates a request for the
bound video session to be reset before other coding control parameters
are applied.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/chapters/videocoding.adoc - include::partial$gen/api/flags/VkVideoCodingControlFlagsKHR.adoc[]</p>
</div>
<div class="paragraph">
<p><code>VkVideoCodingControlFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <code>VkVideoCodingControlFlagBitsKHR</code>.</p>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>

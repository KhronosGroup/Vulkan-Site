<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Queries :: Vulkan Documentation Project</title>
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="apple-touch-icon" sizes="180x180" href="../../../_/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../_/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../_/img/favicon-16x16.png">
    <link rel="manifest" href="../../../_/static/site.webmanifest">
    <link rel="mask-icon" href="../../../_/img/safari-pinned-tab.svg" color="#a41e22">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../.."><img class="navbar-item" alt="Vulkan White Label" src="../../../_/Vulkan_Docs.svg" /></a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field has-filter">
          <label for="search-input"></label>
          <input id="search-input" type="text" placeholder="Search the docs">
          <label class="filter checkbox">
            <input type="checkbox" data-facet-filter="component:spec" checked> In this component
          </label>
        </div>
      </div>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <!-- <a class="navbar-item" href="#">Home</a> -->
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Specs</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../spec/latest/chapters/introduction.html">Vulkan 1.3</a>
            <a class="navbar-item" href="https://registry.khronos.org/OpenGL/specs/gl/GLSLangSpec.4.60.html">GLSL</a>
            <a class="navbar-item" href="../../../guide/latest/hlsl.html">HLSL</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Education</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../guide/latest/index.html">Vulkan Guide</a>
            <a class="navbar-item" href="../../../tutorial/latest/index.html">Vulkan Tutorial</a>
            <a class="navbar-item" href="../../../samples/latest/README.html">Vulkan Samples</a>
            <a class="navbar-item" href="https://www.youtube.com/c/vulkan">YouTube</a>
            <a class="navbar-item" href="https://vulkan.org">More Info at Vulkan.org</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Feedback</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="https://github.com/KhronosGroup/Vulkan-Site/issues/new/choose" target="_blank">Report a Problem</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Community</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="https://discord.gg/vulkan">Vulkan Discord</a>
            <a class="navbar-item" href="https://reddit.com/r/vulkan">Reddit</a>
            <a class="navbar-item" href="https://stackoverflow.com/questions/tagged/vulkan">Stack Overflow</a>
            <a class="navbar-item" href="https://fosstodon.org/@vulkan">Mastodon</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="spec" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">Vulkan Specification</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fundamentals.html">Fundamentals</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="initialization.html">Initialization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="devsandqueues.html">Devices and Queues</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cmdbuffers.html">Command Buffers</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="synchronization.html">Synchronization and Cache Control</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="renderpass.html">Render Pass</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="shaders.html">Shaders</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="pipelines.html">Pipelines</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="memory.html">Memory Allocation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="resources.html">Resource Creation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="samplers.html">Samplers</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="descriptorsets.html">Resource Descriptors</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="interfaces.html">Shader Interfaces</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="textures.html">Image Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fragmentdensitymapops.html">Fragment Density Map Operations</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="queries.html">Queries</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="clears.html">Clear Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="copies.html">Copy Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="drawing.html">Drawing Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fxvertex.html">Fixed-Function Vertex Processing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="tessellation.html">Tessellation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="geometry.html">Geometry Shading</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_mesh_shader/mesh.html">Mesh Shading</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_HUAWEI_cluster_culling_shader/clusterculling.html">Cluster Culling Shading</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="vertexpostproc.html">Fixed-Function Vertex Post-Processing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="primsrast.html">Rasterization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fragops.html">Fragment Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="framebuffer.html">The Framebuffer</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dispatch.html">Dispatching Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_device_generated_commands/generatedcommands.html">Device-Generated Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="sparsemem.html">Sparse Resources</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_KHR_surface/wsi.html">Window System Integration (WSI)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_KHR_deferred_host_operations/deferred_host_operations.html">Deferred Host Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_EXT_private_data.html">Private Data</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="accelstructures.html">Acceleration Structures</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_EXT_opacity_micromap/micromaps.html">Micromap</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="raytraversal.html">Ray Traversal</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="raytracing.html">Ray Tracing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_memory_decompression.html">Memory Decompression</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="videocoding.html">Video Coding</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_optical_flow/optical_flow.html">Optical Flow</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="executiongraphs.html">Execution Graphs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_low_latency2/low_latency2.html">Low Latency 2</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="extensions.html">Extending Vulkan</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="features.html">Features</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="limits.html">Limits</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="formats.html">Formats</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="capabilities.html">Additional Capabilities</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="debugging.html">Debugging</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/spirvenv.html">Vulkan Environment for SPIR-V</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/memorymodel.html">Memory Model</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/compressedtex.html">Compressed Image Formats</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/versions.html">Core Revisions (Informative)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/extensions.html">Layers &amp; Extensions (Informative)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/roadmap.html">Vulkan Roadmap Milestones</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/boilerplate.html">API Boilerplate</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/invariance.html">Invariance</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/glossary.html">Lexicon</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/credits.html">Credits (Informative)</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Vulkan Specification</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../../../tutorial/latest/00_Introduction.html">Khronos Vulkan Tutorial</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../tutorial/latest/00_Introduction.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../features/latest/features/index.html">Vulkan Feature Descriptions</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../features/latest/features/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../guide/latest/index.html">Vulkan Guide</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../guide/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../samples/latest/README.html">Vulkan Samples</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../samples/latest/README.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <div class="title"><a href="../index.html">Vulkan Specification</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Vulkan Specification</a></li>
    <li><a href="queries.html">Queries</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="https://github.com/KhronosGroup/Vulkan-Docs/edit/main/antora/spec/modules/ROOT/pages/chapters/queries.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Queries</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><em>Queries</em> provide a mechanism to return information about the processing of
a sequence of Vulkan commands.
Query operations are asynchronous, and as such, their results are not
returned immediately.
Instead, their results, and their availability status are stored in a
<a href="#queries-pools">Query Pool</a>.
The state of these queries <strong>can</strong> be read back on the host, or copied to a
buffer object on the device.</p>
</div>
<div class="paragraph">
<p>The supported query types are <a href="#queries-occlusion">Occlusion Queries</a>,
<a href="#queries-pipestats">Pipeline Statistics Queries</a>,
<a href="#queries-result-status-only">Result Status Queries</a>,
<a href="#queries-video-encode-feedback">Video Encode Feedback Queries</a>
and <a href="#queries-timestamps">Timestamp Queries</a>.
<a href="#queries-performance">Performance Queries</a> are supported if the associated
extension is available.
<a href="#queries-transform-feedback">Transform Feedback Queries</a> are supported if
the associated extension is available.
<a href="#queries-performance-intel">Intel Performance Queries</a> are supported if the associated extension is
available.
<a href="#queries-mesh-shader">Mesh Shader Queries</a> are supported if the associated
extension is available.</p>
</div>
<div class="paragraph">
<p>Several additional queries with specific purposes associated with ray
tracing are available if the corresponding extensions are supported, as
described for <a href="#VkQueryType">VkQueryType</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="queries-pools"><a class="anchor" href="#queries-pools"></a>Query Pools</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Queries are managed using <em>query pool</em> objects.
Each query pool is a collection of a specific number of queries of a
particular type.</p>
</div>
<div class="paragraph">
<p>Query pools are represented by <code>VkQueryPool</code> handles:</p>
</div>
<div id="VkQueryPool" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkQueryPool)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a query pool, call:</p>
</div>
<div id="vkCreateQueryPool" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VkResult vkCreateQueryPool(
    VkDevice                                    device,
    const VkQueryPoolCreateInfo*                pCreateInfo,
    const VkAllocationCallbacks*                pAllocator,
    VkQueryPool*                                pQueryPool);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the query pool.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to a <a href="#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a>
structure containing the number and type of queries to be managed by the
pool.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="memory.html#memory-allocation" class="xref page">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pQueryPool</code> is a pointer to a <a href="#VkQueryPool">VkQueryPool</a> handle in which the
resulting query pool object is returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateQueryPool-device-parameter" href="#VUID-vkCreateQueryPool-device-parameter"></a> <span class="vuid">VUID-vkCreateQueryPool-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateQueryPool-pCreateInfo-parameter" href="#VUID-vkCreateQueryPool-pCreateInfo-parameter"></a> <span class="vuid">VUID-vkCreateQueryPool-pCreateInfo-parameter</span><br>
 <code>pCreateInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateQueryPool-pAllocator-parameter" href="#VUID-vkCreateQueryPool-pAllocator-parameter"></a> <span class="vuid">VUID-vkCreateQueryPool-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong>must</strong> be a valid pointer to a valid <a href="memory.html#VkAllocationCallbacks" class="xref page">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateQueryPool-pQueryPool-parameter" href="#VUID-vkCreateQueryPool-pQueryPool-parameter"></a> <span class="vuid">VUID-vkCreateQueryPool-pQueryPool-parameter</span><br>
 <code>pQueryPool</code> <strong>must</strong> be a valid pointer to a <a href="#VkQueryPool">VkQueryPool</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkQueryPoolCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkQueryPoolCreateInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef struct VkQueryPoolCreateInfo {
    VkStructureType                  sType;
    const void*                      pNext;
    VkQueryPoolCreateFlags           flags;
    VkQueryType                      queryType;
    uint32_t                         queryCount;
    VkQueryPipelineStatisticFlags    pipelineStatistics;
} VkQueryPoolCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>queryType</code> is a <a href="#VkQueryType">VkQueryType</a> value specifying the type of
queries managed by the pool.</p>
</li>
<li>
<p><code>queryCount</code> is the number of queries managed by the pool.</p>
</li>
<li>
<p><code>pipelineStatistics</code> is a bitmask of
<a href="#VkQueryPipelineStatisticFlagBits">VkQueryPipelineStatisticFlagBits</a> specifying which counters will be
returned in queries on the new pool, as described below in
<a href="#queries-pipestats">Pipeline Statistics Queries</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>pipelineStatistics</code> is ignored if <code>queryType</code> is not
<code>VK_QUERY_TYPE_PIPELINE_STATISTICS</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-queryType-00791" href="#VUID-VkQueryPoolCreateInfo-queryType-00791"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-queryType-00791</span><br>

If the <a href="features.html#features-pipelineStatisticsQuery" class="xref page">    <code>pipelineStatisticsQuery</code></a> feature is not enabled, <code>queryType</code>
<strong>must</strong> not be <code>VK_QUERY_TYPE_PIPELINE_STATISTICS</code></p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-meshShaderQueries-07068" href="#VUID-VkQueryPoolCreateInfo-meshShaderQueries-07068"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-meshShaderQueries-07068</span><br>

If the <a href="features.html#features-meshShaderQueries" class="xref page"><code>meshShaderQueries</code></a> feature
is not enabled, <code>queryType</code> <strong>must</strong> not be
<code>VK_QUERY_TYPE_MESH_PRIMITIVES_GENERATED_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-meshShaderQueries-07069" href="#VUID-VkQueryPoolCreateInfo-meshShaderQueries-07069"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-meshShaderQueries-07069</span><br>

If the <a href="features.html#features-meshShaderQueries" class="xref page"><code>meshShaderQueries</code></a> feature
is not enabled, and <code>queryType</code> is
<code>VK_QUERY_TYPE_PIPELINE_STATISTICS</code>, <code>pipelineStatistics</code> <strong>must</strong>
not contain
<code>VK_QUERY_PIPELINE_STATISTIC_TASK_SHADER_INVOCATIONS_BIT_EXT</code> or
<code>VK_QUERY_PIPELINE_STATISTIC_MESH_SHADER_INVOCATIONS_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-queryType-00792" href="#VUID-VkQueryPoolCreateInfo-queryType-00792"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-queryType-00792</span><br>

If <code>queryType</code> is <code>VK_QUERY_TYPE_PIPELINE_STATISTICS</code>,
<code>pipelineStatistics</code> <strong>must</strong> be a valid combination of
<a href="#VkQueryPipelineStatisticFlagBits">VkQueryPipelineStatisticFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-queryType-09534" href="#VUID-VkQueryPoolCreateInfo-queryType-09534"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-queryType-09534</span><br>

If <code>queryType</code> is <code>VK_QUERY_TYPE_PIPELINE_STATISTICS</code>,
<code>pipelineStatistics</code> <strong>must</strong> not be zero</p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-queryType-03222" href="#VUID-VkQueryPoolCreateInfo-queryType-03222"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-queryType-03222</span><br>

If <code>queryType</code> is <code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, the
<code>pNext</code> chain <strong>must</strong> include a
<a href="#VkQueryPoolPerformanceCreateInfoKHR">VkQueryPoolPerformanceCreateInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-queryCount-02763" href="#VUID-VkQueryPoolCreateInfo-queryCount-02763"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-queryCount-02763</span><br>

<code>queryCount</code> <strong>must</strong> be greater than 0</p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-queryType-07133" href="#VUID-VkQueryPoolCreateInfo-queryType-07133"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-queryType-07133</span><br>

If <code>queryType</code> is <code>VK_QUERY_TYPE_VIDEO_ENCODE_FEEDBACK_KHR</code>,
then the <code>pNext</code> chain <strong>must</strong> include a <a href="videocoding.html#VkVideoProfileInfoKHR" class="xref page">VkVideoProfileInfoKHR</a>
structure with <code>videoCodecOperation</code> specifying an encode operation</p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-queryType-07906" href="#VUID-VkQueryPoolCreateInfo-queryType-07906"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-queryType-07906</span><br>

If <code>queryType</code> is <code>VK_QUERY_TYPE_VIDEO_ENCODE_FEEDBACK_KHR</code>,
then the <code>pNext</code> chain <strong>must</strong> include a
<a href="#VkQueryPoolVideoEncodeFeedbackCreateInfoKHR">VkQueryPoolVideoEncodeFeedbackCreateInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-queryType-07907" href="#VUID-VkQueryPoolCreateInfo-queryType-07907"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-queryType-07907</span><br>

If <code>queryType</code> is <code>VK_QUERY_TYPE_VIDEO_ENCODE_FEEDBACK_KHR</code>, and
the <code>pNext</code> chain includes a <a href="videocoding.html#VkVideoProfileInfoKHR" class="xref page">VkVideoProfileInfoKHR</a> structure
and a <a href="#VkQueryPoolVideoEncodeFeedbackCreateInfoKHR">VkQueryPoolVideoEncodeFeedbackCreateInfoKHR</a> structure, then
<a href="#VkQueryPoolVideoEncodeFeedbackCreateInfoKHR">VkQueryPoolVideoEncodeFeedbackCreateInfoKHR</a>::<code>encodeFeedbackFlags</code>
<strong>must</strong> not contain any bits that are not set in
<a href="videocoding.html#VkVideoEncodeCapabilitiesKHR" class="xref page">VkVideoEncodeCapabilitiesKHR</a>::<code>supportedEncodeFeedbackFlags</code>,
as returned by <a href="videocoding.html#vkGetPhysicalDeviceVideoCapabilitiesKHR" class="xref page">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the
<a href="videocoding.html#video-profiles" class="xref page">video profile</a> described by
<a href="videocoding.html#VkVideoProfileInfoKHR" class="xref page">VkVideoProfileInfoKHR</a> and its <code>pNext</code> chain</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-sType-sType" href="#VUID-VkQueryPoolCreateInfo-sType-sType"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_QUERY_POOL_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-pNext-pNext" href="#VUID-VkQueryPoolCreateInfo-pNext-pNext"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong>must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="#VkQueryPoolPerformanceCreateInfoKHR">VkQueryPoolPerformanceCreateInfoKHR</a>, <a href="#VkQueryPoolPerformanceQueryCreateInfoINTEL">VkQueryPoolPerformanceQueryCreateInfoINTEL</a>, <a href="#VkQueryPoolVideoEncodeFeedbackCreateInfoKHR">VkQueryPoolVideoEncodeFeedbackCreateInfoKHR</a>, <a href="videocoding.html#VkVideoDecodeAV1ProfileInfoKHR" class="xref page">VkVideoDecodeAV1ProfileInfoKHR</a>, <a href="videocoding.html#VkVideoDecodeH264ProfileInfoKHR" class="xref page">VkVideoDecodeH264ProfileInfoKHR</a>, <a href="videocoding.html#VkVideoDecodeH265ProfileInfoKHR" class="xref page">VkVideoDecodeH265ProfileInfoKHR</a>, <a href="videocoding.html#VkVideoDecodeUsageInfoKHR" class="xref page">VkVideoDecodeUsageInfoKHR</a>, <a href="videocoding.html#VkVideoEncodeH264ProfileInfoKHR" class="xref page">VkVideoEncodeH264ProfileInfoKHR</a>, <a href="videocoding.html#VkVideoEncodeH265ProfileInfoKHR" class="xref page">VkVideoEncodeH265ProfileInfoKHR</a>, <a href="videocoding.html#VkVideoEncodeUsageInfoKHR" class="xref page">VkVideoEncodeUsageInfoKHR</a>, or <a href="videocoding.html#VkVideoProfileInfoKHR" class="xref page">VkVideoProfileInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-sType-unique" href="#VUID-VkQueryPoolCreateInfo-sType-unique"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong>must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-flags-zerobitmask" href="#VUID-VkQueryPoolCreateInfo-flags-zerobitmask"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-flags-zerobitmask</span><br>
 <code>flags</code> <strong>must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-queryType-parameter" href="#VUID-VkQueryPoolCreateInfo-queryType-parameter"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-queryType-parameter</span><br>
 <code>queryType</code> <strong>must</strong> be a valid <a href="#VkQueryType">VkQueryType</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkQueryPoolCreateFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef VkFlags VkQueryPoolCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkQueryPoolCreateFlags</code> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkQueryPoolPerformanceCreateInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkQueryPoolPerformanceCreateInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_performance_query
typedef struct VkQueryPoolPerformanceCreateInfoKHR {
    VkStructureType    sType;
    const void*        pNext;
    uint32_t           queueFamilyIndex;
    uint32_t           counterIndexCount;
    const uint32_t*    pCounterIndices;
} VkQueryPoolPerformanceCreateInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>queueFamilyIndex</code> is the queue family index to create this
performance query pool for.</p>
</li>
<li>
<p><code>counterIndexCount</code> is the length of the <code>pCounterIndices</code>
array.</p>
</li>
<li>
<p><code>pCounterIndices</code> is a pointer to an array of indices into the
<a href="devsandqueues.html#vkEnumeratePhysicalDeviceQueueFamilyPerformanceQueryCountersKHR" class="xref page">vkEnumeratePhysicalDeviceQueueFamilyPerformanceQueryCountersKHR</a>::<code>pCounters</code>
to enable in this performance query pool.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkQueryPoolPerformanceCreateInfoKHR-queueFamilyIndex-03236" href="#VUID-VkQueryPoolPerformanceCreateInfoKHR-queueFamilyIndex-03236"></a> <span class="vuid">VUID-VkQueryPoolPerformanceCreateInfoKHR-queueFamilyIndex-03236</span><br>

<code>queueFamilyIndex</code> <strong>must</strong> be a valid queue family index of the device</p>
</li>
<li>
<p><a id="VUID-VkQueryPoolPerformanceCreateInfoKHR-performanceCounterQueryPools-03237" href="#VUID-VkQueryPoolPerformanceCreateInfoKHR-performanceCounterQueryPools-03237"></a> <span class="vuid">VUID-VkQueryPoolPerformanceCreateInfoKHR-performanceCounterQueryPools-03237</span><br>

The <a href="features.html#features-performanceCounterQueryPools" class="xref page">    <code>performanceCounterQueryPools</code></a> feature <strong>must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-VkQueryPoolPerformanceCreateInfoKHR-pCounterIndices-03321" href="#VUID-VkQueryPoolPerformanceCreateInfoKHR-pCounterIndices-03321"></a> <span class="vuid">VUID-VkQueryPoolPerformanceCreateInfoKHR-pCounterIndices-03321</span><br>

Each element of <code>pCounterIndices</code> <strong>must</strong> be in the range of counters
reported by
<code>vkEnumeratePhysicalDeviceQueueFamilyPerformanceQueryCountersKHR</code>
for the queue family specified in <code>queueFamilyIndex</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkQueryPoolPerformanceCreateInfoKHR-sType-sType" href="#VUID-VkQueryPoolPerformanceCreateInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkQueryPoolPerformanceCreateInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_QUERY_POOL_PERFORMANCE_CREATE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkQueryPoolPerformanceCreateInfoKHR-pCounterIndices-parameter" href="#VUID-VkQueryPoolPerformanceCreateInfoKHR-pCounterIndices-parameter"></a> <span class="vuid">VUID-VkQueryPoolPerformanceCreateInfoKHR-pCounterIndices-parameter</span><br>
 <code>pCounterIndices</code> <strong>must</strong> be a valid pointer to an array of <code>counterIndexCount</code> <code>uint32_t</code> values</p>
</li>
<li>
<p><a id="VUID-VkQueryPoolPerformanceCreateInfoKHR-counterIndexCount-arraylength" href="#VUID-VkQueryPoolPerformanceCreateInfoKHR-counterIndexCount-arraylength"></a> <span class="vuid">VUID-VkQueryPoolPerformanceCreateInfoKHR-counterIndexCount-arraylength</span><br>
 <code>counterIndexCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query the number of passes required to query a performance query pool on
a physical device, call:</p>
</div>
<div id="vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_performance_query
void vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR(
    VkPhysicalDevice                            physicalDevice,
    const VkQueryPoolPerformanceCreateInfoKHR*  pPerformanceQueryCreateInfo,
    uint32_t*                                   pNumPasses);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>physicalDevice</code> is the handle to the physical device whose queue
family performance query counter properties will be queried.</p>
</li>
<li>
<p><code>pPerformanceQueryCreateInfo</code> is a pointer to a
<code>VkQueryPoolPerformanceCreateInfoKHR</code> of the performance query that
is to be created.</p>
</li>
<li>
<p><code>pNumPasses</code> is a pointer to an integer related to the number of
passes required to query the performance query pool, as described below.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>pPerformanceQueryCreateInfo</code> member
<code>VkQueryPoolPerformanceCreateInfoKHR</code>::<code>queueFamilyIndex</code> <strong>must</strong> be a
queue family of <code>physicalDevice</code>.
The number of passes required to capture the counters specified in the
<code>pPerformanceQueryCreateInfo</code> member
<code>VkQueryPoolPerformanceCreateInfoKHR</code>::<code>pCounters</code> is returned in
<code>pNumPasses</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR-physicalDevice-parameter" href="#VUID-vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR-physicalDevice-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR-physicalDevice-parameter</span><br>
 <code>physicalDevice</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkPhysicalDevice" class="xref page">VkPhysicalDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR-pPerformanceQueryCreateInfo-parameter" href="#VUID-vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR-pPerformanceQueryCreateInfo-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR-pPerformanceQueryCreateInfo-parameter</span><br>
 <code>pPerformanceQueryCreateInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkQueryPoolPerformanceCreateInfoKHR">VkQueryPoolPerformanceCreateInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR-pNumPasses-parameter" href="#VUID-vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR-pNumPasses-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR-pNumPasses-parameter</span><br>
 <code>pNumPasses</code> <strong>must</strong> be a valid pointer to a <code>uint32_t</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a query pool, call:</p>
</div>
<div id="vkDestroyQueryPool" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkDestroyQueryPool(
    VkDevice                                    device,
    VkQueryPool                                 queryPool,
    const VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the query pool.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="memory.html#memory-allocation" class="xref page">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyQueryPool-queryPool-00793" href="#VUID-vkDestroyQueryPool-queryPool-00793"></a> <span class="vuid">VUID-vkDestroyQueryPool-queryPool-00793</span><br>

All submitted commands that refer to <code>queryPool</code> <strong>must</strong> have
completed execution</p>
</li>
<li>
<p><a id="VUID-vkDestroyQueryPool-queryPool-00794" href="#VUID-vkDestroyQueryPool-queryPool-00794"></a> <span class="vuid">VUID-vkDestroyQueryPool-queryPool-00794</span><br>

If <code>VkAllocationCallbacks</code> were provided when <code>queryPool</code> was
created, a compatible set of callbacks <strong>must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyQueryPool-queryPool-00795" href="#VUID-vkDestroyQueryPool-queryPool-00795"></a> <span class="vuid">VUID-vkDestroyQueryPool-queryPool-00795</span><br>

If no <code>VkAllocationCallbacks</code> were provided when <code>queryPool</code> was
created, <code>pAllocator</code> <strong>must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications <strong>can</strong> verify that <code>queryPool</code> <strong>can</strong> be destroyed by checking
that <code>vkGetQueryPoolResults</code>() without the
<code>VK_QUERY_RESULT_PARTIAL_BIT</code> flag returns <code>VK_SUCCESS</code> for all
queries that are used in command buffers submitted for execution.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyQueryPool-device-parameter" href="#VUID-vkDestroyQueryPool-device-parameter"></a> <span class="vuid">VUID-vkDestroyQueryPool-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyQueryPool-queryPool-parameter" href="#VUID-vkDestroyQueryPool-queryPool-parameter"></a> <span class="vuid">VUID-vkDestroyQueryPool-queryPool-parameter</span><br>
 If <code>queryPool</code> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, <code>queryPool</code> <strong>must</strong> be a valid <a href="#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyQueryPool-pAllocator-parameter" href="#VUID-vkDestroyQueryPool-pAllocator-parameter"></a> <span class="vuid">VUID-vkDestroyQueryPool-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong>must</strong> be a valid pointer to a valid <a href="memory.html#VkAllocationCallbacks" class="xref page">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyQueryPool-queryPool-parent" href="#VUID-vkDestroyQueryPool-queryPool-parent"></a> <span class="vuid">VUID-vkDestroyQueryPool-queryPool-parent</span><br>
 If <code>queryPool</code> is a valid handle, it <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>queryPool</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <a href="#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a>::<code>queryType</code>, specifying
the type of queries managed by the pool, are:</p>
</div>
<div id="VkQueryType" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef enum VkQueryType {
    VK_QUERY_TYPE_OCCLUSION = 0,
    VK_QUERY_TYPE_PIPELINE_STATISTICS = 1,
    VK_QUERY_TYPE_TIMESTAMP = 2,
  // Provided by VK_KHR_video_queue
    VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR = 1000023000,
  // Provided by VK_EXT_transform_feedback
    VK_QUERY_TYPE_TRANSFORM_FEEDBACK_STREAM_EXT = 1000028004,
  // Provided by VK_KHR_performance_query
    VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR = 1000116000,
  // Provided by VK_KHR_acceleration_structure
    VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR = 1000150000,
  // Provided by VK_KHR_acceleration_structure
    VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR = 1000150001,
  // Provided by VK_NV_ray_tracing
    VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_NV = 1000165000,
  // Provided by VK_INTEL_performance_query
    VK_QUERY_TYPE_PERFORMANCE_QUERY_INTEL = 1000210000,
  // Provided by VK_KHR_video_encode_queue
    VK_QUERY_TYPE_VIDEO_ENCODE_FEEDBACK_KHR = 1000299000,
  // Provided by VK_EXT_mesh_shader
    VK_QUERY_TYPE_MESH_PRIMITIVES_GENERATED_EXT = 1000328000,
  // Provided by VK_EXT_primitives_generated_query
    VK_QUERY_TYPE_PRIMITIVES_GENERATED_EXT = 1000382000,
  // Provided by VK_KHR_ray_tracing_maintenance1
    VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_BOTTOM_LEVEL_POINTERS_KHR = 1000386000,
  // Provided by VK_KHR_ray_tracing_maintenance1
    VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SIZE_KHR = 1000386001,
  // Provided by VK_EXT_opacity_micromap
    VK_QUERY_TYPE_MICROMAP_SERIALIZATION_SIZE_EXT = 1000396000,
  // Provided by VK_EXT_opacity_micromap
    VK_QUERY_TYPE_MICROMAP_COMPACTED_SIZE_EXT = 1000396001,
} VkQueryType;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_QUERY_TYPE_OCCLUSION</code> specifies an <a href="#queries-occlusion">    occlusion query</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_PIPELINE_STATISTICS</code> specifies a <a href="#queries-pipestats">    pipeline statistics query</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_TIMESTAMP</code> specifies a <a href="#queries-timestamps">    timestamp query</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code> specifies a
<a href="#queries-performance">performance query</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_TRANSFORM_FEEDBACK_STREAM_EXT</code> specifies a
<a href="#queries-transform-feedback">transform feedback query</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_PRIMITIVES_GENERATED_EXT</code> specifies a
<a href="#queries-primitives-generated">primitives generated query</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code> specifies
a <a href="accelstructures.html#acceleration-structure-copying" class="xref page">acceleration structure size query</a>
for use with <a href="accelstructures.html#vkCmdWriteAccelerationStructuresPropertiesKHR" class="xref page">vkCmdWriteAccelerationStructuresPropertiesKHR</a> or
<a href="accelstructures.html#vkWriteAccelerationStructuresPropertiesKHR" class="xref page">vkWriteAccelerationStructuresPropertiesKHR</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code>
specifies a <a href="accelstructures.html#acceleration-structure-copying" class="xref page">serialization acceleration    structure size query</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SIZE_KHR</code> specifies an
<a href="accelstructures.html#acceleration-structure-copying" class="xref page">acceleration structure size query</a>
for use with <a href="accelstructures.html#vkCmdWriteAccelerationStructuresPropertiesKHR" class="xref page">vkCmdWriteAccelerationStructuresPropertiesKHR</a> or
<a href="accelstructures.html#vkWriteAccelerationStructuresPropertiesKHR" class="xref page">vkWriteAccelerationStructuresPropertiesKHR</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_BOTTOM_LEVEL_POINTERS_KHR</code>
specifies a <a href="accelstructures.html#serialized-as-header" class="xref page">serialization acceleration structure    pointer count query</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_NV</code> specifies
an <a href="accelstructures.html#acceleration-structure-copying" class="xref page">acceleration structure size query</a>
for use with <a href="accelstructures.html#vkCmdWriteAccelerationStructuresPropertiesNV" class="xref page">vkCmdWriteAccelerationStructuresPropertiesNV</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_PERFORMANCE_QUERY_INTEL</code> specifies a
<a href="#queries-performance-intel">Intel performance query</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code> specifies a
<a href="#queries-result-status-only">result status query</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_VIDEO_ENCODE_FEEDBACK_KHR</code> specifies a
<a href="#queries-video-encode-feedback">video encode feedback query</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_MESH_PRIMITIVES_GENERATED_EXT</code> specifies a
<a href="#queries-mesh-shader">generated mesh primitives query</a>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="queries-operation"><a class="anchor" href="#queries-operation"></a>Query Operation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The operation of queries is controlled by the commands
<a href="#vkCmdBeginQuery">vkCmdBeginQuery</a>, <a href="#vkCmdEndQuery">vkCmdEndQuery</a>,
<a href="#vkCmdBeginQueryIndexedEXT">vkCmdBeginQueryIndexedEXT</a>, <a href="#vkCmdEndQueryIndexedEXT">vkCmdEndQueryIndexedEXT</a>,
<a href="#vkCmdResetQueryPool">vkCmdResetQueryPool</a>, <a href="#vkCmdCopyQueryPoolResults">vkCmdCopyQueryPoolResults</a>,
<a href="#vkCmdWriteTimestamp2">vkCmdWriteTimestamp2</a>,
and <a href="#vkCmdWriteTimestamp">vkCmdWriteTimestamp</a>.</p>
</div>
<div class="paragraph">
<p>In order for a <code>VkCommandBuffer</code> to record query management commands,
the queue family for which its <code>VkCommandPool</code> was created <strong>must</strong> support
the appropriate type of operations (graphics, compute) suitable for the
query type of a given query pool.</p>
</div>
<div class="paragraph">
<p>Each query in a query pool has a status that is either <em>unavailable</em> or
<em>available</em>, and also has state to store the numerical results of a query
operation of the type requested when the query pool was created.
Resetting a query via <a href="#vkCmdResetQueryPool">vkCmdResetQueryPool</a>
or <a href="#vkResetQueryPool">vkResetQueryPool</a>
sets the status to unavailable and makes the numerical results <strong>undefined</strong>.
A query is made available by the operation of <a href="#vkCmdEndQuery">vkCmdEndQuery</a>,
<a href="#vkCmdEndQueryIndexedEXT">vkCmdEndQueryIndexedEXT</a>,
<a href="#vkCmdWriteTimestamp2">vkCmdWriteTimestamp2</a>,
or <a href="#vkCmdWriteTimestamp">vkCmdWriteTimestamp</a>.
Both the availability status and numerical results <strong>can</strong> be retrieved by
calling either <a href="#vkGetQueryPoolResults">vkGetQueryPoolResults</a> or
<a href="#vkCmdCopyQueryPoolResults">vkCmdCopyQueryPoolResults</a>.</p>
</div>
<div class="paragraph">
<p>After query pool creation, each query is in an uninitialized state and <strong>must</strong>
be reset before it is used.
Queries <strong>must</strong> also be reset between uses.</p>
</div>
<div class="paragraph">
<p>If a logical device includes multiple physical devices, then each command
that writes a query <strong>must</strong> execute on a single physical device, and any call
to <a href="#vkCmdBeginQuery">vkCmdBeginQuery</a> <strong>must</strong> execute the corresponding <a href="#vkCmdEndQuery">vkCmdEndQuery</a>
command on the same physical device.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To reset a range of queries in a query pool on a queue, call:</p>
</div>
<div id="vkCmdResetQueryPool" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkCmdResetQueryPool(
    VkCommandBuffer                             commandBuffer,
    VkQueryPool                                 queryPool,
    uint32_t                                    firstQuery,
    uint32_t                                    queryCount);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which this command will
be recorded.</p>
</li>
<li>
<p><code>queryPool</code> is the handle of the query pool managing the queries
being reset.</p>
</li>
<li>
<p><code>firstQuery</code> is the initial query index to reset.</p>
</li>
<li>
<p><code>queryCount</code> is the number of queries to reset.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When executed on a queue, this command sets the status of query indices
<span class="eq">[<code>firstQuery</code>, <code>firstQuery</code> +  <code>queryCount</code> - 1]</span> to
unavailable.</p>
</div>
<div class="paragraph">
<p>This command defines an execution dependency between other query commands
that reference the same query.</p>
</div>
<div class="paragraph">
<p>The first <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization scope</a>
includes all commands which reference the queries in <code>queryPool</code>
indicated by <code>firstQuery</code> and <code>queryCount</code> that occur earlier in
<a href="synchronization.html#synchronization-submission-order" class="xref page">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The second <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization scope</a>
includes all commands which reference the queries in <code>queryPool</code>
indicated by <code>firstQuery</code> and <code>queryCount</code> that occur later in
<a href="synchronization.html#synchronization-submission-order" class="xref page">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The operation of this command happens after the first scope and happens
before the second scope.</p>
</div>
<div class="paragraph">
<p>If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, this command sets the status of
query indices <span class="eq">[<code>firstQuery</code>, <code>firstQuery</code> + 
<code>queryCount</code> - 1]</span> to unavailable for each pass of <code>queryPool</code>, as
indicated by a call to
<a href="#vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR">vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Because <code>vkCmdResetQueryPool</code> resets all the passes of the indicated
queries, applications must not record a <code>vkCmdResetQueryPool</code> command
for a <code>queryPool</code> created with <code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>
in a command buffer that needs to be submitted multiple times as indicated
by a call to <a href="#vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR">vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR</a>.
Otherwise applications will never be able to complete the recorded queries.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdResetQueryPool-firstQuery-09436" href="#VUID-vkCmdResetQueryPool-firstQuery-09436"></a> <span class="vuid">VUID-vkCmdResetQueryPool-firstQuery-09436</span><br>

<code>firstQuery</code> <strong>must</strong> be less than the number of queries in
<code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetQueryPool-firstQuery-09437" href="#VUID-vkCmdResetQueryPool-firstQuery-09437"></a> <span class="vuid">VUID-vkCmdResetQueryPool-firstQuery-09437</span><br>

The sum of <code>firstQuery</code> and <code>queryCount</code> <strong>must</strong> be less than or
equal to the number of queries in <code>queryPool</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdResetQueryPool-None-02841" href="#VUID-vkCmdResetQueryPool-None-02841"></a> <span class="vuid">VUID-vkCmdResetQueryPool-None-02841</span><br>

All queries used by the command <strong>must</strong> not be active</p>
</li>
<li>
<p><a id="VUID-vkCmdResetQueryPool-firstQuery-02862" href="#VUID-vkCmdResetQueryPool-firstQuery-02862"></a> <span class="vuid">VUID-vkCmdResetQueryPool-firstQuery-02862</span><br>

If <code>queryPool</code> was created with
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, this command <strong>must</strong> not be
recorded in a command buffer that, either directly or through secondary
command buffers, also contains begin commands for a query from the set
of queries <span class="eq">[<code>firstQuery</code>, <code>firstQuery</code> + 
<code>queryCount</code> - 1]</span></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdResetQueryPool-commandBuffer-parameter" href="#VUID-vkCmdResetQueryPool-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdResetQueryPool-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdResetQueryPool-queryPool-parameter" href="#VUID-vkCmdResetQueryPool-queryPool-parameter"></a> <span class="vuid">VUID-vkCmdResetQueryPool-queryPool-parameter</span><br>
 <code>queryPool</code> <strong>must</strong> be a valid <a href="#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdResetQueryPool-commandBuffer-recording" href="#VUID-vkCmdResetQueryPool-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdResetQueryPool-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdResetQueryPool-commandBuffer-cmdpool" href="#VUID-vkCmdResetQueryPool-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdResetQueryPool-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics, compute, decode, encode, or optical flow operations</p>
</li>
<li>
<p><a id="VUID-vkCmdResetQueryPool-renderpass" href="#VUID-vkCmdResetQueryPool-renderpass"></a> <span class="vuid">VUID-vkCmdResetQueryPool-renderpass</span><br>
 This command <strong>must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdResetQueryPool-videocoding" href="#VUID-vkCmdResetQueryPool-videocoding"></a> <span class="vuid">VUID-vkCmdResetQueryPool-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdResetQueryPool-commonparent" href="#VUID-vkCmdResetQueryPool-commonparent"></a> <span class="vuid">VUID-vkCmdResetQueryPool-commonparent</span><br>
 Both of <code>commandBuffer</code>, and <code>queryPool</code> <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="videocoding.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute<br>
Decode<br>
Encode<br>
Opticalflow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To reset a range of queries in a query pool on the host, call:</p>
</div>
<div id="vkResetQueryPool" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_2
void vkResetQueryPool(
    VkDevice                                    device,
    VkQueryPool                                 queryPool,
    uint32_t                                    firstQuery,
    uint32_t                                    queryCount);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent command</p>
</div>
<div id="vkResetQueryPoolEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_host_query_reset
void vkResetQueryPoolEXT(
    VkDevice                                    device,
    VkQueryPool                                 queryPool,
    uint32_t                                    firstQuery,
    uint32_t                                    queryCount);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the query pool.</p>
</li>
<li>
<p><code>queryPool</code> is the handle of the query pool managing the queries
being reset.</p>
</li>
<li>
<p><code>firstQuery</code> is the initial query index to reset.</p>
</li>
<li>
<p><code>queryCount</code> is the number of queries to reset.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the status of query indices <span class="eq">[<code>firstQuery</code>,
<code>firstQuery</code> +  <code>queryCount</code> - 1]</span> to unavailable.</p>
</div>
<div class="paragraph">
<p>If <code>queryPool</code> is <code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code> this command
sets the status of query indices <span class="eq">[<code>firstQuery</code>, <code>firstQuery</code>
+  <code>queryCount</code> - 1]</span> to unavailable for each pass.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetQueryPool-firstQuery-09436" href="#VUID-vkResetQueryPool-firstQuery-09436"></a> <span class="vuid">VUID-vkResetQueryPool-firstQuery-09436</span><br>

<code>firstQuery</code> <strong>must</strong> be less than the number of queries in
<code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkResetQueryPool-firstQuery-09437" href="#VUID-vkResetQueryPool-firstQuery-09437"></a> <span class="vuid">VUID-vkResetQueryPool-firstQuery-09437</span><br>

The sum of <code>firstQuery</code> and <code>queryCount</code> <strong>must</strong> be less than or
equal to the number of queries in <code>queryPool</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetQueryPool-None-02665" href="#VUID-vkResetQueryPool-None-02665"></a> <span class="vuid">VUID-vkResetQueryPool-None-02665</span><br>

The <a href="features.html#features-hostQueryReset" class="xref page"><code>hostQueryReset</code></a> feature <strong>must</strong> be
enabled</p>
</li>
<li>
<p><a id="VUID-vkResetQueryPool-firstQuery-02741" href="#VUID-vkResetQueryPool-firstQuery-02741"></a> <span class="vuid">VUID-vkResetQueryPool-firstQuery-02741</span><br>

Submitted commands that refer to the range specified by <code>firstQuery</code>
and <code>queryCount</code> in <code>queryPool</code> <strong>must</strong> have completed execution</p>
</li>
<li>
<p><a id="VUID-vkResetQueryPool-firstQuery-02742" href="#VUID-vkResetQueryPool-firstQuery-02742"></a> <span class="vuid">VUID-vkResetQueryPool-firstQuery-02742</span><br>

The range of queries specified by <code>firstQuery</code> and <code>queryCount</code>
in <code>queryPool</code> <strong>must</strong> not be in use by calls to
<a href="#vkGetQueryPoolResults">vkGetQueryPoolResults</a> or <code>vkResetQueryPool</code> in other threads</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetQueryPool-device-parameter" href="#VUID-vkResetQueryPool-device-parameter"></a> <span class="vuid">VUID-vkResetQueryPool-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkResetQueryPool-queryPool-parameter" href="#VUID-vkResetQueryPool-queryPool-parameter"></a> <span class="vuid">VUID-vkResetQueryPool-queryPool-parameter</span><br>
 <code>queryPool</code> <strong>must</strong> be a valid <a href="#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkResetQueryPool-queryPool-parent" href="#VUID-vkResetQueryPool-queryPool-parent"></a> <span class="vuid">VUID-vkResetQueryPool-queryPool-parent</span><br>
 <code>queryPool</code> <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Once queries are reset and ready for use, query commands <strong>can</strong> be issued to a
command buffer.
Occlusion queries and pipeline statistics queries count events - drawn
samples and pipeline stage invocations, respectively - resulting from
commands that are recorded between a <a href="#vkCmdBeginQuery">vkCmdBeginQuery</a> command and a
<a href="#vkCmdEndQuery">vkCmdEndQuery</a> command within a specified command buffer, effectively
scoping a set of drawing and/or dispatching commands.
Timestamp queries write timestamps to a query pool.
Performance queries record performance counters to a query pool.</p>
</div>
<div class="paragraph">
<p>A query <strong>must</strong> begin and end in the same command buffer, although if it is a
primary command buffer, and the <a href="features.html#features-inheritedQueries" class="xref page"><code>inheritedQueries</code></a> feature is enabled, it <strong>can</strong> execute secondary
command buffers during the query operation.
For a secondary command buffer to be executed while a query is active, it
<strong>must</strong> set the <code>occlusionQueryEnable</code>, <code>queryFlags</code>, and/or
<code>pipelineStatistics</code> members of <a href="cmdbuffers.html#VkCommandBufferInheritanceInfo" class="xref page">VkCommandBufferInheritanceInfo</a> to
conservative values, as described in the <a href="cmdbuffers.html#commandbuffers-recording" class="xref page">Command Buffer Recording</a> section.
A query <strong>must</strong> either begin and end inside the same subpass of a render pass
instance, or <strong>must</strong> both begin and end outside of a render pass instance
(i.e. contain entire render pass instances).</p>
</div>
<div class="paragraph">
<p>If queries are used while executing a render pass instance that has
multiview enabled, the query uses <span class="eq">N</span> consecutive query indices in the
query pool (starting at <code>query</code>) where <span class="eq">N</span> is the number of bits set
in the view mask in the subpass the query is used in.
How the numerical results of the query are distributed among the queries is
implementation-dependent.
For example, some implementations <strong>may</strong> write each view&#8217;s results to a
distinct query, while other implementations <strong>may</strong> write the total result to
the first query and write zero to the other queries.
However, the sum of the results in all the queries <strong>must</strong> accurately reflect
the total result of the query summed over all views.
Applications <strong>can</strong> sum the results from all the queries to compute the total
result.</p>
</div>
<div class="paragraph">
<p>Queries used with multiview rendering <strong>must</strong> not span subpasses, i.e. they
<strong>must</strong> begin and end in the same subpass.</p>
</div>
<div class="paragraph">
<p>A query <strong>must</strong> either begin and end inside the same video coding scope, or
<strong>must</strong> both begin and end outside of a video coding scope and <strong>must</strong> not
contain entire video coding scopes.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To begin a query, call:</p>
</div>
<div id="vkCmdBeginQuery" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkCmdBeginQuery(
    VkCommandBuffer                             commandBuffer,
    VkQueryPool                                 queryPool,
    uint32_t                                    query,
    VkQueryControlFlags                         flags);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which this command will
be recorded.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool that will manage the results of the
query.</p>
</li>
<li>
<p><code>query</code> is the query index within the query pool that will contain
the results.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkQueryControlFlagBits">VkQueryControlFlagBits</a> specifying
constraints on the types of queries that <strong>can</strong> be performed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <code>queryType</code> of the pool is <code>VK_QUERY_TYPE_OCCLUSION</code> and
<code>flags</code> contains <code>VK_QUERY_CONTROL_PRECISE_BIT</code>, an implementation
<strong>must</strong> return a result that matches the actual number of samples passed.
This is described in more detail in <a href="#queries-occlusion">Occlusion Queries</a>.</p>
</div>
<div class="paragraph">
<p>Calling <code>vkCmdBeginQuery</code> is equivalent to calling
<a href="#vkCmdBeginQueryIndexedEXT">vkCmdBeginQueryIndexedEXT</a> with the <code>index</code> parameter set to zero.</p>
</div>
<div id="queries-operation-active" class="paragraph">
<p>After beginning a query, that query is considered <em>active</em> within the
command buffer it was called in until that same query is ended.
Queries active in a primary command buffer when secondary command buffers
are executed are considered active for those secondary command buffers.</p>
</div>
<div class="paragraph">
<p>Furthermore, if the query is started within a video coding scope, the
following command buffer states are initialized for the query type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="queries-operation-active-query-index"></a> The <em>active_query_index</em> is set
to the value specified by <code>query</code>.</p>
</li>
<li>
<p><a id="queries-operation-last-activatable-query-index"></a> The <em>last activatable
query index</em> is also set to the value specified by <code>query</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each <a href="videocoding.html#video-coding" class="xref page">video coding operation</a> stores a result to the query
corresponding to the current active query index, followed by incrementing
the active query index.
If the active query index gets incremented past the last activatable query
index, issuing any further video coding operations results in <strong>undefined</strong>
behavior.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>In practice, this means that currently no more than a single video coding
operation <strong>must</strong> be issued between a begin and end query pair.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This command defines an execution dependency between other query commands
that reference the same query.</p>
</div>
<div class="paragraph">
<p>The first <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization scope</a>
includes all commands which reference the queries in <code>queryPool</code>
indicated by <code>query</code> that occur earlier in
<a href="synchronization.html#synchronization-submission-order" class="xref page">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The second <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization scope</a>
includes all commands which reference the queries in <code>queryPool</code>
indicated by <code>query</code> that occur later in
<a href="synchronization.html#synchronization-submission-order" class="xref page">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The operation of this command happens after the first scope and happens
before the second scope.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBeginQuery-None-00807" href="#VUID-vkCmdBeginQuery-None-00807"></a> <span class="vuid">VUID-vkCmdBeginQuery-None-00807</span><br>

All queries used by the command <strong>must</strong> be <em>unavailable</em></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-02804" href="#VUID-vkCmdBeginQuery-queryType-02804"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-02804</span><br>

The <code>queryType</code> used to create <code>queryPool</code> <strong>must</strong> not be
<code>VK_QUERY_TYPE_TIMESTAMP</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-04728" href="#VUID-vkCmdBeginQuery-queryType-04728"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-04728</span><br>

The <code>queryType</code> used to create <code>queryPool</code> <strong>must</strong> not be
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code> or
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-06741" href="#VUID-vkCmdBeginQuery-queryType-06741"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-06741</span><br>

The <code>queryType</code> used to create <code>queryPool</code> <strong>must</strong> not be
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SIZE_KHR</code> or
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_BOTTOM_LEVEL_POINTERS_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-04729" href="#VUID-vkCmdBeginQuery-queryType-04729"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-04729</span><br>

The <code>queryType</code> used to create <code>queryPool</code> <strong>must</strong> not be
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_NV</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-00800" href="#VUID-vkCmdBeginQuery-queryType-00800"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-00800</span><br>

If the <a href="features.html#features-occlusionQueryPrecise" class="xref page"><code>occlusionQueryPrecise</code></a>
feature is not enabled, or the <code>queryType</code> used to create
<code>queryPool</code> was not <code>VK_QUERY_TYPE_OCCLUSION</code>, <code>flags</code> <strong>must</strong>
not contain <code>VK_QUERY_CONTROL_PRECISE_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-query-00802" href="#VUID-vkCmdBeginQuery-query-00802"></a> <span class="vuid">VUID-vkCmdBeginQuery-query-00802</span><br>

<code>query</code> <strong>must</strong> be less than the number of queries in <code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-00803" href="#VUID-vkCmdBeginQuery-queryType-00803"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-00803</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_OCCLUSION</code>, the <code>VkCommandPool</code> that
<code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-00804" href="#VUID-vkCmdBeginQuery-queryType-00804"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-00804</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PIPELINE_STATISTICS</code> and any of the
<code>pipelineStatistics</code> indicate graphics operations, the
<code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong>
support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-00805" href="#VUID-vkCmdBeginQuery-queryType-00805"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-00805</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PIPELINE_STATISTICS</code> and any of the
<code>pipelineStatistics</code> indicate compute operations, the
<code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong>
support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-commandBuffer-01885" href="#VUID-vkCmdBeginQuery-commandBuffer-01885"></a> <span class="vuid">VUID-vkCmdBeginQuery-commandBuffer-01885</span><br>

<code>commandBuffer</code> <strong>must</strong> not be a protected command buffer</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-query-00808" href="#VUID-vkCmdBeginQuery-query-00808"></a> <span class="vuid">VUID-vkCmdBeginQuery-query-00808</span><br>

If called within a render pass instance, the sum of <code>query</code> and the
number of bits set in the current subpass&#8217;s view mask <strong>must</strong> be less than
or equal to the number of queries in <code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-07126" href="#VUID-vkCmdBeginQuery-queryType-07126"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-07126</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code>, then the <code>VkCommandPool</code>
that <code>commandBuffer</code> was allocated from <strong>must</strong> have been created with
a queue family index that supports <a href="#queries-result-status-only">result    status queries</a>, as indicated by
<a href="devsandqueues.html#VkQueueFamilyQueryResultStatusPropertiesKHR" class="xref page">VkQueueFamilyQueryResultStatusPropertiesKHR</a>::<code>queryResultStatusSupport</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-None-07127" href="#VUID-vkCmdBeginQuery-None-07127"></a> <span class="vuid">VUID-vkCmdBeginQuery-None-07127</span><br>

If there is a bound video session, then there <strong>must</strong> be no
<a href="#queries-operation-active">active</a> queries</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-None-08370" href="#VUID-vkCmdBeginQuery-None-08370"></a> <span class="vuid">VUID-vkCmdBeginQuery-None-08370</span><br>

If there is a bound video session, then it <strong>must</strong> not have been created
with <code>VK_VIDEO_SESSION_CREATE_INLINE_QUERIES_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-07128" href="#VUID-vkCmdBeginQuery-queryType-07128"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-07128</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code> and there is a bound video
session, then <code>queryPool</code> <strong>must</strong> have been created with a
<a href="videocoding.html#VkVideoProfileInfoKHR" class="xref page">VkVideoProfileInfoKHR</a> structure included in the <code>pNext</code> chain
of <a href="#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a> identical to the one specified in
<a href="videocoding.html#VkVideoSessionCreateInfoKHR" class="xref page">VkVideoSessionCreateInfoKHR</a>::<code>pVideoProfile</code> the bound video
session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-07129" href="#VUID-vkCmdBeginQuery-queryType-07129"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-07129</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_VIDEO_ENCODE_FEEDBACK_KHR</code>, then there <strong>must</strong> be a
bound video session</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-07130" href="#VUID-vkCmdBeginQuery-queryType-07130"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-07130</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_VIDEO_ENCODE_FEEDBACK_KHR</code> and there is a bound video
session, then <code>queryPool</code> <strong>must</strong> have been created with a
<a href="videocoding.html#VkVideoProfileInfoKHR" class="xref page">VkVideoProfileInfoKHR</a> structure included in the <code>pNext</code> chain
of <a href="#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a> identical to the one specified in
<a href="videocoding.html#VkVideoSessionCreateInfoKHR" class="xref page">VkVideoSessionCreateInfoKHR</a>::<code>pVideoProfile</code> the bound video
session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-07131" href="#VUID-vkCmdBeginQuery-queryType-07131"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-07131</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was not
<code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code>
or <code>VK_QUERY_TYPE_VIDEO_ENCODE_FEEDBACK_KHR</code>,
then there <strong>must</strong> be no bound video session</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryPool-01922" href="#VUID-vkCmdBeginQuery-queryPool-01922"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryPool-01922</span><br>

<code>queryPool</code> <strong>must</strong> have been created with a <code>queryType</code> that
differs from that of any queries that are
<a href="#queries-operation-active">active</a> within <code>commandBuffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-07070" href="#VUID-vkCmdBeginQuery-queryType-07070"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-07070</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_MESH_PRIMITIVES_GENERATED_EXT</code> the
<code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong>
support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-02327" href="#VUID-vkCmdBeginQuery-queryType-02327"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-02327</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_TRANSFORM_FEEDBACK_STREAM_EXT</code> the
<code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong>
support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-02328" href="#VUID-vkCmdBeginQuery-queryType-02328"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-02328</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_TRANSFORM_FEEDBACK_STREAM_EXT</code> then
<code>VkPhysicalDeviceTransformFeedbackPropertiesEXT</code>::<code>transformFeedbackQueries</code>
<strong>must</strong> be supported</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-06687" href="#VUID-vkCmdBeginQuery-queryType-06687"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-06687</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PRIMITIVES_GENERATED_EXT</code> the <code>VkCommandPool</code>
that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics
operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-06688" href="#VUID-vkCmdBeginQuery-queryType-06688"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-06688</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PRIMITIVES_GENERATED_EXT</code> then
<a href="features.html#features-primitivesGeneratedQuery" class="xref page"><code>primitivesGeneratedQuery</code></a>
<strong>must</strong> be enabled</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryPool-07289" href="#VUID-vkCmdBeginQuery-queryPool-07289"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryPool-07289</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, then the
<a href="#VkQueryPoolPerformanceCreateInfoKHR">VkQueryPoolPerformanceCreateInfoKHR</a>::<code>queueFamilyIndex</code>
<code>queryPool</code> was created with <strong>must</strong> equal the queue family index of
the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryPool-03223" href="#VUID-vkCmdBeginQuery-queryPool-03223"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryPool-03223</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, the <a href="#profiling-lock">    profiling lock</a> <strong>must</strong> have been held before <a href="cmdbuffers.html#vkBeginCommandBuffer" class="xref page">vkBeginCommandBuffer</a>
was called on <code>commandBuffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryPool-03224" href="#VUID-vkCmdBeginQuery-queryPool-03224"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryPool-03224</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code> and one of the counters used
to create <code>queryPool</code> was
<code>VK_PERFORMANCE_COUNTER_SCOPE_COMMAND_BUFFER_KHR</code>, the query begin
<strong>must</strong> be the first recorded command in <code>commandBuffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryPool-03225" href="#VUID-vkCmdBeginQuery-queryPool-03225"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryPool-03225</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code> and one of the counters used
to create <code>queryPool</code> was
<code>VK_PERFORMANCE_COUNTER_SCOPE_RENDER_PASS_KHR</code>, the begin command
<strong>must</strong> not be recorded within a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryPool-03226" href="#VUID-vkCmdBeginQuery-queryPool-03226"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryPool-03226</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code> and another query pool with a
<code>queryType</code> <code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code> has been used
within <code>commandBuffer</code>, its parent primary command buffer or
secondary command buffer recorded within the same parent primary command
buffer as <code>commandBuffer</code>, the
<a href="features.html#features-performanceCounterMultipleQueryPools" class="xref page">    <code>performanceCounterMultipleQueryPools</code></a> feature <strong>must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-None-02863" href="#VUID-vkCmdBeginQuery-None-02863"></a> <span class="vuid">VUID-vkCmdBeginQuery-None-02863</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, this command <strong>must</strong> not be
recorded in a command buffer that, either directly or through secondary
command buffers, also contains a <code>vkCmdResetQueryPool</code> command
affecting the same query</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBeginQuery-commandBuffer-parameter" href="#VUID-vkCmdBeginQuery-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdBeginQuery-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryPool-parameter" href="#VUID-vkCmdBeginQuery-queryPool-parameter"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryPool-parameter</span><br>
 <code>queryPool</code> <strong>must</strong> be a valid <a href="#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-flags-parameter" href="#VUID-vkCmdBeginQuery-flags-parameter"></a> <span class="vuid">VUID-vkCmdBeginQuery-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkQueryControlFlagBits">VkQueryControlFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-commandBuffer-recording" href="#VUID-vkCmdBeginQuery-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdBeginQuery-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-commandBuffer-cmdpool" href="#VUID-vkCmdBeginQuery-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdBeginQuery-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics, compute, decode, or encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-commonparent" href="#VUID-vkCmdBeginQuery-commonparent"></a> <span class="vuid">VUID-vkCmdBeginQuery-commonparent</span><br>
 Both of <code>commandBuffer</code>, and <code>queryPool</code> <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="videocoding.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute<br>
Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action<br>
State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To begin an indexed query, call:</p>
</div>
<div id="vkCmdBeginQueryIndexedEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_transform_feedback
void vkCmdBeginQueryIndexedEXT(
    VkCommandBuffer                             commandBuffer,
    VkQueryPool                                 queryPool,
    uint32_t                                    query,
    VkQueryControlFlags                         flags,
    uint32_t                                    index);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which this command will
be recorded.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool that will manage the results of the
query.</p>
</li>
<li>
<p><code>query</code> is the query index within the query pool that will contain
the results.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkQueryControlFlagBits">VkQueryControlFlagBits</a> specifying
constraints on the types of queries that <strong>can</strong> be performed.</p>
</li>
<li>
<p><code>index</code> is the query type specific index.
When the query type is <code>VK_QUERY_TYPE_TRANSFORM_FEEDBACK_STREAM_EXT</code>
or <code>VK_QUERY_TYPE_PRIMITIVES_GENERATED_EXT</code>,
the index represents the vertex stream.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>vkCmdBeginQueryIndexedEXT</code> command operates the same as the
<a href="#vkCmdBeginQuery">vkCmdBeginQuery</a> command, except that it also accepts a query type
specific <code>index</code> parameter.</p>
</div>
<div class="paragraph">
<p>This command defines an execution dependency between other query commands
that reference the same query index.</p>
</div>
<div class="paragraph">
<p>The first <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization scope</a>
includes all commands which reference the queries in <code>queryPool</code>
indicated by <code>query</code> and <code>index</code> that occur earlier in
<a href="synchronization.html#synchronization-submission-order" class="xref page">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The second <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization scope</a>
includes all commands which reference the queries in <code>queryPool</code>
indicated by <code>query</code> and <code>index</code> that occur later in
<a href="synchronization.html#synchronization-submission-order" class="xref page">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The operation of this command happens after the first scope and happens
before the second scope.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-None-00807" href="#VUID-vkCmdBeginQueryIndexedEXT-None-00807"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-None-00807</span><br>

All queries used by the command <strong>must</strong> be <em>unavailable</em></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-02804" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-02804"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-02804</span><br>

The <code>queryType</code> used to create <code>queryPool</code> <strong>must</strong> not be
<code>VK_QUERY_TYPE_TIMESTAMP</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-04728" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-04728"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-04728</span><br>

The <code>queryType</code> used to create <code>queryPool</code> <strong>must</strong> not be
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code> or
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-06741" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-06741"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-06741</span><br>

The <code>queryType</code> used to create <code>queryPool</code> <strong>must</strong> not be
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SIZE_KHR</code> or
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_BOTTOM_LEVEL_POINTERS_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-04729" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-04729"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-04729</span><br>

The <code>queryType</code> used to create <code>queryPool</code> <strong>must</strong> not be
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_NV</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-00800" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-00800"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-00800</span><br>

If the <a href="features.html#features-occlusionQueryPrecise" class="xref page"><code>occlusionQueryPrecise</code></a>
feature is not enabled, or the <code>queryType</code> used to create
<code>queryPool</code> was not <code>VK_QUERY_TYPE_OCCLUSION</code>, <code>flags</code> <strong>must</strong>
not contain <code>VK_QUERY_CONTROL_PRECISE_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-query-00802" href="#VUID-vkCmdBeginQueryIndexedEXT-query-00802"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-query-00802</span><br>

<code>query</code> <strong>must</strong> be less than the number of queries in <code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-00803" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-00803"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-00803</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_OCCLUSION</code>, the <code>VkCommandPool</code> that
<code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-00804" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-00804"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-00804</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PIPELINE_STATISTICS</code> and any of the
<code>pipelineStatistics</code> indicate graphics operations, the
<code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong>
support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-00805" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-00805"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-00805</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PIPELINE_STATISTICS</code> and any of the
<code>pipelineStatistics</code> indicate compute operations, the
<code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong>
support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-commandBuffer-01885" href="#VUID-vkCmdBeginQueryIndexedEXT-commandBuffer-01885"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-commandBuffer-01885</span><br>

<code>commandBuffer</code> <strong>must</strong> not be a protected command buffer</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-query-00808" href="#VUID-vkCmdBeginQueryIndexedEXT-query-00808"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-query-00808</span><br>

If called within a render pass instance, the sum of <code>query</code> and the
number of bits set in the current subpass&#8217;s view mask <strong>must</strong> be less than
or equal to the number of queries in <code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-07126" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-07126"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-07126</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code>, then the <code>VkCommandPool</code>
that <code>commandBuffer</code> was allocated from <strong>must</strong> have been created with
a queue family index that supports <a href="#queries-result-status-only">result    status queries</a>, as indicated by
<a href="devsandqueues.html#VkQueueFamilyQueryResultStatusPropertiesKHR" class="xref page">VkQueueFamilyQueryResultStatusPropertiesKHR</a>::<code>queryResultStatusSupport</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-None-07127" href="#VUID-vkCmdBeginQueryIndexedEXT-None-07127"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-None-07127</span><br>

If there is a bound video session, then there <strong>must</strong> be no
<a href="#queries-operation-active">active</a> queries</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-None-08370" href="#VUID-vkCmdBeginQueryIndexedEXT-None-08370"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-None-08370</span><br>

If there is a bound video session, then it <strong>must</strong> not have been created
with <code>VK_VIDEO_SESSION_CREATE_INLINE_QUERIES_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-07128" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-07128"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-07128</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code> and there is a bound video
session, then <code>queryPool</code> <strong>must</strong> have been created with a
<a href="videocoding.html#VkVideoProfileInfoKHR" class="xref page">VkVideoProfileInfoKHR</a> structure included in the <code>pNext</code> chain
of <a href="#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a> identical to the one specified in
<a href="videocoding.html#VkVideoSessionCreateInfoKHR" class="xref page">VkVideoSessionCreateInfoKHR</a>::<code>pVideoProfile</code> the bound video
session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-07129" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-07129"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-07129</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_VIDEO_ENCODE_FEEDBACK_KHR</code>, then there <strong>must</strong> be a
bound video session</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-07130" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-07130"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-07130</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_VIDEO_ENCODE_FEEDBACK_KHR</code> and there is a bound video
session, then <code>queryPool</code> <strong>must</strong> have been created with a
<a href="videocoding.html#VkVideoProfileInfoKHR" class="xref page">VkVideoProfileInfoKHR</a> structure included in the <code>pNext</code> chain
of <a href="#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a> identical to the one specified in
<a href="videocoding.html#VkVideoSessionCreateInfoKHR" class="xref page">VkVideoSessionCreateInfoKHR</a>::<code>pVideoProfile</code> the bound video
session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-07131" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-07131"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-07131</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was not
<code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code>
or <code>VK_QUERY_TYPE_VIDEO_ENCODE_FEEDBACK_KHR</code>,
then there <strong>must</strong> be no bound video session</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryPool-04753" href="#VUID-vkCmdBeginQueryIndexedEXT-queryPool-04753"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryPool-04753</span><br>

If the <code>queryPool</code> was created with the same <code>queryType</code> as that
of another <a href="#queries-operation-active">active</a> query within
<code>commandBuffer</code>, then <code>index</code> <strong>must</strong> not match the index used for
the active query</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-02338" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-02338"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-02338</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_TRANSFORM_FEEDBACK_STREAM_EXT</code> the
<code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong>
support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-02339" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-02339"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-02339</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_TRANSFORM_FEEDBACK_STREAM_EXT</code> the <code>index</code>
parameter <strong>must</strong> be less than
<code>VkPhysicalDeviceTransformFeedbackPropertiesEXT</code>::<code>maxTransformFeedbackStreams</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-06692" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-06692"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-06692</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was not
<code>VK_QUERY_TYPE_TRANSFORM_FEEDBACK_STREAM_EXT</code>
and not <code>VK_QUERY_TYPE_PRIMITIVES_GENERATED_EXT</code>,
the <code>index</code> <strong>must</strong> be zero</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-06689" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-06689"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-06689</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PRIMITIVES_GENERATED_EXT</code> the <code>VkCommandPool</code>
that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics
operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-06690" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-06690"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-06690</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PRIMITIVES_GENERATED_EXT</code> the <code>index</code> parameter
<strong>must</strong> be less than
<code>VkPhysicalDeviceTransformFeedbackPropertiesEXT</code>::<code>maxTransformFeedbackStreams</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-06691" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-06691"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-06691</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PRIMITIVES_GENERATED_EXT</code> and the
<a href="features.html#features-primitivesGeneratedQueryWithNonZeroStreams" class="xref page">    <code>primitivesGeneratedQueryWithNonZeroStreams</code></a> feature is not
enabled, the <code>index</code> parameter <strong>must</strong> be zero</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-06693" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-06693"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-06693</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PRIMITIVES_GENERATED_EXT</code> then
<a href="features.html#features-primitivesGeneratedQuery" class="xref page"><code>primitivesGeneratedQuery</code></a>
<strong>must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-02341" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-02341"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-02341</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_TRANSFORM_FEEDBACK_STREAM_EXT</code> then
<code>VkPhysicalDeviceTransformFeedbackPropertiesEXT</code>::<code>transformFeedbackQueries</code>
<strong>must</strong> be supported</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryType-07071" href="#VUID-vkCmdBeginQueryIndexedEXT-queryType-07071"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryType-07071</span><br>

The <code>queryType</code> used to create <code>queryPool</code> <strong>must</strong> not be
<code>VK_QUERY_TYPE_MESH_PRIMITIVES_GENERATED_EXT</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryPool-07289" href="#VUID-vkCmdBeginQueryIndexedEXT-queryPool-07289"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryPool-07289</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, then the
<a href="#VkQueryPoolPerformanceCreateInfoKHR">VkQueryPoolPerformanceCreateInfoKHR</a>::<code>queueFamilyIndex</code>
<code>queryPool</code> was created with <strong>must</strong> equal the queue family index of
the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryPool-03223" href="#VUID-vkCmdBeginQueryIndexedEXT-queryPool-03223"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryPool-03223</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, the <a href="#profiling-lock">    profiling lock</a> <strong>must</strong> have been held before <a href="cmdbuffers.html#vkBeginCommandBuffer" class="xref page">vkBeginCommandBuffer</a>
was called on <code>commandBuffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryPool-03224" href="#VUID-vkCmdBeginQueryIndexedEXT-queryPool-03224"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryPool-03224</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code> and one of the counters used
to create <code>queryPool</code> was
<code>VK_PERFORMANCE_COUNTER_SCOPE_COMMAND_BUFFER_KHR</code>, the query begin
<strong>must</strong> be the first recorded command in <code>commandBuffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryPool-03225" href="#VUID-vkCmdBeginQueryIndexedEXT-queryPool-03225"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryPool-03225</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code> and one of the counters used
to create <code>queryPool</code> was
<code>VK_PERFORMANCE_COUNTER_SCOPE_RENDER_PASS_KHR</code>, the begin command
<strong>must</strong> not be recorded within a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryPool-03226" href="#VUID-vkCmdBeginQueryIndexedEXT-queryPool-03226"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryPool-03226</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code> and another query pool with a
<code>queryType</code> <code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code> has been used
within <code>commandBuffer</code>, its parent primary command buffer or
secondary command buffer recorded within the same parent primary command
buffer as <code>commandBuffer</code>, the
<a href="features.html#features-performanceCounterMultipleQueryPools" class="xref page">    <code>performanceCounterMultipleQueryPools</code></a> feature <strong>must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-None-02863" href="#VUID-vkCmdBeginQueryIndexedEXT-None-02863"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-None-02863</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, this command <strong>must</strong> not be
recorded in a command buffer that, either directly or through secondary
command buffers, also contains a <code>vkCmdResetQueryPool</code> command
affecting the same query</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-commandBuffer-parameter" href="#VUID-vkCmdBeginQueryIndexedEXT-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-queryPool-parameter" href="#VUID-vkCmdBeginQueryIndexedEXT-queryPool-parameter"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-queryPool-parameter</span><br>
 <code>queryPool</code> <strong>must</strong> be a valid <a href="#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-flags-parameter" href="#VUID-vkCmdBeginQueryIndexedEXT-flags-parameter"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkQueryControlFlagBits">VkQueryControlFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-commandBuffer-recording" href="#VUID-vkCmdBeginQueryIndexedEXT-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-commandBuffer-cmdpool" href="#VUID-vkCmdBeginQueryIndexedEXT-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics, compute, decode, or encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-videocoding" href="#VUID-vkCmdBeginQueryIndexedEXT-videocoding"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQueryIndexedEXT-commonparent" href="#VUID-vkCmdBeginQueryIndexedEXT-commonparent"></a> <span class="vuid">VUID-vkCmdBeginQueryIndexedEXT-commonparent</span><br>
 Both of <code>commandBuffer</code>, and <code>queryPool</code> <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="videocoding.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute<br>
Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action<br>
State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in <a href="#vkCmdBeginQuery">vkCmdBeginQuery</a>::<code>flags</code>, specifying
constraints on the types of queries that <strong>can</strong> be performed, are:</p>
</div>
<div id="VkQueryControlFlagBits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef enum VkQueryControlFlagBits {
    VK_QUERY_CONTROL_PRECISE_BIT = 0x00000001,
} VkQueryControlFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_QUERY_CONTROL_PRECISE_BIT</code> specifies the precision of
<a href="#queries-occlusion">occlusion queries</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkQueryControlFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef VkFlags VkQueryControlFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkQueryControlFlags</code> is a bitmask type for setting a mask of zero or
more <a href="#VkQueryControlFlagBits">VkQueryControlFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To end a query after the set of desired drawing or dispatching commands is
executed, call:</p>
</div>
<div id="vkCmdEndQuery" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkCmdEndQuery(
    VkCommandBuffer                             commandBuffer,
    VkQueryPool                                 queryPool,
    uint32_t                                    query);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which this command will
be recorded.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool that is managing the results of the
query.</p>
</li>
<li>
<p><code>query</code> is the query index within the query pool where the result is
stored.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The command completes the query in <code>queryPool</code> identified by
<code>query</code>, and marks it as available.</p>
</div>
<div class="paragraph">
<p>This command defines an execution dependency between other query commands
that reference the same query.</p>
</div>
<div class="paragraph">
<p>The first <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization scope</a>
includes all commands which reference the queries in <code>queryPool</code>
indicated by <code>query</code> that occur earlier in
<a href="synchronization.html#synchronization-submission-order" class="xref page">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The second <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization scope</a>
includes only the operation of this command.</p>
</div>
<div class="paragraph">
<p>Calling <code>vkCmdEndQuery</code> is equivalent to calling
<a href="#vkCmdEndQueryIndexedEXT">vkCmdEndQueryIndexedEXT</a> with the <code>index</code> parameter set to zero.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdEndQuery-None-01923" href="#VUID-vkCmdEndQuery-None-01923"></a> <span class="vuid">VUID-vkCmdEndQuery-None-01923</span><br>

All queries used by the command <strong>must</strong> be
<a href="#queries-operation-active">active</a></p>
</li>
<li>
<p><a id="VUID-vkCmdEndQuery-query-00810" href="#VUID-vkCmdEndQuery-query-00810"></a> <span class="vuid">VUID-vkCmdEndQuery-query-00810</span><br>

<code>query</code> <strong>must</strong> be less than the number of queries in <code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEndQuery-commandBuffer-01886" href="#VUID-vkCmdEndQuery-commandBuffer-01886"></a> <span class="vuid">VUID-vkCmdEndQuery-commandBuffer-01886</span><br>

<code>commandBuffer</code> <strong>must</strong> not be a protected command buffer</p>
</li>
<li>
<p><a id="VUID-vkCmdEndQuery-query-00812" href="#VUID-vkCmdEndQuery-query-00812"></a> <span class="vuid">VUID-vkCmdEndQuery-query-00812</span><br>

If <code>vkCmdEndQuery</code> is called within a render pass instance, the sum
of <code>query</code> and the number of bits set in the current subpass&#8217;s view
mask <strong>must</strong> be less than or equal to the number of queries in
<code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEndQuery-queryPool-03227" href="#VUID-vkCmdEndQuery-queryPool-03227"></a> <span class="vuid">VUID-vkCmdEndQuery-queryPool-03227</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code> and one or more of the
counters used to create <code>queryPool</code> was
<code>VK_PERFORMANCE_COUNTER_SCOPE_COMMAND_BUFFER_KHR</code>, the
<a href="#vkCmdEndQuery">vkCmdEndQuery</a> <strong>must</strong> be the last recorded command in
<code>commandBuffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEndQuery-queryPool-03228" href="#VUID-vkCmdEndQuery-queryPool-03228"></a> <span class="vuid">VUID-vkCmdEndQuery-queryPool-03228</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code> and one or more of the
counters used to create <code>queryPool</code> was
<code>VK_PERFORMANCE_COUNTER_SCOPE_RENDER_PASS_KHR</code>, the
<a href="#vkCmdEndQuery">vkCmdEndQuery</a> <strong>must</strong> not be recorded within a render pass instance</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdEndQuery-None-07007" href="#VUID-vkCmdEndQuery-None-07007"></a> <span class="vuid">VUID-vkCmdEndQuery-None-07007</span><br>

If called within a subpass of a render pass instance, the corresponding
<code>vkCmdBeginQuery</code>* command <strong>must</strong> have been called previously within
the same subpass</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdEndQuery-commandBuffer-parameter" href="#VUID-vkCmdEndQuery-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdEndQuery-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdEndQuery-queryPool-parameter" href="#VUID-vkCmdEndQuery-queryPool-parameter"></a> <span class="vuid">VUID-vkCmdEndQuery-queryPool-parameter</span><br>
 <code>queryPool</code> <strong>must</strong> be a valid <a href="#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdEndQuery-commandBuffer-recording" href="#VUID-vkCmdEndQuery-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdEndQuery-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdEndQuery-commandBuffer-cmdpool" href="#VUID-vkCmdEndQuery-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdEndQuery-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics, compute, decode, or encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdEndQuery-commonparent" href="#VUID-vkCmdEndQuery-commonparent"></a> <span class="vuid">VUID-vkCmdEndQuery-commonparent</span><br>
 Both of <code>commandBuffer</code>, and <code>queryPool</code> <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="videocoding.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute<br>
Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action<br>
State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To end an indexed query after the set of desired drawing or dispatching
commands is recorded, call:</p>
</div>
<div id="vkCmdEndQueryIndexedEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_transform_feedback
void vkCmdEndQueryIndexedEXT(
    VkCommandBuffer                             commandBuffer,
    VkQueryPool                                 queryPool,
    uint32_t                                    query,
    uint32_t                                    index);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which this command will
be recorded.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool that is managing the results of the
query.</p>
</li>
<li>
<p><code>query</code> is the query index within the query pool where the result is
stored.</p>
</li>
<li>
<p><code>index</code> is the query type specific index.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The command completes the query in <code>queryPool</code> identified by <code>query</code>
and <code>index</code>, and marks it as available.</p>
</div>
<div class="paragraph">
<p>The <code>vkCmdEndQueryIndexedEXT</code> command operates the same as the
<a href="#vkCmdEndQuery">vkCmdEndQuery</a> command, except that it also accepts a query type
specific <code>index</code> parameter.</p>
</div>
<div class="paragraph">
<p>This command defines an execution dependency between other query commands
that reference the same query index.</p>
</div>
<div class="paragraph">
<p>The first <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization scope</a>
includes all commands which reference the queries in <code>queryPool</code>
indicated by <code>query</code> that occur earlier in
<a href="synchronization.html#synchronization-submission-order" class="xref page">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The second <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization scope</a>
includes only the operation of this command.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdEndQueryIndexedEXT-None-02342" href="#VUID-vkCmdEndQueryIndexedEXT-None-02342"></a> <span class="vuid">VUID-vkCmdEndQueryIndexedEXT-None-02342</span><br>

All queries used by the command <strong>must</strong> be
<a href="#queries-operation-active">active</a></p>
</li>
<li>
<p><a id="VUID-vkCmdEndQueryIndexedEXT-query-02343" href="#VUID-vkCmdEndQueryIndexedEXT-query-02343"></a> <span class="vuid">VUID-vkCmdEndQueryIndexedEXT-query-02343</span><br>

<code>query</code> <strong>must</strong> be less than the number of queries in <code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEndQueryIndexedEXT-commandBuffer-02344" href="#VUID-vkCmdEndQueryIndexedEXT-commandBuffer-02344"></a> <span class="vuid">VUID-vkCmdEndQueryIndexedEXT-commandBuffer-02344</span><br>

<code>commandBuffer</code> <strong>must</strong> not be a protected command buffer</p>
</li>
<li>
<p><a id="VUID-vkCmdEndQueryIndexedEXT-query-02345" href="#VUID-vkCmdEndQueryIndexedEXT-query-02345"></a> <span class="vuid">VUID-vkCmdEndQueryIndexedEXT-query-02345</span><br>

If <code>vkCmdEndQueryIndexedEXT</code> is called within a render pass
instance, the sum of <code>query</code> and the number of bits set in the
current subpass&#8217;s view mask <strong>must</strong> be less than or equal to the number of
queries in <code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEndQueryIndexedEXT-queryType-06694" href="#VUID-vkCmdEndQueryIndexedEXT-queryType-06694"></a> <span class="vuid">VUID-vkCmdEndQueryIndexedEXT-queryType-06694</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_TRANSFORM_FEEDBACK_STREAM_EXT</code>
or <code>VK_QUERY_TYPE_PRIMITIVES_GENERATED_EXT</code>,
the <code>index</code> parameter <strong>must</strong> be less than
<code>VkPhysicalDeviceTransformFeedbackPropertiesEXT</code>::<code>maxTransformFeedbackStreams</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEndQueryIndexedEXT-queryType-06695" href="#VUID-vkCmdEndQueryIndexedEXT-queryType-06695"></a> <span class="vuid">VUID-vkCmdEndQueryIndexedEXT-queryType-06695</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was not
<code>VK_QUERY_TYPE_TRANSFORM_FEEDBACK_STREAM_EXT</code>
and not <code>VK_QUERY_TYPE_PRIMITIVES_GENERATED_EXT</code>,
the <code>index</code> <strong>must</strong> be zero</p>
</li>
<li>
<p><a id="VUID-vkCmdEndQueryIndexedEXT-queryType-06696" href="#VUID-vkCmdEndQueryIndexedEXT-queryType-06696"></a> <span class="vuid">VUID-vkCmdEndQueryIndexedEXT-queryType-06696</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_TRANSFORM_FEEDBACK_STREAM_EXT</code>
or <code>VK_QUERY_TYPE_PRIMITIVES_GENERATED_EXT</code>,
<code>index</code> <strong>must</strong> equal the <code>index</code> used to begin the query</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdEndQueryIndexedEXT-None-07007" href="#VUID-vkCmdEndQueryIndexedEXT-None-07007"></a> <span class="vuid">VUID-vkCmdEndQueryIndexedEXT-None-07007</span><br>

If called within a subpass of a render pass instance, the corresponding
<code>vkCmdBeginQuery</code>* command <strong>must</strong> have been called previously within
the same subpass</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdEndQueryIndexedEXT-commandBuffer-parameter" href="#VUID-vkCmdEndQueryIndexedEXT-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdEndQueryIndexedEXT-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdEndQueryIndexedEXT-queryPool-parameter" href="#VUID-vkCmdEndQueryIndexedEXT-queryPool-parameter"></a> <span class="vuid">VUID-vkCmdEndQueryIndexedEXT-queryPool-parameter</span><br>
 <code>queryPool</code> <strong>must</strong> be a valid <a href="#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdEndQueryIndexedEXT-commandBuffer-recording" href="#VUID-vkCmdEndQueryIndexedEXT-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdEndQueryIndexedEXT-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdEndQueryIndexedEXT-commandBuffer-cmdpool" href="#VUID-vkCmdEndQueryIndexedEXT-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdEndQueryIndexedEXT-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics, compute, decode, or encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdEndQueryIndexedEXT-videocoding" href="#VUID-vkCmdEndQueryIndexedEXT-videocoding"></a> <span class="vuid">VUID-vkCmdEndQueryIndexedEXT-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdEndQueryIndexedEXT-commonparent" href="#VUID-vkCmdEndQueryIndexedEXT-commonparent"></a> <span class="vuid">VUID-vkCmdEndQueryIndexedEXT-commonparent</span><br>
 Both of <code>commandBuffer</code>, and <code>queryPool</code> <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="videocoding.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute<br>
Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action<br>
State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="queries-operation-memorylayout" class="paragraph">
<p>An application <strong>can</strong> retrieve results either by requesting they be written
into application-provided memory, or by requesting they be copied into a
<code>VkBuffer</code>.
In either case, the layout in memory is defined as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first query&#8217;s result is written starting at the first byte requested
by the command, and each subsequent query&#8217;s result begins <code>stride</code>
bytes later.</p>
</li>
<li>
<p>Occlusion queries, pipeline statistics queries,
transform feedback queries,
primitives generated queries,
mesh shader queries,
video encode feedback queries,
and timestamp queries store results in a tightly packed array of
unsigned integers, either 32- or 64-bits as requested by the command,
storing the numerical results and, if requested, the availability
status.</p>
</li>
<li>
<p>Performance queries store results in a tightly packed array whose type
is determined by the <code>unit</code> member of the corresponding
<a href="devsandqueues.html#VkPerformanceCounterKHR" class="xref page">VkPerformanceCounterKHR</a>.</p>
</li>
<li>
<p>If <code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code> is used, the final
element of each query&#8217;s result is an integer indicating whether the
query&#8217;s result is available, with any non-zero value indicating that it
is available.</p>
</li>
<li>
<p>If <code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code> is used, the final element
of each query&#8217;s result is an integer value indicating that status of the
query result.
Positive values indicate success, negative values indicate failure, and
0 indicates that the result is not yet available.
Specific error codes are encoded in the <a href="#VkQueryResultStatusKHR">VkQueryResultStatusKHR</a>
enumeration.</p>
</li>
<li>
<p>Occlusion queries write one integer value - the number of samples
passed.
Pipeline statistics queries write one integer value for each bit that is
enabled in the <code>pipelineStatistics</code> when the pool is created, and
the statistics values are written in bit order starting from the least
significant bit.
Timestamp queries write one integer value.
Performance queries write one <a href="#VkPerformanceCounterResultKHR">VkPerformanceCounterResultKHR</a> value
for each <a href="devsandqueues.html#VkPerformanceCounterKHR" class="xref page">VkPerformanceCounterKHR</a> in the query.
Transform feedback queries write two integers; the first integer is the
number of primitives successfully written to the corresponding transform
feedback buffer and the second is the number of primitives output to the
vertex stream, regardless of whether they were successfully captured or
not.
In other words, if the transform feedback buffer was sized too small for
the number of primitives output by the vertex stream, the first integer
represents the number of primitives actually written and the second is
the number that would have been written if all the transform feedback
buffers associated with that vertex stream were large enough.
Primitives generated queries write the number of primitives output to
the vertex stream, regardless of whether transform feedback is active or
not, or whether they were successfully captured by transform feedback or
not.
This is identical to the second integer of the transform feedback
queries if transform feedback is active.
Mesh shader queries write a single integer.
Video encode feedback queries write one or more integer values for each
bit that is enabled in
<a href="#VkQueryPoolVideoEncodeFeedbackCreateInfoKHR">VkQueryPoolVideoEncodeFeedbackCreateInfoKHR</a>::<code>encodeFeedbackFlags</code>
when the pool is created, and the feedback values are written in bit
order starting from the least significant bit, as described
<a href="#queries-video-encode-feedback">here</a>.</p>
</li>
<li>
<p>If more than one query is retrieved and <code>stride</code> is not at least as
large as the size of the array of values corresponding to a single
query, the values written to memory are <strong>undefined</strong>.</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To retrieve status and results for a set of queries, call:</p>
</div>
<div id="vkGetQueryPoolResults" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
VkResult vkGetQueryPoolResults(
    VkDevice                                    device,
    VkQueryPool                                 queryPool,
    uint32_t                                    firstQuery,
    uint32_t                                    queryCount,
    size_t                                      dataSize,
    void*                                       pData,
    VkDeviceSize                                stride,
    VkQueryResultFlags                          flags);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the query pool.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool managing the queries containing the
desired results.</p>
</li>
<li>
<p><code>firstQuery</code> is the initial query index.</p>
</li>
<li>
<p><code>queryCount</code> is the number of queries to read.</p>
</li>
<li>
<p><code>dataSize</code> is the size in bytes of the buffer pointed to by
<code>pData</code>.</p>
</li>
<li>
<p><code>pData</code> is a pointer to a user-allocated buffer where the results
will be written</p>
</li>
<li>
<p><code>stride</code> is the stride in bytes between results for individual
queries within <code>pData</code>.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkQueryResultFlagBits">VkQueryResultFlagBits</a> specifying how
and when results are returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any results written for a query are written according to
<a href="#queries-operation-memorylayout">a layout dependent on the query type</a>.</p>
</div>
<div class="paragraph">
<p>If no bits are set in <code>flags</code>, and all requested queries are in the
available state, results are written as an array of 32-bit unsigned integer
values.
Behavior when not all queries are available is described
<a href="#queries-wait-bit-not-set">below</a>.</p>
</div>
<div class="paragraph">
<p>If <code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code> is set, results for all
queries in <code>queryPool</code> identified by <code>firstQuery</code> and
<code>queryCount</code> are copied to <code>pData</code>, along with an extra availability
or status
value written directly after the results of each query and interpreted as an
unsigned integer.
A value of zero indicates that the results are not yet available, otherwise
the query is complete and results are available.
The size of the availability
or status
values is 64 bits if <code>VK_QUERY_RESULT_64_BIT</code> is set in <code>flags</code>.
Otherwise, it is 32 bits.</p>
</div>
<div class="paragraph">
<p>If <code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code> is set, results for all queries
in <code>queryPool</code> identified by <code>firstQuery</code> and <code>queryCount</code> are
copied to <code>pData</code>, along with an extra status value written directly
after the results of each query and interpreted as a signed integer.
A value of zero indicates that the results are not yet available.
Positive values indicate that the operations within the query completed
successfully, and the query results are valid.
Negative values indicate that the operations within the query completed
unsuccessfully.</p>
</div>
<div class="paragraph">
<p><a href="#VkQueryResultStatusKHR">VkQueryResultStatusKHR</a> defines specific meaning for values returned
here, though implementations are free to return other values.</p>
</div>
<div class="paragraph">
<p>If the status value written is negative, indicating that the operations
within the query completed unsuccessfully, then all other results written by
this command are <strong>undefined</strong> unless otherwise specified for any of the
results of the used query type.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>If <code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code>
or <code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code>
is set, the layout of data in the buffer is a <em>(result,availability)</em>
or <em>(result,status)</em>
pair for each query returned, and <code>stride</code> is the stride between each
pair.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Results for any available query written by this command are final and
represent the final result of the query.
If <code>VK_QUERY_RESULT_PARTIAL_BIT</code> is set, then for any query that is
unavailable, an intermediate result between zero and the final result value
is written for that query.
Otherwise, any result written by this command is <strong>undefined</strong>.</p>
</div>
<div class="paragraph">
<p>If <code>VK_QUERY_RESULT_64_BIT</code> is set, results and, if returned,
availability
or status
values for all queries are written as an array of 64-bit values.
If the <code>queryPool</code> was created with
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, results for each query are
written as an array of the type indicated by
<a href="devsandqueues.html#VkPerformanceCounterKHR" class="xref page">VkPerformanceCounterKHR</a>::<code>storage</code> for the counter being queried.
Otherwise, results and availability
or status
values are written as an array of 32-bit values.
If an unsigned integer query&#8217;s value overflows the result type, the value
<strong>may</strong> either wrap or saturate.
If a signed integer query&#8217;s value overflows the result type, the value is
<strong>undefined</strong>.
If a floating point query&#8217;s value is not representable as the result type,
the value is <strong>undefined</strong>.</p>
</div>
<div class="paragraph">
<p>If <code>VK_QUERY_RESULT_WAIT_BIT</code> is set, this command defines an execution
dependency with any earlier commands that writes one of the identified
queries.
The first <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization scope</a>
includes all instances of <a href="#vkCmdEndQuery">vkCmdEndQuery</a>,
<a href="#vkCmdEndQueryIndexedEXT">vkCmdEndQueryIndexedEXT</a>,
<a href="#vkCmdWriteTimestamp2">vkCmdWriteTimestamp2</a>,
and <a href="#vkCmdWriteTimestamp">vkCmdWriteTimestamp</a> that reference any query in <code>queryPool</code>
indicated by <code>firstQuery</code> and <code>queryCount</code>.
The second <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization scope</a>
includes the host operations of this command.</p>
</div>
<div id="queries-wait-bit-not-set" class="paragraph">
<p>If <code>VK_QUERY_RESULT_WAIT_BIT</code> is not set, <code>vkGetQueryPoolResults</code>
<strong>may</strong> return <code>VK_NOT_READY</code> if there are queries in the unavailable
state.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications <strong>must</strong> take care to ensure that use of the
<code>VK_QUERY_RESULT_WAIT_BIT</code> bit has the desired effect.</p>
</div>
<div class="paragraph">
<p>For example, if a query has been used previously and a command buffer
records the commands <code>vkCmdResetQueryPool</code>, <code>vkCmdBeginQuery</code>, and
<code>vkCmdEndQuery</code> for that query, then the query will remain in the
available state until
<code>vkResetQueryPool</code> is called or
the <code>vkCmdResetQueryPool</code> command executes on a queue.
Applications <strong>can</strong> use fences or events to ensure that a query has already
been reset before checking for its results or availability status.
Otherwise, a stale value could be returned from a previous use of the query.</p>
</div>
<div class="paragraph">
<p>The above also applies when <code>VK_QUERY_RESULT_WAIT_BIT</code> is used in
combination with <code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code>.
In this case, the returned availability status <strong>may</strong> reflect the result of a
previous use of the query unless
<code>vkResetQueryPool</code> is called or
the <code>vkCmdResetQueryPool</code> command has been executed since the last use
of the query.</p>
</div>
<div class="paragraph">
<p>A similar situation can arise with the
<code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code> flag.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications <strong>can</strong> double-buffer query pool usage, with a pool per frame, and
reset queries at the end of the frame in which they are read.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetQueryPoolResults-firstQuery-09436" href="#VUID-vkGetQueryPoolResults-firstQuery-09436"></a> <span class="vuid">VUID-vkGetQueryPoolResults-firstQuery-09436</span><br>

<code>firstQuery</code> <strong>must</strong> be less than the number of queries in
<code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-firstQuery-09437" href="#VUID-vkGetQueryPoolResults-firstQuery-09437"></a> <span class="vuid">VUID-vkGetQueryPoolResults-firstQuery-09437</span><br>

The sum of <code>firstQuery</code> and <code>queryCount</code> <strong>must</strong> be less than or
equal to the number of queries in <code>queryPool</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetQueryPoolResults-queryCount-09438" href="#VUID-vkGetQueryPoolResults-queryCount-09438"></a> <span class="vuid">VUID-vkGetQueryPoolResults-queryCount-09438</span><br>

If <code>queryCount</code> is greater than 1, <code>stride</code> <strong>must</strong> not be zero</p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-queryType-09439" href="#VUID-vkGetQueryPoolResults-queryType-09439"></a> <span class="vuid">VUID-vkGetQueryPoolResults-queryType-09439</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_TIMESTAMP</code>, <code>flags</code> <strong>must</strong> not contain
<code>VK_QUERY_RESULT_PARTIAL_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-queryType-09440" href="#VUID-vkGetQueryPoolResults-queryType-09440"></a> <span class="vuid">VUID-vkGetQueryPoolResults-queryType-09440</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, <code>flags</code> <strong>must</strong> not contain
<code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code>,
<code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code>,
<code>VK_QUERY_RESULT_PARTIAL_BIT</code>, or <code>VK_QUERY_RESULT_64_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-queryType-09441" href="#VUID-vkGetQueryPoolResults-queryType-09441"></a> <span class="vuid">VUID-vkGetQueryPoolResults-queryType-09441</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, the <code>queryPool</code> <strong>must</strong>
have been recorded once for each pass as retrieved via a call to
<a href="#vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR">vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR</a></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-queryType-09442" href="#VUID-vkGetQueryPoolResults-queryType-09442"></a> <span class="vuid">VUID-vkGetQueryPoolResults-queryType-09442</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code>, then <code>flags</code> <strong>must</strong>
include <code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-flags-09443" href="#VUID-vkGetQueryPoolResults-flags-09443"></a> <span class="vuid">VUID-vkGetQueryPoolResults-flags-09443</span><br>

If <code>flags</code> includes <code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code>, then
it <strong>must</strong> not include <code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetQueryPoolResults-None-09401" href="#VUID-vkGetQueryPoolResults-None-09401"></a> <span class="vuid">VUID-vkGetQueryPoolResults-None-09401</span><br>

All queries used by the command <strong>must</strong> not be uninitialized</p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-flags-02828" href="#VUID-vkGetQueryPoolResults-flags-02828"></a> <span class="vuid">VUID-vkGetQueryPoolResults-flags-02828</span><br>

If <code>VK_QUERY_RESULT_64_BIT</code> is not set in <code>flags</code>
and the <code>queryType</code> used to create <code>queryPool</code> was not
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>,
then <code>pData</code> and <code>stride</code> <strong>must</strong> be multiples of <code>4</code></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-flags-00815" href="#VUID-vkGetQueryPoolResults-flags-00815"></a> <span class="vuid">VUID-vkGetQueryPoolResults-flags-00815</span><br>

If <code>VK_QUERY_RESULT_64_BIT</code> is set in <code>flags</code> then <code>pData</code>
and <code>stride</code> <strong>must</strong> be multiples of <code>8</code></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-stride-08993" href="#VUID-vkGetQueryPoolResults-stride-08993"></a> <span class="vuid">VUID-vkGetQueryPoolResults-stride-08993</span><br>

    If <code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code> is set, <code>stride</code>
    <strong>must</strong> be large enough to contain the unsigned integer representing
    availability
or status
    in addition to the query result</p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-queryType-03229" href="#VUID-vkGetQueryPoolResults-queryType-03229"></a> <span class="vuid">VUID-vkGetQueryPoolResults-queryType-03229</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, then <code>pData</code> and
<code>stride</code> <strong>must</strong> be multiples of the size of
<a href="#VkPerformanceCounterResultKHR">VkPerformanceCounterResultKHR</a></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-queryType-04519" href="#VUID-vkGetQueryPoolResults-queryType-04519"></a> <span class="vuid">VUID-vkGetQueryPoolResults-queryType-04519</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, then <code>stride</code> <strong>must</strong> be
large enough to contain the
<a href="#VkQueryPoolPerformanceCreateInfoKHR">VkQueryPoolPerformanceCreateInfoKHR</a>::<code>counterIndexCount</code> used
to create <code>queryPool</code> times the size of
<a href="#VkPerformanceCounterResultKHR">VkPerformanceCounterResultKHR</a></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-dataSize-00817" href="#VUID-vkGetQueryPoolResults-dataSize-00817"></a> <span class="vuid">VUID-vkGetQueryPoolResults-dataSize-00817</span><br>

<code>dataSize</code> <strong>must</strong> be large enough to contain the result of each
query, as described <a href="#queries-operation-memorylayout">here</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetQueryPoolResults-device-parameter" href="#VUID-vkGetQueryPoolResults-device-parameter"></a> <span class="vuid">VUID-vkGetQueryPoolResults-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-queryPool-parameter" href="#VUID-vkGetQueryPoolResults-queryPool-parameter"></a> <span class="vuid">VUID-vkGetQueryPoolResults-queryPool-parameter</span><br>
 <code>queryPool</code> <strong>must</strong> be a valid <a href="#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-pData-parameter" href="#VUID-vkGetQueryPoolResults-pData-parameter"></a> <span class="vuid">VUID-vkGetQueryPoolResults-pData-parameter</span><br>
 <code>pData</code> <strong>must</strong> be a valid pointer to an array of <code>dataSize</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-flags-parameter" href="#VUID-vkGetQueryPoolResults-flags-parameter"></a> <span class="vuid">VUID-vkGetQueryPoolResults-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkQueryResultFlagBits">VkQueryResultFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-dataSize-arraylength" href="#VUID-vkGetQueryPoolResults-dataSize-arraylength"></a> <span class="vuid">VUID-vkGetQueryPoolResults-dataSize-arraylength</span><br>
 <code>dataSize</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-queryPool-parent" href="#VUID-vkGetQueryPoolResults-queryPool-parent"></a> <span class="vuid">VUID-vkGetQueryPoolResults-queryPool-parent</span><br>
 <code>queryPool</code> <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_NOT_READY</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in <a href="#vkGetQueryPoolResults">vkGetQueryPoolResults</a>::<code>flags</code> and
<a href="#vkCmdCopyQueryPoolResults">vkCmdCopyQueryPoolResults</a>::<code>flags</code>, specifying how and when
results are returned, are:</p>
</div>
<div id="VkQueryResultFlagBits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef enum VkQueryResultFlagBits {
    VK_QUERY_RESULT_64_BIT = 0x00000001,
    VK_QUERY_RESULT_WAIT_BIT = 0x00000002,
    VK_QUERY_RESULT_WITH_AVAILABILITY_BIT = 0x00000004,
    VK_QUERY_RESULT_PARTIAL_BIT = 0x00000008,
  // Provided by VK_KHR_video_queue
    VK_QUERY_RESULT_WITH_STATUS_BIT_KHR = 0x00000010,
} VkQueryResultFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_QUERY_RESULT_64_BIT</code> specifies the results will be written as an
array of 64-bit unsigned integer values.
If this bit is not set, the results will be written as an array of
32-bit unsigned integer values.</p>
</li>
<li>
<p><code>VK_QUERY_RESULT_WAIT_BIT</code> specifies that Vulkan will wait for each
query&#8217;s status to become available before retrieving its results.</p>
</li>
<li>
<p><code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code> specifies that the
availability status accompanies the results.</p>
</li>
<li>
<p><code>VK_QUERY_RESULT_PARTIAL_BIT</code> specifies that returning partial
results is acceptable.</p>
</li>
<li>
<p><code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code> specifies that the last value
returned in the query is a <a href="#VkQueryResultStatusKHR">VkQueryResultStatusKHR</a> value.
See <a href="#queries-result-status-only">result status query</a> for information
on how an application can determine whether the use of this flag bit is
supported.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkQueryResultFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef VkFlags VkQueryResultFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkQueryResultFlags</code> is a bitmask type for setting a mask of zero or
more <a href="#VkQueryResultFlagBits">VkQueryResultFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="query-result-status-codes" class="paragraph">
<p>Specific status codes that <strong>can</strong> be returned from a query are:</p>
</div>
<div id="VkQueryResultStatusKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_queue
typedef enum VkQueryResultStatusKHR {
    VK_QUERY_RESULT_STATUS_ERROR_KHR = -1,
    VK_QUERY_RESULT_STATUS_NOT_READY_KHR = 0,
    VK_QUERY_RESULT_STATUS_COMPLETE_KHR = 1,
  // Provided by VK_KHR_video_encode_queue
    VK_QUERY_RESULT_STATUS_INSUFFICIENT_BITSTREAM_BUFFER_RANGE_KHR = -1000299000,
} VkQueryResultStatusKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_QUERY_RESULT_STATUS_NOT_READY_KHR</code> indicates that the query
result is not yet available.</p>
</li>
<li>
<p><code>VK_QUERY_RESULT_STATUS_ERROR_KHR</code> indicates that operations did not
complete successfully.</p>
</li>
<li>
<p><code>VK_QUERY_RESULT_STATUS_COMPLETE_KHR</code> indicates that operations
completed successfully and the query result is available.</p>
</li>
<li>
<p><code>VK_QUERY_RESULT_STATUS_INSUFFICIENT_BITSTREAM_BUFFER_RANGE_KHR</code>
indicates that a video encode operation did not complete successfully
due to the destination video bitstream buffer range not being
sufficiently large to fit the encoded bitstream data.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy query statuses and numerical results directly to buffer memory,
call:</p>
</div>
<div id="vkCmdCopyQueryPoolResults" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkCmdCopyQueryPoolResults(
    VkCommandBuffer                             commandBuffer,
    VkQueryPool                                 queryPool,
    uint32_t                                    firstQuery,
    uint32_t                                    queryCount,
    VkBuffer                                    dstBuffer,
    VkDeviceSize                                dstOffset,
    VkDeviceSize                                stride,
    VkQueryResultFlags                          flags);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which this command will
be recorded.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool managing the queries containing the
desired results.</p>
</li>
<li>
<p><code>firstQuery</code> is the initial query index.</p>
</li>
<li>
<p><code>queryCount</code> is the number of queries.
<code>firstQuery</code> and <code>queryCount</code> together define a range of
queries.</p>
</li>
<li>
<p><code>dstBuffer</code> is a <a href="resources.html#VkBuffer" class="xref page">VkBuffer</a> object that will receive the results
of the copy command.</p>
</li>
<li>
<p><code>dstOffset</code> is an offset into <code>dstBuffer</code>.</p>
</li>
<li>
<p><code>stride</code> is the stride in bytes between results for individual
queries within <code>dstBuffer</code>.
The required size of the backing memory for <code>dstBuffer</code> is
determined as described above for <a href="#vkGetQueryPoolResults">vkGetQueryPoolResults</a>.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkQueryResultFlagBits">VkQueryResultFlagBits</a> specifying how
and when results are returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any results written for a query are written according to
<a href="#queries-operation-memorylayout">a layout dependent on the query type</a>.</p>
</div>
<div class="paragraph">
<p>Results for any query in <code>queryPool</code> identified by <code>firstQuery</code> and
<code>queryCount</code> that is available are copied to <code>dstBuffer</code>.</p>
</div>
<div class="paragraph">
<p>If <code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code> is set, results for all
queries in <code>queryPool</code> identified by <code>firstQuery</code> and
<code>queryCount</code> are copied to <code>dstBuffer</code>, along with an extra
availability value written directly after the results of each query and
interpreted as an unsigned integer.
A value of zero indicates that the results are not yet available, otherwise
the query is complete and results are available.</p>
</div>
<div class="paragraph">
<p>If <code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code> is set, results for all queries
in <code>queryPool</code> identified by <code>firstQuery</code> and <code>queryCount</code> are
copied to <code>dstBuffer</code>, along with an extra status value written directly
after the results of each query and interpreted as a signed integer.
A value of zero indicates that the results are not yet available.
Positive values indicate that the operations within the query completed
successfully, and the query results are valid.
Negative values indicate that the operations within the query completed
unsuccessfully.</p>
</div>
<div class="paragraph">
<p><a href="#VkQueryResultStatusKHR">VkQueryResultStatusKHR</a> defines specific meaning for values returned
here, though implementations are free to return other values.</p>
</div>
<div class="paragraph">
<p>If the status value written is negative, indicating that the operations
within the query completed unsuccessfully, then all other results written by
this command are <strong>undefined</strong> unless otherwise specified for any of the
results of the used query type.</p>
</div>
<div class="paragraph">
<p>Results for any available query written by this command are final and
represent the final result of the query.
If <code>VK_QUERY_RESULT_PARTIAL_BIT</code> is set, then for any query that is
unavailable, an intermediate result between zero and the final result value
is written for that query.
Otherwise, any result written by this command is <strong>undefined</strong>.</p>
</div>
<div class="paragraph">
<p>If <code>VK_QUERY_RESULT_64_BIT</code> is set, results and availability
or status
values for all queries are written as an array of 64-bit values.
If the <code>queryPool</code> was created with
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, results for each query are
written as an array of the type indicated by
<a href="devsandqueues.html#VkPerformanceCounterKHR" class="xref page">VkPerformanceCounterKHR</a>::<code>storage</code> for the counter being queried.
Otherwise, results and availability
or status
values are written as an array of 32-bit values.
If an unsigned integer query&#8217;s value overflows the result type, the value
<strong>may</strong> either wrap or saturate.
If a signed integer query&#8217;s value overflows the result type, the value is
<strong>undefined</strong>.
If a floating point query&#8217;s value is not representable as the result type,
the value is <strong>undefined</strong>.</p>
</div>
<div class="paragraph">
<p>This command defines an execution dependency between other query commands
that reference the same query.</p>
</div>
<div class="paragraph">
<p>The first <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization scope</a>
includes all commands which reference the queries in <code>queryPool</code>
indicated by <code>query</code> that occur earlier in
<a href="synchronization.html#synchronization-submission-order" class="xref page">submission order</a>.
If <code>flags</code> does not include <code>VK_QUERY_RESULT_WAIT_BIT</code>,
<a href="#vkCmdEndQueryIndexedEXT">vkCmdEndQueryIndexedEXT</a>,
<a href="#vkCmdWriteTimestamp2">vkCmdWriteTimestamp2</a>,
<a href="#vkCmdEndQuery">vkCmdEndQuery</a>, and <a href="#vkCmdWriteTimestamp">vkCmdWriteTimestamp</a> are excluded from this
scope.</p>
</div>
<div class="paragraph">
<p>The second <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization scope</a>
includes all commands which reference the queries in <code>queryPool</code>
indicated by <code>query</code> that occur later in
<a href="synchronization.html#synchronization-submission-order" class="xref page">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The operation of this command happens after the first scope and happens
before the second scope.</p>
</div>
<div class="paragraph">
<p><code>vkCmdCopyQueryPoolResults</code> is considered to be a transfer operation,
and its writes to buffer memory <strong>must</strong> be synchronized using
<code>VK_PIPELINE_STAGE_TRANSFER_BIT</code> and <code>VK_ACCESS_TRANSFER_WRITE_BIT</code>
before using the results.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-firstQuery-09436" href="#VUID-vkCmdCopyQueryPoolResults-firstQuery-09436"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-firstQuery-09436</span><br>

<code>firstQuery</code> <strong>must</strong> be less than the number of queries in
<code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-firstQuery-09437" href="#VUID-vkCmdCopyQueryPoolResults-firstQuery-09437"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-firstQuery-09437</span><br>

The sum of <code>firstQuery</code> and <code>queryCount</code> <strong>must</strong> be less than or
equal to the number of queries in <code>queryPool</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-queryCount-09438" href="#VUID-vkCmdCopyQueryPoolResults-queryCount-09438"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-queryCount-09438</span><br>

If <code>queryCount</code> is greater than 1, <code>stride</code> <strong>must</strong> not be zero</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-queryType-09439" href="#VUID-vkCmdCopyQueryPoolResults-queryType-09439"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-queryType-09439</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_TIMESTAMP</code>, <code>flags</code> <strong>must</strong> not contain
<code>VK_QUERY_RESULT_PARTIAL_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-queryType-09440" href="#VUID-vkCmdCopyQueryPoolResults-queryType-09440"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-queryType-09440</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, <code>flags</code> <strong>must</strong> not contain
<code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code>,
<code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code>,
<code>VK_QUERY_RESULT_PARTIAL_BIT</code>, or <code>VK_QUERY_RESULT_64_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-queryType-09441" href="#VUID-vkCmdCopyQueryPoolResults-queryType-09441"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-queryType-09441</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, the <code>queryPool</code> <strong>must</strong>
have been recorded once for each pass as retrieved via a call to
<a href="#vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR">vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR</a></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-queryType-09442" href="#VUID-vkCmdCopyQueryPoolResults-queryType-09442"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-queryType-09442</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code>, then <code>flags</code> <strong>must</strong>
include <code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-flags-09443" href="#VUID-vkCmdCopyQueryPoolResults-flags-09443"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-flags-09443</span><br>

If <code>flags</code> includes <code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code>, then
it <strong>must</strong> not include <code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-None-09402" href="#VUID-vkCmdCopyQueryPoolResults-None-09402"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-None-09402</span><br>

All queries used by the command <strong>must</strong> not be uninitialized when the
command is executed</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-dstOffset-00819" href="#VUID-vkCmdCopyQueryPoolResults-dstOffset-00819"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-dstOffset-00819</span><br>

<code>dstOffset</code> <strong>must</strong> be less than the size of <code>dstBuffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-flags-00822" href="#VUID-vkCmdCopyQueryPoolResults-flags-00822"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-flags-00822</span><br>

If <code>VK_QUERY_RESULT_64_BIT</code> is not set in <code>flags</code> then
<code>dstOffset</code> and <code>stride</code> <strong>must</strong> be multiples of <code>4</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-flags-00823" href="#VUID-vkCmdCopyQueryPoolResults-flags-00823"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-flags-00823</span><br>

If <code>VK_QUERY_RESULT_64_BIT</code> is set in <code>flags</code> then
<code>dstOffset</code> and <code>stride</code> <strong>must</strong> be multiples of <code>8</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-dstBuffer-00824" href="#VUID-vkCmdCopyQueryPoolResults-dstBuffer-00824"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-dstBuffer-00824</span><br>

<code>dstBuffer</code> <strong>must</strong> have enough storage, from <code>dstOffset</code>, to
contain the result of each query, as described
<a href="#queries-operation-memorylayout">here</a></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-dstBuffer-00825" href="#VUID-vkCmdCopyQueryPoolResults-dstBuffer-00825"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-dstBuffer-00825</span><br>

<code>dstBuffer</code> <strong>must</strong> have been created with
<code>VK_BUFFER_USAGE_TRANSFER_DST_BIT</code> usage flag</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-dstBuffer-00826" href="#VUID-vkCmdCopyQueryPoolResults-dstBuffer-00826"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-dstBuffer-00826</span><br>

If <code>dstBuffer</code> is non-sparse then it <strong>must</strong> be bound completely and
contiguously to a single <code>VkDeviceMemory</code> object</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-queryType-03232" href="#VUID-vkCmdCopyQueryPoolResults-queryType-03232"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-queryType-03232</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>,
<a href="limits.html#VkPhysicalDevicePerformanceQueryPropertiesKHR" class="xref page">VkPhysicalDevicePerformanceQueryPropertiesKHR</a>::<code>allowCommandBufferQueryCopies</code>
<strong>must</strong> be <code>VK_TRUE</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-queryType-02734" href="#VUID-vkCmdCopyQueryPoolResults-queryType-02734"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-queryType-02734</span><br>

<a href="#vkCmdCopyQueryPoolResults">vkCmdCopyQueryPoolResults</a> <strong>must</strong> not be called if the
<code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_INTEL</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-None-07429" href="#VUID-vkCmdCopyQueryPoolResults-None-07429"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-None-07429</span><br>

All queries used by the command <strong>must</strong> not be active</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-None-08752" href="#VUID-vkCmdCopyQueryPoolResults-None-08752"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-None-08752</span><br>

All queries used by the command <strong>must</strong> have been made <em>available</em> by
prior executed commands</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-commandBuffer-parameter" href="#VUID-vkCmdCopyQueryPoolResults-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-queryPool-parameter" href="#VUID-vkCmdCopyQueryPoolResults-queryPool-parameter"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-queryPool-parameter</span><br>
 <code>queryPool</code> <strong>must</strong> be a valid <a href="#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-dstBuffer-parameter" href="#VUID-vkCmdCopyQueryPoolResults-dstBuffer-parameter"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-dstBuffer-parameter</span><br>
 <code>dstBuffer</code> <strong>must</strong> be a valid <a href="resources.html#VkBuffer" class="xref page">VkBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-flags-parameter" href="#VUID-vkCmdCopyQueryPoolResults-flags-parameter"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkQueryResultFlagBits">VkQueryResultFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-commandBuffer-recording" href="#VUID-vkCmdCopyQueryPoolResults-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-commandBuffer-cmdpool" href="#VUID-vkCmdCopyQueryPoolResults-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics, or compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-renderpass" href="#VUID-vkCmdCopyQueryPoolResults-renderpass"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-renderpass</span><br>
 This command <strong>must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-videocoding" href="#VUID-vkCmdCopyQueryPoolResults-videocoding"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-commonparent" href="#VUID-vkCmdCopyQueryPoolResults-commonparent"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-commonparent</span><br>
 Each of <code>commandBuffer</code>, <code>dstBuffer</code>, and <code>queryPool</code> <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="videocoding.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="queries-operation-undefined" class="paragraph">
<p>Rendering operations such as clears, MSAA resolves, attachment load/store
operations, and blits <strong>may</strong> count towards the results of queries.
This behavior is implementation-dependent and <strong>may</strong> vary depending on the
path used within an implementation.
For example, some implementations have several types of clears, some of
which <strong>may</strong> include vertices and some not.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="queries-occlusion"><a class="anchor" href="#queries-occlusion"></a>Occlusion Queries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Occlusion queries track the number of samples that pass the per-fragment
tests for a set of drawing commands.
As such, occlusion queries are only available on queue families supporting
graphics operations.
The application <strong>can</strong> then use these results to inform future rendering
decisions.
An occlusion query is begun and ended by calling <code>vkCmdBeginQuery</code> and
<code>vkCmdEndQuery</code>, respectively.
When an occlusion query begins, the count of passing samples always starts
at zero.
For each drawing command, the count is incremented as described in
<a href="fragops.html#fragops-samplecount" class="xref page">Sample Counting</a>.
If <code>flags</code> does not contain <code>VK_QUERY_CONTROL_PRECISE_BIT</code> an
implementation <strong>may</strong> generate any non-zero result value for the query if the
count of passing samples is non-zero.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Not setting <code>VK_QUERY_CONTROL_PRECISE_BIT</code> mode <strong>may</strong> be more efficient
on some implementations, and <strong>should</strong> be used where it is sufficient to know
a boolean result on whether any samples passed the per-fragment tests.
In this case, some implementations <strong>may</strong> only return zero or one, indifferent
to the actual number of samples passing the per-fragment tests.</p>
</div>
<div class="paragraph">
<p>Setting <code>VK_QUERY_CONTROL_PRECISE_BIT</code> does not guarantee that different
implementations return the same number of samples in an occlusion query.
Some implementations may kill fragments in the
<a href="pipelines.html#pipelines-graphics-subsets-pre-rasterization" class="xref page">pre-rasterization shader stage</a>, and these killed fragments do not contribute to the final result of
the query.
It is possible that some implementations generate a zero result value for
the query, while others generate a non-zero value.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When an occlusion query finishes, the result for that query is marked as
available.
The application <strong>can</strong> then either copy the result to a buffer (via
<code>vkCmdCopyQueryPoolResults</code>) or request it be put into host memory (via
<code>vkGetQueryPoolResults</code>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>If occluding geometry is not drawn first, samples <strong>can</strong> pass the depth test,
but still not be visible in a final image.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="queries-pipestats"><a class="anchor" href="#queries-pipestats"></a>Pipeline Statistics Queries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Pipeline statistics queries allow the application to sample a specified set
of <code>VkPipeline</code> counters.
These counters are accumulated by Vulkan for a set of either drawing or
dispatching commands while a pipeline statistics query is active.
As such, pipeline statistics queries are available on queue families
supporting either graphics or compute operations.
The availability of pipeline statistics queries is indicated by the
<code>pipelineStatisticsQuery</code> member of the <code>VkPhysicalDeviceFeatures</code>
object (see <code>vkGetPhysicalDeviceFeatures</code> and <code>vkCreateDevice</code> for
detecting and requesting this query type on a <code>VkDevice</code>).</p>
</div>
<div class="paragraph">
<p>A pipeline statistics query is begun and ended by calling
<code>vkCmdBeginQuery</code> and <code>vkCmdEndQuery</code>, respectively.
When a pipeline statistics query begins, all statistics counters are set to
zero.
While the query is active, the pipeline type determines which set of
statistics are available, but these <strong>must</strong> be configured on the query pool
when it is created.
If a statistic counter is issued on a command buffer that does not support
the corresponding operation, or the counter corresponds to a shading stage
which is missing from any of the pipelines used while the query is active,
the value of that counter is <strong>undefined</strong> after the query has been made
available.
At least one statistic counter relevant to the operations supported on the
recording command buffer <strong>must</strong> be enabled.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in
<a href="#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a>::<code>pipelineStatistics</code> for query pools and in
<a href="cmdbuffers.html#VkCommandBufferInheritanceInfo" class="xref page">VkCommandBufferInheritanceInfo</a>::<code>pipelineStatistics</code> for secondary
command buffers, individually enabling pipeline statistics counters, are:</p>
</div>
<div id="VkQueryPipelineStatisticFlagBits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef enum VkQueryPipelineStatisticFlagBits {
    VK_QUERY_PIPELINE_STATISTIC_INPUT_ASSEMBLY_VERTICES_BIT = 0x00000001,
    VK_QUERY_PIPELINE_STATISTIC_INPUT_ASSEMBLY_PRIMITIVES_BIT = 0x00000002,
    VK_QUERY_PIPELINE_STATISTIC_VERTEX_SHADER_INVOCATIONS_BIT = 0x00000004,
    VK_QUERY_PIPELINE_STATISTIC_GEOMETRY_SHADER_INVOCATIONS_BIT = 0x00000008,
    VK_QUERY_PIPELINE_STATISTIC_GEOMETRY_SHADER_PRIMITIVES_BIT = 0x00000010,
    VK_QUERY_PIPELINE_STATISTIC_CLIPPING_INVOCATIONS_BIT = 0x00000020,
    VK_QUERY_PIPELINE_STATISTIC_CLIPPING_PRIMITIVES_BIT = 0x00000040,
    VK_QUERY_PIPELINE_STATISTIC_FRAGMENT_SHADER_INVOCATIONS_BIT = 0x00000080,
    VK_QUERY_PIPELINE_STATISTIC_TESSELLATION_CONTROL_SHADER_PATCHES_BIT = 0x00000100,
    VK_QUERY_PIPELINE_STATISTIC_TESSELLATION_EVALUATION_SHADER_INVOCATIONS_BIT = 0x00000200,
    VK_QUERY_PIPELINE_STATISTIC_COMPUTE_SHADER_INVOCATIONS_BIT = 0x00000400,
  // Provided by VK_EXT_mesh_shader
    VK_QUERY_PIPELINE_STATISTIC_TASK_SHADER_INVOCATIONS_BIT_EXT = 0x00000800,
  // Provided by VK_EXT_mesh_shader
    VK_QUERY_PIPELINE_STATISTIC_MESH_SHADER_INVOCATIONS_BIT_EXT = 0x00001000,
  // Provided by VK_HUAWEI_cluster_culling_shader
    VK_QUERY_PIPELINE_STATISTIC_CLUSTER_CULLING_SHADER_INVOCATIONS_BIT_HUAWEI = 0x00002000,
} VkQueryPipelineStatisticFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_INPUT_ASSEMBLY_VERTICES_BIT</code> specifies
that queries managed by the pool will count the number of vertices
processed by the <a href="drawing.html#drawing" class="xref page">input assembly</a> stage.
Vertices corresponding to incomplete primitives <strong>may</strong> contribute to the
count.</p>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_INPUT_ASSEMBLY_PRIMITIVES_BIT</code>
specifies that queries managed by the pool will count the number of
primitives processed by the <a href="drawing.html#drawing" class="xref page">input assembly</a> stage.
If primitive restart is enabled, restarting the primitive topology has
no effect on the count.
Incomplete primitives <strong>may</strong> be counted.</p>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_VERTEX_SHADER_INVOCATIONS_BIT</code>
specifies that queries managed by the pool will count the number of
vertex shader invocations.
This counter&#8217;s value is incremented each time a vertex shader is
<a href="shaders.html#shaders-vertex-execution" class="xref page">invoked</a>.</p>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_GEOMETRY_SHADER_INVOCATIONS_BIT</code>
specifies that queries managed by the pool will count the number of
geometry shader invocations.
This counter&#8217;s value is incremented each time a geometry shader is
<a href="shaders.html#shaders-geometry-execution" class="xref page">invoked</a>.
In the case of <a href="geometry.html#geometry-invocations" class="xref page">instanced geometry shaders</a>, the
geometry shader invocations count is incremented for each separate
instanced invocation.</p>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_GEOMETRY_SHADER_PRIMITIVES_BIT</code>
specifies that queries managed by the pool will count the number of
primitives generated by geometry shader invocations.
The counter&#8217;s value is incremented each time the geometry shader emits a
primitive.
Restarting primitive topology using the SPIR-V instructions
<code>OpEndPrimitive</code> or <code>OpEndStreamPrimitive</code> has no effect on the
geometry shader output primitives count.</p>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_CLIPPING_INVOCATIONS_BIT</code> specifies
that queries managed by the pool will count the number of primitives
processed by the <a href="vertexpostproc.html#vertexpostproc-clipping" class="xref page">Primitive Clipping</a> stage of
the pipeline.
The counter&#8217;s value is incremented each time a primitive reaches the
primitive clipping stage.</p>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_CLIPPING_PRIMITIVES_BIT</code> specifies that
queries managed by the pool will count the number of primitives output
by the <a href="vertexpostproc.html#vertexpostproc-clipping" class="xref page">Primitive Clipping</a> stage of the
pipeline.
The counter&#8217;s value is incremented each time a primitive passes the
primitive clipping stage.
The actual number of primitives output by the primitive clipping stage
for a particular input primitive is implementation-dependent but <strong>must</strong>
satisfy the following conditions:</p>
<div class="ulist">
<ul>
<li>
<p>If at least one vertex of the input primitive lies inside the clipping
volume, the counter is incremented by one or more.</p>
</li>
<li>
<p>Otherwise, the counter is incremented by zero or more.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_FRAGMENT_SHADER_INVOCATIONS_BIT</code>
specifies that queries managed by the pool will count the number of
fragment shader invocations.
The counter&#8217;s value is incremented each time the fragment shader is
<a href="fragops.html#fragops-shader" class="xref page">invoked</a>.</p>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_TESSELLATION_CONTROL_SHADER_PATCHES_BIT</code>
specifies that queries managed by the pool will count the number of
patches processed by the tessellation control shader.
The counter&#8217;s value is incremented once for each patch for which a
tessellation control shader is
<a href="shaders.html#shaders-tessellation-control-execution" class="xref page">invoked</a>.</p>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_TESSELLATION_EVALUATION_SHADER_INVOCATIONS_BIT</code>
specifies that queries managed by the pool will count the number of
invocations of the tessellation evaluation shader.
The counter&#8217;s value is incremented each time the tessellation evaluation
shader is <a href="shaders.html#shaders-tessellation-evaluation-execution" class="xref page">invoked</a>.</p>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_COMPUTE_SHADER_INVOCATIONS_BIT</code>
specifies that queries managed by the pool will count the number of
compute shader invocations.
The counter&#8217;s value is incremented every time the compute shader is
invoked.
Implementations <strong>may</strong> skip the execution of certain compute shader
invocations or execute additional compute shader invocations for
implementation-dependent reasons as long as the results of rendering
otherwise remain unchanged.</p>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_TASK_SHADER_INVOCATIONS_BIT_EXT</code>
specifies that queries managed by the pool will count the number of task
shader invocations.
The counter&#8217;s value is incremented every time the task shader is
invoked.</p>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_MESH_SHADER_INVOCATIONS_BIT_EXT</code>
specifies that queries managed by the pool will count the number of mesh
shader invocations.
The counter&#8217;s value is incremented every time the mesh shader is
invoked.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These values are intended to measure relative statistics on one
implementation.
Various device architectures will count these values differently.
Any or all counters <strong>may</strong> be affected by the issues described in
<a href="#queries-operation-undefined">Query Operation</a>.</p>
</div>
<div class="paragraph">
<p>This counting difference is especially true if the pipeline contains mesh or
task shaders, which may affect several of the counters in unexpected ways.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>For example, tile-based rendering devices <strong>may</strong> need to replay the scene
multiple times, affecting some of the counts.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If a pipeline has <code>rasterizerDiscardEnable</code> enabled, implementations
<strong>may</strong> discard primitives after the final
<a href="pipelines.html#pipelines-graphics-subsets-pre-rasterization" class="xref page">pre-rasterization shader stage</a>.
As a result, if <code>rasterizerDiscardEnable</code> is enabled, the clipping input
and output primitives counters <strong>may</strong> not be incremented.</p>
</div>
<div class="paragraph">
<p>When a pipeline statistics query finishes, the result for that query is
marked as available.
The application <strong>can</strong> copy the result to a buffer (via
<code>vkCmdCopyQueryPoolResults</code>), or request it be put into host memory (via
<code>vkGetQueryPoolResults</code>).</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkQueryPipelineStatisticFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef VkFlags VkQueryPipelineStatisticFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkQueryPipelineStatisticFlags</code> is a bitmask type for setting a mask of
zero or more <a href="#VkQueryPipelineStatisticFlagBits">VkQueryPipelineStatisticFlagBits</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="queries-timestamps"><a class="anchor" href="#queries-timestamps"></a>Timestamp Queries</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Timestamps</em> provide applications with a mechanism for timing the execution
of commands.
A timestamp is an integer value generated by the <code>VkPhysicalDevice</code>.
Unlike other queries, timestamps do not operate over a range, and so do not
use <a href="#vkCmdBeginQuery">vkCmdBeginQuery</a> or <a href="#vkCmdEndQuery">vkCmdEndQuery</a>.
The mechanism is built around a set of commands that allow the application
to tell the <code>VkPhysicalDevice</code> to write timestamp values to a
<a href="#queries-pools">query pool</a> and then either read timestamp values on the
host (using <a href="#vkGetQueryPoolResults">vkGetQueryPoolResults</a>) or copy timestamp values to a
<code>VkBuffer</code> (using <a href="#vkCmdCopyQueryPoolResults">vkCmdCopyQueryPoolResults</a>).
The application <strong>can</strong> then compute differences between timestamps to
determine execution time.</p>
</div>
<div class="paragraph">
<p>The number of valid bits in a timestamp value is determined by the
<code>VkQueueFamilyProperties</code>::<code>timestampValidBits</code> property of the
queue on which the timestamp is written.
Timestamps are supported on any queue which reports a non-zero value for
<code>timestampValidBits</code> via <a href="devsandqueues.html#vkGetPhysicalDeviceQueueFamilyProperties" class="xref page">vkGetPhysicalDeviceQueueFamilyProperties</a>.
If the <a href="limits.html#limits-timestampComputeAndGraphics" class="xref page"><code>timestampComputeAndGraphics</code></a> limit is <code>VK_TRUE</code>, timestamps are
supported by every queue family that supports either graphics or compute
operations (see <a href="devsandqueues.html#VkQueueFamilyProperties" class="xref page">VkQueueFamilyProperties</a>).</p>
</div>
<div class="paragraph">
<p>The number of nanoseconds it takes for a timestamp value to be incremented
by 1 <strong>can</strong> be obtained from
<code>VkPhysicalDeviceLimits</code>::<code>timestampPeriod</code> after a call to
<code>vkGetPhysicalDeviceProperties</code>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To request a timestamp and write the value to memory, call:</p>
</div>
<div id="vkCmdWriteTimestamp2" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
void vkCmdWriteTimestamp2(
    VkCommandBuffer                             commandBuffer,
    VkPipelineStageFlags2                       stage,
    VkQueryPool                                 queryPool,
    uint32_t                                    query);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent command</p>
</div>
<div id="vkCmdWriteTimestamp2KHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_synchronization2
void vkCmdWriteTimestamp2KHR(
    VkCommandBuffer                             commandBuffer,
    VkPipelineStageFlags2                       stage,
    VkQueryPool                                 queryPool,
    uint32_t                                    query);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>stage</code> specifies a stage of the pipeline.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool that will manage the timestamp.</p>
</li>
<li>
<p><code>query</code> is the query within the query pool that will contain the
timestamp.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <code>vkCmdWriteTimestamp2</code> is submitted to a queue, it defines an
execution dependency on commands that were submitted before it, and writes a
timestamp to a query pool.</p>
</div>
<div class="paragraph">
<p>The first <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization scope</a>
includes all commands that occur earlier in
<a href="synchronization.html#synchronization-submission-order" class="xref page">submission order</a>.
The synchronization scope is limited to operations on the pipeline stage
specified by <code>stage</code>.</p>
</div>
<div class="paragraph">
<p>The second <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization scope</a>
includes only the timestamp write operation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Implementations may write the timestamp at any stage that is
<a href="synchronization.html#synchronization-pipeline-stages-order" class="xref page">logically later</a> than <code>stage</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Any timestamp write that <a href="synchronization.html#synchronization-dependencies-execution" class="xref page">happens-after</a> another timestamp write in the same submission <strong>must</strong> not
have a lower value unless its value overflows the maximum supported integer
bit width of the query.
If
<code><a href="../appendices/extensions.html#VK_KHR_calibrated_timestamps" class="xref page">VK_KHR_calibrated_timestamps</a></code>
or
<code><a href="../appendices/extensions.html#VK_EXT_calibrated_timestamps" class="xref page">VK_EXT_calibrated_timestamps</a></code>
is enabled, this extends to timestamp writes across all submissions on the
same logical device: any timestamp write that
<a href="synchronization.html#synchronization-dependencies-execution" class="xref page">happens-after</a> another <strong>must</strong> not
have a lower value unless its value overflows the maximum supported integer
bit width of the query.
Timestamps written by this command <strong>must</strong> be in the
<code>VK_TIME_DOMAIN_DEVICE_KHR</code>
<a href="synchronization.html#VkTimeDomainKHR" class="xref page">time domain</a>.
If an overflow occurs, the timestamp value <strong>must</strong> wrap back to zero.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Comparisons between timestamps should be done between timestamps where they
are guaranteed to not decrease.
For example, subtracting an older timestamp from a newer one to determine
the execution time of a sequence of commands is only a reliable measurement
if the two timestamp writes were performed in the same
submission, or if the writes were performed on the same logical device and
<code><a href="../appendices/extensions.html#VK_KHR_calibrated_timestamps" class="xref page">VK_KHR_calibrated_timestamps</a></code>
or
<code><a href="../appendices/extensions.html#VK_EXT_calibrated_timestamps" class="xref page">VK_EXT_calibrated_timestamps</a></code>
is enabled.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code>vkCmdWriteTimestamp2</code> is called while executing a render pass
instance that has multiview enabled, the timestamp uses <span class="eq">N</span> consecutive
query indices in the query pool (starting at <code>query</code>) where <span class="eq">N</span> is
the number of bits set in the view mask of the subpass the command is
executed in.
The resulting query values are determined by an implementation-dependent
choice of one of the following behaviors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first query is a timestamp value and (if more than one bit is set in
the view mask) zero is written to the remaining queries.
If two timestamps are written in the same subpass, the sum of the
execution time of all views between those commands is the difference
between the first query written by each command.</p>
</li>
<li>
<p>All <span class="eq">N</span> queries are timestamp values.
If two timestamps are written in the same subpass, the sum of the
execution time of all views between those commands is the sum of the
difference between corresponding queries written by each command.
The difference between corresponding queries <strong>may</strong> be the execution time
of a single view.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In either case, the application <strong>can</strong> sum the differences between all <span class="eq">N</span>
queries to determine the total execution time.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-stage-03929" href="#VUID-vkCmdWriteTimestamp2-stage-03929"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-stage-03929</span><br>

If the <a href="features.html#features-geometryShader" class="xref page"><code>geometryShader</code></a> feature is not
enabled, <code>stage</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-stage-03930" href="#VUID-vkCmdWriteTimestamp2-stage-03930"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-stage-03930</span><br>

If the <a href="features.html#features-tessellationShader" class="xref page"><code>tessellationShader</code></a> feature
is not enabled, <code>stage</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-stage-03931" href="#VUID-vkCmdWriteTimestamp2-stage-03931"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-stage-03931</span><br>

If the <a href="features.html#features-conditionalRendering" class="xref page"><code>conditionalRendering</code></a>
feature is not enabled, <code>stage</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_CONDITIONAL_RENDERING_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-stage-03932" href="#VUID-vkCmdWriteTimestamp2-stage-03932"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-stage-03932</span><br>

If the <a href="features.html#features-fragmentDensityMap" class="xref page"><code>fragmentDensityMap</code></a> feature
is not enabled, <code>stage</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-stage-03933" href="#VUID-vkCmdWriteTimestamp2-stage-03933"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-stage-03933</span><br>

If the <a href="features.html#features-transformFeedback" class="xref page"><code>transformFeedback</code></a> feature
is not enabled, <code>stage</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TRANSFORM_FEEDBACK_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-stage-03934" href="#VUID-vkCmdWriteTimestamp2-stage-03934"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-stage-03934</span><br>

If the <a href="features.html#features-meshShader" class="xref page"><code>meshShader</code></a> feature is not enabled,
<code>stage</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-stage-03935" href="#VUID-vkCmdWriteTimestamp2-stage-03935"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-stage-03935</span><br>

If the <a href="features.html#features-taskShader" class="xref page"><code>taskShader</code></a> feature is not enabled,
<code>stage</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-stage-07316" href="#VUID-vkCmdWriteTimestamp2-stage-07316"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-stage-07316</span><br>

If neither the <a href="features.html#features-shadingRateImage" class="xref page"><code>shadingRateImage</code></a> or
<a href="features.html#features-attachmentFragmentShadingRate" class="xref page">    <code>attachmentFragmentShadingRate</code></a> are enabled, <code>stage</code>
<strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-stage-04957" href="#VUID-vkCmdWriteTimestamp2-stage-04957"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-stage-04957</span><br>

If the <a href="features.html#features-subpassShading" class="xref page"><code>subpassShading</code></a> feature is not
enabled, <code>stage</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_SUBPASS_SHADER_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-stage-04995" href="#VUID-vkCmdWriteTimestamp2-stage-04995"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-stage-04995</span><br>

If the <a href="features.html#features-invocationMask" class="xref page"><code>invocationMask</code></a> feature is not
enabled, <code>stage</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_INVOCATION_MASK_BIT_HUAWEI</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-stage-07946" href="#VUID-vkCmdWriteTimestamp2-stage-07946"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-stage-07946</span><br>

If neither the <a href="../appendices/extensions.html#VK_NV_ray_tracing" class="xref page">VK_NV_ray_tracing</a> extension or
<a href="features.html#features-rayTracingPipeline" class="xref page"><code>rayTracingPipeline</code> feature</a> are
enabled, <code>stage</code> <strong>must</strong> not contain
<code>VK_PIPELINE_STAGE_2_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-synchronization2-03858" href="#VUID-vkCmdWriteTimestamp2-synchronization2-03858"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-synchronization2-03858</span><br>

The <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature <strong>must</strong>
be enabled</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-stage-03859" href="#VUID-vkCmdWriteTimestamp2-stage-03859"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-stage-03859</span><br>

<code>stage</code> <strong>must</strong> only include a single pipeline stage</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-stage-03860" href="#VUID-vkCmdWriteTimestamp2-stage-03860"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-stage-03860</span><br>

<code>stage</code> <strong>must</strong> only include stages valid for the queue family that
was used to create the command pool that <code>commandBuffer</code> was
allocated from</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-queryPool-03861" href="#VUID-vkCmdWriteTimestamp2-queryPool-03861"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-queryPool-03861</span><br>

<code>queryPool</code> <strong>must</strong> have been created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_TIMESTAMP</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-timestampValidBits-03863" href="#VUID-vkCmdWriteTimestamp2-timestampValidBits-03863"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-timestampValidBits-03863</span><br>

The command pool&#8217;s queue family <strong>must</strong> support a non-zero
<code>timestampValidBits</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-query-04903" href="#VUID-vkCmdWriteTimestamp2-query-04903"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-query-04903</span><br>

<code>query</code> <strong>must</strong> be less than the number of queries in <code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-None-03864" href="#VUID-vkCmdWriteTimestamp2-None-03864"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-None-03864</span><br>

All queries used by the command <strong>must</strong> be <em>unavailable</em></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-query-03865" href="#VUID-vkCmdWriteTimestamp2-query-03865"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-query-03865</span><br>

If <code>vkCmdWriteTimestamp2</code> is called within a render pass instance,
the sum of <code>query</code> and the number of bits set in the current
subpass&#8217;s view mask <strong>must</strong> be less than or equal to the number of queries
in <code>queryPool</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-commandBuffer-parameter" href="#VUID-vkCmdWriteTimestamp2-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-stage-parameter" href="#VUID-vkCmdWriteTimestamp2-stage-parameter"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-stage-parameter</span><br>
 <code>stage</code> <strong>must</strong> be a valid combination of <a href="synchronization.html#VkPipelineStageFlagBits2" class="xref page">VkPipelineStageFlagBits2</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-queryPool-parameter" href="#VUID-vkCmdWriteTimestamp2-queryPool-parameter"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-queryPool-parameter</span><br>
 <code>queryPool</code> <strong>must</strong> be a valid <a href="#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-commandBuffer-recording" href="#VUID-vkCmdWriteTimestamp2-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-commandBuffer-cmdpool" href="#VUID-vkCmdWriteTimestamp2-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support transfer, graphics, compute, decode, or encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-commonparent" href="#VUID-vkCmdWriteTimestamp2-commonparent"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-commonparent</span><br>
 Both of <code>commandBuffer</code>, and <code>queryPool</code> <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="videocoding.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transfer<br>
Graphics<br>
Compute<br>
Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To request a timestamp and write the value to memory, call:</p>
</div>
<div id="vkCmdWriteTimestamp" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkCmdWriteTimestamp(
    VkCommandBuffer                             commandBuffer,
    VkPipelineStageFlagBits                     pipelineStage,
    VkQueryPool                                 queryPool,
    uint32_t                                    query);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>pipelineStage</code> is a <a href="synchronization.html#VkPipelineStageFlagBits" class="xref page">VkPipelineStageFlagBits</a> value, specifying
a stage of the pipeline.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool that will manage the timestamp.</p>
</li>
<li>
<p><code>query</code> is the query within the query pool that will contain the
timestamp.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <code>vkCmdWriteTimestamp</code> is submitted to a queue, it defines an
execution dependency on commands that were submitted before it, and writes a
timestamp to a query pool.</p>
</div>
<div class="paragraph">
<p>The first <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization scope</a>
includes all commands that occur earlier in
<a href="synchronization.html#synchronization-submission-order" class="xref page">submission order</a>.
The synchronization scope is limited to operations on the pipeline stage
specified by <code>pipelineStage</code>.</p>
</div>
<div class="paragraph">
<p>The second <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization scope</a>
includes only the timestamp write operation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Implementations may write the timestamp at any stage that is
<a href="synchronization.html#synchronization-pipeline-stages-order" class="xref page">logically later</a> than <code>stage</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Any timestamp write that <a href="synchronization.html#synchronization-dependencies-execution" class="xref page">happens-after</a> another timestamp write in the same submission <strong>must</strong> not
have a lower value unless its value overflows the maximum supported integer
bit width of the query.
If
<code><a href="../appendices/extensions.html#VK_KHR_calibrated_timestamps" class="xref page">VK_KHR_calibrated_timestamps</a></code>
or
<code><a href="../appendices/extensions.html#VK_EXT_calibrated_timestamps" class="xref page">VK_EXT_calibrated_timestamps</a></code>
is enabled, this extends to timestamp writes across all submissions on the
same logical device: any timestamp write that
<a href="synchronization.html#synchronization-dependencies-execution" class="xref page">happens-after</a> another <strong>must</strong> not
have a lower value unless its value overflows the maximum supported integer
bit width of the query.
Timestamps written by this command <strong>must</strong> be in the
<code>VK_TIME_DOMAIN_DEVICE_KHR</code>
<a href="synchronization.html#VkTimeDomainKHR" class="xref page">time domain</a>.
If an overflow occurs, the timestamp value <strong>must</strong> wrap back to zero.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Comparisons between timestamps should be done between timestamps where they
are guaranteed to not decrease.
For example, subtracting an older timestamp from a newer one to determine
the execution time of a sequence of commands is only a reliable measurement
if the two timestamp writes were performed in the same
submission, or if the writes were performed on the same logical device and
<code><a href="../appendices/extensions.html#VK_KHR_calibrated_timestamps" class="xref page">VK_KHR_calibrated_timestamps</a></code>
or
<code><a href="../appendices/extensions.html#VK_EXT_calibrated_timestamps" class="xref page">VK_EXT_calibrated_timestamps</a></code>
is enabled.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code>vkCmdWriteTimestamp</code> is called while executing a render pass
instance that has multiview enabled, the timestamp uses <span class="eq">N</span> consecutive
query indices in the query pool (starting at <code>query</code>) where <span class="eq">N</span> is
the number of bits set in the view mask of the subpass the command is
executed in.
The resulting query values are determined by an implementation-dependent
choice of one of the following behaviors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first query is a timestamp value and (if more than one bit is set in
the view mask) zero is written to the remaining queries.
If two timestamps are written in the same subpass, the sum of the
execution time of all views between those commands is the difference
between the first query written by each command.</p>
</li>
<li>
<p>All <span class="eq">N</span> queries are timestamp values.
If two timestamps are written in the same subpass, the sum of the
execution time of all views between those commands is the sum of the
difference between corresponding queries written by each command.
The difference between corresponding queries <strong>may</strong> be the execution time
of a single view.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In either case, the application <strong>can</strong> sum the differences between all <span class="eq">N</span>
queries to determine the total execution time.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-pipelineStage-04074" href="#VUID-vkCmdWriteTimestamp-pipelineStage-04074"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-pipelineStage-04074</span><br>

<code>pipelineStage</code> <strong>must</strong> be a
<a href="synchronization.html#synchronization-pipeline-stages-supported" class="xref page">valid stage</a> for the queue
family that was used to create the command pool that <code>commandBuffer</code>
was allocated from</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-pipelineStage-04075" href="#VUID-vkCmdWriteTimestamp-pipelineStage-04075"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-pipelineStage-04075</span><br>

If the <a href="features.html#features-geometryShader" class="xref page"><code>geometryShader</code></a> feature is not
enabled, <code>pipelineStage</code> <strong>must</strong> not be
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-pipelineStage-04076" href="#VUID-vkCmdWriteTimestamp-pipelineStage-04076"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-pipelineStage-04076</span><br>

If the <a href="features.html#features-tessellationShader" class="xref page"><code>tessellationShader</code></a> feature
is not enabled, <code>pipelineStage</code> <strong>must</strong> not be
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-pipelineStage-04077" href="#VUID-vkCmdWriteTimestamp-pipelineStage-04077"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-pipelineStage-04077</span><br>

If the <a href="features.html#features-conditionalRendering" class="xref page"><code>conditionalRendering</code></a>
feature is not enabled, <code>pipelineStage</code> <strong>must</strong> not be
<code>VK_PIPELINE_STAGE_CONDITIONAL_RENDERING_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-pipelineStage-04078" href="#VUID-vkCmdWriteTimestamp-pipelineStage-04078"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-pipelineStage-04078</span><br>

If the <a href="features.html#features-fragmentDensityMap" class="xref page"><code>fragmentDensityMap</code></a> feature
is not enabled, <code>pipelineStage</code> <strong>must</strong> not be
<code>VK_PIPELINE_STAGE_FRAGMENT_DENSITY_PROCESS_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-pipelineStage-04079" href="#VUID-vkCmdWriteTimestamp-pipelineStage-04079"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-pipelineStage-04079</span><br>

If the <a href="features.html#features-transformFeedback" class="xref page"><code>transformFeedback</code></a> feature
is not enabled, <code>pipelineStage</code> <strong>must</strong> not be
<code>VK_PIPELINE_STAGE_TRANSFORM_FEEDBACK_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-pipelineStage-04080" href="#VUID-vkCmdWriteTimestamp-pipelineStage-04080"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-pipelineStage-04080</span><br>

If the <a href="features.html#features-meshShader" class="xref page"><code>meshShader</code></a> feature is not enabled,
<code>pipelineStage</code> <strong>must</strong> not be
<code>VK_PIPELINE_STAGE_MESH_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-pipelineStage-07077" href="#VUID-vkCmdWriteTimestamp-pipelineStage-07077"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-pipelineStage-07077</span><br>

If the <a href="features.html#features-taskShader" class="xref page"><code>taskShader</code></a> feature is not enabled,
<code>pipelineStage</code> <strong>must</strong> not be
<code>VK_PIPELINE_STAGE_TASK_SHADER_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-shadingRateImage-07314" href="#VUID-vkCmdWriteTimestamp-shadingRateImage-07314"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-shadingRateImage-07314</span><br>

If neither the <a href="features.html#features-shadingRateImage" class="xref page"><code>shadingRateImage</code></a> or
<a href="features.html#features-attachmentFragmentShadingRate" class="xref page">    <code>attachmentFragmentShadingRate</code></a> are enabled, <code>pipelineStage</code>
<strong>must</strong> not be
<code>VK_PIPELINE_STAGE_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-synchronization2-06489" href="#VUID-vkCmdWriteTimestamp-synchronization2-06489"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-synchronization2-06489</span><br>

If the <a href="features.html#features-synchronization2" class="xref page"><code>synchronization2</code></a> feature is
not enabled, <code>pipelineStage</code> <strong>must</strong> not be
<code>VK_PIPELINE_STAGE_NONE</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-rayTracingPipeline-07943" href="#VUID-vkCmdWriteTimestamp-rayTracingPipeline-07943"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-rayTracingPipeline-07943</span><br>

If neither the <a href="../appendices/extensions.html#VK_NV_ray_tracing" class="xref page">VK_NV_ray_tracing</a> extension or
<a href="features.html#features-rayTracingPipeline" class="xref page"><code>rayTracingPipeline</code> feature</a> are
enabled, <code>pipelineStage</code> <strong>must</strong> not be
<code>VK_PIPELINE_STAGE_RAY_TRACING_SHADER_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-queryPool-01416" href="#VUID-vkCmdWriteTimestamp-queryPool-01416"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-queryPool-01416</span><br>

<code>queryPool</code> <strong>must</strong> have been created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_TIMESTAMP</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-timestampValidBits-00829" href="#VUID-vkCmdWriteTimestamp-timestampValidBits-00829"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-timestampValidBits-00829</span><br>

The command pool&#8217;s queue family <strong>must</strong> support a non-zero
<code>timestampValidBits</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-query-04904" href="#VUID-vkCmdWriteTimestamp-query-04904"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-query-04904</span><br>

<code>query</code> <strong>must</strong> be less than the number of queries in <code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-None-00830" href="#VUID-vkCmdWriteTimestamp-None-00830"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-None-00830</span><br>

All queries used by the command <strong>must</strong> be <em>unavailable</em></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-query-00831" href="#VUID-vkCmdWriteTimestamp-query-00831"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-query-00831</span><br>

If <code>vkCmdWriteTimestamp</code> is called within a render pass instance,
the sum of <code>query</code> and the number of bits set in the current
subpass&#8217;s view mask <strong>must</strong> be less than or equal to the number of queries
in <code>queryPool</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-commandBuffer-parameter" href="#VUID-vkCmdWriteTimestamp-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-pipelineStage-parameter" href="#VUID-vkCmdWriteTimestamp-pipelineStage-parameter"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-pipelineStage-parameter</span><br>
 <code>pipelineStage</code> <strong>must</strong> be a valid <a href="synchronization.html#VkPipelineStageFlagBits" class="xref page">VkPipelineStageFlagBits</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-queryPool-parameter" href="#VUID-vkCmdWriteTimestamp-queryPool-parameter"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-queryPool-parameter</span><br>
 <code>queryPool</code> <strong>must</strong> be a valid <a href="#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-commandBuffer-recording" href="#VUID-vkCmdWriteTimestamp-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-commandBuffer-cmdpool" href="#VUID-vkCmdWriteTimestamp-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support transfer, graphics, compute, decode, encode, or optical flow operations</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-commonparent" href="#VUID-vkCmdWriteTimestamp-commonparent"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-commonparent</span><br>
 Both of <code>commandBuffer</code>, and <code>queryPool</code> <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="videocoding.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transfer<br>
Graphics<br>
Compute<br>
Decode<br>
Encode<br>
Opticalflow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="queries-performance"><a class="anchor" href="#queries-performance"></a>Performance Queries</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Performance queries</em> provide applications with a mechanism for getting
performance counter information about the execution of command buffers,
render passes, and commands.</p>
</div>
<div class="paragraph">
<p>Each queue family advertises the performance counters that <strong>can</strong> be queried
on a queue of that family via a call to
<a href="devsandqueues.html#vkEnumeratePhysicalDeviceQueueFamilyPerformanceQueryCountersKHR" class="xref page">vkEnumeratePhysicalDeviceQueueFamilyPerformanceQueryCountersKHR</a>.
Implementations <strong>may</strong> limit access to performance counters based on platform
requirements or only to specialized drivers for development purposes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This may include no performance counters being enumerated, or a reduced set.
Please refer to platform-specific documentation for guidance on any such
restrictions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Performance queries use the existing <a href="#vkCmdBeginQuery">vkCmdBeginQuery</a> and
<a href="#vkCmdEndQuery">vkCmdEndQuery</a> to control what command buffers, render passes, or
commands to get performance information for.</p>
</div>
<div class="paragraph">
<p>Implementations <strong>may</strong> require multiple passes where the command buffer,
render passes, or commands being recorded are the same and are executed on
the same queue to record performance counter data.
This is achieved by submitting the same batch and providing a
<a href="cmdbuffers.html#VkPerformanceQuerySubmitInfoKHR" class="xref page">VkPerformanceQuerySubmitInfoKHR</a> structure containing a counter pass
index.
The number of passes required for a given performance query pool <strong>can</strong> be
queried via a call to
<a href="#vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR">vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Command buffers created with
<code>VK_COMMAND_BUFFER_USAGE_ONE_TIME_SUBMIT_BIT</code> <strong>must</strong> not be re-submitted.
Changing command buffer usage bits <strong>may</strong> affect performance.
To avoid this, the application <strong>should</strong> re-record any command buffers with
the <code>VK_COMMAND_BUFFER_USAGE_ONE_TIME_SUBMIT_BIT</code> when multiple counter
passes are required.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Performance counter results from a performance query pool <strong>can</strong> be obtained
with the command <a href="#vkGetQueryPoolResults">vkGetQueryPoolResults</a>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPerformanceCounterResultKHR</code> union is defined as:</p>
</div>
<div id="VkPerformanceCounterResultKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_performance_query
typedef union VkPerformanceCounterResultKHR {
    int32_t     int32;
    int64_t     int64;
    uint32_t    uint32;
    uint64_t    uint64;
    float       float32;
    double      float64;
} VkPerformanceCounterResultKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>int32</code> is a 32-bit signed integer value.</p>
</li>
<li>
<p><code>int64</code> is a 64-bit signed integer value.</p>
</li>
<li>
<p><code>uint32</code> is a 32-bit unsigned integer value.</p>
</li>
<li>
<p><code>uint64</code> is a 64-bit unsigned integer value.</p>
</li>
<li>
<p><code>float32</code> is a 32-bit floating-point value.</p>
</li>
<li>
<p><code>float64</code> is a 64-bit floating-point value.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Performance query results are returned in an array of
<code>VkPerformanceCounterResultKHR</code> unions containing the data associated
with each counter in the query, stored in the same order as the counters
supplied in <code>pCounterIndices</code> when creating the performance query.
<a href="devsandqueues.html#VkPerformanceCounterKHR" class="xref page">VkPerformanceCounterKHR</a>::<code>storage</code> specifies how to parse the
counter data.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="profiling-lock"><a class="anchor" href="#profiling-lock"></a>Profiling Lock</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To record and submit a command buffer containing a performance query pool
the profiling lock <strong>must</strong> be held.
The profiling lock <strong>must</strong> be acquired prior to any call to
<a href="cmdbuffers.html#vkBeginCommandBuffer" class="xref page">vkBeginCommandBuffer</a> that will be using a performance query pool.
The profiling lock <strong>must</strong> be held while any command buffer containing a
performance query pool is in the <em>recording</em>, <em>executable</em>, or <em>pending
state</em>.
To acquire the profiling lock, call:</p>
</div>
<div id="vkAcquireProfilingLockKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_performance_query
VkResult vkAcquireProfilingLockKHR(
    VkDevice                                    device,
    const VkAcquireProfilingLockInfoKHR*        pInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device to profile.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a <code>VkAcquireProfilingLockInfoKHR</code>
structure containing information about how the profiling is to be
acquired.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Implementations <strong>may</strong> allow multiple actors to hold the profiling lock
concurrently.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkAcquireProfilingLockKHR-device-parameter" href="#VUID-vkAcquireProfilingLockKHR-device-parameter"></a> <span class="vuid">VUID-vkAcquireProfilingLockKHR-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkAcquireProfilingLockKHR-pInfo-parameter" href="#VUID-vkAcquireProfilingLockKHR-pInfo-parameter"></a> <span class="vuid">VUID-vkAcquireProfilingLockKHR-pInfo-parameter</span><br>
 <code>pInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkAcquireProfilingLockInfoKHR">VkAcquireProfilingLockInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_TIMEOUT</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAcquireProfilingLockInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkAcquireProfilingLockInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_performance_query
typedef struct VkAcquireProfilingLockInfoKHR {
    VkStructureType                   sType;
    const void*                       pNext;
    VkAcquireProfilingLockFlagsKHR    flags;
    uint64_t                          timeout;
} VkAcquireProfilingLockInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>timeout</code> indicates how long the function waits, in nanoseconds, if
the profiling lock is not available.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAcquireProfilingLockInfoKHR-sType-sType" href="#VUID-VkAcquireProfilingLockInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkAcquireProfilingLockInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_ACQUIRE_PROFILING_LOCK_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAcquireProfilingLockInfoKHR-pNext-pNext" href="#VUID-VkAcquireProfilingLockInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkAcquireProfilingLockInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkAcquireProfilingLockInfoKHR-flags-zerobitmask" href="#VUID-VkAcquireProfilingLockInfoKHR-flags-zerobitmask"></a> <span class="vuid">VUID-VkAcquireProfilingLockInfoKHR-flags-zerobitmask</span><br>
 <code>flags</code> <strong>must</strong> be <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>If <code>timeout</code> is 0, <code>vkAcquireProfilingLockKHR</code> will not block while
attempting to acquire the profiling lock.
If <code>timeout</code> is <code>UINT64_MAX</code>, the function will not return until the
profiling lock was acquired.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkAcquireProfilingLockFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_performance_query
typedef enum VkAcquireProfilingLockFlagBitsKHR {
} VkAcquireProfilingLockFlagBitsKHR;</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkAcquireProfilingLockFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_performance_query
typedef VkFlags VkAcquireProfilingLockFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#VkAcquireProfilingLockFlagsKHR">VkAcquireProfilingLockFlagsKHR</a> is a bitmask type for setting a mask,
but is currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To release the profiling lock, call:</p>
</div>
<div id="vkReleaseProfilingLockKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_performance_query
void vkReleaseProfilingLockKHR(
    VkDevice                                    device);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device to cease profiling on.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkReleaseProfilingLockKHR-device-03235" href="#VUID-vkReleaseProfilingLockKHR-device-03235"></a> <span class="vuid">VUID-vkReleaseProfilingLockKHR-device-03235</span><br>

The profiling lock of <code>device</code> <strong>must</strong> have been held via a previous
successful call to <a href="#vkAcquireProfilingLockKHR">vkAcquireProfilingLockKHR</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkReleaseProfilingLockKHR-device-parameter" href="#VUID-vkReleaseProfilingLockKHR-device-parameter"></a> <span class="vuid">VUID-vkReleaseProfilingLockKHR-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="queries-transform-feedback"><a class="anchor" href="#queries-transform-feedback"></a>Transform Feedback Queries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Transform feedback queries track the number of primitives attempted to be
written and actually written, by the vertex stream being captured, to a
transform feedback buffer.
This query is updated during drawing commands while transform feedback is
active.
The number of primitives actually written will be less than the number
attempted to be written if the bound transform feedback buffer size was too
small for the number of primitives actually drawn.
Primitives are not written beyond the bound range of the transform feedback
buffer.
A transform feedback query is begun and ended by calling
<code>vkCmdBeginQuery</code> and <code>vkCmdEndQuery</code>, respectively to query for
vertex stream zero.
<code>vkCmdBeginQueryIndexedEXT</code> and <code>vkCmdEndQueryIndexedEXT</code> <strong>can</strong> be
used to begin and end transform feedback queries for any supported vertex
stream.
When a transform feedback query begins, the count of primitives written and
primitives needed starts from zero.
For each drawing command, the count is incremented as vertex attribute
outputs are captured to the transform feedback buffers while transform
feedback is active.</p>
</div>
<div class="paragraph">
<p>When a transform feedback query finishes, the result for that query is
marked as available.
The application <strong>can</strong> then either copy the result to a buffer (via
<code>vkCmdCopyQueryPoolResults</code>) or request it be put into host memory (via
<code>vkGetQueryPoolResults</code>).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="queries-primitives-generated"><a class="anchor" href="#queries-primitives-generated"></a>Primitives Generated Queries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When a generated primitive query for a vertex stream is active, the
primitives-generated count is incremented every time a primitive emitted to
that stream reaches the transform feedback stage, whether or not transform
feedback is active.
A primitives generated query is begun and ended by calling
<code>vkCmdBeginQuery</code> and <code>vkCmdEndQuery</code>, respectively to query for
vertex stream zero.
<code>vkCmdBeginQueryIndexedEXT</code> and <code>vkCmdEndQueryIndexedEXT</code> <strong>can</strong> be
used to begin and end primitives generated queries for any supported vertex
stream.
When a primitives generated query begins, the count of primitives generated
starts from zero.</p>
</div>
<div class="paragraph">
<p>When a primitives generated query finishes, the result for that query is
marked as available.
The application <strong>can</strong> then either copy the result to a buffer (via
<code>vkCmdCopyQueryPoolResults</code>) or request it be put into host memory (via
<code>vkGetQueryPoolResults</code>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The result of this query is typically identical to
<code>VK_QUERY_PIPELINE_STATISTIC_CLIPPING_INVOCATIONS_BIT</code>, but the
primitives generated query is deterministic, i.e. it must be identical to
the number of primitives processed.
<code>VK_QUERY_PIPELINE_STATISTIC_CLIPPING_INVOCATIONS_BIT</code> may vary for
implementation-dependent reasons, e.g. the same primitive may be processed
multiple times for purposes of clipping.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="queries-mesh-shader"><a class="anchor" href="#queries-mesh-shader"></a>Mesh Shader Queries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When a generated mesh primitives query is active, the
mesh-primitives-generated count is incremented every time a primitive
emitted from the mesh shader stage reaches the fragment shader stage.
When a generated mesh primitives query begins, the mesh-primitives-generated
count starts from zero.</p>
</div>
<div class="paragraph">
<p>Mesh and task shader pipeline statistics queries function the same way that
invocation queries work for other shader stages, counting the number of
times the respective shader stage has been run.
When the statistics query begins, the invocation counters start from zero.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="queries-performance-intel"><a class="anchor" href="#queries-performance-intel"></a>Intel Performance Queries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Intel performance queries allow an application to capture performance data
for a set of commands.
Performance queries are used in a similar way than other types of queries.
A main difference with existing queries is that the resulting data should be
handed over to a library capable to produce human readable results rather
than being read directly by an application.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Prior to creating a performance query pool, initialize the device for
performance queries with the call:</p>
</div>
<div id="vkInitializePerformanceApiINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
VkResult vkInitializePerformanceApiINTEL(
    VkDevice                                    device,
    const VkInitializePerformanceApiInfoINTEL*  pInitializeInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device used for the queries.</p>
</li>
<li>
<p><code>pInitializeInfo</code> is a pointer to a
<a href="#VkInitializePerformanceApiInfoINTEL">VkInitializePerformanceApiInfoINTEL</a> structure specifying
initialization parameters.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkInitializePerformanceApiINTEL-device-parameter" href="#VUID-vkInitializePerformanceApiINTEL-device-parameter"></a> <span class="vuid">VUID-vkInitializePerformanceApiINTEL-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkInitializePerformanceApiINTEL-pInitializeInfo-parameter" href="#VUID-vkInitializePerformanceApiINTEL-pInitializeInfo-parameter"></a> <span class="vuid">VUID-vkInitializePerformanceApiINTEL-pInitializeInfo-parameter</span><br>
 <code>pInitializeInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkInitializePerformanceApiInfoINTEL">VkInitializePerformanceApiInfoINTEL</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkInitializePerformanceApiInfoINTEL</code> structure is defined as :</p>
</div>
<div id="VkInitializePerformanceApiInfoINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
typedef struct VkInitializePerformanceApiInfoINTEL {
    VkStructureType    sType;
    const void*        pNext;
    void*              pUserData;
} VkInitializePerformanceApiInfoINTEL;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pUserData</code> is a pointer for application data.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkInitializePerformanceApiInfoINTEL-sType-sType" href="#VUID-VkInitializePerformanceApiInfoINTEL-sType-sType"></a> <span class="vuid">VUID-VkInitializePerformanceApiInfoINTEL-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_INITIALIZE_PERFORMANCE_API_INFO_INTEL</code></p>
</li>
<li>
<p><a id="VUID-VkInitializePerformanceApiInfoINTEL-pNext-pNext" href="#VUID-VkInitializePerformanceApiInfoINTEL-pNext-pNext"></a> <span class="vuid">VUID-VkInitializePerformanceApiInfoINTEL-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Once performance query operations have completed, uninitialize the device
for performance queries with the call:</p>
</div>
<div id="vkUninitializePerformanceApiINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
void vkUninitializePerformanceApiINTEL(
    VkDevice                                    device);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device used for the queries.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkUninitializePerformanceApiINTEL-device-parameter" href="#VUID-vkUninitializePerformanceApiINTEL-device-parameter"></a> <span class="vuid">VUID-vkUninitializePerformanceApiINTEL-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Some performance query features of a device can be discovered with the call:</p>
</div>
<div id="vkGetPerformanceParameterINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
VkResult vkGetPerformanceParameterINTEL(
    VkDevice                                    device,
    VkPerformanceParameterTypeINTEL             parameter,
    VkPerformanceValueINTEL*                    pValue);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device to query.</p>
</li>
<li>
<p><code>parameter</code> is the parameter to query.</p>
</li>
<li>
<p><code>pValue</code> is a pointer to a <a href="#VkPerformanceValueINTEL">VkPerformanceValueINTEL</a> structure
in which the type and value of the parameter are returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPerformanceParameterINTEL-device-parameter" href="#VUID-vkGetPerformanceParameterINTEL-device-parameter"></a> <span class="vuid">VUID-vkGetPerformanceParameterINTEL-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetPerformanceParameterINTEL-parameter-parameter" href="#VUID-vkGetPerformanceParameterINTEL-parameter-parameter"></a> <span class="vuid">VUID-vkGetPerformanceParameterINTEL-parameter-parameter</span><br>
 <code>parameter</code> <strong>must</strong> be a valid <a href="#VkPerformanceParameterTypeINTEL">VkPerformanceParameterTypeINTEL</a> value</p>
</li>
<li>
<p><a id="VUID-vkGetPerformanceParameterINTEL-pValue-parameter" href="#VUID-vkGetPerformanceParameterINTEL-pValue-parameter"></a> <span class="vuid">VUID-vkGetPerformanceParameterINTEL-pValue-parameter</span><br>
 <code>pValue</code> <strong>must</strong> be a valid pointer to a <a href="#VkPerformanceValueINTEL">VkPerformanceValueINTEL</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <a href="#vkGetPerformanceParameterINTEL">vkGetPerformanceParameterINTEL</a>::<code>parameter</code>,
specifying a performance query feature, are:</p>
</div>
<div id="VkPerformanceParameterTypeINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
typedef enum VkPerformanceParameterTypeINTEL {
    VK_PERFORMANCE_PARAMETER_TYPE_HW_COUNTERS_SUPPORTED_INTEL = 0,
    VK_PERFORMANCE_PARAMETER_TYPE_STREAM_MARKER_VALID_BITS_INTEL = 1,
} VkPerformanceParameterTypeINTEL;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PERFORMANCE_PARAMETER_TYPE_HW_COUNTERS_SUPPORTED_INTEL</code> has a
boolean result which tells whether hardware counters can be captured.</p>
</li>
<li>
<p><code>VK_PERFORMANCE_PARAMETER_TYPE_STREAM_MARKER_VALID_BITS_INTEL</code> has a
32 bits integer result which tells how many bits can be written into the
<code>VkPerformanceValueINTEL</code> value.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPerformanceValueINTEL</code> structure is defined as:</p>
</div>
<div id="VkPerformanceValueINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
typedef struct VkPerformanceValueINTEL {
    VkPerformanceValueTypeINTEL    type;
    VkPerformanceValueDataINTEL    data;
} VkPerformanceValueINTEL;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>type</code> is a <a href="#VkPerformanceValueTypeINTEL">VkPerformanceValueTypeINTEL</a> value specifying the
type of the returned data.</p>
</li>
<li>
<p><code>data</code> is a <a href="#VkPerformanceValueDataINTEL">VkPerformanceValueDataINTEL</a> union specifying the
value of the returned data.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <a href="#VkPerformanceValueINTEL">VkPerformanceValueINTEL</a>::<code>type</code>, specifying the
type of the data returned in <a href="#VkPerformanceValueINTEL">VkPerformanceValueINTEL</a>::<code>data</code>, are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PERFORMANCE_VALUE_TYPE_UINT32_INTEL</code> specifies that unsigned
32-bit integer data is returned in <code>data.value32</code>.</p>
</li>
<li>
<p><code>VK_PERFORMANCE_VALUE_TYPE_UINT64_INTEL</code> specifies that unsigned
64-bit integer data is returned in <code>data.value64</code>.</p>
</li>
<li>
<p><code>VK_PERFORMANCE_VALUE_TYPE_FLOAT_INTEL</code> specifies that
floating-point data is returned in <code>data.valueFloat</code>.</p>
</li>
<li>
<p><code>VK_PERFORMANCE_VALUE_TYPE_BOOL_INTEL</code> specifies that
<code>VkBool32</code> data is returned in <code>data.valueBool</code>.</p>
</li>
<li>
<p><code>VK_PERFORMANCE_VALUE_TYPE_STRING_INTEL</code> specifies that a pointer to
a null-terminated UTF-8 string is returned in <code>data.valueString</code>.
The pointer is valid for the lifetime of the <code>device</code> parameter
passed to <a href="#vkGetPerformanceParameterINTEL">vkGetPerformanceParameterINTEL</a>.</p>
</li>
</ul>
</div>
<div id="VkPerformanceValueTypeINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
typedef enum VkPerformanceValueTypeINTEL {
    VK_PERFORMANCE_VALUE_TYPE_UINT32_INTEL = 0,
    VK_PERFORMANCE_VALUE_TYPE_UINT64_INTEL = 1,
    VK_PERFORMANCE_VALUE_TYPE_FLOAT_INTEL = 2,
    VK_PERFORMANCE_VALUE_TYPE_BOOL_INTEL = 3,
    VK_PERFORMANCE_VALUE_TYPE_STRING_INTEL = 4,
} VkPerformanceValueTypeINTEL;</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPerformanceValueDataINTEL</code> union is defined as:</p>
</div>
<div id="VkPerformanceValueDataINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
typedef union VkPerformanceValueDataINTEL {
    uint32_t       value32;
    uint64_t       value64;
    float          valueFloat;
    VkBool32       valueBool;
    const char*    valueString;
} VkPerformanceValueDataINTEL;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>data.value32</code> represents 32-bit integer data.</p>
</li>
<li>
<p><code>data.value64</code> represents 64-bit integer data.</p>
</li>
<li>
<p><code>data.valueFloat</code> represents floating-point data.</p>
</li>
<li>
<p><code>data.valueBool</code> represents <code>VkBool32</code> data.</p>
</li>
<li>
<p><code>data.valueString</code> represents a pointer to a null-terminated UTF-8
string.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The correct member of the union is determined by the associated
<a href="#VkPerformanceValueTypeINTEL">VkPerformanceValueTypeINTEL</a> value.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkQueryPoolPerformanceQueryCreateInfoINTEL</code> structure is defined
as:</p>
</div>
<div id="VkQueryPoolPerformanceQueryCreateInfoINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
typedef struct VkQueryPoolPerformanceQueryCreateInfoINTEL {
    VkStructureType                 sType;
    const void*                     pNext;
    VkQueryPoolSamplingModeINTEL    performanceCountersSampling;
} VkQueryPoolPerformanceQueryCreateInfoINTEL;</code></pre>
</div>
</div>
<div id="VkQueryPoolCreateInfoINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
typedef VkQueryPoolPerformanceQueryCreateInfoINTEL VkQueryPoolCreateInfoINTEL;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To create a pool for Intel performance queries, set
<a href="#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a>::<code>queryType</code> to
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_INTEL</code> and add a
<code>VkQueryPoolPerformanceQueryCreateInfoINTEL</code> structure to the
<code>pNext</code> chain of the <a href="#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a> structure.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>performanceCountersSampling</code> describe how performance queries
should be captured.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkQueryPoolPerformanceQueryCreateInfoINTEL-sType-sType" href="#VUID-VkQueryPoolPerformanceQueryCreateInfoINTEL-sType-sType"></a> <span class="vuid">VUID-VkQueryPoolPerformanceQueryCreateInfoINTEL-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_QUERY_POOL_PERFORMANCE_QUERY_CREATE_INFO_INTEL</code></p>
</li>
<li>
<p><a id="VUID-VkQueryPoolPerformanceQueryCreateInfoINTEL-performanceCountersSampling-parameter" href="#VUID-VkQueryPoolPerformanceQueryCreateInfoINTEL-performanceCountersSampling-parameter"></a> <span class="vuid">VUID-VkQueryPoolPerformanceQueryCreateInfoINTEL-performanceCountersSampling-parameter</span><br>
 <code>performanceCountersSampling</code> <strong>must</strong> be a valid <a href="#VkQueryPoolSamplingModeINTEL">VkQueryPoolSamplingModeINTEL</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of
<a href="#VkQueryPoolPerformanceQueryCreateInfoINTEL">VkQueryPoolPerformanceQueryCreateInfoINTEL</a>::<code>performanceCountersSampling</code>
are:</p>
</div>
<div id="VkQueryPoolSamplingModeINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
typedef enum VkQueryPoolSamplingModeINTEL {
    VK_QUERY_POOL_SAMPLING_MODE_MANUAL_INTEL = 0,
} VkQueryPoolSamplingModeINTEL;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_QUERY_POOL_SAMPLING_MODE_MANUAL_INTEL</code> is the default mode in
which the application calls <a href="#vkCmdBeginQuery">vkCmdBeginQuery</a> and
<a href="#vkCmdEndQuery">vkCmdEndQuery</a> to record performance data.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To help associate query results with a particular point at which an
application emitted commands, markers can be set into the command buffers
with the call:</p>
</div>
<div id="vkCmdSetPerformanceMarkerINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
VkResult vkCmdSetPerformanceMarkerINTEL(
    VkCommandBuffer                             commandBuffer,
    const VkPerformanceMarkerInfoINTEL*         pMarkerInfo);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The last marker set onto a command buffer before the end of a query will be
part of the query result.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetPerformanceMarkerINTEL-commandBuffer-parameter" href="#VUID-vkCmdSetPerformanceMarkerINTEL-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetPerformanceMarkerINTEL-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetPerformanceMarkerINTEL-pMarkerInfo-parameter" href="#VUID-vkCmdSetPerformanceMarkerINTEL-pMarkerInfo-parameter"></a> <span class="vuid">VUID-vkCmdSetPerformanceMarkerINTEL-pMarkerInfo-parameter</span><br>
 <code>pMarkerInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkPerformanceMarkerInfoINTEL">VkPerformanceMarkerInfoINTEL</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdSetPerformanceMarkerINTEL-commandBuffer-recording" href="#VUID-vkCmdSetPerformanceMarkerINTEL-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetPerformanceMarkerINTEL-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetPerformanceMarkerINTEL-commandBuffer-cmdpool" href="#VUID-vkCmdSetPerformanceMarkerINTEL-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetPerformanceMarkerINTEL-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics, compute, or transfer operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetPerformanceMarkerINTEL-videocoding" href="#VUID-vkCmdSetPerformanceMarkerINTEL-videocoding"></a> <span class="vuid">VUID-vkCmdSetPerformanceMarkerINTEL-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="videocoding.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute<br>
Transfer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action<br>
State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPerformanceMarkerInfoINTEL</code> structure is defined as:</p>
</div>
<div id="VkPerformanceMarkerInfoINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
typedef struct VkPerformanceMarkerInfoINTEL {
    VkStructureType    sType;
    const void*        pNext;
    uint64_t           marker;
} VkPerformanceMarkerInfoINTEL;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>marker</code> is the marker value that will be recorded into the opaque
query results.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPerformanceMarkerInfoINTEL-sType-sType" href="#VUID-VkPerformanceMarkerInfoINTEL-sType-sType"></a> <span class="vuid">VUID-VkPerformanceMarkerInfoINTEL-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_PERFORMANCE_MARKER_INFO_INTEL</code></p>
</li>
<li>
<p><a id="VUID-VkPerformanceMarkerInfoINTEL-pNext-pNext" href="#VUID-VkPerformanceMarkerInfoINTEL-pNext-pNext"></a> <span class="vuid">VUID-VkPerformanceMarkerInfoINTEL-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When monitoring the behavior of an application within the dataset generated
by the entire set of applications running on the system, it is useful to
identify draw calls within a potentially huge amount of performance data.
To do so, application can generate stream markers that will be used to trace
back a particular draw call with a particular performance data item.</p>
</div>
<div id="vkCmdSetPerformanceStreamMarkerINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
VkResult vkCmdSetPerformanceStreamMarkerINTEL(
    VkCommandBuffer                             commandBuffer,
    const VkPerformanceStreamMarkerInfoINTEL*   pMarkerInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is a <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> into which a stream
marker is added.</p>
</li>
<li>
<p><code>pMarkerInfo</code> is a pointer to a
<a href="#VkPerformanceStreamMarkerInfoINTEL">VkPerformanceStreamMarkerInfoINTEL</a> structure describing the marker
to insert.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetPerformanceStreamMarkerINTEL-commandBuffer-parameter" href="#VUID-vkCmdSetPerformanceStreamMarkerINTEL-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetPerformanceStreamMarkerINTEL-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetPerformanceStreamMarkerINTEL-pMarkerInfo-parameter" href="#VUID-vkCmdSetPerformanceStreamMarkerINTEL-pMarkerInfo-parameter"></a> <span class="vuid">VUID-vkCmdSetPerformanceStreamMarkerINTEL-pMarkerInfo-parameter</span><br>
 <code>pMarkerInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkPerformanceStreamMarkerInfoINTEL">VkPerformanceStreamMarkerInfoINTEL</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdSetPerformanceStreamMarkerINTEL-commandBuffer-recording" href="#VUID-vkCmdSetPerformanceStreamMarkerINTEL-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetPerformanceStreamMarkerINTEL-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetPerformanceStreamMarkerINTEL-commandBuffer-cmdpool" href="#VUID-vkCmdSetPerformanceStreamMarkerINTEL-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetPerformanceStreamMarkerINTEL-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics, compute, or transfer operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetPerformanceStreamMarkerINTEL-videocoding" href="#VUID-vkCmdSetPerformanceStreamMarkerINTEL-videocoding"></a> <span class="vuid">VUID-vkCmdSetPerformanceStreamMarkerINTEL-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="videocoding.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute<br>
Transfer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action<br>
State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPerformanceStreamMarkerInfoINTEL</code> structure is defined as:</p>
</div>
<div id="VkPerformanceStreamMarkerInfoINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
typedef struct VkPerformanceStreamMarkerInfoINTEL {
    VkStructureType    sType;
    const void*        pNext;
    uint32_t           marker;
} VkPerformanceStreamMarkerInfoINTEL;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>marker</code> is the marker value that will be recorded into the reports
consumed by an external application.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPerformanceStreamMarkerInfoINTEL-marker-02735" href="#VUID-VkPerformanceStreamMarkerInfoINTEL-marker-02735"></a> <span class="vuid">VUID-VkPerformanceStreamMarkerInfoINTEL-marker-02735</span><br>

The value written by the application into <code>marker</code> <strong>must</strong> only used
the valid bits as reported by <a href="#vkGetPerformanceParameterINTEL">vkGetPerformanceParameterINTEL</a> with
the <code>VK_PERFORMANCE_PARAMETER_TYPE_STREAM_MARKER_VALID_BITS_INTEL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPerformanceStreamMarkerInfoINTEL-sType-sType" href="#VUID-VkPerformanceStreamMarkerInfoINTEL-sType-sType"></a> <span class="vuid">VUID-VkPerformanceStreamMarkerInfoINTEL-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_PERFORMANCE_STREAM_MARKER_INFO_INTEL</code></p>
</li>
<li>
<p><a id="VUID-VkPerformanceStreamMarkerInfoINTEL-pNext-pNext" href="#VUID-VkPerformanceStreamMarkerInfoINTEL-pNext-pNext"></a> <span class="vuid">VUID-VkPerformanceStreamMarkerInfoINTEL-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Some applications might want measure the effect of a set of commands with a
different settings.
It is possible to override a particular settings using :</p>
</div>
<div id="vkCmdSetPerformanceOverrideINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
VkResult vkCmdSetPerformanceOverrideINTEL(
    VkCommandBuffer                             commandBuffer,
    const VkPerformanceOverrideInfoINTEL*       pOverrideInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer where the override takes
place.</p>
</li>
<li>
<p><code>pOverrideInfo</code> is a pointer to a
<a href="#VkPerformanceOverrideInfoINTEL">VkPerformanceOverrideInfoINTEL</a> structure selecting the parameter
to override.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetPerformanceOverrideINTEL-pOverrideInfo-02736" href="#VUID-vkCmdSetPerformanceOverrideINTEL-pOverrideInfo-02736"></a> <span class="vuid">VUID-vkCmdSetPerformanceOverrideINTEL-pOverrideInfo-02736</span><br>

<code>pOverrideInfo</code> <strong>must</strong> not be used with a
<a href="#VkPerformanceOverrideTypeINTEL">VkPerformanceOverrideTypeINTEL</a> that is not reported available by
<code>vkGetPerformanceParameterINTEL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetPerformanceOverrideINTEL-commandBuffer-parameter" href="#VUID-vkCmdSetPerformanceOverrideINTEL-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetPerformanceOverrideINTEL-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetPerformanceOverrideINTEL-pOverrideInfo-parameter" href="#VUID-vkCmdSetPerformanceOverrideINTEL-pOverrideInfo-parameter"></a> <span class="vuid">VUID-vkCmdSetPerformanceOverrideINTEL-pOverrideInfo-parameter</span><br>
 <code>pOverrideInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkPerformanceOverrideInfoINTEL">VkPerformanceOverrideInfoINTEL</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdSetPerformanceOverrideINTEL-commandBuffer-recording" href="#VUID-vkCmdSetPerformanceOverrideINTEL-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetPerformanceOverrideINTEL-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetPerformanceOverrideINTEL-commandBuffer-cmdpool" href="#VUID-vkCmdSetPerformanceOverrideINTEL-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetPerformanceOverrideINTEL-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics, compute, or transfer operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetPerformanceOverrideINTEL-videocoding" href="#VUID-vkCmdSetPerformanceOverrideINTEL-videocoding"></a> <span class="vuid">VUID-vkCmdSetPerformanceOverrideINTEL-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="videocoding.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute<br>
Transfer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPerformanceOverrideInfoINTEL</code> structure is defined as:</p>
</div>
<div id="VkPerformanceOverrideInfoINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
typedef struct VkPerformanceOverrideInfoINTEL {
    VkStructureType                   sType;
    const void*                       pNext;
    VkPerformanceOverrideTypeINTEL    type;
    VkBool32                          enable;
    uint64_t                          parameter;
} VkPerformanceOverrideInfoINTEL;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>type</code> is the particular <a href="#VkPerformanceOverrideTypeINTEL">VkPerformanceOverrideTypeINTEL</a> to
set.</p>
</li>
<li>
<p><code>enable</code> defines whether the override is enabled.</p>
</li>
<li>
<p><code>parameter</code> is a potential required parameter for the override.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPerformanceOverrideInfoINTEL-sType-sType" href="#VUID-VkPerformanceOverrideInfoINTEL-sType-sType"></a> <span class="vuid">VUID-VkPerformanceOverrideInfoINTEL-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_PERFORMANCE_OVERRIDE_INFO_INTEL</code></p>
</li>
<li>
<p><a id="VUID-VkPerformanceOverrideInfoINTEL-pNext-pNext" href="#VUID-VkPerformanceOverrideInfoINTEL-pNext-pNext"></a> <span class="vuid">VUID-VkPerformanceOverrideInfoINTEL-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkPerformanceOverrideInfoINTEL-type-parameter" href="#VUID-VkPerformanceOverrideInfoINTEL-type-parameter"></a> <span class="vuid">VUID-VkPerformanceOverrideInfoINTEL-type-parameter</span><br>
 <code>type</code> <strong>must</strong> be a valid <a href="#VkPerformanceOverrideTypeINTEL">VkPerformanceOverrideTypeINTEL</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <a href="#VkPerformanceOverrideInfoINTEL">VkPerformanceOverrideInfoINTEL</a>::<code>type</code>,
specifying performance override types, are:</p>
</div>
<div id="VkPerformanceOverrideTypeINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
typedef enum VkPerformanceOverrideTypeINTEL {
    VK_PERFORMANCE_OVERRIDE_TYPE_NULL_HARDWARE_INTEL = 0,
    VK_PERFORMANCE_OVERRIDE_TYPE_FLUSH_GPU_CACHES_INTEL = 1,
} VkPerformanceOverrideTypeINTEL;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PERFORMANCE_OVERRIDE_TYPE_NULL_HARDWARE_INTEL</code> turns all
rendering operations into noop.</p>
</li>
<li>
<p><code>VK_PERFORMANCE_OVERRIDE_TYPE_FLUSH_GPU_CACHES_INTEL</code> stalls the
stream of commands until all previously emitted commands have completed
and all caches been flushed and invalidated.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Before submitting command buffers containing performance queries commands to
a device queue, the application must acquire and set a performance query
configuration.
The configuration can be released once all command buffers containing
performance query commands are not in a pending state.</p>
</div>
<div id="VkPerformanceConfigurationINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkPerformanceConfigurationINTEL)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To acquire a device performance configuration, call:</p>
</div>
<div id="vkAcquirePerformanceConfigurationINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
VkResult vkAcquirePerformanceConfigurationINTEL(
    VkDevice                                    device,
    const VkPerformanceConfigurationAcquireInfoINTEL* pAcquireInfo,
    VkPerformanceConfigurationINTEL*            pConfiguration);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that the performance query commands
will be submitted to.</p>
</li>
<li>
<p><code>pAcquireInfo</code> is a pointer to a
<a href="#VkPerformanceConfigurationAcquireInfoINTEL">VkPerformanceConfigurationAcquireInfoINTEL</a> structure, specifying
the performance configuration to acquire.</p>
</li>
<li>
<p><code>pConfiguration</code> is a pointer to a
<code>VkPerformanceConfigurationINTEL</code> handle in which the resulting
configuration object is returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkAcquirePerformanceConfigurationINTEL-device-parameter" href="#VUID-vkAcquirePerformanceConfigurationINTEL-device-parameter"></a> <span class="vuid">VUID-vkAcquirePerformanceConfigurationINTEL-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkAcquirePerformanceConfigurationINTEL-pAcquireInfo-parameter" href="#VUID-vkAcquirePerformanceConfigurationINTEL-pAcquireInfo-parameter"></a> <span class="vuid">VUID-vkAcquirePerformanceConfigurationINTEL-pAcquireInfo-parameter</span><br>
 <code>pAcquireInfo</code> <strong>must</strong> be a valid pointer to a valid <a href="#VkPerformanceConfigurationAcquireInfoINTEL">VkPerformanceConfigurationAcquireInfoINTEL</a> structure</p>
</li>
<li>
<p><a id="VUID-vkAcquirePerformanceConfigurationINTEL-pConfiguration-parameter" href="#VUID-vkAcquirePerformanceConfigurationINTEL-pConfiguration-parameter"></a> <span class="vuid">VUID-vkAcquirePerformanceConfigurationINTEL-pConfiguration-parameter</span><br>
 <code>pConfiguration</code> <strong>must</strong> be a valid pointer to a <a href="#VkPerformanceConfigurationINTEL">VkPerformanceConfigurationINTEL</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPerformanceConfigurationAcquireInfoINTEL</code> structure is defined
as:</p>
</div>
<div id="VkPerformanceConfigurationAcquireInfoINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
typedef struct VkPerformanceConfigurationAcquireInfoINTEL {
    VkStructureType                        sType;
    const void*                            pNext;
    VkPerformanceConfigurationTypeINTEL    type;
} VkPerformanceConfigurationAcquireInfoINTEL;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>type</code> is one of the <a href="#VkPerformanceConfigurationTypeINTEL">VkPerformanceConfigurationTypeINTEL</a> type
of performance configuration that will be acquired.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPerformanceConfigurationAcquireInfoINTEL-sType-sType" href="#VUID-VkPerformanceConfigurationAcquireInfoINTEL-sType-sType"></a> <span class="vuid">VUID-VkPerformanceConfigurationAcquireInfoINTEL-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_PERFORMANCE_CONFIGURATION_ACQUIRE_INFO_INTEL</code></p>
</li>
<li>
<p><a id="VUID-VkPerformanceConfigurationAcquireInfoINTEL-pNext-pNext" href="#VUID-VkPerformanceConfigurationAcquireInfoINTEL-pNext-pNext"></a> <span class="vuid">VUID-VkPerformanceConfigurationAcquireInfoINTEL-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkPerformanceConfigurationAcquireInfoINTEL-type-parameter" href="#VUID-VkPerformanceConfigurationAcquireInfoINTEL-type-parameter"></a> <span class="vuid">VUID-VkPerformanceConfigurationAcquireInfoINTEL-type-parameter</span><br>
 <code>type</code> <strong>must</strong> be a valid <a href="#VkPerformanceConfigurationTypeINTEL">VkPerformanceConfigurationTypeINTEL</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of
<a href="#VkPerformanceConfigurationAcquireInfoINTEL">VkPerformanceConfigurationAcquireInfoINTEL</a>::<code>type</code>, specifying
performance configuration types, are:</p>
</div>
<div id="VkPerformanceConfigurationTypeINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
typedef enum VkPerformanceConfigurationTypeINTEL {
    VK_PERFORMANCE_CONFIGURATION_TYPE_COMMAND_QUEUE_METRICS_DISCOVERY_ACTIVATED_INTEL = 0,
} VkPerformanceConfigurationTypeINTEL;</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To set a performance configuration, call:</p>
</div>
<div id="vkQueueSetPerformanceConfigurationINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
VkResult vkQueueSetPerformanceConfigurationINTEL(
    VkQueue                                     queue,
    VkPerformanceConfigurationINTEL             configuration);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>queue</code> is the queue on which the configuration will be used.</p>
</li>
<li>
<p><code>configuration</code> is the configuration to use.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkQueueSetPerformanceConfigurationINTEL-queue-parameter" href="#VUID-vkQueueSetPerformanceConfigurationINTEL-queue-parameter"></a> <span class="vuid">VUID-vkQueueSetPerformanceConfigurationINTEL-queue-parameter</span><br>
 <code>queue</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkQueue" class="xref page">VkQueue</a> handle</p>
</li>
<li>
<p><a id="VUID-vkQueueSetPerformanceConfigurationINTEL-configuration-parameter" href="#VUID-vkQueueSetPerformanceConfigurationINTEL-configuration-parameter"></a> <span class="vuid">VUID-vkQueueSetPerformanceConfigurationINTEL-configuration-parameter</span><br>
 <code>configuration</code> <strong>must</strong> be a valid <a href="#VkPerformanceConfigurationINTEL">VkPerformanceConfigurationINTEL</a> handle</p>
</li>
<li>
<p><a id="VUID-vkQueueSetPerformanceConfigurationINTEL-commonparent" href="#VUID-vkQueueSetPerformanceConfigurationINTEL-commonparent"></a> <span class="vuid">VUID-vkQueueSetPerformanceConfigurationINTEL-commonparent</span><br>
 Both of <code>configuration</code>, and <code>queue</code> <strong>must</strong> have been created, allocated, or retrieved from the same <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="videocoding.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To release a device performance configuration, call:</p>
</div>
<div id="vkReleasePerformanceConfigurationINTEL" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_INTEL_performance_query
VkResult vkReleasePerformanceConfigurationINTEL(
    VkDevice                                    device,
    VkPerformanceConfigurationINTEL             configuration);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device associated to the configuration object to
release.</p>
</li>
<li>
<p><code>configuration</code> is the configuration object to release.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkReleasePerformanceConfigurationINTEL-configuration-02737" href="#VUID-vkReleasePerformanceConfigurationINTEL-configuration-02737"></a> <span class="vuid">VUID-vkReleasePerformanceConfigurationINTEL-configuration-02737</span><br>

<code>configuration</code> <strong>must</strong> not be released before all command buffers
submitted while the configuration was set are in
<a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">pending state</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkReleasePerformanceConfigurationINTEL-device-parameter" href="#VUID-vkReleasePerformanceConfigurationINTEL-device-parameter"></a> <span class="vuid">VUID-vkReleasePerformanceConfigurationINTEL-device-parameter</span><br>
 <code>device</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkDevice" class="xref page">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkReleasePerformanceConfigurationINTEL-configuration-parameter" href="#VUID-vkReleasePerformanceConfigurationINTEL-configuration-parameter"></a> <span class="vuid">VUID-vkReleasePerformanceConfigurationINTEL-configuration-parameter</span><br>
 If <code>configuration</code> is not <a href="../appendices/boilerplate.html#VK_NULL_HANDLE" class="xref page">VK_NULL_HANDLE</a>, <code>configuration</code> <strong>must</strong> be a valid <a href="#VkPerformanceConfigurationINTEL">VkPerformanceConfigurationINTEL</a> handle</p>
</li>
<li>
<p><a id="VUID-vkReleasePerformanceConfigurationINTEL-configuration-parent" href="#VUID-vkReleasePerformanceConfigurationINTEL-configuration-parent"></a> <span class="vuid">VUID-vkReleasePerformanceConfigurationINTEL-configuration-parent</span><br>
 If <code>configuration</code> is a valid handle, it <strong>must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>configuration</code> <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="queries-result-status-only"><a class="anchor" href="#queries-result-status-only"></a>Result Status Queries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Result status queries serve a single purpose: allowing the application to
determine whether a set of operations have completed successfully or not, as
indicated by the <a href="#VkQueryResultStatusKHR">VkQueryResultStatusKHR</a> value written when retrieving
the result of a query using the <code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code>
flag.</p>
</div>
<div class="paragraph">
<p>Unlike other query types, result status queries do not track or maintain any
other data beyond the completion status, thus no other data is written when
retrieving their results.</p>
</div>
<div class="paragraph">
<p>Support for result status queries is indicated by
<a href="devsandqueues.html#VkQueueFamilyQueryResultStatusPropertiesKHR" class="xref page">VkQueueFamilyQueryResultStatusPropertiesKHR</a>::<code>queryResultStatusSupport</code>
, as returned by <a href="devsandqueues.html#vkGetPhysicalDeviceQueueFamilyProperties2" class="xref page">vkGetPhysicalDeviceQueueFamilyProperties2</a> for the
queue family in question.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="queries-video-encode-feedback"><a class="anchor" href="#queries-video-encode-feedback"></a>Video Encode Feedback Queries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Video encode feedback queries allow the application to capture feedback
values generated by video encode operations.
As such, video encode feedback queries are available on queue families
supporting video encode operations.
The availability of individual video encode feedback values is indicated by
the bits of
<a href="videocoding.html#VkVideoEncodeCapabilitiesKHR" class="xref page">VkVideoEncodeCapabilitiesKHR</a>::<code>supportedEncodeFeedbackFlags</code>, as
returned by <a href="videocoding.html#vkGetPhysicalDeviceVideoCapabilitiesKHR" class="xref page">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the
<a href="videocoding.html#video-profiles" class="xref page">video profile</a> the queries are intended to be used with.</p>
</div>
<div class="paragraph">
<p>The set of enabled video encode feedback values <strong>must</strong> be configured on the
query pool when it is created using the <code>encodeFeedbackFlags</code> member of
the <a href="#VkQueryPoolVideoEncodeFeedbackCreateInfoKHR">VkQueryPoolVideoEncodeFeedbackCreateInfoKHR</a> included in the
<code>pNext</code> chain of <a href="#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkQueryPoolVideoEncodeFeedbackCreateInfoKHR</code> structure is defined
as:</p>
</div>
<div id="VkQueryPoolVideoEncodeFeedbackCreateInfoKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef struct VkQueryPoolVideoEncodeFeedbackCreateInfoKHR {
    VkStructureType                  sType;
    const void*                      pNext;
    VkVideoEncodeFeedbackFlagsKHR    encodeFeedbackFlags;
} VkQueryPoolVideoEncodeFeedbackCreateInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>encodeFeedbackFlags</code> is a bitmask of
<a href="#VkVideoEncodeFeedbackFlagBitsKHR">VkVideoEncodeFeedbackFlagBitsKHR</a> values specifying the set of
enabled video encode feedback values captured by queries of the new
pool.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkQueryPoolVideoEncodeFeedbackCreateInfoKHR-sType-sType" href="#VUID-VkQueryPoolVideoEncodeFeedbackCreateInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkQueryPoolVideoEncodeFeedbackCreateInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_QUERY_POOL_VIDEO_ENCODE_FEEDBACK_CREATE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkQueryPoolVideoEncodeFeedbackCreateInfoKHR-encodeFeedbackFlags-parameter" href="#VUID-VkQueryPoolVideoEncodeFeedbackCreateInfoKHR-encodeFeedbackFlags-parameter"></a> <span class="vuid">VUID-VkQueryPoolVideoEncodeFeedbackCreateInfoKHR-encodeFeedbackFlags-parameter</span><br>
 <code>encodeFeedbackFlags</code> <strong>must</strong> be a valid combination of <a href="#VkVideoEncodeFeedbackFlagBitsKHR">VkVideoEncodeFeedbackFlagBitsKHR</a> values</p>
</li>
<li>
<p><a id="VUID-VkQueryPoolVideoEncodeFeedbackCreateInfoKHR-encodeFeedbackFlags-requiredbitmask" href="#VUID-VkQueryPoolVideoEncodeFeedbackCreateInfoKHR-encodeFeedbackFlags-requiredbitmask"></a> <span class="vuid">VUID-VkQueryPoolVideoEncodeFeedbackCreateInfoKHR-encodeFeedbackFlags-requiredbitmask</span><br>
 <code>encodeFeedbackFlags</code> <strong>must</strong> not be <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in
<a href="#VkQueryPoolVideoEncodeFeedbackCreateInfoKHR">VkQueryPoolVideoEncodeFeedbackCreateInfoKHR</a>::<code>encodeFeedbackFlags</code>
for video encode feedback query pools are:</p>
</div>
<div id="VkVideoEncodeFeedbackFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef enum VkVideoEncodeFeedbackFlagBitsKHR {
    VK_VIDEO_ENCODE_FEEDBACK_BITSTREAM_BUFFER_OFFSET_BIT_KHR = 0x00000001,
    VK_VIDEO_ENCODE_FEEDBACK_BITSTREAM_BYTES_WRITTEN_BIT_KHR = 0x00000002,
    VK_VIDEO_ENCODE_FEEDBACK_BITSTREAM_HAS_OVERRIDES_BIT_KHR = 0x00000004,
} VkVideoEncodeFeedbackFlagBitsKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_FEEDBACK_BITSTREAM_BUFFER_OFFSET_BIT_KHR</code> specifies
that queries managed by the pool will capture the byte offset of the
bitstream data written by the video encode operation to the bitstream
buffer specified in <a href="videocoding.html#VkVideoEncodeInfoKHR" class="xref page">VkVideoEncodeInfoKHR</a>::<code>dstBuffer</code> relative
to the offset specified in
<a href="videocoding.html#VkVideoEncodeInfoKHR" class="xref page">VkVideoEncodeInfoKHR</a>::<code>dstBufferOffset</code>.
For the first video encode operation issued by any
<a href="videocoding.html#video-encode-commands" class="xref page">video encode command</a>, this value will always
be zero, meaning that bitstream data is always written to the buffer
specified in <a href="videocoding.html#VkVideoEncodeInfoKHR" class="xref page">VkVideoEncodeInfoKHR</a>::<code>dstBuffer</code> starting from
the offset specified in
<a href="videocoding.html#VkVideoEncodeInfoKHR" class="xref page">VkVideoEncodeInfoKHR</a>::<code>dstBufferOffset</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_FEEDBACK_BITSTREAM_BYTES_WRITTEN_BIT_KHR</code> specifies
that queries managed by the pool will capture the number of bytes
written by the video encode operation to the bitstream buffer specified
in <a href="videocoding.html#VkVideoEncodeInfoKHR" class="xref page">VkVideoEncodeInfoKHR</a>::<code>dstBuffer</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_FEEDBACK_BITSTREAM_HAS_OVERRIDES_BIT_KHR</code> specifies
that queries managed by the pool will capture a boolean value indicating
that the data written to the bitstream buffer specified in
<a href="videocoding.html#VkVideoEncodeInfoKHR" class="xref page">VkVideoEncodeInfoKHR</a>::<code>dstBuffer</code> contains
<a href="videocoding.html#encode-overrides" class="xref page">overridden parameters</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When retrieving the results of video encode feedback queries, the values
corresponding to each enabled video encode feedback are written in the order
of the bits defined above, followed by an optional value indicating
availability or result status if <code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code>
or <code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code> is specified, respectively.</p>
</div>
<div class="paragraph">
<p>If the result status of a video encode feedback query is negative, then the
results of all enabled video encode feedback values will be <strong>undefined</strong>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Thus it is recommended that applications always specify
<code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code> when retrieving the results of
video encode feedback queries and ignore such <strong>undefined</strong> video encode
feedback values for any <a href="videocoding.html#encode-unsuccessful" class="xref page">unsuccessfully</a> completed
video encode operations.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeFeedbackFlagsKHR" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_KHR_video_encode_queue
typedef VkFlags VkVideoEncodeFeedbackFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeFeedbackFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <a href="#VkVideoEncodeFeedbackFlagBitsKHR">VkVideoEncodeFeedbackFlagBitsKHR</a>.</p>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
    <!--
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
    -->
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Fragment Operations :: Vulkan Documentation Project Demo</title>
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../..">Vulkan Documentation Project Demo</a>
      <div class="navbar-item">
        <img alt="Vulkan White Label" src="../../../_/Vulkan_White_Dec16.svg" height="100%" />
      </div>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <label for="search-input"></label><input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <!-- <a class="navbar-item" href="#">Home</a> -->
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Specs</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../spec/latest/chapters/introduction.html">Vulkan 1.3</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Guides</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../guide/latest/index.html">Vulkan Guide</a>
          </div>
        </div>
            <!--
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Tools</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">TBD</a>
          </div>
        </div>
            -->
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Tutorial</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../tutorial/latest/index.html">Vulkan Tutorial</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Samples</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../samples/latest/README.html">Vulkan Samples</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Help</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="https://discord.gg/vulkan">Vulkan Discord</a>
            <a class="navbar-item" href="https://khr.io/khrdiscord">Khronos Discord</a>
          </div>
        </div>
            <!--
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
            -->
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="spec" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Vulkan Specification and Proposals</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fundamentals.html">Fundamentals</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="initialization.html">Initialization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="devsandqueues.html">Devices and Queues</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cmdbuffers.html">Command Buffers</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="synchronization.html">Synchronization and Cache Control</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="renderpass.html">Render Pass</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="shaders.html">Shaders</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="pipelines.html">Pipelines</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="memory.html">Memory Allocation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="resources.html">Resource Creation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="samplers.html">Samplers</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="descriptorsets.html">Resource Descriptors</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="interfaces.html">Shader Interfaces</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="textures.html">Image Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fragmentdensitymapops.html">Fragment Density Map Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="queries.html">Queries</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="clears.html">Clear Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="copies.html">Copy Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="drawing.html">Drawing Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="fxvertex.html">Fixed-Function Vertex Processing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="tessellation.html">Tessellation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="geometry.html">Geometry Shading</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_mesh_shader/mesh.html">Mesh Shading</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_HUAWEI_cluster_culling_shader/clusterculling.html">Cluster Culling Shading</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="vertexpostproc.html">Fixed-Function Vertex Post-Processing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="primsrast.html">Rasterization</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="fragops.html">Fragment Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="framebuffer.html">The Framebuffer</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dispatch.html">Dispatching Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_device_generated_commands/generatedcommands.html">Device-Generated Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="sparsemem.html">Sparse Resources</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_KHR_surface/wsi.html">Window System Integration (WSI)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_KHR_deferred_host_operations/deferred_host_operations.html">Deferred Host Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_EXT_private_data.html">Private Data</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="accelstructures.html">Acceleration Structures</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_EXT_opacity_micromap/micromaps.html">Micromap</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="raytraversal.html">Ray Traversal</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="raytracing.html">Ray Tracing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_memory_decompression.html">Memory Decompression</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="video_extensions.html">Video Coding</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="VK_NV_optical_flow/optical_flow.html">Optical Flow</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="extensions.html">Extending Vulkan</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="features.html">Features</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="limits.html">Limits</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="formats.html">Formats</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="capabilities.html">Additional Capabilities</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="debugging.html">Debugging</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/spirvenv.html">Vulkan Environment for SPIR-V</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/memorymodel.html">Memory Model</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/compressedtex.html">Compressed Image Formats</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/versions.html">Core Revisions (Informative)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/extensions.html">Layers &amp; Extensions (Informative)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/roadmap.html">Vulkan Roadmap Milestones</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/boilerplate.html">API Boilerplate</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/invariance.html">Invariance</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/glossary.html">Lexicon</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendices/credits.html">Credits (Informative)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../proposals/index.html">Vulkan Proposals</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Vulkan Roadmap</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/Roadmap.html">Vulkan Roadmap</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Extension Proposals</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_AMD_shader_early_and_late_fragment_tests.html">VK_AMD_shader_early_and_late_fragment_tests</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_attachment_feedback_loop_layout.html">VK_EXT_attachment_feedback_loop_layout</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_graphics_pipeline_library.html">VK_EXT_graphics_pipeline_library</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_image_2d_array_of_3d.html">VK_EXT_image_2d_array_of_3d</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_image_compression_control.html">VK_EXT_image_compression_control</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_metal_objects.html">VK_EXT_metal_objects</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_multisampled_render_to_single_sampled.html">VK_EXT_multisampled_render_to_single_sampled</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_non_seamless_cube_map.html">VK_EXT_non_seamless_cube_map</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_primitives_generated_query.html">VK_EXT_primitives_generated_query</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_rasterization_order_attachment_access.html">VK_EXT_rasterization_order_attachment_access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_shader_module_identifier.html">VK_EXT_shader_module_identifier</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_EXT_subpass_merge_feedback.html">VK_EXT_subpass_merge_feedback</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_GOOGLE_surfaceless_query.html">VK_GOOGLE_surfaceless_query</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_HUAWEI_invocation_mask.html">VK_HUAWEI_invocation_mask</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_KHR_dynamic_rendering.html">VK_KHR_dynamic_rendering</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_KHR_fragment_shader_barycentric.html">VK_KHR_fragment_shader_barycentric</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_KHR_fragment_shading_rate.html">VK_KHR_fragment_shading_rate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_KHR_shader_integer_dot_product.html">VK_KHR_shader_integer_dot_product</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_QCOM_image_processing.html">VK_QCOM_image_processing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/VK_QCOM_tile_properties.html">VK_QCOM_tile_properties</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Extension Proposal Template</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../proposals/proposals/template.html">Proposal Template</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Vulkan Specification and Proposals</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../tutorial/latest/00_Introduction.html">Khronos Vulkan Tutorial</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../tutorial/latest/00_Introduction.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../guide/latest/index.html">Vulkan Guide</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../guide/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../samples/latest/README.html">Vulkan Samples</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../samples/latest/README.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../index.html">Vulkan Specification and Proposals</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Vulkan Specification and Proposals</a></li>
    <li><a href="fragops.html">Fragment Operations</a></li>
  </ul>
</nav>
    <!--
  <div class="edit-this-page"><a href="https://github.com/KhronosGroup/Vulkan-Docs/edit/main/antora/modules/ROOT/pages/chapters/fragops.adoc">Edit this Page</a></div>
      -->
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Fragment Operations</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Fragments produced by rasterization go through a number of operations to
determine whether or how values produced by fragment shading are written to
the framebuffer.</p>
</div>
<div class="paragraph">
<p>The following fragment operations adhere to <a href="primsrast.html#primsrast-order" class="xref page">rasterizationorder</a>, and are typically performed in this order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#fragops-discard-rectangles">Discard rectangles test</a></p>
</li>
<li>
<p><a href="#fragops-scissor">Scissor test</a></p>
</li>
<li>
<p><a href="#fragops-exclusive-scissor">Exclusive scissor test</a></p>
</li>
<li>
<p><a href="#fragops-samplemask">Sample mask test</a></p>
</li>
<li>
<p>Certain <a href="#fragops-shader">Fragment shading</a> operations:</p>
<div class="ulist">
<ul>
<li>
<p><a href="#fragops-shader-samplemask">Sample Mask Accesses</a></p>
</li>
<li>
<p><a href="#fragops-shader-tileimage-reads">Tile Image Reads</a></p>
</li>
<li>
<p><a href="#fragops-shader-depthreplacement">Depth Replacement</a></p>
</li>
<li>
<p><a href="#fragops-shader-stencilrefreplacement">Stencil Reference Replacement</a></p>
</li>
<li>
<p><a href="#fragops-shader-interlock">Interlocked Operations</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="#fragops-covg">Multisample coverage</a></p>
</li>
<li>
<p><a href="#fragops-dbt">Depth bounds test</a></p>
</li>
<li>
<p><a href="#fragops-stencil">Stencil test</a></p>
</li>
<li>
<p><a href="#fragops-depth">Depth test</a></p>
</li>
<li>
<p><a href="#fragops-rep-frag-test">Representative fragment test</a></p>
</li>
<li>
<p><a href="#fragops-samplecount">Sample counting</a></p>
</li>
<li>
<p><a href="#fragops-coverage-to-color">Coverage to color</a></p>
</li>
<li>
<p><a href="#fragops-coverage-reduction">Coverage reduction</a></p>
</li>
<li>
<p><a href="#fragops-coverage-modulation">Coverage modulation</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The <a href="primsrast.html#primsrast-multisampling-coverage-mask" class="xref page">coverage mask</a> generated by
rasterization describes the initial coverage of each sample covered by the
fragment.
Fragment operations will update the coverage mask to add or subtract
coverage where appropriate.
If a fragment operation results in all bits of the coverage mask being <code>0</code>,
the fragment is discarded, and no further operations are performed.
Fragments can also be programmatically discarded in a fragment shader by
executing one of</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>OpTerminateInvocation</code></p>
</li>
<li>
<p><code>OpDemoteToHelperInvocationEXT</code></p>
</li>
<li>
<p><code>OpKill</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When one of the fragment operations in this chapter is described as
&#8220;replacing&#8221; a fragment shader output, that output is replaced
unconditionally, even if no fragment shader previously wrote to that output.</p>
</div>
<div class="paragraph">
<p>If there is a <a href="#fragops-shader">fragment shader</a> and it declares the
<code>PostDepthCoverage</code> execution mode, the <a href="#fragops-samplemask">sample masktest</a> is instead performed after the <a href="#fragops-depth">depth test</a>.</p>
</div>
<div class="paragraph">
<p>If
<code>VkPhysicalDeviceMaintenance5PropertiesKHR</code>::<code>earlyFragmentMultisampleCoverageAfterSampleCounting</code>
is set to <code>VK_TRUE</code> and there is a <a href="#fragops-shader">fragment shader</a>
which declares the <code>EarlyFragmentTests</code> execution mode, <a href="#fragops-shader">fragment shading</a> and <a href="#fragops-covg">multisample coverage</a> operations
<strong>must</strong> be performed after <a href="#fragops-samplecount">sample counting</a>.</p>
</div>
<div class="paragraph">
<p>Otherwise, if
<code>VkPhysicalDeviceMaintenance5PropertiesKHR</code>::<code>earlyFragmentMultisampleCoverageAfterSampleCounting</code>
is set to <code>VK_FALSE</code> and there is a <a href="#fragops-shader">fragment shader</a>
which declares the <code>EarlyFragmentTests</code> execution mode, <a href="#fragops-shader">fragment shading</a> and <a href="#fragops-covg">multisample coverage</a> operations
<strong>should</strong> instead be performed after <a href="#fragops-samplecount">sample counting</a>,
but <strong>may</strong> be performed before <a href="#fragops-samplecount">sample counting</a>.</p>
</div>
<div class="paragraph">
<p>If
<code>VkPhysicalDeviceMaintenance5PropertiesKHR</code>::<code>earlyFragmentSampleMaskTestBeforeSampleCounting</code>
is set to <code>VK_TRUE</code> and there is a <a href="#fragops-shader">fragment shader</a>
which declares the <code>EarlyFragmentTests</code> execution mode
<a href="#fragops-samplemask">sample mask test</a> operations <strong>must</strong> follow the order
of fragment operations from above.</p>
</div>
<div class="paragraph">
<p>Otherwise, if
<code>VkPhysicalDeviceMaintenance5PropertiesKHR</code>::<code>earlyFragmentSampleMaskTestBeforeSampleCounting</code>
is set to <code>VK_FALSE</code> and there is a <a href="#fragops-shader">fragment shader</a>
which declares the <code>EarlyFragmentTests</code> execution mode,
<a href="#fragops-samplemask">sample mask test</a> operations <strong>should</strong> follow the order
of fragment operations from above but <strong>may</strong> instead be performed after
<a href="#fragops-samplecount">sample counting</a>.</p>
</div>
<div class="paragraph">
<p>If there is a <a href="#fragops-shader">fragment shader</a> which declares the
<code>EarlyAndLateFragmentTestsAMD</code> execution mode, and it does not declare
the <code>DepthReplacing</code>
or <code>StencilRefReplacingEXT</code>
execution mode, <a href="#fragops-shader">fragment shading</a> and <a href="#fragops-covg">multisample coverage</a> operations are instead be performed after
<a href="#fragops-samplecount">sample counting</a>.</p>
</div>
<div class="paragraph">
<p>For a pipeline with the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a fragment shader is specified</p>
</li>
<li>
<p>the fragment shader either specifies <code>EarlyAndLateFragmentTestsAMD</code>
or does not write to storage resources;</p>
</li>
<li>
<p>the fragment shader specifies the <code>StencilRefReplacingEXT</code> execution
mode;</p>
</li>
<li>
<p>either</p>
<div class="ulist">
<ul>
<li>
<p>the fragment shader specifies the <code>StencilRefUnchangedFrontAMD</code>
execution mode;</p>
</li>
<li>
<p>the fragment shader specifies the <code>StencilRefLessFrontAMD</code> execution
mode and the pipeline uses a
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>front.compareOp</code> of
<code>VK_COMPARE_OP_GREATER</code> or <code>VK_COMPARE_OP_GREATER_OR_EQUAL</code>; or</p>
</li>
<li>
<p>the fragment shader specifies the <code>StencilRefGreaterFrontAMD</code>
execution mode and the pipeline uses a
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>front.compareOp</code> of
<code>VK_COMPARE_OP_LESS</code> or <code>VK_COMPARE_OP_LESS_OR_EQUAL</code>; and</p>
</li>
</ul>
</div>
</li>
<li>
<p>either</p>
<div class="ulist">
<ul>
<li>
<p>the fragment shader specifies the <code>StencilRefUnchangedBackAMD</code>
execution mode;</p>
</li>
<li>
<p>the fragment shader specifies the <code>StencilRefLessBackAMD</code> execution
mode and the pipeline uses a
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>back.compareOp</code> of
<code>VK_COMPARE_OP_GREATER</code> or <code>VK_COMPARE_OP_GREATER_OR_EQUAL</code>; or</p>
</li>
<li>
<p>the fragment shader specifies the <code>StencilRefGreaterBackAMD</code>
execution mode and the pipeline uses a
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>back.compareOp</code> of
<code>VK_COMPARE_OP_LESS</code> or <code>VK_COMPARE_OP_LESS_OR_EQUAL</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>an additional <a href="#fragops-stencil">stencil test</a> <strong>may</strong> be performed before
<a href="#fragops-shader">fragment shading</a>, using the stencil reference value
specified by
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>front.reference</code> or
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>back.reference</code>.</p>
</div>
<div class="paragraph">
<p>For a pipeline with the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a fragment shader is specified</p>
</li>
<li>
<p>the fragment shader
either specifies <code>EarlyAndLateFragmentTestsAMD</code> or
does not write to storage resources;</p>
</li>
<li>
<p>the fragment shader specifies the <code>DepthReplacing</code> execution mode;
and</p>
</li>
<li>
<p>either</p>
<div class="ulist">
<ul>
<li>
<p>the fragment shader specifies the <code>DepthUnchanged</code> execution mode;</p>
</li>
<li>
<p>the fragment shader specifies the <code>DepthLess</code> execution mode and the
pipeline uses a
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>depthCompareOp</code> of
<code>VK_COMPARE_OP_GREATER</code> or <code>VK_COMPARE_OP_GREATER_OR_EQUAL</code>; or</p>
</li>
<li>
<p>the fragment shader specifies the <code>DepthGreater</code> execution mode and
the pipeline uses a
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>depthCompareOp</code> of
<code>VK_COMPARE_OP_LESS</code> or <code>VK_COMPARE_OP_LESS_OR_EQUAL</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>the implementation <strong>may</strong> perform <a href="#fragops-dbt">depth bounds test</a> before
<a href="#fragops-shader">fragment shading</a> and perform an additional
<a href="#fragops-depth">depth test</a> immediately after that using the interpolated
depth value generated by rasterization.</p>
</div>
<div class="paragraph">
<p>Once all fragment operations have completed, fragment shader outputs for
covered color attachment samples pass through <a href="framebuffer.html#framebuffer" class="xref page">framebufferoperations</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fragops-discard-rectangles"><a class="anchor" href="#fragops-discard-rectangles"></a>Discard Rectangles Test</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The discard rectangle test compares the framebuffer coordinates
<span class="eq">(x<sub>f</sub>,y<sub>f</sub>)</span> of each sample covered by a fragment against a set of
<em>discard rectangles</em>.</p>
</div>
<div class="paragraph">
<p>Each discard rectangle is defined by a <a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>.
These values are either set by the
<a href="#VkPipelineDiscardRectangleStateCreateInfoEXT">VkPipelineDiscardRectangleStateCreateInfoEXT</a> structure during pipeline
creation, or dynamically by the <a href="#vkCmdSetDiscardRectangleEXT">vkCmdSetDiscardRectangleEXT</a> command.</p>
</div>
<div class="paragraph">
<p>A given sample is considered inside a discard rectangle if the <span class="eq">x<sub>f</sub></span> is
in the range <span class="eq">[<a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>::<code>offset.x</code>,
<a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>::<code>offset.x</code> +  <a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>::<code>extent.x</code>)</span>, and
<span class="eq">y<sub>f</sub></span> is in the range <span class="eq">[<a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>::<code>offset.y</code>,
<a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>::<code>offset.y</code> +  <a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>::<code>extent.y</code>)</span>.
If the test is set to be inclusive, samples that are not inside any of the
discard rectangles will have their coverage set to <code>0</code>.
If the test is set to be exclusive, samples that are inside any of the
discard rectangles will have their coverage set to <code>0</code>.</p>
</div>
<div class="paragraph">
<p>If no discard rectangles are specified, the coverage mask is unmodified by
this operation.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPipelineDiscardRectangleStateCreateInfoEXT</code> structure is defined
as:</p>
</div>
<div id="VkPipelineDiscardRectangleStateCreateInfoEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_discard_rectangles
typedef struct VkPipelineDiscardRectangleStateCreateInfoEXT {
    VkStructureType                                  sType;
    const void*                                      pNext;
    VkPipelineDiscardRectangleStateCreateFlagsEXT    flags;
    VkDiscardRectangleModeEXT                        discardRectangleMode;
    uint32_t                                         discardRectangleCount;
    const VkRect2D*                                  pDiscardRectangles;
} VkPipelineDiscardRectangleStateCreateInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>discardRectangleMode</code> is a <a href="#VkDiscardRectangleModeEXT">VkDiscardRectangleModeEXT</a> value
determining whether the discard rectangle test is inclusive or
exclusive.</p>
</li>
<li>
<p><code>discardRectangleCount</code> is the number of discard rectangles to use.</p>
</li>
<li>
<p><code>pDiscardRectangles</code> is a pointer to an array of <a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>
structures defining discard rectangles.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <code>VK_DYNAMIC_STATE_DISCARD_RECTANGLE_EXT</code> dynamic state is enabled
for a pipeline, the <code>pDiscardRectangles</code> member is ignored.
If the <code>VK_DYNAMIC_STATE_DISCARD_RECTANGLE_ENABLE_EXT</code> dynamic state is
not enabled for the pipeline the presence of this structure in the
<a href="pipelines.html#VkGraphicsPipelineCreateInfo" class="xref page">VkGraphicsPipelineCreateInfo</a> chain, and a <code>discardRectangleCount</code>
greater than zero, implicitly enables discard rectangles in the pipeline,
otherwise discard rectangles <strong>must</strong> enabled or disabled by
<a href="#vkCmdSetDiscardRectangleEnableEXT">vkCmdSetDiscardRectangleEnableEXT</a>.
If the <code>VK_DYNAMIC_STATE_DISCARD_RECTANGLE_MODE_EXT</code> dynamic state is
enabled for the pipeline, the <code>discardRectangleMode</code> member is ignored,
and the discard rectangle mode <strong>must</strong> be set by
<a href="#vkCmdSetDiscardRectangleModeEXT">vkCmdSetDiscardRectangleModeEXT</a>.</p>
</div>
<div class="paragraph">
<p>When this structure is included in the <code>pNext</code> chain of
<a href="pipelines.html#VkGraphicsPipelineCreateInfo" class="xref page">VkGraphicsPipelineCreateInfo</a>, it defines parameters of the discard
rectangle test.
If the <code>VK_DYNAMIC_STATE_DISCARD_RECTANGLE_EXT</code> dynamic state is not
enabled, and this structure is not included in the <code>pNext</code> chain, it is
equivalent to specifying this structure with a <code>discardRectangleCount</code>
of <code>0</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPipelineDiscardRectangleStateCreateInfoEXT-discardRectangleCount-00582" href="#VUID-VkPipelineDiscardRectangleStateCreateInfoEXT-discardRectangleCount-00582"></a> <span class="vuid">VUID-VkPipelineDiscardRectangleStateCreateInfoEXT-discardRectangleCount-00582</span><br>

<code>discardRectangleCount</code> <strong>must</strong> be less than or equal to
<code>VkPhysicalDeviceDiscardRectanglePropertiesEXT</code>::<code>maxDiscardRectangles</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPipelineDiscardRectangleStateCreateInfoEXT-sType-sType" href="#VUID-VkPipelineDiscardRectangleStateCreateInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkPipelineDiscardRectangleStateCreateInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_PIPELINE_DISCARD_RECTANGLE_STATE_CREATE_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineDiscardRectangleStateCreateInfoEXT-flags-zerobitmask" href="#VUID-VkPipelineDiscardRectangleStateCreateInfoEXT-flags-zerobitmask"></a> <span class="vuid">VUID-VkPipelineDiscardRectangleStateCreateInfoEXT-flags-zerobitmask</span><br>
 <code>flags</code> <strong>must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineDiscardRectangleStateCreateInfoEXT-discardRectangleMode-parameter" href="#VUID-VkPipelineDiscardRectangleStateCreateInfoEXT-discardRectangleMode-parameter"></a> <span class="vuid">VUID-VkPipelineDiscardRectangleStateCreateInfoEXT-discardRectangleMode-parameter</span><br>
 <code>discardRectangleMode</code> <strong>must</strong> be a valid <a href="#VkDiscardRectangleModeEXT">VkDiscardRectangleModeEXT</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkPipelineDiscardRectangleStateCreateFlagsEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_discard_rectangles
typedef VkFlags VkPipelineDiscardRectangleStateCreateFlagsEXT;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkPipelineDiscardRectangleStateCreateFlagsEXT</code> is a bitmask type for
setting a mask, but is currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>VkDiscardRectangleModeEXT</code> values are:</p>
</div>
<div id="VkDiscardRectangleModeEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_discard_rectangles
typedef enum VkDiscardRectangleModeEXT {
    VK_DISCARD_RECTANGLE_MODE_INCLUSIVE_EXT = 0,
    VK_DISCARD_RECTANGLE_MODE_EXCLUSIVE_EXT = 1,
} VkDiscardRectangleModeEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_DISCARD_RECTANGLE_MODE_INCLUSIVE_EXT</code> specifies that the discard
rectangle test is inclusive.</p>
</li>
<li>
<p><code>VK_DISCARD_RECTANGLE_MODE_EXCLUSIVE_EXT</code> specifies that the discard
rectangle test is exclusive.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the discard rectangles,
call:</p>
</div>
<div id="vkCmdSetDiscardRectangleEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_discard_rectangles
void vkCmdSetDiscardRectangleEXT(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    firstDiscardRectangle,
    uint32_t                                    discardRectangleCount,
    const VkRect2D*                             pDiscardRectangles);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>firstDiscardRectangle</code> is the index of the first discard rectangle
whose state is updated by the command.</p>
</li>
<li>
<p><code>discardRectangleCount</code> is the number of discard rectangles whose
state are updated by the command.</p>
</li>
<li>
<p><code>pDiscardRectangles</code> is a pointer to an array of <a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>
structures specifying discard rectangles.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The discard rectangle taken from element <span class="eq">i</span> of <code>pDiscardRectangles</code>
replace the current state for the discard rectangle at index
<span class="eq"><code>firstDiscardRectangle</code> +  i</span>, for <span class="eq">i</span> in <span class="eq">[0,
<code>discardRectangleCount</code>)</span>.</p>
</div>
<div class="paragraph">
<p>This command sets the discard rectangles for subsequent drawing commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_DISCARD_RECTANGLE_EXT</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="#VkPipelineDiscardRectangleStateCreateInfoEXT">VkPipelineDiscardRectangleStateCreateInfoEXT</a>::<code>pDiscardRectangles</code>
values used to create the currently active pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleEXT-firstDiscardRectangle-00585" href="#VUID-vkCmdSetDiscardRectangleEXT-firstDiscardRectangle-00585"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleEXT-firstDiscardRectangle-00585</span><br>

The sum of <code>firstDiscardRectangle</code> and <code>discardRectangleCount</code>
<strong>must</strong> be less than or equal to
<a href="limits.html#VkPhysicalDeviceDiscardRectanglePropertiesEXT" class="xref page">VkPhysicalDeviceDiscardRectanglePropertiesEXT</a>::<code>maxDiscardRectangles</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleEXT-x-00587" href="#VUID-vkCmdSetDiscardRectangleEXT-x-00587"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleEXT-x-00587</span><br>

The <code>x</code> and <code>y</code> member of <code>offset</code> in each <a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>
element of <code>pDiscardRectangles</code> <strong>must</strong> be greater than or equal to
<code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleEXT-offset-00588" href="#VUID-vkCmdSetDiscardRectangleEXT-offset-00588"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleEXT-offset-00588</span><br>

Evaluation of <span class="eq">(<code>offset.x</code> +  <code>extent.width</code>)</span> in each
<a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a> element of <code>pDiscardRectangles</code> <strong>must</strong> not cause a
signed integer addition overflow</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleEXT-offset-00589" href="#VUID-vkCmdSetDiscardRectangleEXT-offset-00589"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleEXT-offset-00589</span><br>

Evaluation of <span class="eq">(<code>offset.y</code> +  <code>extent.height</code>)</span> in each
<a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a> element of <code>pDiscardRectangles</code> <strong>must</strong> not cause a
signed integer addition overflow</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleEXT-viewportScissor2D-04788" href="#VUID-vkCmdSetDiscardRectangleEXT-viewportScissor2D-04788"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleEXT-viewportScissor2D-04788</span><br>

If this command is recorded in a secondary command buffer with
<a href="cmdbuffers.html#VkCommandBufferInheritanceViewportScissorInfoNV" class="xref page">VkCommandBufferInheritanceViewportScissorInfoNV</a>::<code>viewportScissor2D</code>
enabled, then this function <strong>must</strong> not be called</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleEXT-commandBuffer-parameter" href="#VUID-vkCmdSetDiscardRectangleEXT-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleEXT-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleEXT-pDiscardRectangles-parameter" href="#VUID-vkCmdSetDiscardRectangleEXT-pDiscardRectangles-parameter"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleEXT-pDiscardRectangles-parameter</span><br>
 <code>pDiscardRectangles</code> <strong>must</strong> be a valid pointer to an array of <code>discardRectangleCount</code> <a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleEXT-commandBuffer-recording" href="#VUID-vkCmdSetDiscardRectangleEXT-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleEXT-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleEXT-commandBuffer-cmdpool" href="#VUID-vkCmdSetDiscardRectangleEXT-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleEXT-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleEXT-videocoding" href="#VUID-vkCmdSetDiscardRectangleEXT-videocoding"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleEXT-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleEXT-discardRectangleCount-arraylength" href="#VUID-vkCmdSetDiscardRectangleEXT-discardRectangleCount-arraylength"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleEXT-discardRectangleCount-arraylength</span><br>
 <code>discardRectangleCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> whether discard rectangles
are enabled, call:</p>
</div>
<div id="vkCmdSetDiscardRectangleEnableEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_discard_rectangles
void vkCmdSetDiscardRectangleEnableEXT(
    VkCommandBuffer                             commandBuffer,
    VkBool32                                    discardRectangleEnable);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>discardRectangleEnable</code> specifies whether discard rectangles are
enabled or not.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the discard rectangle enable for subsequent drawing
commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_DISCARD_RECTANGLE_ENABLE_EXT</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is implied by the
<a href="#VkPipelineDiscardRectangleStateCreateInfoEXT">VkPipelineDiscardRectangleStateCreateInfoEXT</a>::<code>discardRectangleCount</code>
value used to create the currently active pipeline, where a non-zero
<code>discardRectangleCount</code> implicitly enables discard rectangles, otherwise
they are disabled.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleEnableEXT-specVersion-07851" href="#VUID-vkCmdSetDiscardRectangleEnableEXT-specVersion-07851"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleEnableEXT-specVersion-07851</span><br>

The <code><a href="../appendices/extensions.html#VK_EXT_discard_rectangles" class="xref page">VK_EXT_discard_rectangles</a></code> extension <strong>must</strong> be enabled, and
the implementation <strong>must</strong> support at least <code>specVersion</code> <code>2</code> of this
extension</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleEnableEXT-commandBuffer-parameter" href="#VUID-vkCmdSetDiscardRectangleEnableEXT-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleEnableEXT-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleEnableEXT-commandBuffer-recording" href="#VUID-vkCmdSetDiscardRectangleEnableEXT-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleEnableEXT-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleEnableEXT-commandBuffer-cmdpool" href="#VUID-vkCmdSetDiscardRectangleEnableEXT-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleEnableEXT-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleEnableEXT-videocoding" href="#VUID-vkCmdSetDiscardRectangleEnableEXT-videocoding"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleEnableEXT-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the discard rectangle mode,
call:</p>
</div>
<div id="vkCmdSetDiscardRectangleModeEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_discard_rectangles
void vkCmdSetDiscardRectangleModeEXT(
    VkCommandBuffer                             commandBuffer,
    VkDiscardRectangleModeEXT                   discardRectangleMode);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>discardRectangleMode</code> specifies the discard rectangle mode for all
discard rectangles, either inclusive or exclusive.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the discard rectangle mode for subsequent drawing commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_DISCARD_RECTANGLE_MODE_EXT</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="#VkPipelineDiscardRectangleStateCreateInfoEXT">VkPipelineDiscardRectangleStateCreateInfoEXT</a>::<code>discardRectangleMode</code>
value used to create the currently active pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleModeEXT-specVersion-07852" href="#VUID-vkCmdSetDiscardRectangleModeEXT-specVersion-07852"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleModeEXT-specVersion-07852</span><br>

The <code><a href="../appendices/extensions.html#VK_EXT_discard_rectangles" class="xref page">VK_EXT_discard_rectangles</a></code> extension <strong>must</strong> be enabled, and
the implementation <strong>must</strong> support at least <code>specVersion</code> <code>2</code> of this
extension</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleModeEXT-commandBuffer-parameter" href="#VUID-vkCmdSetDiscardRectangleModeEXT-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleModeEXT-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleModeEXT-discardRectangleMode-parameter" href="#VUID-vkCmdSetDiscardRectangleModeEXT-discardRectangleMode-parameter"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleModeEXT-discardRectangleMode-parameter</span><br>
 <code>discardRectangleMode</code> <strong>must</strong> be a valid <a href="#VkDiscardRectangleModeEXT">VkDiscardRectangleModeEXT</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleModeEXT-commandBuffer-recording" href="#VUID-vkCmdSetDiscardRectangleModeEXT-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleModeEXT-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleModeEXT-commandBuffer-cmdpool" href="#VUID-vkCmdSetDiscardRectangleModeEXT-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleModeEXT-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDiscardRectangleModeEXT-videocoding" href="#VUID-vkCmdSetDiscardRectangleModeEXT-videocoding"></a> <span class="vuid">VUID-vkCmdSetDiscardRectangleModeEXT-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fragops-scissor"><a class="anchor" href="#fragops-scissor"></a>Scissor Test</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The scissor test compares the framebuffer coordinates <span class="eq">(x<sub>f</sub>,y<sub>f</sub>)</span> of
each sample covered by a fragment against a <em>scissor rectangle</em> at the index
equal to the fragment&#8217;s <a href="interfaces.html#interfaces-builtin-variables-viewportindex" class="xref page"><code>ViewportIndex</code></a>.</p>
</div>
<div class="paragraph">
<p>Each scissor rectangle is defined by a <a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>.
These values are either set by the <a href="vertexpostproc.html#VkPipelineViewportStateCreateInfo" class="xref page">VkPipelineViewportStateCreateInfo</a>
structure during pipeline creation, or dynamically by the
<a href="#vkCmdSetScissor">vkCmdSetScissor</a> command.</p>
</div>
<div class="paragraph">
<p>A given sample is considered inside a scissor rectangle if <span class="eq">x<sub>f</sub></span> is in
the range <span class="eq">[<a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>::<code>offset.x</code>,
<a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>::<code>offset.x</code> +  <a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>::<code>extent.x</code>)</span>, and
<span class="eq">y<sub>f</sub></span> is in the range <span class="eq">[<a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>::<code>offset.y</code>,
<a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>::<code>offset.y</code> +  <a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>::<code>extent.y</code>)</span>.
Samples with coordinates outside the scissor rectangle at the corresponding
<code>ViewportIndex</code> will have their coverage set to <code>0</code>.</p>
</div>
<div class="paragraph">
<p>If a render pass transform is enabled, the (<code>offset.x</code> and
<code>offset.y</code>) and (<code>extent.width</code> and <code>extent.height</code>) values are
transformed as described in <a href="vertexpostproc.html#vertexpostproc-renderpass-transform" class="xref page">renderpass transform</a> before participating in the scissor test.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the scissor rectangles,
call:</p>
</div>
<div id="vkCmdSetScissor" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkCmdSetScissor(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    firstScissor,
    uint32_t                                    scissorCount,
    const VkRect2D*                             pScissors);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>firstScissor</code> is the index of the first scissor whose state is
updated by the command.</p>
</li>
<li>
<p><code>scissorCount</code> is the number of scissors whose rectangles are
updated by the command.</p>
</li>
<li>
<p><code>pScissors</code> is a pointer to an array of <a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a> structures
defining scissor rectangles.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The scissor rectangles taken from element <span class="eq">i</span> of <code>pScissors</code> replace
the current state for the scissor index <span class="eq"><code>firstScissor</code> +  i</span>,
for <span class="eq">i</span> in <span class="eq">[0, <code>scissorCount</code>)</span>.</p>
</div>
<div class="paragraph">
<p>This command sets the scissor rectangles for subsequent drawing commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with <code>VK_DYNAMIC_STATE_SCISSOR</code>
set in <a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="vertexpostproc.html#VkPipelineViewportStateCreateInfo" class="xref page">VkPipelineViewportStateCreateInfo</a>::<code>pScissors</code> values used to
create the currently active pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetScissor-firstScissor-00592" href="#VUID-vkCmdSetScissor-firstScissor-00592"></a> <span class="vuid">VUID-vkCmdSetScissor-firstScissor-00592</span><br>

The sum of <code>firstScissor</code> and <code>scissorCount</code> <strong>must</strong> be between
<code>1</code> and <code>VkPhysicalDeviceLimits</code>::<code>maxViewports</code>, inclusive</p>
</li>
<li>
<p><a id="VUID-vkCmdSetScissor-firstScissor-00593" href="#VUID-vkCmdSetScissor-firstScissor-00593"></a> <span class="vuid">VUID-vkCmdSetScissor-firstScissor-00593</span><br>

If the <a href="features.html#features-multiViewport" class="xref page"><code>multiViewport</code></a> feature is not
enabled, <code>firstScissor</code> <strong>must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetScissor-scissorCount-00594" href="#VUID-vkCmdSetScissor-scissorCount-00594"></a> <span class="vuid">VUID-vkCmdSetScissor-scissorCount-00594</span><br>

If the <a href="features.html#features-multiViewport" class="xref page"><code>multiViewport</code></a> feature is not
enabled, <code>scissorCount</code> <strong>must</strong> be <code>1</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetScissor-x-00595" href="#VUID-vkCmdSetScissor-x-00595"></a> <span class="vuid">VUID-vkCmdSetScissor-x-00595</span><br>

The <code>x</code> and <code>y</code> members of <code>offset</code> member of any element of
<code>pScissors</code> <strong>must</strong> be greater than or equal to <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetScissor-offset-00596" href="#VUID-vkCmdSetScissor-offset-00596"></a> <span class="vuid">VUID-vkCmdSetScissor-offset-00596</span><br>

Evaluation of <span class="eq">(<code>offset.x</code> +  <code>extent.width</code>)</span> <strong>must</strong> not
cause a signed integer addition overflow for any element of
<code>pScissors</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetScissor-offset-00597" href="#VUID-vkCmdSetScissor-offset-00597"></a> <span class="vuid">VUID-vkCmdSetScissor-offset-00597</span><br>

Evaluation of <span class="eq">(<code>offset.y</code> +  <code>extent.height</code>)</span> <strong>must</strong>
not cause a signed integer addition overflow for any element of
<code>pScissors</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetScissor-viewportScissor2D-04789" href="#VUID-vkCmdSetScissor-viewportScissor2D-04789"></a> <span class="vuid">VUID-vkCmdSetScissor-viewportScissor2D-04789</span><br>

If this command is recorded in a secondary command buffer with
<a href="cmdbuffers.html#VkCommandBufferInheritanceViewportScissorInfoNV" class="xref page">VkCommandBufferInheritanceViewportScissorInfoNV</a>::<code>viewportScissor2D</code>
enabled, then this function <strong>must</strong> not be called</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetScissor-commandBuffer-parameter" href="#VUID-vkCmdSetScissor-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetScissor-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetScissor-pScissors-parameter" href="#VUID-vkCmdSetScissor-pScissors-parameter"></a> <span class="vuid">VUID-vkCmdSetScissor-pScissors-parameter</span><br>
 <code>pScissors</code> <strong>must</strong> be a valid pointer to an array of <code>scissorCount</code> <a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdSetScissor-commandBuffer-recording" href="#VUID-vkCmdSetScissor-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetScissor-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetScissor-commandBuffer-cmdpool" href="#VUID-vkCmdSetScissor-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetScissor-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetScissor-videocoding" href="#VUID-vkCmdSetScissor-videocoding"></a> <span class="vuid">VUID-vkCmdSetScissor-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdSetScissor-scissorCount-arraylength" href="#VUID-vkCmdSetScissor-scissorCount-arraylength"></a> <span class="vuid">VUID-vkCmdSetScissor-scissorCount-arraylength</span><br>
 <code>scissorCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fragops-exclusive-scissor"><a class="anchor" href="#fragops-exclusive-scissor"></a>Exclusive Scissor Test</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The exclusive scissor test compares the framebuffer coordinates
<span class="eq">(x<sub>f</sub>,y<sub>f</sub>)</span> of each sample covered by a fragment against an <em>exclusive
scissor rectangle</em> at the index equal to the fragment&#8217;s
<a href="interfaces.html#interfaces-builtin-variables-viewportindex" class="xref page"><code>ViewportIndex</code></a>.</p>
</div>
<div class="paragraph">
<p>Each exclusive scissor rectangle is defined by a <a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>.
These values are either set by the
<a href="#VkPipelineViewportExclusiveScissorStateCreateInfoNV">VkPipelineViewportExclusiveScissorStateCreateInfoNV</a> structure during
pipeline creation, or dynamically by the <a href="#vkCmdSetExclusiveScissorNV">vkCmdSetExclusiveScissorNV</a>
command.</p>
</div>
<div class="paragraph">
<p>A given sample is considered inside an exclusive scissor rectangle if
<span class="eq">x<sub>f</sub></span> is in the range <span class="eq">[<a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>::<code>offset.x</code>,
<a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>::<code>offset.x</code> +  <a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>::<code>extent.x</code>)</span>, and
<span class="eq">y<sub>f</sub></span> is in the range <span class="eq">[<a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>::<code>offset.y</code>,
<a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>::<code>offset.y</code> +  <a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>::<code>extent.y</code>)</span>.
Samples with coordinates inside the exclusive scissor rectangle at the
corresponding <code>ViewportIndex</code> will have their coverage set to <code>0</code>.</p>
</div>
<div class="paragraph">
<p>If no exclusive scissor rectangles are specified, the coverage mask is
unmodified by this operation.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPipelineViewportExclusiveScissorStateCreateInfoNV</code> structure is
defined as:</p>
</div>
<div id="VkPipelineViewportExclusiveScissorStateCreateInfoNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_NV_scissor_exclusive
typedef struct VkPipelineViewportExclusiveScissorStateCreateInfoNV {
    VkStructureType    sType;
    const void*        pNext;
    uint32_t           exclusiveScissorCount;
    const VkRect2D*    pExclusiveScissors;
} VkPipelineViewportExclusiveScissorStateCreateInfoNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>exclusiveScissorCount</code> is the number of exclusive scissor
rectangles.</p>
</li>
<li>
<p><code>pExclusiveScissors</code> is a pointer to an array of <a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>
structures defining exclusive scissor rectangles.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <code>VK_DYNAMIC_STATE_EXCLUSIVE_SCISSOR_NV</code> dynamic state is enabled
for a pipeline, the <code>pExclusiveScissors</code> member is ignored.</p>
</div>
<div class="paragraph">
<p>When this structure is included in the <code>pNext</code> chain of
<a href="pipelines.html#VkGraphicsPipelineCreateInfo" class="xref page">VkGraphicsPipelineCreateInfo</a>, it defines parameters of the exclusive
scissor test.
If this structure is not included in the <code>pNext</code> chain, it is equivalent
to specifying this structure with a <code>exclusiveScissorCount</code> of <code>0</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPipelineViewportExclusiveScissorStateCreateInfoNV-exclusiveScissorCount-02027" href="#VUID-VkPipelineViewportExclusiveScissorStateCreateInfoNV-exclusiveScissorCount-02027"></a> <span class="vuid">VUID-VkPipelineViewportExclusiveScissorStateCreateInfoNV-exclusiveScissorCount-02027</span><br>

If the <a href="features.html#features-multiViewport" class="xref page"><code>multiViewport</code></a> feature is not
enabled, <code>exclusiveScissorCount</code> <strong>must</strong> be <code>0</code> or <code>1</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineViewportExclusiveScissorStateCreateInfoNV-exclusiveScissorCount-02028" href="#VUID-VkPipelineViewportExclusiveScissorStateCreateInfoNV-exclusiveScissorCount-02028"></a> <span class="vuid">VUID-VkPipelineViewportExclusiveScissorStateCreateInfoNV-exclusiveScissorCount-02028</span><br>

<code>exclusiveScissorCount</code> <strong>must</strong> be less than or equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxViewports</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineViewportExclusiveScissorStateCreateInfoNV-exclusiveScissorCount-02029" href="#VUID-VkPipelineViewportExclusiveScissorStateCreateInfoNV-exclusiveScissorCount-02029"></a> <span class="vuid">VUID-VkPipelineViewportExclusiveScissorStateCreateInfoNV-exclusiveScissorCount-02029</span><br>

<code>exclusiveScissorCount</code> <strong>must</strong> be <code>0</code> or greater than or equal to the
<code>viewportCount</code> member of <a href="vertexpostproc.html#VkPipelineViewportStateCreateInfo" class="xref page">VkPipelineViewportStateCreateInfo</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPipelineViewportExclusiveScissorStateCreateInfoNV-sType-sType" href="#VUID-VkPipelineViewportExclusiveScissorStateCreateInfoNV-sType-sType"></a> <span class="vuid">VUID-VkPipelineViewportExclusiveScissorStateCreateInfoNV-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_PIPELINE_VIEWPORT_EXCLUSIVE_SCISSOR_STATE_CREATE_INFO_NV</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the exclusive scissor
rectangles, call:</p>
</div>
<div id="vkCmdSetExclusiveScissorNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_NV_scissor_exclusive
void vkCmdSetExclusiveScissorNV(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    firstExclusiveScissor,
    uint32_t                                    exclusiveScissorCount,
    const VkRect2D*                             pExclusiveScissors);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>firstExclusiveScissor</code> is the index of the first exclusive scissor
rectangle whose state is updated by the command.</p>
</li>
<li>
<p><code>exclusiveScissorCount</code> is the number of exclusive scissor
rectangles updated by the command.</p>
</li>
<li>
<p><code>pExclusiveScissors</code> is a pointer to an array of <a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a>
structures defining exclusive scissor rectangles.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The scissor rectangles taken from element <span class="eq">i</span> of
<code>pExclusiveScissors</code> replace the current state for the scissor index
<span class="eq"><code>firstExclusiveScissor</code> +  i</span>, for <span class="eq">i</span> in <span class="eq">[0,
<code>exclusiveScissorCount</code>)</span>.</p>
</div>
<div class="paragraph">
<p>This command sets the exclusive scissor rectangles for subsequent drawing
commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_EXCLUSIVE_SCISSOR_NV</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="#VkPipelineViewportExclusiveScissorStateCreateInfoNV">VkPipelineViewportExclusiveScissorStateCreateInfoNV</a>::<code>pExclusiveScissors</code>
values used to create the currently active pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetExclusiveScissorNV-None-02031" href="#VUID-vkCmdSetExclusiveScissorNV-None-02031"></a> <span class="vuid">VUID-vkCmdSetExclusiveScissorNV-None-02031</span><br>

The <a href="features.html#features-exclusiveScissor" class="xref page"><code>exclusiveScissor</code></a> feature <strong>must</strong>
be enabled</p>
</li>
<li>
<p><a id="VUID-vkCmdSetExclusiveScissorNV-firstExclusiveScissor-02034" href="#VUID-vkCmdSetExclusiveScissorNV-firstExclusiveScissor-02034"></a> <span class="vuid">VUID-vkCmdSetExclusiveScissorNV-firstExclusiveScissor-02034</span><br>

The sum of <code>firstExclusiveScissor</code> and <code>exclusiveScissorCount</code>
<strong>must</strong> be between <code>1</code> and
<code>VkPhysicalDeviceLimits</code>::<code>maxViewports</code>, inclusive</p>
</li>
<li>
<p><a id="VUID-vkCmdSetExclusiveScissorNV-firstExclusiveScissor-02035" href="#VUID-vkCmdSetExclusiveScissorNV-firstExclusiveScissor-02035"></a> <span class="vuid">VUID-vkCmdSetExclusiveScissorNV-firstExclusiveScissor-02035</span><br>

If the <a href="features.html#features-multiViewport" class="xref page"><code>multiViewport</code></a> feature is not
enabled, <code>firstExclusiveScissor</code> <strong>must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetExclusiveScissorNV-exclusiveScissorCount-02036" href="#VUID-vkCmdSetExclusiveScissorNV-exclusiveScissorCount-02036"></a> <span class="vuid">VUID-vkCmdSetExclusiveScissorNV-exclusiveScissorCount-02036</span><br>

If the <a href="features.html#features-multiViewport" class="xref page"><code>multiViewport</code></a> feature is not
enabled, <code>exclusiveScissorCount</code> <strong>must</strong> be <code>1</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetExclusiveScissorNV-x-02037" href="#VUID-vkCmdSetExclusiveScissorNV-x-02037"></a> <span class="vuid">VUID-vkCmdSetExclusiveScissorNV-x-02037</span><br>

The <code>x</code> and <code>y</code> members of <code>offset</code> in each member of
<code>pExclusiveScissors</code> <strong>must</strong> be greater than or equal to <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetExclusiveScissorNV-offset-02038" href="#VUID-vkCmdSetExclusiveScissorNV-offset-02038"></a> <span class="vuid">VUID-vkCmdSetExclusiveScissorNV-offset-02038</span><br>

Evaluation of <span class="eq">(<code>offset.x</code> +  <code>extent.width</code>)</span> for each
member of <code>pExclusiveScissors</code> <strong>must</strong> not cause a signed integer
addition overflow</p>
</li>
<li>
<p><a id="VUID-vkCmdSetExclusiveScissorNV-offset-02039" href="#VUID-vkCmdSetExclusiveScissorNV-offset-02039"></a> <span class="vuid">VUID-vkCmdSetExclusiveScissorNV-offset-02039</span><br>

Evaluation of <span class="eq">(<code>offset.y</code> +  <code>extent.height</code>)</span> for each
member of <code>pExclusiveScissors</code> <strong>must</strong> not cause a signed integer
addition overflow</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetExclusiveScissorNV-commandBuffer-parameter" href="#VUID-vkCmdSetExclusiveScissorNV-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetExclusiveScissorNV-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetExclusiveScissorNV-pExclusiveScissors-parameter" href="#VUID-vkCmdSetExclusiveScissorNV-pExclusiveScissors-parameter"></a> <span class="vuid">VUID-vkCmdSetExclusiveScissorNV-pExclusiveScissors-parameter</span><br>
 <code>pExclusiveScissors</code> <strong>must</strong> be a valid pointer to an array of <code>exclusiveScissorCount</code> <a href="fundamentals.html#VkRect2D" class="xref page">VkRect2D</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdSetExclusiveScissorNV-commandBuffer-recording" href="#VUID-vkCmdSetExclusiveScissorNV-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetExclusiveScissorNV-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetExclusiveScissorNV-commandBuffer-cmdpool" href="#VUID-vkCmdSetExclusiveScissorNV-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetExclusiveScissorNV-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetExclusiveScissorNV-videocoding" href="#VUID-vkCmdSetExclusiveScissorNV-videocoding"></a> <span class="vuid">VUID-vkCmdSetExclusiveScissorNV-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdSetExclusiveScissorNV-exclusiveScissorCount-arraylength" href="#VUID-vkCmdSetExclusiveScissorNV-exclusiveScissorCount-arraylength"></a> <span class="vuid">VUID-vkCmdSetExclusiveScissorNV-exclusiveScissorCount-arraylength</span><br>
 <code>exclusiveScissorCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> whether an exclusive scissor
is enabled or not, call:</p>
</div>
<div id="vkCmdSetExclusiveScissorEnableNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_NV_scissor_exclusive
void vkCmdSetExclusiveScissorEnableNV(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    firstExclusiveScissor,
    uint32_t                                    exclusiveScissorCount,
    const VkBool32*                             pExclusiveScissorEnables);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>firstExclusiveScissor</code> is the index of the first exclusive scissor
rectangle whose state is updated by the command.</p>
</li>
<li>
<p><code>exclusiveScissorCount</code> is the number of exclusive scissor
rectangles updated by the command.</p>
</li>
<li>
<p><code>pExclusiveScissorEnables</code> is a pointer to an array of
<code>VkBool32</code> values defining whether the exclusive scissor is
enabled.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The exclusive scissor enables taken from element <span class="eq">i</span> of
<code>pExclusiveScissorEnables</code> replace the current state for the scissor
index <span class="eq"><code>firstExclusiveScissor</code> +  i</span>, for <span class="eq">i</span> in <span class="eq">[0,
<code>exclusiveScissorCount</code>)</span>.</p>
</div>
<div class="paragraph">
<p>This command sets the exclusive scissor enable for subsequent drawing
commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_EXCLUSIVE_SCISSOR_ENABLE_NV</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is implied by the
<a href="#VkPipelineViewportExclusiveScissorStateCreateInfoNV">VkPipelineViewportExclusiveScissorStateCreateInfoNV</a>::<code>exclusiveScissorCount</code>
value used to create the currently active pipeline, where all
<code>exclusiveScissorCount</code> exclusive scissors are implicitly enabled and
the remainder up to <code>VkPhysicalDeviceLimits</code>::<code>maxViewports</code> are
implicitly disabled.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetExclusiveScissorEnableNV-exclusiveScissor-07853" href="#VUID-vkCmdSetExclusiveScissorEnableNV-exclusiveScissor-07853"></a> <span class="vuid">VUID-vkCmdSetExclusiveScissorEnableNV-exclusiveScissor-07853</span><br>

The <a href="features.html#features-exclusiveScissor" class="xref page"><code>exclusiveScissor</code></a> feature <strong>must</strong>
be enabled, and the implementation <strong>must</strong> support at least
<code>specVersion</code> <code>2</code> of the <code><a href="../appendices/extensions.html#VK_NV_scissor_exclusive" class="xref page">VK_NV_scissor_exclusive</a></code> extension</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetExclusiveScissorEnableNV-commandBuffer-parameter" href="#VUID-vkCmdSetExclusiveScissorEnableNV-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetExclusiveScissorEnableNV-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetExclusiveScissorEnableNV-pExclusiveScissorEnables-parameter" href="#VUID-vkCmdSetExclusiveScissorEnableNV-pExclusiveScissorEnables-parameter"></a> <span class="vuid">VUID-vkCmdSetExclusiveScissorEnableNV-pExclusiveScissorEnables-parameter</span><br>
 <code>pExclusiveScissorEnables</code> <strong>must</strong> be a valid pointer to an array of <code>exclusiveScissorCount</code> <code>VkBool32</code> values</p>
</li>
<li>
<p><a id="VUID-vkCmdSetExclusiveScissorEnableNV-commandBuffer-recording" href="#VUID-vkCmdSetExclusiveScissorEnableNV-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetExclusiveScissorEnableNV-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetExclusiveScissorEnableNV-commandBuffer-cmdpool" href="#VUID-vkCmdSetExclusiveScissorEnableNV-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetExclusiveScissorEnableNV-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetExclusiveScissorEnableNV-videocoding" href="#VUID-vkCmdSetExclusiveScissorEnableNV-videocoding"></a> <span class="vuid">VUID-vkCmdSetExclusiveScissorEnableNV-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdSetExclusiveScissorEnableNV-exclusiveScissorCount-arraylength" href="#VUID-vkCmdSetExclusiveScissorEnableNV-exclusiveScissorCount-arraylength"></a> <span class="vuid">VUID-vkCmdSetExclusiveScissorEnableNV-exclusiveScissorCount-arraylength</span><br>
 <code>exclusiveScissorCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fragops-samplemask"><a class="anchor" href="#fragops-samplemask"></a>Sample Mask Test</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The sample mask test compares the <a href="primsrast.html#primsrast-multisampling-coverage-mask" class="xref page">coverage mask</a> for a fragment with the <em>sample mask</em> defined by
<a href="primsrast.html#VkPipelineMultisampleStateCreateInfo" class="xref page">VkPipelineMultisampleStateCreateInfo</a>::<code>pSampleMask</code>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the sample mask, call:</p>
</div>
<div id="vkCmdSetSampleMaskEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_extended_dynamic_state3, VK_EXT_shader_object
void vkCmdSetSampleMaskEXT(
    VkCommandBuffer                             commandBuffer,
    VkSampleCountFlagBits                       samples,
    const VkSampleMask*                         pSampleMask);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>samples</code> specifies the number of sample bits in the
<code>pSampleMask</code>.</p>
</li>
<li>
<p><code>pSampleMask</code> is a pointer to an array of <code>VkSampleMask</code>
values, where the array size is based on the <code>samples</code> parameter.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the sample mask for subsequent drawing commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_SAMPLE_MASK_EXT</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="primsrast.html#VkPipelineMultisampleStateCreateInfo" class="xref page">VkPipelineMultisampleStateCreateInfo</a>::<code>pSampleMask</code> value used to
create the currently active pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetSampleMaskEXT-None-08504" href="#VUID-vkCmdSetSampleMaskEXT-None-08504"></a> <span class="vuid">VUID-vkCmdSetSampleMaskEXT-None-08504</span><br>

Either the <a href="features.html#features-extendedDynamicState3SampleMask" class="xref page">    <code>extendedDynamicState3SampleMask</code></a> feature or the
<a href="features.html#features-shaderObject" class="xref page"><code>shaderObject</code></a> feature or both <strong>must</strong> be
enabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetSampleMaskEXT-commandBuffer-parameter" href="#VUID-vkCmdSetSampleMaskEXT-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetSampleMaskEXT-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetSampleMaskEXT-samples-parameter" href="#VUID-vkCmdSetSampleMaskEXT-samples-parameter"></a> <span class="vuid">VUID-vkCmdSetSampleMaskEXT-samples-parameter</span><br>
 <code>samples</code> <strong>must</strong> be a valid <a href="limits.html#VkSampleCountFlagBits" class="xref page">VkSampleCountFlagBits</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdSetSampleMaskEXT-pSampleMask-parameter" href="#VUID-vkCmdSetSampleMaskEXT-pSampleMask-parameter"></a> <span class="vuid">VUID-vkCmdSetSampleMaskEXT-pSampleMask-parameter</span><br>
 <code>pSampleMask</code> <strong>must</strong> be a valid pointer to an array of <span class="steminline"> <svg style="vertical-align: -0.816ex; overflow: visible;" xmlns="http://www.w3.org/2000/svg" width="8.402ex" height="3.006ex" role="img" focusable="false" viewBox="0 -967.9 3713.8 1328.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2308" d="M174 734Q178 746 190 750H298H369Q400 750 411 747T422 730T411 713T372 709Q365 709 345 709T310 710H214V-235Q206 -248 196 -250Q192 -250 189 -249T184 -247T180 -244T178 -241T176 -237T174 -234V734Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(444,0)"><g data-mml-node="mfrac"><g data-mml-node="TeXAtom" transform="translate(220,477.2) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="73" d="M153 285Q153 349 197 395T311 442Q355 442 386 420T418 356Q418 321 401 308T365 294Q336 294 331 326Q331 336 334 345T343 359T353 368T362 374L366 376Q365 379 362 383T344 396T308 404Q265 404 246 377T226 325T244 289T287 275T339 258T383 212Q395 188 395 163Q395 132 379 95T333 32Q279 -11 207 -11Q154 -11 115 13T76 86Q76 108 83 123T102 145T121 153T135 156Q154 156 164 145T175 117Q175 82 142 66L132 62Q131 62 131 61Q131 57 139 49T166 34T210 26Q250 26 277 44T312 83T321 123Q321 153 301 166T248 185T204 198Q176 211 162 241Q153 258 153 285Z"></path><path data-c="61" d="M418 53Q418 26 438 26Q466 26 494 131Q500 151 504 152Q507 153 516 153H521Q531 153 534 153T540 150T543 144Q543 141 540 126T529 88T509 43T477 5T434 -11Q404 -11 383 3T354 30T347 48H346Q345 47 342 45T337 40Q282 -11 228 -11Q172 -11 137 34T101 146Q101 260 177 351T333 442Q343 442 352 441T369 437T382 431T393 425T402 417T409 410T414 402T419 396Q423 406 436 414T461 422Q475 422 484 413T494 395Q494 384 459 244T420 88Q418 80 418 58V53ZM397 323Q397 344 382 374T333 405Q302 405 271 372Q249 349 235 316T203 215Q184 135 184 108V100V94Q184 54 207 35Q218 26 235 26Q279 26 330 91Q343 109 346 118T372 217Q397 317 397 323Z" transform="translate(409,0)"></path><path data-c="6D" d="M81 278Q75 284 75 289Q77 299 89 338Q101 373 114 396T142 428T166 439T186 442H189Q225 440 251 417Q266 401 271 384L275 374L286 386Q342 442 414 442Q428 442 440 440T461 435T479 427T493 418T503 407T511 397T516 387T520 378T523 370L524 366Q546 395 583 418T667 442Q729 442 755 411T782 338Q782 290 743 178T704 45Q704 26 720 26Q773 26 802 136Q805 148 807 150T822 153H828Q838 153 841 153T848 150T851 143Q851 137 843 115T821 63T778 12T715 -10Q671 -10 652 16T632 71Q632 88 668 191T704 349Q704 367 703 372Q693 405 664 405Q637 405 613 393T571 360T547 329T534 309Q523 290 518 274T487 151Q455 24 452 16Q438 -11 408 -11T376 18Q376 26 411 167T447 314Q449 325 449 346Q449 372 444 384Q431 405 408 405Q334 405 276 305Q266 289 262 273T231 151Q199 24 196 16Q182 -11 152 -11T120 18Q120 26 159 182T200 347Q202 361 202 372Q202 405 181 405Q168 405 159 391Q145 374 132 328T117 280T98 278H81Z" transform="translate(920,0)"></path><path data-c="70" d="M81 278Q75 284 75 287Q93 379 131 417Q154 442 189 442Q222 440 243 423T272 382L280 390Q335 442 389 442Q446 442 482 398T518 284Q518 212 480 137T375 19Q321 -10 291 -10H282H278Q237 -10 204 28L202 32L181 -51Q160 -135 160 -139Q160 -147 205 -148H230Q236 -155 236 -157T233 -175Q230 -187 227 -190T214 -194Q211 -194 202 -194T169 -193T108 -192Q40 -192 21 -194H13Q6 -187 6 -183T9 -167Q13 -153 16 -151T39 -148Q73 -147 78 -136Q82 -128 139 104Q199 337 199 347Q202 362 202 372Q202 406 182 406Q169 406 159 391Q145 374 132 328T117 280T98 278H81ZM221 111Q234 26 286 26Q307 26 336 47T385 116Q398 147 416 217T435 332Q435 354 433 361Q420 405 383 405Q333 405 279 326L273 317L221 111Z" transform="translate(1738,0)"></path><path data-c="6C" d="M162 61Q162 26 183 26Q211 26 239 131Q245 151 249 152Q252 153 261 153H266H271Q288 153 288 144Q288 143 286 129Q276 91 266 65T232 14T179 -11Q144 -11 116 12T87 81Q87 96 88 102L216 616Q216 629 209 632T170 637H149Q143 643 143 645T145 664Q150 683 158 683Q163 683 223 688T300 694Q312 694 312 686Q312 676 240 389L164 86Q162 74 162 61Z" transform="translate(2249,0)"></path><path data-c="65" d="M107 166Q107 230 131 283T193 369T270 420T345 441Q346 441 352 441T361 442H364Q409 442 439 418T470 355Q470 270 366 239Q308 223 218 223H205Q189 164 189 125Q189 83 206 55T261 27Q309 27 353 50T426 109Q436 121 440 121T453 111T466 97Q469 92 455 77Q424 41 372 16T258 -10Q184 -10 146 41T107 166ZM416 333T416 354T401 390T360 405Q322 405 292 384T246 336T223 288T215 261Q215 260 240 260Q262 261 276 262T314 266T353 275T384 291T408 317Z" transform="translate(2505,0)"></path><path data-c="73" d="M153 285Q153 349 197 395T311 442Q355 442 386 420T418 356Q418 321 401 308T365 294Q336 294 331 326Q331 336 334 345T343 359T353 368T362 374L366 376Q365 379 362 383T344 396T308 404Q265 404 246 377T226 325T244 289T287 275T339 258T383 212Q395 188 395 163Q395 132 379 95T333 32Q279 -11 207 -11Q154 -11 115 13T76 86Q76 108 83 123T102 145T121 153T135 156Q154 156 164 145T175 117Q175 82 142 66L132 62Q131 62 131 61Q131 57 139 49T166 34T210 26Q250 26 277 44T312 83T321 123Q321 153 301 166T248 185T204 198Q176 211 162 241Q153 258 153 285Z" transform="translate(2965,0)"></path></g></g><g data-mml-node="mn" transform="translate(1059.3,-345) scale(0.707)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" transform="translate(500,0)"></path></g><rect width="2585.8" height="60" x="120" y="220"></rect></g></g><g data-mml-node="mo" transform="translate(3269.8,0)"><path data-c="2309" d="M21 717T21 730T32 746T75 750H147H256Q266 742 269 735V-235Q262 -248 251 -250Q247 -250 244 -249T239 -247T235 -244T233 -241T231 -237T229 -234V710H133Q119 710 99 710T71 709Q43 709 32 713Z"></path></g></g></g></svg> </span> <code>VkSampleMask</code> values</p>
</li>
<li>
<p><a id="VUID-vkCmdSetSampleMaskEXT-commandBuffer-recording" href="#VUID-vkCmdSetSampleMaskEXT-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetSampleMaskEXT-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetSampleMaskEXT-commandBuffer-cmdpool" href="#VUID-vkCmdSetSampleMaskEXT-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetSampleMaskEXT-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetSampleMaskEXT-videocoding" href="#VUID-vkCmdSetSampleMaskEXT-videocoding"></a> <span class="vuid">VUID-vkCmdSetSampleMaskEXT-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Each bit of the coverage mask is associated with a sample index as described
in the <a href="primsrast.html#primsrast-multisampling-coverage-mask" class="xref page">rasterization chapter</a>.
If the bit in <a href="primsrast.html#VkPipelineMultisampleStateCreateInfo" class="xref page">VkPipelineMultisampleStateCreateInfo</a>::<code>pSampleMask</code>
which is associated with that same sample index is set to <code>0</code>, the coverage
mask bit is set to <code>0</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fragops-shader"><a class="anchor" href="#fragops-shader"></a>Fragment Shading</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="shaders.html#shaders-fragment" class="xref page">Fragment shaders</a> are invoked for each fragment, or as
<a href="shaders.html#shaders-helper-invocations" class="xref page">helper invocations</a>.</p>
</div>
<div class="paragraph">
<p>Most operations in the fragment shader are not performed in
<a href="primsrast.html#primsrast-order" class="xref page">rasterization order</a>, with exceptions called out in the
following sections.</p>
</div>
<div class="paragraph">
<p>For fragment shaders invoked by fragments, the following rules apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A fragment shader <strong>must</strong> not be executed if a <a href="#fragops">fragment    operation</a> that executes before fragment shading discards the fragment.</p>
</li>
<li>
<p>A fragment shader <strong>may</strong> not be executed if:</p>
<div class="ulist">
<ul>
<li>
<p>An implementation determines that another fragment shader, invoked by a
subsequent primitive in <a href="drawing.html#drawing-primitive-order" class="xref page">primitive order</a>,
overwrites all results computed by the shader (including writes to
storage resources).</p>
</li>
<li>
<p>Any other <a href="#fragops">fragment operation</a> discards the fragment, and
the shader does not write to any storage resources.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Otherwise, at least one fragment shader <strong>must</strong> be executed.</p>
<div class="ulist">
<ul>
<li>
<p>If <a href="primsrast.html#primsrast-sampleshading" class="xref page">sample shading</a> is enabled and multiple
invocations per fragment are <strong>required</strong>, additional invocations <strong>must</strong> be
executed as specified.</p>
</li>
<li>
<p>If a <a href="primsrast.html#primsrast-shading-rate-image" class="xref page">shading rate image</a> is used and
multiple invocations per fragment are <strong>required</strong>, additional invocations
<strong>must</strong> be executed as specified.</p>
</li>
<li>
<p>Each covered sample <strong>must</strong> be included in at least one fragment shader
invocation.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>If no fragment shader is included in the pipeline, no fragment shader is
executed, and <strong>undefined</strong> values <strong>may</strong> be written to all color attachment
outputs during this fragment operation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Multiple fragment shader invocations may be executed for the same fragment
for any number of implementation-dependent reasons.
When there is more than one fragment shader invocation per fragment, the
association of samples to invocations is implementation-dependent.
Stores and atomics performed by these additional invocations have the normal
effect.</p>
</div>
<div class="paragraph">
<p>For example, if the subpass includes multiple views in its view mask, a
fragment shader may be invoked separately for each view.</p>
</div>
<div class="paragraph">
<p>Similarly, if the render pass has a fragment density map attachment, more
than one fragment shader invocation may be invoked for each covered sample.
Such additional invocations are only produced if
<code>VkPhysicalDeviceFragmentDensityMapPropertiesEXT</code>::<code>fragmentDensityInvocations</code>
is <code>VK_TRUE</code>.
Implementations may generate these additional fragment shader invocations in
order to make transitions between fragment areas with different fragment
densities more smooth.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="fragops-shader-samplemask"><a class="anchor" href="#fragops-shader-samplemask"></a>Sample Mask</h3>
<div class="paragraph">
<p>Reading from the <a href="interfaces.html#interfaces-builtin-variables-samplemask" class="xref page"><code>SampleMask</code></a> built-in in the <code>Input</code> storage class will return the
coverage mask for the current fragment as calculated by fragment operations
that executed prior to fragment shading.</p>
</div>
<div class="paragraph">
<p>If <a href="primsrast.html#primsrast-sampleshading" class="xref page">sample shading</a> is enabled, fragment shaders
will only see values of <code>1</code> for samples being shaded - other bits will be
<code>0</code>.</p>
</div>
<div class="paragraph">
<p>Each bit of the coverage mask is associated with a sample index as described
in the <a href="primsrast.html#primsrast-multisampling-coverage-mask" class="xref page">rasterization chapter</a>.
If the bit in <code>SampleMask</code> which is associated with that same sample
index is set to <code>0</code>, that coverage mask bit is set to <code>0</code>.</p>
</div>
<div class="paragraph">
<p>Values written to the <a href="interfaces.html#interfaces-builtin-variables-samplemask" class="xref page"><code>SampleMask</code></a> built-in in the <code>Output</code> storage class will be used by
the <a href="#fragops-covg">multisample coverage</a> operation, with the same encoding
as the input built-in.</p>
</div>
</div>
<div class="sect2">
<h3 id="fragops-shader-tileimage-reads"><a class="anchor" href="#fragops-shader-tileimage-reads"></a>Fragment Shader Tile Image Reads</h3>
<div class="paragraph">
<p>If the <code><a href="../appendices/extensions.html#VK_EXT_shader_tile_image" class="xref page">VK_EXT_shader_tile_image</a></code> extension is enabled,
implementations divide the framebuffer into a grid of tiles.
A <a href="../appendices/glossary.html#glossary-tile-image" class="xref page">tile image</a> is a view of a framebuffer attachment
tile for fragments with locations within the tile.</p>
</div>
<div class="paragraph">
<p>Within a render pass instance initiated by <a href="renderpass.html#vkCmdBeginRenderingKHR" class="xref page">vkCmdBeginRenderingKHR</a>,
fragment shader invocations <strong>can</strong> read the framebuffer color, depth, and
stencil values at the fragment location via tile images.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Even though fragment shader invocation can only read from the corresponding
fragment location, the abstraction of a tile image is introduced for the
following reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Tile dimensions will be exposed in a future extension</p>
</li>
<li>
<p>Future functionality such as executing compute dispatches within render
passes via tile shaders can leverage tile images.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Enabling <a href="features.html#features-shaderTileImageColorReadAccess" class="xref page">shaderTileImageColorReadAccess</a>, <a href="features.html#features-shaderTileImageDepthReadAccess" class="xref page">shaderTileImageDepthReadAccess</a>,
<a href="features.html#features-shaderTileImageStencilReadAccess" class="xref page">shaderTileImageStencilReadAccess</a> enables fragment shader invocations to
read from color, depth, and stencil, respectively.</p>
</div>
<div class="paragraph">
<p>Color values are read from tile image variables with
<code>OpColorAttachmentReadEXT</code>.
Tile image variables are linked to specific color attachments using
<code>Location</code> decoration.
See <a href="interfaces.html#interfaces-fragmenttileimage" class="xref page">Fragment Tile Image Interface</a> for more
details.</p>
</div>
<div class="paragraph">
<p>Depth values are read with <code>OpDepthAttachmentReadEXT</code>.</p>
</div>
<div class="paragraph">
<p>Stencil values are read with <code>OpStencilAttachmentReadEXT</code>.</p>
</div>
<div class="paragraph">
<p>The sample to read is specified by a
<a href="primsrast.html#primsrast-multisampling-coverage-mask" class="xref page">sample index</a> value specified as
the <code>Sample</code> operand to <code>OpColorAttachmentReadEXT</code>,
<code>OpDepthAttachmentReadEXT</code>, or <code>OpStencilAttachmentReadEXT</code>.</p>
</div>
<div class="paragraph">
<p>If <a href="primsrast.html#primsrast-sampleshading" class="xref page">sample shading</a> is disabled, a fragment
invocation <strong>can</strong> read from all sample locations associated with the fragment
regardless of the fragment&#8217;s coverage.
This functionality is supported for
<a href="primsrast.html#VkPipelineMultisampleStateCreateInfo" class="xref page">VkPipelineMultisampleStateCreateInfo</a>::<code>rasterizationSamples</code> &gt; 1
when
<a href="devsandqueues.html#VkPhysicalDeviceShaderTileImagePropertiesEXT" class="xref page">VkPhysicalDeviceShaderTileImagePropertiesEXT</a>::<code>shaderTileImageReadSampleFromPixelRateInvocation</code>
is <code>VK_TRUE</code>.</p>
</div>
<div class="paragraph">
<p>If <a href="primsrast.html#primsrast-sampleshading" class="xref page">sample shading</a> is enabled, and
<code>minSampleShading</code> is 1.0, a fragment invocation <strong>must</strong> only read from
the <a href="primsrast.html#primsrast-multisampling-coverageindex" class="xref page">coverage index</a> sample.
Tile image access <strong>must</strong> not be used if the value of <code>minSampleShading</code>
is not 1.0.</p>
</div>
<div class="paragraph">
<p>If the <a href="#fragops-shader">fragment shader</a> declares the
<code>EarlyFragmentTests</code> execution mode, depth reads are allowed only if
depth writes are disabled and stencil reads are allowed only if stencil
writes are disabled.</p>
</div>
<div class="paragraph">
<p>If
<a href="devsandqueues.html#VkPhysicalDeviceShaderTileImagePropertiesEXT" class="xref page">VkPhysicalDeviceShaderTileImagePropertiesEXT</a>::<code>shaderTileImageReadFromHelperInvocation</code>
is <code>VK_FALSE</code>, values read from helper invocations are <strong>undefined</strong>
otherwise the values read are subject to the coherency guarantees described
below.</p>
</div>
<div class="paragraph">
<p><code>OpDepthAttachmentReadEXT</code> returns an <strong>undefined</strong> value if no depth
attachment is present.
<code>OpStencilAttachmentReadEXT</code> returns an <strong>undefined</strong> value if no stencil
attachment is present.</p>
</div>
<div class="paragraph">
<p>Tile image reads from color, depth and stencil attachments are said to be
coherent when the accesses happen in raster order and without
<a href="../appendices/memorymodel.html#memory-model-access-data-race" class="xref page">data race</a> with respect to accesses to the
attachments from framebuffer-space pipeline stages.
The samples which qualify for coherent access and the enabling conditions
are described below.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Let <span class="eq">Rc</span> be the set of components being read from an attachment
<span class="eq">A</span> in a draw call</p>
</li>
<li>
<p>Let <span class="eq">Wc</span> be the set of components being written to <span class="eq">A</span> by the
draw call</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The samples which qualify for coherent tile image reads from an attachment
<span class="eq">A</span> are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All samples in a pixel when <span class="eq">Rc</span> is disjoint with <span class="eq">Wc</span>.</p>
</li>
<li>
<p>The samples with coverage in a fragment when <span class="eq">Rc</span> is not disjoint
with <span class="eq">Wc</span>.
The samples with coverage are determined by the coverage mask for the
fragment as calculated by fragment operations that executed prior to
fragment shading, including early fragment tests if enabled for the draw
call.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A fragment shader <strong>can</strong> declare <code>NonCoherentColorAttachmentReadEXT</code>,
<code>NonCoherentDepthAttachmentReadEXT</code>, or
<code>NonCoherentStencilAttachmentReadEXT</code> execution modes to enable
non-coherent tile image reads which requires
<a href="synchronization.html#synchronization-pipeline-barriers-explicit-renderpass-tileimage" class="xref page">explicittile image synchronization</a> for the writes to an attachment to be made
visible via tile image reads.</p>
</div>
<div class="paragraph">
<p>When
<a href="devsandqueues.html#VkPhysicalDeviceShaderTileImagePropertiesEXT" class="xref page">VkPhysicalDeviceShaderTileImagePropertiesEXT</a>::<code>shaderTileImageCoherentReadAccelerated</code>
is <code>VK_TRUE</code>, the implementation prefers that coherent tile image reads
are used, otherwise the implementation prefers that non-coherent tile image
reads are used.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>In practice, the most common tile image reads usage patterns fall under one
of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Programmable blending - each fragment reads from a single sample
(SampleID) at its location.
Per-sample shading is typically enabled when multisampled rendertargets
are used.</p>
</li>
<li>
<p>G-buffer generation and shading in one render pass - in the shading
phase a fragment reads from a single sample at its location.</p>
</li>
<li>
<p>Programmable resolve - a fragment reads from all samples at its location
(per-sample shading is disabled).
This requires the use of a "full-screen triangle" instead of a rectangle
composed of two triangles in order to avoid data races along the shared
edge of the triangles.</p>
</li>
<li>
<p>1:1 texturing with LOD - in use cases such a deferred screen space
decals a fragment reads a single sample (SampleID) from depth buffer,
but requires being able to read from helper threads to derive the
texture LOD.
This use case is supported as long as the attachment components being
read are not overwritten by color, depth, or stencil attachment writes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All of the above use cases are supported by coherent tile image reads, but
only the latter three are supported when non-coherent reads are used as
there is no mechanism to synchronize non-coherent reads with writes within a
draw call.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="fragops-shader-depthreplacement"><a class="anchor" href="#fragops-shader-depthreplacement"></a>Depth Replacement</h3>
<div class="paragraph">
<p>Writing to the <a href="interfaces.html#interfaces-builtin-variables-fragdepth" class="xref page"><code>FragDepth</code></a>
built-in will replace the fragment&#8217;s calculated depth values for each sample
in the input <code>SampleMask</code>.
<a href="#fragops-depth">Depth testing</a> performed after the fragment shader for
this fragment will use this new value as <span class="eq">z<sub>f</sub></span>.</p>
</div>
</div>
<div class="sect2">
<h3 id="fragops-shader-stencilrefreplacement"><a class="anchor" href="#fragops-shader-stencilrefreplacement"></a>Stencil Reference Replacement</h3>
<div class="paragraph">
<p>Writing to the
<a href="interfaces.html#interfaces-builtin-variables-fragdepth" class="xref page"><code>FragStencilRefEXT</code></a> built-in
will replace the fragment&#8217;s stencil reference value for each sample in the
input <code>SampleMask</code>.
<a href="#fragops-stencil">Stencil testing</a> performed after the fragment shader for
this fragment will use this new value as <span class="eq">s<sub>r</sub></span>.</p>
</div>
</div>
<div class="sect2">
<h3 id="fragops-shader-interlock"><a class="anchor" href="#fragops-shader-interlock"></a>Interlocked Operations</h3>
<div class="paragraph">
<p><code>OpBeginInvocationInterlockEXT</code> and <code>OpEndInvocationInterlockEXT</code>
define a section of a fragment shader which imposes additional ordering
constraints on operations performed within them.
These operations are defined as <em>interlocked operations</em>.
How interlocked operations are ordered against other fragment shader
invocations depends on the specified execution modes.</p>
</div>
<div class="paragraph">
<p>If the <code>ShadingRateInterlockOrderedEXT</code> execution mode is specified, any
interlocked operations in a fragment shader <strong>must</strong> happen before interlocked
operations in fragment shader invocations that execute later in
<a href="primsrast.html#primsrast-order" class="xref page">rasterization order</a> and cover at least one sample in
the same fragment area, and <strong>must</strong> happen after interlocked operations in a
fragment shader that executes earlier in <a href="primsrast.html#primsrast-order" class="xref page">rasterizationorder</a> and cover at least one sample in the same fragment area.</p>
</div>
<div class="paragraph">
<p>If the <code>ShadingRateInterlockUnorderedEXT</code> execution mode is specified,
any interlocked operations in a fragment shader <strong>must</strong> happen before or after
interlocked operations in fragment shader invocations that execute earlier
or later in <a href="primsrast.html#primsrast-order" class="xref page">rasterization order</a> and cover at least one
sample in the same fragment area.</p>
</div>
<div class="paragraph">
<p>If the <code>PixelInterlockOrderedEXT</code> execution mode is specified, any
interlocked operations in a fragment shader <strong>must</strong> happen before interlocked
operations in fragment shader invocations that execute later in
<a href="primsrast.html#primsrast-order" class="xref page">rasterization order</a> and cover at least one sample in
the same pixel, and <strong>must</strong> happen after interlocked operations in a fragment
shader that executes earlier in <a href="primsrast.html#primsrast-order" class="xref page">rasterization order</a> and
cover at least one sample in the same pixel.</p>
</div>
<div class="paragraph">
<p>If the <code>PixelInterlockUnorderedEXT</code> execution mode is specified, any
interlocked operations in a fragment shader <strong>must</strong> happen before or after
interlocked operations in fragment shader invocations that execute earlier
or later in <a href="primsrast.html#primsrast-order" class="xref page">rasterization order</a> and cover at least one
sample in the same pixel.</p>
</div>
<div class="paragraph">
<p>If the <code>SampleInterlockOrderedEXT</code> execution mode is specified, any
interlocked operations in a fragment shader <strong>must</strong> happen before interlocked
operations in fragment shader invocations that execute later in
<a href="primsrast.html#primsrast-order" class="xref page">rasterization order</a> and cover at least one of the same
samples, and <strong>must</strong> happen after interlocked operations in a fragment shader
that executes earlier in <a href="primsrast.html#primsrast-order" class="xref page">rasterization order</a> and cover
at least one of the same samples.</p>
</div>
<div class="paragraph">
<p>If the <code>SampleInterlockUnorderedEXT</code> execution mode is specified, any
interlocked operations in a fragment shader <strong>must</strong> happen before or after
interlocked operations in fragment shader invocations that execute earlier
or later in <a href="primsrast.html#primsrast-order" class="xref page">rasterization order</a> and cover at least one
of the same samples.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fragops-covg"><a class="anchor" href="#fragops-covg"></a>Multisample Coverage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If a fragment shader is active and its entry point&#8217;s interface includes a
built-in output variable decorated with <code>SampleMask</code>,
but not <code>OverrideCoverageNV</code>,
the coverage mask is <code>ANDed</code> with the bits of the <code>SampleMask</code>
built-in to generate a new coverage mask.
If the <code>SampleMask</code> built-in is also decorated with
<code>OverrideCoverageNV</code>, the coverage mask is replaced with the mask bits
set in the shader.
If <a href="primsrast.html#primsrast-sampleshading" class="xref page">sample shading</a> is enabled, bits written to
<code>SampleMask</code> corresponding to samples that are not being shaded by the
fragment shader invocation are ignored.
If no fragment shader is active, or if the active fragment shader does not
include <code>SampleMask</code> in its interface, the coverage mask is not modified.</p>
</div>
<div class="paragraph">
<p>Next, the fragment alpha value and coverage mask are modified based on the
line coverage factor if the <code>lineRasterizationMode</code> member of the
<a href="primsrast.html#VkPipelineRasterizationStateCreateInfo" class="xref page">VkPipelineRasterizationStateCreateInfo</a> structure is
<code>VK_LINE_RASTERIZATION_MODE_RECTANGULAR_SMOOTH_EXT</code>, and the
<code>alphaToCoverageEnable</code> and <code>alphaToOneEnable</code> members of the
<a href="primsrast.html#VkPipelineMultisampleStateCreateInfo" class="xref page">VkPipelineMultisampleStateCreateInfo</a> structure.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the
<code>alphaToCoverageEnable</code> state, call:</p>
</div>
<div id="vkCmdSetAlphaToCoverageEnableEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_extended_dynamic_state3, VK_EXT_shader_object
void vkCmdSetAlphaToCoverageEnableEXT(
    VkCommandBuffer                             commandBuffer,
    VkBool32                                    alphaToCoverageEnable);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>alphaToCoverageEnable</code> specifies the <code>alphaToCoverageEnable</code>
state.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the <code>alphaToCoverageEnable</code> state for subsequent
drawing commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_ALPHA_TO_COVERAGE_ENABLE_EXT</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="primsrast.html#VkPipelineMultisampleStateCreateInfo" class="xref page">VkPipelineMultisampleStateCreateInfo</a>::<code>alphaToCoverageEnable</code>
value used to create the currently active pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetAlphaToCoverageEnableEXT-None-08506" href="#VUID-vkCmdSetAlphaToCoverageEnableEXT-None-08506"></a> <span class="vuid">VUID-vkCmdSetAlphaToCoverageEnableEXT-None-08506</span><br>

Either the <a href="features.html#features-extendedDynamicState3AlphaToCoverageEnable" class="xref page">    <code>extendedDynamicState3AlphaToCoverageEnable</code></a> feature or the
<a href="features.html#features-shaderObject" class="xref page"><code>shaderObject</code></a> feature or both <strong>must</strong> be
enabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetAlphaToCoverageEnableEXT-commandBuffer-parameter" href="#VUID-vkCmdSetAlphaToCoverageEnableEXT-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetAlphaToCoverageEnableEXT-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetAlphaToCoverageEnableEXT-commandBuffer-recording" href="#VUID-vkCmdSetAlphaToCoverageEnableEXT-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetAlphaToCoverageEnableEXT-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetAlphaToCoverageEnableEXT-commandBuffer-cmdpool" href="#VUID-vkCmdSetAlphaToCoverageEnableEXT-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetAlphaToCoverageEnableEXT-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetAlphaToCoverageEnableEXT-videocoding" href="#VUID-vkCmdSetAlphaToCoverageEnableEXT-videocoding"></a> <span class="vuid">VUID-vkCmdSetAlphaToCoverageEnableEXT-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the <code>alphaToOneEnable</code>
state, call:</p>
</div>
<div id="vkCmdSetAlphaToOneEnableEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_extended_dynamic_state3, VK_EXT_shader_object
void vkCmdSetAlphaToOneEnableEXT(
    VkCommandBuffer                             commandBuffer,
    VkBool32                                    alphaToOneEnable);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>alphaToOneEnable</code> specifies the <code>alphaToOneEnable</code> state.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the <code>alphaToOneEnable</code> state for subsequent drawing
commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_ALPHA_TO_ONE_ENABLE_EXT</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="primsrast.html#VkPipelineMultisampleStateCreateInfo" class="xref page">VkPipelineMultisampleStateCreateInfo</a>::<code>alphaToOneEnable</code> value
used to create the currently active pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetAlphaToOneEnableEXT-None-08508" href="#VUID-vkCmdSetAlphaToOneEnableEXT-None-08508"></a> <span class="vuid">VUID-vkCmdSetAlphaToOneEnableEXT-None-08508</span><br>

Either the <a href="features.html#features-extendedDynamicState3AlphaToOneEnable" class="xref page">    <code>extendedDynamicState3AlphaToOneEnable</code></a> feature or the
<a href="features.html#features-shaderObject" class="xref page"><code>shaderObject</code></a> feature or both <strong>must</strong> be
enabled</p>
</li>
<li>
<p><a id="VUID-vkCmdSetAlphaToOneEnableEXT-alphaToOne-07607" href="#VUID-vkCmdSetAlphaToOneEnableEXT-alphaToOne-07607"></a> <span class="vuid">VUID-vkCmdSetAlphaToOneEnableEXT-alphaToOne-07607</span><br>

If the <a href="features.html#features-alphaToOne" class="xref page"><code>alphaToOne</code></a> feature is not enabled,
<code>alphaToOneEnable</code> <strong>must</strong> be <code>VK_FALSE</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetAlphaToOneEnableEXT-commandBuffer-parameter" href="#VUID-vkCmdSetAlphaToOneEnableEXT-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetAlphaToOneEnableEXT-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetAlphaToOneEnableEXT-commandBuffer-recording" href="#VUID-vkCmdSetAlphaToOneEnableEXT-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetAlphaToOneEnableEXT-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetAlphaToOneEnableEXT-commandBuffer-cmdpool" href="#VUID-vkCmdSetAlphaToOneEnableEXT-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetAlphaToOneEnableEXT-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetAlphaToOneEnableEXT-videocoding" href="#VUID-vkCmdSetAlphaToOneEnableEXT-videocoding"></a> <span class="vuid">VUID-vkCmdSetAlphaToOneEnableEXT-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>All alpha values in this section refer only to the alpha component of the
fragment shader output that has a <code>Location</code> and <code>Index</code> decoration of
zero (see the <a href="interfaces.html#interfaces-fragmentoutput" class="xref page">Fragment Output Interface</a>
section).
If that shader output has an integer or unsigned integer type, then these
operations are skipped.</p>
</div>
<div class="paragraph">
<p>If the <code>lineRasterizationMode</code> member of the
<a href="primsrast.html#VkPipelineRasterizationStateCreateInfo" class="xref page">VkPipelineRasterizationStateCreateInfo</a> structure is
<code>VK_LINE_RASTERIZATION_MODE_RECTANGULAR_SMOOTH_EXT</code> and the fragment
came from a line segment, then the alpha value is replaced by multiplying it
by the coverage factor for the fragment computed during
<a href="primsrast.html#primsrast-lines-smooth" class="xref page">smooth line rasterization</a>.</p>
</div>
<div class="paragraph">
<p>If <code>alphaToCoverageEnable</code> is enabled, a temporary coverage mask is
generated where each bit is determined by the fragment&#8217;s alpha value, which
is ANDed with the fragment coverage mask.</p>
</div>
<div class="paragraph">
<p>No specific algorithm is specified for converting the alpha value to a
temporary coverage mask.
It is intended that the number of 1&#8217;s in this value be proportional to the
alpha value (clamped to <span class="eq">[0,1]</span>), with all 1&#8217;s corresponding to a value
of 1.0 and all 0&#8217;s corresponding to 0.0.
The algorithm <strong>may</strong> be different at different framebuffer coordinates.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Using different algorithms at different framebuffer coordinates <strong>may</strong> help to
avoid artifacts caused by regular coverage sample locations.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally, if <code>alphaToOneEnable</code> is enabled, each alpha value is replaced
by the maximum representable alpha value for fixed-point color attachments,
or by 1.0 for floating-point attachments.
Otherwise, the alpha values are not changed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fragops-ds-state"><a class="anchor" href="#fragops-ds-state"></a>Depth and Stencil Operations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Pipeline state controlling the <a href="#fragops-dbt">depth bounds tests</a>,
<a href="#fragops-stencil">stencil test</a>, and <a href="#fragops-depth">depth test</a> is
specified through the members of the
<code>VkPipelineDepthStencilStateCreateInfo</code> structure.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPipelineDepthStencilStateCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkPipelineDepthStencilStateCreateInfo" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef struct VkPipelineDepthStencilStateCreateInfo {
    VkStructureType                           sType;
    const void*                               pNext;
    VkPipelineDepthStencilStateCreateFlags    flags;
    VkBool32                                  depthTestEnable;
    VkBool32                                  depthWriteEnable;
    VkCompareOp                               depthCompareOp;
    VkBool32                                  depthBoundsTestEnable;
    VkBool32                                  stencilTestEnable;
    VkStencilOpState                          front;
    VkStencilOpState                          back;
    float                                     minDepthBounds;
    float                                     maxDepthBounds;
} VkPipelineDepthStencilStateCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of
<a href="#VkPipelineDepthStencilStateCreateFlagBits">VkPipelineDepthStencilStateCreateFlagBits</a> specifying additional
depth/stencil state information.</p>
</li>
<li>
<p><code>depthTestEnable</code> controls whether <a href="#fragops-depth">depth testing</a>
is enabled.</p>
</li>
<li>
<p><code>depthWriteEnable</code> controls whether <a href="#fragops-depth-write">depth    writes</a> are enabled when <code>depthTestEnable</code> is <code>VK_TRUE</code>.
Depth writes are always disabled when <code>depthTestEnable</code> is
<code>VK_FALSE</code>.</p>
</li>
<li>
<p><code>depthCompareOp</code> is a <a href="samplers.html#VkCompareOp" class="xref page">VkCompareOp</a> value specifying the
comparison operator to use in the <a href="#fragops-depth-comparison">Depth    Comparison</a> step of the <a href="#fragops-depth">depth test</a>.</p>
</li>
<li>
<p><code>depthBoundsTestEnable</code> controls whether <a href="#fragops-dbt">depth bounds    testing</a> is enabled.</p>
</li>
<li>
<p><code>stencilTestEnable</code> controls whether <a href="#fragops-stencil">stencil    testing</a> is enabled.</p>
</li>
<li>
<p><code>front</code> and <code>back</code> are <a href="#VkStencilOpState">VkStencilOpState</a> values controlling
the corresponding parameters of the <a href="#fragops-stencil">stencil test</a>.</p>
</li>
<li>
<p><code>minDepthBounds</code> is the minimum depth bound used in the
<a href="#fragops-dbt">depth bounds test</a>.</p>
</li>
<li>
<p><code>maxDepthBounds</code> is the maximum depth bound used in the
<a href="#fragops-dbt">depth bounds test</a>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPipelineDepthStencilStateCreateInfo-depthBoundsTestEnable-00598" href="#VUID-VkPipelineDepthStencilStateCreateInfo-depthBoundsTestEnable-00598"></a> <span class="vuid">VUID-VkPipelineDepthStencilStateCreateInfo-depthBoundsTestEnable-00598</span><br>

If the <a href="features.html#features-depthBounds" class="xref page"><code>depthBounds</code></a> feature is not
enabled, <code>depthBoundsTestEnable</code> <strong>must</strong> be <code>VK_FALSE</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineDepthStencilStateCreateInfo-separateStencilMaskRef-04453" href="#VUID-VkPipelineDepthStencilStateCreateInfo-separateStencilMaskRef-04453"></a> <span class="vuid">VUID-VkPipelineDepthStencilStateCreateInfo-separateStencilMaskRef-04453</span><br>

If the <code><a href="../appendices/extensions.html#VK_KHR_portability_subset" class="xref page">VK_KHR_portability_subset</a></code> extension is enabled, and
<a href="features.html#VkPhysicalDevicePortabilitySubsetFeaturesKHR" class="xref page">VkPhysicalDevicePortabilitySubsetFeaturesKHR</a>::<code>separateStencilMaskRef</code>
is <code>VK_FALSE</code>, and the value of
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>stencilTestEnable</code> is
<code>VK_TRUE</code>, and the value of
<a href="primsrast.html#VkPipelineRasterizationStateCreateInfo" class="xref page">VkPipelineRasterizationStateCreateInfo</a>::<code>cullMode</code> is
<code>VK_CULL_MODE_NONE</code>, the value of <code>reference</code> in each of the
<a href="#VkStencilOpState">VkStencilOpState</a> structs in <code>front</code> and <code>back</code> <strong>must</strong> be
the same</p>
</li>
<li>
<p><a id="VUID-VkPipelineDepthStencilStateCreateInfo-rasterizationOrderDepthAttachmentAccess-06463" href="#VUID-VkPipelineDepthStencilStateCreateInfo-rasterizationOrderDepthAttachmentAccess-06463"></a> <span class="vuid">VUID-VkPipelineDepthStencilStateCreateInfo-rasterizationOrderDepthAttachmentAccess-06463</span><br>

If the <a href="features.html#features-rasterizationOrderDepthAttachmentAccess" class="xref page">    <code>rasterizationOrderDepthAttachmentAccess</code></a> feature is not enabled,
<code>flags</code> <strong>must</strong> not include
<code>VK_PIPELINE_DEPTH_STENCIL_STATE_CREATE_RASTERIZATION_ORDER_ATTACHMENT_DEPTH_ACCESS_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineDepthStencilStateCreateInfo-rasterizationOrderStencilAttachmentAccess-06464" href="#VUID-VkPipelineDepthStencilStateCreateInfo-rasterizationOrderStencilAttachmentAccess-06464"></a> <span class="vuid">VUID-VkPipelineDepthStencilStateCreateInfo-rasterizationOrderStencilAttachmentAccess-06464</span><br>

If the <a href="features.html#features-rasterizationOrderStencilAttachmentAccess" class="xref page">    <code>rasterizationOrderStencilAttachmentAccess</code></a> feature is not
enabled, <code>flags</code> <strong>must</strong> not include
<code>VK_PIPELINE_DEPTH_STENCIL_STATE_CREATE_RASTERIZATION_ORDER_ATTACHMENT_STENCIL_ACCESS_BIT_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPipelineDepthStencilStateCreateInfo-sType-sType" href="#VUID-VkPipelineDepthStencilStateCreateInfo-sType-sType"></a> <span class="vuid">VUID-VkPipelineDepthStencilStateCreateInfo-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_PIPELINE_DEPTH_STENCIL_STATE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineDepthStencilStateCreateInfo-pNext-pNext" href="#VUID-VkPipelineDepthStencilStateCreateInfo-pNext-pNext"></a> <span class="vuid">VUID-VkPipelineDepthStencilStateCreateInfo-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineDepthStencilStateCreateInfo-flags-parameter" href="#VUID-VkPipelineDepthStencilStateCreateInfo-flags-parameter"></a> <span class="vuid">VUID-VkPipelineDepthStencilStateCreateInfo-flags-parameter</span><br>
 <code>flags</code> <strong>must</strong> be a valid combination of <a href="#VkPipelineDepthStencilStateCreateFlagBits">VkPipelineDepthStencilStateCreateFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkPipelineDepthStencilStateCreateInfo-depthCompareOp-parameter" href="#VUID-VkPipelineDepthStencilStateCreateInfo-depthCompareOp-parameter"></a> <span class="vuid">VUID-VkPipelineDepthStencilStateCreateInfo-depthCompareOp-parameter</span><br>
 <code>depthCompareOp</code> <strong>must</strong> be a valid <a href="samplers.html#VkCompareOp" class="xref page">VkCompareOp</a> value</p>
</li>
<li>
<p><a id="VUID-VkPipelineDepthStencilStateCreateInfo-front-parameter" href="#VUID-VkPipelineDepthStencilStateCreateInfo-front-parameter"></a> <span class="vuid">VUID-VkPipelineDepthStencilStateCreateInfo-front-parameter</span><br>
 <code>front</code> <strong>must</strong> be a valid <a href="#VkStencilOpState">VkStencilOpState</a> structure</p>
</li>
<li>
<p><a id="VUID-VkPipelineDepthStencilStateCreateInfo-back-parameter" href="#VUID-VkPipelineDepthStencilStateCreateInfo-back-parameter"></a> <span class="vuid">VUID-VkPipelineDepthStencilStateCreateInfo-back-parameter</span><br>
 <code>back</code> <strong>must</strong> be a valid <a href="#VkStencilOpState">VkStencilOpState</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkPipelineDepthStencilStateCreateFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef VkFlags VkPipelineDepthStencilStateCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkPipelineDepthStencilStateCreateFlags</code> is a bitmask type for setting a
mask of zero or more <a href="#VkPipelineDepthStencilStateCreateFlagBits">VkPipelineDepthStencilStateCreateFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong>can</strong> be set in the
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>flags</code> parameter are:</p>
</div>
<div id="VkPipelineDepthStencilStateCreateFlagBits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_rasterization_order_attachment_access
typedef enum VkPipelineDepthStencilStateCreateFlagBits {
  // Provided by VK_EXT_rasterization_order_attachment_access
    VK_PIPELINE_DEPTH_STENCIL_STATE_CREATE_RASTERIZATION_ORDER_ATTACHMENT_DEPTH_ACCESS_BIT_EXT = 0x00000001,
  // Provided by VK_EXT_rasterization_order_attachment_access
    VK_PIPELINE_DEPTH_STENCIL_STATE_CREATE_RASTERIZATION_ORDER_ATTACHMENT_STENCIL_ACCESS_BIT_EXT = 0x00000002,
  // Provided by VK_ARM_rasterization_order_attachment_access
    VK_PIPELINE_DEPTH_STENCIL_STATE_CREATE_RASTERIZATION_ORDER_ATTACHMENT_DEPTH_ACCESS_BIT_ARM = VK_PIPELINE_DEPTH_STENCIL_STATE_CREATE_RASTERIZATION_ORDER_ATTACHMENT_DEPTH_ACCESS_BIT_EXT,
  // Provided by VK_ARM_rasterization_order_attachment_access
    VK_PIPELINE_DEPTH_STENCIL_STATE_CREATE_RASTERIZATION_ORDER_ATTACHMENT_STENCIL_ACCESS_BIT_ARM = VK_PIPELINE_DEPTH_STENCIL_STATE_CREATE_RASTERIZATION_ORDER_ATTACHMENT_STENCIL_ACCESS_BIT_EXT,
} VkPipelineDepthStencilStateCreateFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_DEPTH_STENCIL_STATE_CREATE_RASTERIZATION_ORDER_ATTACHMENT_DEPTH_ACCESS_BIT_EXT</code>
indicates that access to the depth aspects of depth/stencil and input
attachments will have implicit framebuffer-local memory dependencies.</p>
</li>
<li>
<p><code>VK_PIPELINE_DEPTH_STENCIL_STATE_CREATE_RASTERIZATION_ORDER_ATTACHMENT_STENCIL_ACCESS_BIT_EXT</code>
indicates that access to the stencil aspects of depth/stencil and input
attachments will have implicit framebuffer-local memory dependencies.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When
<code>VK_PIPELINE_DEPTH_STENCIL_STATE_CREATE_RASTERIZATION_ORDER_ATTACHMENT_DEPTH_ACCESS_BIT_EXT</code>
is included in a pipeline, it forms a framebuffer-local memory dependency
for each fragment generated by draw commands for that pipeline with the
following scopes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization scope</a>
includes <code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code> and
<code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code> pipeline stages executed
by all previous fragments (as defined by <a href="drawing.html#drawing-primitive-order" class="xref page">    primitive order</a>) in the corresponding
<a href="synchronization.html#synchronization-framebuffer-regions" class="xref page">framebuffer regions</a> including
those generated by the same draw command.</p>
</li>
<li>
<p>The second <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization    scope</a> includes <code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code> stage
executed by the generated fragment.</p>
</li>
<li>
<p>The first <a href="synchronization.html#synchronization-dependencies-access-scopes" class="xref page">access scope</a>
includes all writes to the depth aspect of depth/stencil attachments.</p>
</li>
<li>
<p>The second <a href="synchronization.html#synchronization-dependencies-access-scopes" class="xref page">access scope</a>
includes all reads from the depth aspect of input attachments.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When
<code>VK_PIPELINE_DEPTH_STENCIL_STATE_CREATE_RASTERIZATION_ORDER_ATTACHMENT_STENCIL_ACCESS_BIT_EXT</code>
is included in a pipeline, it forms a framebuffer-local memory dependency
for each fragment generated by draw commands for that pipeline with the
following scopes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization scope</a>
includes <code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code>
<code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code> pipeline stages executed
by all previous fragments (as defined by <a href="drawing.html#drawing-primitive-order" class="xref page">    primitive order</a>) in the corresponding
<a href="synchronization.html#synchronization-framebuffer-regions" class="xref page">framebuffer regions</a> including
those generated by the same draw command.</p>
</li>
<li>
<p>The second <a href="synchronization.html#synchronization-dependencies-scopes" class="xref page">synchronization    scope</a> includes <code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code> and
<code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code> pipeline stages executed
by the generated fragment.</p>
</li>
<li>
<p>The first <a href="synchronization.html#synchronization-dependencies-access-scopes" class="xref page">access scope</a>
includes all writes to the stencil aspect of depth/stencil attachments.</p>
</li>
<li>
<p>The second <a href="synchronization.html#synchronization-dependencies-access-scopes" class="xref page">access scope</a>
includes all reads from the stencil aspect of input attachments.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fragops-dbt"><a class="anchor" href="#fragops-dbt"></a>Depth Bounds Test</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The depth bounds test compares the depth value <span class="eq">z<sub>a</sub></span> in the
depth/stencil attachment at each sample&#8217;s framebuffer coordinates
<span class="eq">(x<sub>f</sub>,y<sub>f</sub>)</span> and <a href="primsrast.html#primsrast-multisampling-coverage-mask" class="xref page">sampleindex</a> <span class="eq">i</span> against a set of <em>depth bounds</em>.</p>
</div>
<div class="paragraph">
<p>The depth bounds are determined by two floating point values defining a
minimum (<code>minDepthBounds</code>) and maximum (<code>maxDepthBounds</code>) depth
value.
These values are either set by the
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a> structure during pipeline
creation, or dynamically by
<a href="#vkCmdSetDepthBoundsTestEnable">vkCmdSetDepthBoundsTestEnable</a> and
<a href="#vkCmdSetDepthBounds">vkCmdSetDepthBounds</a>.</p>
</div>
<div class="paragraph">
<p>A given sample is considered within the depth bounds if <span class="eq">z<sub>a</sub></span> is in the
range <span class="eq">[<code>minDepthBounds</code>,<code>maxDepthBounds</code>]</span>.
Samples with depth attachment values outside of the depth bounds will have
their coverage set to <code>0</code>.</p>
</div>
<div class="paragraph">
<p>If the depth bounds test is disabled, or if there is no depth attachment,
the coverage mask is unmodified by this operation.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically enable or disable</a> the depth
bounds test, call:</p>
</div>
<div id="vkCmdSetDepthBoundsTestEnable" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
void vkCmdSetDepthBoundsTestEnable(
    VkCommandBuffer                             commandBuffer,
    VkBool32                                    depthBoundsTestEnable);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent command</p>
</div>
<div id="vkCmdSetDepthBoundsTestEnableEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_extended_dynamic_state, VK_EXT_shader_object
void vkCmdSetDepthBoundsTestEnableEXT(
    VkCommandBuffer                             commandBuffer,
    VkBool32                                    depthBoundsTestEnable);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>depthBoundsTestEnable</code> specifies if the depth bounds test is
enabled.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the depth bounds enable for subsequent drawing commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_DEPTH_BOUNDS_TEST_ENABLE</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>depthBoundsTestEnable</code>
value used to create the currently active pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetDepthBoundsTestEnable-None-08971" href="#VUID-vkCmdSetDepthBoundsTestEnable-None-08971"></a> <span class="vuid">VUID-vkCmdSetDepthBoundsTestEnable-None-08971</span><br>

At least one of the following <strong>must</strong> be true:</p>
<div class="ulist">
<ul>
<li>
<p>the <a href="features.html#features-extendedDynamicState" class="xref page"><code>extendedDynamicState</code></a>
feature is enabled</p>
</li>
<li>
<p>the <a href="features.html#features-shaderObject" class="xref page"><code>shaderObject</code></a> feature is enabled</p>
</li>
<li>
<p>the value of <a href="initialization.html#VkApplicationInfo" class="xref page">VkApplicationInfo</a>::<code>apiVersion</code> used to create
the <a href="initialization.html#VkInstance" class="xref page">VkInstance</a> parent of <code>commandBuffer</code> is greater than or
equal to Version 1.3</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetDepthBoundsTestEnable-commandBuffer-parameter" href="#VUID-vkCmdSetDepthBoundsTestEnable-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetDepthBoundsTestEnable-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDepthBoundsTestEnable-commandBuffer-recording" href="#VUID-vkCmdSetDepthBoundsTestEnable-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetDepthBoundsTestEnable-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetDepthBoundsTestEnable-commandBuffer-cmdpool" href="#VUID-vkCmdSetDepthBoundsTestEnable-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetDepthBoundsTestEnable-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDepthBoundsTestEnable-videocoding" href="#VUID-vkCmdSetDepthBoundsTestEnable-videocoding"></a> <span class="vuid">VUID-vkCmdSetDepthBoundsTestEnable-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the depth bounds range,
call:</p>
</div>
<div id="vkCmdSetDepthBounds" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkCmdSetDepthBounds(
    VkCommandBuffer                             commandBuffer,
    float                                       minDepthBounds,
    float                                       maxDepthBounds);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>minDepthBounds</code> is the minimum depth bound.</p>
</li>
<li>
<p><code>maxDepthBounds</code> is the maximum depth bound.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the depth bounds range for subsequent drawing commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_DEPTH_BOUNDS</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>minDepthBounds</code> and
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>maxDepthBounds</code> values
used to create the currently active pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetDepthBounds-minDepthBounds-00600" href="#VUID-vkCmdSetDepthBounds-minDepthBounds-00600"></a> <span class="vuid">VUID-vkCmdSetDepthBounds-minDepthBounds-00600</span><br>

If the <code><a href="../appendices/extensions.html#VK_EXT_depth_range_unrestricted" class="xref page">VK_EXT_depth_range_unrestricted</a></code> extension is not enabled
<code>minDepthBounds</code> <strong>must</strong> be between <code>0.0</code> and <code>1.0</code>, inclusive</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDepthBounds-maxDepthBounds-00601" href="#VUID-vkCmdSetDepthBounds-maxDepthBounds-00601"></a> <span class="vuid">VUID-vkCmdSetDepthBounds-maxDepthBounds-00601</span><br>

If the <code><a href="../appendices/extensions.html#VK_EXT_depth_range_unrestricted" class="xref page">VK_EXT_depth_range_unrestricted</a></code> extension is not enabled
<code>maxDepthBounds</code> <strong>must</strong> be between <code>0.0</code> and <code>1.0</code>, inclusive</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetDepthBounds-commandBuffer-parameter" href="#VUID-vkCmdSetDepthBounds-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetDepthBounds-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDepthBounds-commandBuffer-recording" href="#VUID-vkCmdSetDepthBounds-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetDepthBounds-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetDepthBounds-commandBuffer-cmdpool" href="#VUID-vkCmdSetDepthBounds-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetDepthBounds-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDepthBounds-videocoding" href="#VUID-vkCmdSetDepthBounds-videocoding"></a> <span class="vuid">VUID-vkCmdSetDepthBounds-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fragops-stencil"><a class="anchor" href="#fragops-stencil"></a>Stencil Test</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The stencil test compares the stencil attachment value <span class="eq">s<sub>a</sub></span> in the
depth/stencil attachment at each sample&#8217;s framebuffer coordinates
<span class="eq">(x<sub>f</sub>,y<sub>f</sub>)</span> and <a href="primsrast.html#primsrast-multisampling-coverage-mask" class="xref page">sampleindex</a> <span class="eq">i</span> against a <em>stencil reference value</em>.</p>
</div>
<div class="paragraph">
<p>If the render pass has a fragment density map attachment and the fragment
covers multiple pixels, there is an implementation-dependent association of
coverage samples to stencil attachment samples within the fragment.
However, if all samples in the fragment are covered, and the stencil
attachment value is updated as a result of this test, all stencil attachment
samples will be updated.</p>
</div>
<div class="paragraph">
<p>If the stencil test is not enabled, as specified by
<a href="#vkCmdSetStencilTestEnable">vkCmdSetStencilTestEnable</a> or
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>stencilTestEnable</code>, or if
there is no stencil attachment, the coverage mask is unmodified by this
operation.</p>
</div>
<div class="paragraph">
<p>The stencil test is controlled by one of two sets of stencil-related state,
the front stencil state and the back stencil state.
Stencil tests and writes use the back stencil state when processing
fragments generated by <a href="primsrast.html#primsrast-polygons-basic" class="xref page">back-facing</a>
<a href="primsrast.html#primsrast-polygons" class="xref page">polygons</a>, and the front stencil state when processing
fragments generated by <a href="primsrast.html#primsrast-polygons-basic" class="xref page">front-facing polygons</a> or
any other primitives.</p>
</div>
<div class="paragraph">
<p>The comparison operation performed is determined by the <a href="samplers.html#VkCompareOp" class="xref page">VkCompareOp</a>
value set by
<a href="#vkCmdSetStencilOp">vkCmdSetStencilOp</a>::<code>compareOp</code>, or by
<a href="#VkStencilOpState">VkStencilOpState</a>::<code>compareOp</code> during pipeline creation.</p>
</div>
<div class="paragraph">
<p>The compare mask <span class="eq">s<sub>c</sub></span> and stencil reference value <span class="eq">s<sub>r</sub></span> of the
front or the back stencil state set determine arguments of the comparison
operation.
<span class="eq">s<sub>c</sub></span> is set by the <a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>
structure during pipeline creation, or by the
<a href="#vkCmdSetStencilCompareMask">vkCmdSetStencilCompareMask</a> command.
<span class="eq">s<sub>r</sub></span> is set by <a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a> or by
<a href="#vkCmdSetStencilReference">vkCmdSetStencilReference</a>.</p>
</div>
<div class="paragraph">
<p><span class="eq">s<sub>r</sub></span> and <span class="eq">s<sub>a</sub></span> are each independently combined with <span class="eq">s<sub>c</sub></span>
using a bitwise <code>AND</code> operation to create masked reference and attachment
values <span class="eq">s'<sub>r</sub></span> and <span class="eq">s'<sub>a</sub></span>.
<span class="eq">s'<sub>r</sub></span> and <span class="eq">s'<sub>a</sub></span> are used as the <em>reference</em> and <em>test</em> values,
respectively, in the operation specified by the <a href="samplers.html#VkCompareOp" class="xref page">VkCompareOp</a>.</p>
</div>
<div class="paragraph">
<p>If the comparison evaluates to false, the coverage for the sample is set to
<code>0</code>.</p>
</div>
<div class="paragraph">
<p>A new stencil value <span class="eq">s<sub>g</sub></span> is generated according to a stencil operation
defined by <a href="#VkStencilOp">VkStencilOp</a> parameters set by
<a href="#vkCmdSetStencilOp">vkCmdSetStencilOp</a> or
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>.
If the stencil test fails, <code>failOp</code> defines the stencil operation used.
If the stencil test passes however, the stencil op used is based on the
<a href="#fragops-depth">depth test</a> - if it passes,
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>passOp</code> is used, otherwise
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>depthFailOp</code> is used.</p>
</div>
<div class="paragraph">
<p>The stencil attachment value <span class="eq">s<sub>a</sub></span> is then updated with the generated
stencil value <span class="eq">s<sub>g</sub></span> according to the write mask <span class="eq">s<sub>w</sub></span> defined by
<code>writeMask</code> in <a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>front</code>
and <a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>back</code> as:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq">s<sub>a</sub> = (s<sub>a</sub> &amp; ¬s<sub>w</sub>) | (s<sub>g</sub> &amp; s<sub>w</sub>)</span></p>
</dd>
</dl>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically enable or disable</a> the stencil
test, call:</p>
</div>
<div id="vkCmdSetStencilTestEnable" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
void vkCmdSetStencilTestEnable(
    VkCommandBuffer                             commandBuffer,
    VkBool32                                    stencilTestEnable);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent command</p>
</div>
<div id="vkCmdSetStencilTestEnableEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_extended_dynamic_state, VK_EXT_shader_object
void vkCmdSetStencilTestEnableEXT(
    VkCommandBuffer                             commandBuffer,
    VkBool32                                    stencilTestEnable);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>stencilTestEnable</code> specifies if the stencil test is enabled.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the stencil test enable for subsequent drawing commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_STENCIL_TEST_ENABLE</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>stencilTestEnable</code> value
used to create the currently active pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetStencilTestEnable-None-08971" href="#VUID-vkCmdSetStencilTestEnable-None-08971"></a> <span class="vuid">VUID-vkCmdSetStencilTestEnable-None-08971</span><br>

At least one of the following <strong>must</strong> be true:</p>
<div class="ulist">
<ul>
<li>
<p>the <a href="features.html#features-extendedDynamicState" class="xref page"><code>extendedDynamicState</code></a>
feature is enabled</p>
</li>
<li>
<p>the <a href="features.html#features-shaderObject" class="xref page"><code>shaderObject</code></a> feature is enabled</p>
</li>
<li>
<p>the value of <a href="initialization.html#VkApplicationInfo" class="xref page">VkApplicationInfo</a>::<code>apiVersion</code> used to create
the <a href="initialization.html#VkInstance" class="xref page">VkInstance</a> parent of <code>commandBuffer</code> is greater than or
equal to Version 1.3</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetStencilTestEnable-commandBuffer-parameter" href="#VUID-vkCmdSetStencilTestEnable-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetStencilTestEnable-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilTestEnable-commandBuffer-recording" href="#VUID-vkCmdSetStencilTestEnable-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetStencilTestEnable-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilTestEnable-commandBuffer-cmdpool" href="#VUID-vkCmdSetStencilTestEnable-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetStencilTestEnable-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilTestEnable-videocoding" href="#VUID-vkCmdSetStencilTestEnable-videocoding"></a> <span class="vuid">VUID-vkCmdSetStencilTestEnable-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the stencil operation, call:</p>
</div>
<div id="vkCmdSetStencilOp" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
void vkCmdSetStencilOp(
    VkCommandBuffer                             commandBuffer,
    VkStencilFaceFlags                          faceMask,
    VkStencilOp                                 failOp,
    VkStencilOp                                 passOp,
    VkStencilOp                                 depthFailOp,
    VkCompareOp                                 compareOp);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent command</p>
</div>
<div id="vkCmdSetStencilOpEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_extended_dynamic_state, VK_EXT_shader_object
void vkCmdSetStencilOpEXT(
    VkCommandBuffer                             commandBuffer,
    VkStencilFaceFlags                          faceMask,
    VkStencilOp                                 failOp,
    VkStencilOp                                 passOp,
    VkStencilOp                                 depthFailOp,
    VkCompareOp                                 compareOp);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>faceMask</code> is a bitmask of <a href="#VkStencilFaceFlagBits">VkStencilFaceFlagBits</a> specifying
the set of stencil state for which to update the stencil operation.</p>
</li>
<li>
<p><code>failOp</code> is a <a href="#VkStencilOp">VkStencilOp</a> value specifying the action
performed on samples that fail the stencil test.</p>
</li>
<li>
<p><code>passOp</code> is a <a href="#VkStencilOp">VkStencilOp</a> value specifying the action
performed on samples that pass both the depth and stencil tests.</p>
</li>
<li>
<p><code>depthFailOp</code> is a <a href="#VkStencilOp">VkStencilOp</a> value specifying the action
performed on samples that pass the stencil test and fail the depth test.</p>
</li>
<li>
<p><code>compareOp</code> is a <a href="samplers.html#VkCompareOp" class="xref page">VkCompareOp</a> value specifying the comparison
operator used in the stencil test.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the stencil operation for subsequent drawing commands when
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with <code>VK_DYNAMIC_STATE_STENCIL_OP</code>
set in <a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the corresponding
<code>VkPipelineDepthStencilStateCreateInfo</code>::<code>failOp</code>, <code>passOp</code>,
<code>depthFailOp</code>, and <code>compareOp</code> values used to create the currently
active pipeline, for both front and back faces.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetStencilOp-None-08971" href="#VUID-vkCmdSetStencilOp-None-08971"></a> <span class="vuid">VUID-vkCmdSetStencilOp-None-08971</span><br>

At least one of the following <strong>must</strong> be true:</p>
<div class="ulist">
<ul>
<li>
<p>the <a href="features.html#features-extendedDynamicState" class="xref page"><code>extendedDynamicState</code></a>
feature is enabled</p>
</li>
<li>
<p>the <a href="features.html#features-shaderObject" class="xref page"><code>shaderObject</code></a> feature is enabled</p>
</li>
<li>
<p>the value of <a href="initialization.html#VkApplicationInfo" class="xref page">VkApplicationInfo</a>::<code>apiVersion</code> used to create
the <a href="initialization.html#VkInstance" class="xref page">VkInstance</a> parent of <code>commandBuffer</code> is greater than or
equal to Version 1.3</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetStencilOp-commandBuffer-parameter" href="#VUID-vkCmdSetStencilOp-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetStencilOp-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilOp-faceMask-parameter" href="#VUID-vkCmdSetStencilOp-faceMask-parameter"></a> <span class="vuid">VUID-vkCmdSetStencilOp-faceMask-parameter</span><br>
 <code>faceMask</code> <strong>must</strong> be a valid combination of <a href="#VkStencilFaceFlagBits">VkStencilFaceFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilOp-faceMask-requiredbitmask" href="#VUID-vkCmdSetStencilOp-faceMask-requiredbitmask"></a> <span class="vuid">VUID-vkCmdSetStencilOp-faceMask-requiredbitmask</span><br>
 <code>faceMask</code> <strong>must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilOp-failOp-parameter" href="#VUID-vkCmdSetStencilOp-failOp-parameter"></a> <span class="vuid">VUID-vkCmdSetStencilOp-failOp-parameter</span><br>
 <code>failOp</code> <strong>must</strong> be a valid <a href="#VkStencilOp">VkStencilOp</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilOp-passOp-parameter" href="#VUID-vkCmdSetStencilOp-passOp-parameter"></a> <span class="vuid">VUID-vkCmdSetStencilOp-passOp-parameter</span><br>
 <code>passOp</code> <strong>must</strong> be a valid <a href="#VkStencilOp">VkStencilOp</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilOp-depthFailOp-parameter" href="#VUID-vkCmdSetStencilOp-depthFailOp-parameter"></a> <span class="vuid">VUID-vkCmdSetStencilOp-depthFailOp-parameter</span><br>
 <code>depthFailOp</code> <strong>must</strong> be a valid <a href="#VkStencilOp">VkStencilOp</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilOp-compareOp-parameter" href="#VUID-vkCmdSetStencilOp-compareOp-parameter"></a> <span class="vuid">VUID-vkCmdSetStencilOp-compareOp-parameter</span><br>
 <code>compareOp</code> <strong>must</strong> be a valid <a href="samplers.html#VkCompareOp" class="xref page">VkCompareOp</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilOp-commandBuffer-recording" href="#VUID-vkCmdSetStencilOp-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetStencilOp-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilOp-commandBuffer-cmdpool" href="#VUID-vkCmdSetStencilOp-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetStencilOp-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilOp-videocoding" href="#VUID-vkCmdSetStencilOp-videocoding"></a> <span class="vuid">VUID-vkCmdSetStencilOp-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkStencilOpState</code> structure is defined as:</p>
</div>
<div id="VkStencilOpState" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef struct VkStencilOpState {
    VkStencilOp    failOp;
    VkStencilOp    passOp;
    VkStencilOp    depthFailOp;
    VkCompareOp    compareOp;
    uint32_t       compareMask;
    uint32_t       writeMask;
    uint32_t       reference;
} VkStencilOpState;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>failOp</code> is a <a href="#VkStencilOp">VkStencilOp</a> value specifying the action
performed on samples that fail the stencil test.</p>
</li>
<li>
<p><code>passOp</code> is a <a href="#VkStencilOp">VkStencilOp</a> value specifying the action
performed on samples that pass both the depth and stencil tests.</p>
</li>
<li>
<p><code>depthFailOp</code> is a <a href="#VkStencilOp">VkStencilOp</a> value specifying the action
performed on samples that pass the stencil test and fail the depth test.</p>
</li>
<li>
<p><code>compareOp</code> is a <a href="samplers.html#VkCompareOp" class="xref page">VkCompareOp</a> value specifying the comparison
operator used in the stencil test.</p>
</li>
<li>
<p><code>compareMask</code> selects the bits of the unsigned integer stencil
values participating in the stencil test.</p>
</li>
<li>
<p><code>writeMask</code> selects the bits of the unsigned integer stencil values
updated by the stencil test in the stencil framebuffer attachment.</p>
</li>
<li>
<p><code>reference</code> is an integer stencil reference value that is used in
the unsigned stencil comparison.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkStencilOpState-failOp-parameter" href="#VUID-VkStencilOpState-failOp-parameter"></a> <span class="vuid">VUID-VkStencilOpState-failOp-parameter</span><br>
 <code>failOp</code> <strong>must</strong> be a valid <a href="#VkStencilOp">VkStencilOp</a> value</p>
</li>
<li>
<p><a id="VUID-VkStencilOpState-passOp-parameter" href="#VUID-VkStencilOpState-passOp-parameter"></a> <span class="vuid">VUID-VkStencilOpState-passOp-parameter</span><br>
 <code>passOp</code> <strong>must</strong> be a valid <a href="#VkStencilOp">VkStencilOp</a> value</p>
</li>
<li>
<p><a id="VUID-VkStencilOpState-depthFailOp-parameter" href="#VUID-VkStencilOpState-depthFailOp-parameter"></a> <span class="vuid">VUID-VkStencilOpState-depthFailOp-parameter</span><br>
 <code>depthFailOp</code> <strong>must</strong> be a valid <a href="#VkStencilOp">VkStencilOp</a> value</p>
</li>
<li>
<p><a id="VUID-VkStencilOpState-compareOp-parameter" href="#VUID-VkStencilOpState-compareOp-parameter"></a> <span class="vuid">VUID-VkStencilOpState-compareOp-parameter</span><br>
 <code>compareOp</code> <strong>must</strong> be a valid <a href="samplers.html#VkCompareOp" class="xref page">VkCompareOp</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the stencil compare mask,
call:</p>
</div>
<div id="vkCmdSetStencilCompareMask" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkCmdSetStencilCompareMask(
    VkCommandBuffer                             commandBuffer,
    VkStencilFaceFlags                          faceMask,
    uint32_t                                    compareMask);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>faceMask</code> is a bitmask of <a href="#VkStencilFaceFlagBits">VkStencilFaceFlagBits</a> specifying
the set of stencil state for which to update the compare mask.</p>
</li>
<li>
<p><code>compareMask</code> is the new value to use as the stencil compare mask.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the stencil compare mask for subsequent drawing commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_STENCIL_COMPARE_MASK</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="#VkStencilOpState">VkStencilOpState</a>::<code>compareMask</code> value used to create the currently
active pipeline, for both front and back faces.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetStencilCompareMask-commandBuffer-parameter" href="#VUID-vkCmdSetStencilCompareMask-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetStencilCompareMask-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilCompareMask-faceMask-parameter" href="#VUID-vkCmdSetStencilCompareMask-faceMask-parameter"></a> <span class="vuid">VUID-vkCmdSetStencilCompareMask-faceMask-parameter</span><br>
 <code>faceMask</code> <strong>must</strong> be a valid combination of <a href="#VkStencilFaceFlagBits">VkStencilFaceFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilCompareMask-faceMask-requiredbitmask" href="#VUID-vkCmdSetStencilCompareMask-faceMask-requiredbitmask"></a> <span class="vuid">VUID-vkCmdSetStencilCompareMask-faceMask-requiredbitmask</span><br>
 <code>faceMask</code> <strong>must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilCompareMask-commandBuffer-recording" href="#VUID-vkCmdSetStencilCompareMask-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetStencilCompareMask-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilCompareMask-commandBuffer-cmdpool" href="#VUID-vkCmdSetStencilCompareMask-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetStencilCompareMask-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilCompareMask-videocoding" href="#VUID-vkCmdSetStencilCompareMask-videocoding"></a> <span class="vuid">VUID-vkCmdSetStencilCompareMask-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>VkStencilFaceFlagBits</code> values are:</p>
</div>
<div id="VkStencilFaceFlagBits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef enum VkStencilFaceFlagBits {
    VK_STENCIL_FACE_FRONT_BIT = 0x00000001,
    VK_STENCIL_FACE_BACK_BIT = 0x00000002,
    VK_STENCIL_FACE_FRONT_AND_BACK = 0x00000003,
    VK_STENCIL_FRONT_AND_BACK = VK_STENCIL_FACE_FRONT_AND_BACK,
} VkStencilFaceFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_STENCIL_FACE_FRONT_BIT</code> specifies that only the front set of
stencil state is updated.</p>
</li>
<li>
<p><code>VK_STENCIL_FACE_BACK_BIT</code> specifies that only the back set of
stencil state is updated.</p>
</li>
<li>
<p><code>VK_STENCIL_FACE_FRONT_AND_BACK</code> is the combination of
<code>VK_STENCIL_FACE_FRONT_BIT</code> and <code>VK_STENCIL_FACE_BACK_BIT</code>, and
specifies that both sets of stencil state are updated.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkStencilFaceFlags" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef VkFlags VkStencilFaceFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkStencilFaceFlags</code> is a bitmask type for setting a mask of zero or
more <a href="#VkStencilFaceFlagBits">VkStencilFaceFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the stencil write mask,
call:</p>
</div>
<div id="vkCmdSetStencilWriteMask" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkCmdSetStencilWriteMask(
    VkCommandBuffer                             commandBuffer,
    VkStencilFaceFlags                          faceMask,
    uint32_t                                    writeMask);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>faceMask</code> is a bitmask of <a href="#VkStencilFaceFlagBits">VkStencilFaceFlagBits</a> specifying
the set of stencil state for which to update the write mask, as
described above for <a href="#vkCmdSetStencilCompareMask">vkCmdSetStencilCompareMask</a>.</p>
</li>
<li>
<p><code>writeMask</code> is the new value to use as the stencil write mask.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the stencil write mask for subsequent drawing commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_STENCIL_WRITE_MASK</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the <code>writeMask</code> value used to
create the currently active pipeline, for both
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>front</code> and
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>back</code> faces.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetStencilWriteMask-commandBuffer-parameter" href="#VUID-vkCmdSetStencilWriteMask-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetStencilWriteMask-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilWriteMask-faceMask-parameter" href="#VUID-vkCmdSetStencilWriteMask-faceMask-parameter"></a> <span class="vuid">VUID-vkCmdSetStencilWriteMask-faceMask-parameter</span><br>
 <code>faceMask</code> <strong>must</strong> be a valid combination of <a href="#VkStencilFaceFlagBits">VkStencilFaceFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilWriteMask-faceMask-requiredbitmask" href="#VUID-vkCmdSetStencilWriteMask-faceMask-requiredbitmask"></a> <span class="vuid">VUID-vkCmdSetStencilWriteMask-faceMask-requiredbitmask</span><br>
 <code>faceMask</code> <strong>must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilWriteMask-commandBuffer-recording" href="#VUID-vkCmdSetStencilWriteMask-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetStencilWriteMask-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilWriteMask-commandBuffer-cmdpool" href="#VUID-vkCmdSetStencilWriteMask-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetStencilWriteMask-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilWriteMask-videocoding" href="#VUID-vkCmdSetStencilWriteMask-videocoding"></a> <span class="vuid">VUID-vkCmdSetStencilWriteMask-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the stencil reference value,
call:</p>
</div>
<div id="vkCmdSetStencilReference" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
void vkCmdSetStencilReference(
    VkCommandBuffer                             commandBuffer,
    VkStencilFaceFlags                          faceMask,
    uint32_t                                    reference);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>faceMask</code> is a bitmask of <a href="#VkStencilFaceFlagBits">VkStencilFaceFlagBits</a> specifying
the set of stencil state for which to update the reference value, as
described above for <a href="#vkCmdSetStencilCompareMask">vkCmdSetStencilCompareMask</a>.</p>
</li>
<li>
<p><code>reference</code> is the new value to use as the stencil reference value.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the stencil reference value for subsequent drawing
commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_STENCIL_REFERENCE</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>reference</code> value used to
create the currently active pipeline, for both front and back faces.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetStencilReference-commandBuffer-parameter" href="#VUID-vkCmdSetStencilReference-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetStencilReference-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilReference-faceMask-parameter" href="#VUID-vkCmdSetStencilReference-faceMask-parameter"></a> <span class="vuid">VUID-vkCmdSetStencilReference-faceMask-parameter</span><br>
 <code>faceMask</code> <strong>must</strong> be a valid combination of <a href="#VkStencilFaceFlagBits">VkStencilFaceFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilReference-faceMask-requiredbitmask" href="#VUID-vkCmdSetStencilReference-faceMask-requiredbitmask"></a> <span class="vuid">VUID-vkCmdSetStencilReference-faceMask-requiredbitmask</span><br>
 <code>faceMask</code> <strong>must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilReference-commandBuffer-recording" href="#VUID-vkCmdSetStencilReference-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetStencilReference-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilReference-commandBuffer-cmdpool" href="#VUID-vkCmdSetStencilReference-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetStencilReference-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetStencilReference-videocoding" href="#VUID-vkCmdSetStencilReference-videocoding"></a> <span class="vuid">VUID-vkCmdSetStencilReference-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of the <code>failOp</code>, <code>passOp</code>, and <code>depthFailOp</code>
members of <a href="#VkStencilOpState">VkStencilOpState</a>, specifying what happens to the stored
stencil value if this or certain subsequent tests fail or pass, are:</p>
</div>
<div id="VkStencilOp" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_0
typedef enum VkStencilOp {
    VK_STENCIL_OP_KEEP = 0,
    VK_STENCIL_OP_ZERO = 1,
    VK_STENCIL_OP_REPLACE = 2,
    VK_STENCIL_OP_INCREMENT_AND_CLAMP = 3,
    VK_STENCIL_OP_DECREMENT_AND_CLAMP = 4,
    VK_STENCIL_OP_INVERT = 5,
    VK_STENCIL_OP_INCREMENT_AND_WRAP = 6,
    VK_STENCIL_OP_DECREMENT_AND_WRAP = 7,
} VkStencilOp;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_STENCIL_OP_KEEP</code> keeps the current value.</p>
</li>
<li>
<p><code>VK_STENCIL_OP_ZERO</code> sets the value to 0.</p>
</li>
<li>
<p><code>VK_STENCIL_OP_REPLACE</code> sets the value to <code>reference</code>.</p>
</li>
<li>
<p><code>VK_STENCIL_OP_INCREMENT_AND_CLAMP</code> increments the current value and
clamps to the maximum representable unsigned value.</p>
</li>
<li>
<p><code>VK_STENCIL_OP_DECREMENT_AND_CLAMP</code> decrements the current value and
clamps to 0.</p>
</li>
<li>
<p><code>VK_STENCIL_OP_INVERT</code> bitwise-inverts the current value.</p>
</li>
<li>
<p><code>VK_STENCIL_OP_INCREMENT_AND_WRAP</code> increments the current value and
wraps to 0 when the maximum value would have been exceeded.</p>
</li>
<li>
<p><code>VK_STENCIL_OP_DECREMENT_AND_WRAP</code> decrements the current value and
wraps to the maximum possible value when the value would go below 0.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For purposes of increment and decrement, the stencil bits are considered as
an unsigned integer.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fragops-depth"><a class="anchor" href="#fragops-depth"></a>Depth Test</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The depth test compares the depth value <span class="eq">z<sub>a</sub></span> in the depth/stencil
attachment at each sample&#8217;s framebuffer coordinates <span class="eq">(x<sub>f</sub>,y<sub>f</sub>)</span> and
<a href="primsrast.html#primsrast-multisampling-coverage-mask" class="xref page">sample index</a> <span class="eq">i</span> against the
sample&#8217;s depth value <span class="eq">z<sub>f</sub></span>.
If there is no depth attachment then the depth test is skipped.</p>
</div>
<div class="paragraph">
<p>If the render pass has a fragment density map attachment and the fragment
covers multiple pixels, there is an implementation-dependent association of
rasterization samples to depth attachment samples within the fragment.
However, if all samples in the fragment are covered, and the depth
attachment value is updated as a result of this test, all depth attachment
samples will be updated.</p>
</div>
<div class="paragraph">
<p>The depth test occurs in three stages, as detailed in the following
sections.</p>
</div>
<div class="sect2">
<h3 id="_depth_clamping_and_range_adjustment"><a class="anchor" href="#_depth_clamping_and_range_adjustment"></a>Depth Clamping and Range Adjustment</h3>
<div class="paragraph">
<p>If <a href="primsrast.html#VkPipelineRasterizationStateCreateInfo" class="xref page">VkPipelineRasterizationStateCreateInfo</a>::<code>depthClampEnable</code> is
enabled, <span class="eq">z<sub>f</sub></span> is clamped to <span class="eq">[z<sub>min</sub>, z<sub>max</sub>]</span>, where <span class="eq">z<sub>min</sub>
= min(n,f)</span>, <span class="eq">z<sub>max</sub> = max(n,f)]</span>, and <span class="eq">n</span> and <span class="eq">f</span> are the
<code>minDepth</code> and <code>maxDepth</code> depth range values of the viewport used by
this fragment, respectively.</p>
</div>
<div class="paragraph">
<p>If
<a href="features.html#VkPhysicalDeviceDepthClampZeroOneFeaturesEXT" class="xref page">VkPhysicalDeviceDepthClampZeroOneFeaturesEXT</a>::<code>depthClampZeroOne</code>
is enabled:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the depth attachment has a floating-point format and
<a href="../appendices/extensions.html#VK_EXT_depth_range_unrestricted" class="xref page">VK_EXT_depth_range_unrestricted</a> is enabled then <span class="eq">z<sub>f</sub></span> is
unchanged.</p>
</li>
<li>
<p>Otherwise, <span class="eq">z<sub>f</sub></span> is clamped to the range <span class="eq">[0, 1]</span>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Otherwise:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If <span class="eq">z<sub>f</sub></span> is not in the range <span class="eq">[z<sub>min</sub>, z<sub>max</sub>]</span>, then
<span class="eq">z<sub>f</sub></span> is <strong>undefined</strong> following this step.</p>
</li>
<li>
<p>If the depth attachment has a fixed-point format and <span class="eq">z<sub>f</sub></span> is not
in the range <span class="eq">[0, 1]</span>, then <span class="eq">z<sub>f</sub></span> is <strong>undefined</strong> following this
step.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="fragops-depth-comparison"><a class="anchor" href="#fragops-depth-comparison"></a>Depth Comparison</h3>
<div class="paragraph">
<p>If the depth test is not enabled, as specified by
<a href="#vkCmdSetDepthTestEnable">vkCmdSetDepthTestEnable</a> or
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>depthTestEnable</code>, then
this step is skipped.</p>
</div>
<div class="paragraph">
<p>The comparison operation performed is determined by the <a href="samplers.html#VkCompareOp" class="xref page">VkCompareOp</a>
value set by
<a href="#vkCmdSetDepthCompareOp">vkCmdSetDepthCompareOp</a>, or by
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>depthCompareOp</code> during
pipeline creation.
<span class="eq">z<sub>f</sub></span> and <span class="eq">z<sub>a</sub></span> are used as the <em>reference</em> and <em>test</em> values,
respectively, in the operation specified by the <a href="samplers.html#VkCompareOp" class="xref page">VkCompareOp</a>.</p>
</div>
<div class="paragraph">
<p>If the comparison evaluates to false, the coverage for the sample is set to
<code>0</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="fragops-depth-write"><a class="anchor" href="#fragops-depth-write"></a>Depth Attachment Writes</h3>
<div class="paragraph">
<p>If depth writes are enabled, as specified by
<a href="#vkCmdSetDepthWriteEnable">vkCmdSetDepthWriteEnable</a> or
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>depthWriteEnable</code>, and the
comparison evaluated to true, the depth attachment value <span class="eq">z<sub>a</sub></span> is set
to the sample&#8217;s depth value <span class="eq">z<sub>f</sub></span>.
If there is no depth attachment, no value is written.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically enable or disable</a> the depth
test, call:</p>
</div>
<div id="vkCmdSetDepthTestEnable" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
void vkCmdSetDepthTestEnable(
    VkCommandBuffer                             commandBuffer,
    VkBool32                                    depthTestEnable);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent command</p>
</div>
<div id="vkCmdSetDepthTestEnableEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_extended_dynamic_state, VK_EXT_shader_object
void vkCmdSetDepthTestEnableEXT(
    VkCommandBuffer                             commandBuffer,
    VkBool32                                    depthTestEnable);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>depthTestEnable</code> specifies if the depth test is enabled.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the depth test enable for subsequent drawing commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_DEPTH_TEST_ENABLE</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>depthTestEnable</code> value
used to create the currently active pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetDepthTestEnable-None-08971" href="#VUID-vkCmdSetDepthTestEnable-None-08971"></a> <span class="vuid">VUID-vkCmdSetDepthTestEnable-None-08971</span><br>

At least one of the following <strong>must</strong> be true:</p>
<div class="ulist">
<ul>
<li>
<p>the <a href="features.html#features-extendedDynamicState" class="xref page"><code>extendedDynamicState</code></a>
feature is enabled</p>
</li>
<li>
<p>the <a href="features.html#features-shaderObject" class="xref page"><code>shaderObject</code></a> feature is enabled</p>
</li>
<li>
<p>the value of <a href="initialization.html#VkApplicationInfo" class="xref page">VkApplicationInfo</a>::<code>apiVersion</code> used to create
the <a href="initialization.html#VkInstance" class="xref page">VkInstance</a> parent of <code>commandBuffer</code> is greater than or
equal to Version 1.3</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetDepthTestEnable-commandBuffer-parameter" href="#VUID-vkCmdSetDepthTestEnable-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetDepthTestEnable-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDepthTestEnable-commandBuffer-recording" href="#VUID-vkCmdSetDepthTestEnable-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetDepthTestEnable-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetDepthTestEnable-commandBuffer-cmdpool" href="#VUID-vkCmdSetDepthTestEnable-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetDepthTestEnable-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDepthTestEnable-videocoding" href="#VUID-vkCmdSetDepthTestEnable-videocoding"></a> <span class="vuid">VUID-vkCmdSetDepthTestEnable-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the depth compare operator,
call:</p>
</div>
<div id="vkCmdSetDepthCompareOp" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
void vkCmdSetDepthCompareOp(
    VkCommandBuffer                             commandBuffer,
    VkCompareOp                                 depthCompareOp);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent command</p>
</div>
<div id="vkCmdSetDepthCompareOpEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_extended_dynamic_state, VK_EXT_shader_object
void vkCmdSetDepthCompareOpEXT(
    VkCommandBuffer                             commandBuffer,
    VkCompareOp                                 depthCompareOp);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>depthCompareOp</code> is a <a href="samplers.html#VkCompareOp" class="xref page">VkCompareOp</a> value specifying the
comparison operator used for the <a href="#fragops-depth-comparison">Depth    Comparison</a> step of the <a href="#fragops-depth">depth test</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the depth comparison operator for subsequent drawing
commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_DEPTH_COMPARE_OP</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>depthCompareOp</code> value used
to create the currently active pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetDepthCompareOp-None-08971" href="#VUID-vkCmdSetDepthCompareOp-None-08971"></a> <span class="vuid">VUID-vkCmdSetDepthCompareOp-None-08971</span><br>

At least one of the following <strong>must</strong> be true:</p>
<div class="ulist">
<ul>
<li>
<p>the <a href="features.html#features-extendedDynamicState" class="xref page"><code>extendedDynamicState</code></a>
feature is enabled</p>
</li>
<li>
<p>the <a href="features.html#features-shaderObject" class="xref page"><code>shaderObject</code></a> feature is enabled</p>
</li>
<li>
<p>the value of <a href="initialization.html#VkApplicationInfo" class="xref page">VkApplicationInfo</a>::<code>apiVersion</code> used to create
the <a href="initialization.html#VkInstance" class="xref page">VkInstance</a> parent of <code>commandBuffer</code> is greater than or
equal to Version 1.3</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetDepthCompareOp-commandBuffer-parameter" href="#VUID-vkCmdSetDepthCompareOp-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetDepthCompareOp-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDepthCompareOp-depthCompareOp-parameter" href="#VUID-vkCmdSetDepthCompareOp-depthCompareOp-parameter"></a> <span class="vuid">VUID-vkCmdSetDepthCompareOp-depthCompareOp-parameter</span><br>
 <code>depthCompareOp</code> <strong>must</strong> be a valid <a href="samplers.html#VkCompareOp" class="xref page">VkCompareOp</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDepthCompareOp-commandBuffer-recording" href="#VUID-vkCmdSetDepthCompareOp-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetDepthCompareOp-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetDepthCompareOp-commandBuffer-cmdpool" href="#VUID-vkCmdSetDepthCompareOp-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetDepthCompareOp-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDepthCompareOp-videocoding" href="#VUID-vkCmdSetDepthCompareOp-videocoding"></a> <span class="vuid">VUID-vkCmdSetDepthCompareOp-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the depth write enable,
call:</p>
</div>
<div id="vkCmdSetDepthWriteEnable" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_VERSION_1_3
void vkCmdSetDepthWriteEnable(
    VkCommandBuffer                             commandBuffer,
    VkBool32                                    depthWriteEnable);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent command</p>
</div>
<div id="vkCmdSetDepthWriteEnableEXT" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_extended_dynamic_state, VK_EXT_shader_object
void vkCmdSetDepthWriteEnableEXT(
    VkCommandBuffer                             commandBuffer,
    VkBool32                                    depthWriteEnable);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>depthWriteEnable</code> specifies if depth writes are enabled.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the depth write enable for subsequent drawing commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_DEPTH_WRITE_ENABLE</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a>::<code>depthWriteEnable</code> value
used to create the currently active pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetDepthWriteEnable-None-08971" href="#VUID-vkCmdSetDepthWriteEnable-None-08971"></a> <span class="vuid">VUID-vkCmdSetDepthWriteEnable-None-08971</span><br>

At least one of the following <strong>must</strong> be true:</p>
<div class="ulist">
<ul>
<li>
<p>the <a href="features.html#features-extendedDynamicState" class="xref page"><code>extendedDynamicState</code></a>
feature is enabled</p>
</li>
<li>
<p>the <a href="features.html#features-shaderObject" class="xref page"><code>shaderObject</code></a> feature is enabled</p>
</li>
<li>
<p>the value of <a href="initialization.html#VkApplicationInfo" class="xref page">VkApplicationInfo</a>::<code>apiVersion</code> used to create
the <a href="initialization.html#VkInstance" class="xref page">VkInstance</a> parent of <code>commandBuffer</code> is greater than or
equal to Version 1.3</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetDepthWriteEnable-commandBuffer-parameter" href="#VUID-vkCmdSetDepthWriteEnable-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetDepthWriteEnable-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDepthWriteEnable-commandBuffer-recording" href="#VUID-vkCmdSetDepthWriteEnable-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetDepthWriteEnable-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetDepthWriteEnable-commandBuffer-cmdpool" href="#VUID-vkCmdSetDepthWriteEnable-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetDepthWriteEnable-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetDepthWriteEnable-videocoding" href="#VUID-vkCmdSetDepthWriteEnable-videocoding"></a> <span class="vuid">VUID-vkCmdSetDepthWriteEnable-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fragops-rep-frag-test"><a class="anchor" href="#fragops-rep-frag-test"></a>Representative Fragment Test</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The representative fragment test allows implementations to reduce the amount
of rasterization and fragment processing work performed for each point,
line, or triangle primitive.
For any primitive that produces one or more fragments that pass all prior
early fragment tests, the implementation <strong>may</strong> choose one or more
&#8220;representative&#8221; fragments for processing and discard all other fragments.
For draw calls rendering multiple points, lines, or triangles arranged in
lists, strips, or fans, the representative fragment test is performed
independently for each of those primitives.
The set of fragments discarded by the representative fragment test is
implementation-dependent.
In some cases, the representative fragment test may not discard any
fragments for a given primitive.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the <code>pNext</code> chain of <a href="pipelines.html#VkGraphicsPipelineCreateInfo" class="xref page">VkGraphicsPipelineCreateInfo</a> includes a
<code>VkPipelineRepresentativeFragmentTestStateCreateInfoNV</code> structure, then
that structure includes parameters controlling the representative fragment
test.</p>
</div>
<div class="paragraph">
<p>The <code>VkPipelineRepresentativeFragmentTestStateCreateInfoNV</code> structure is
defined as:</p>
</div>
<div id="VkPipelineRepresentativeFragmentTestStateCreateInfoNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_NV_representative_fragment_test
typedef struct VkPipelineRepresentativeFragmentTestStateCreateInfoNV {
    VkStructureType    sType;
    const void*        pNext;
    VkBool32           representativeFragmentTestEnable;
} VkPipelineRepresentativeFragmentTestStateCreateInfoNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>representativeFragmentTestEnable</code> controls whether the
representative fragment test is enabled.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If this structure is not included in the <code>pNext</code> chain,
<code>representativeFragmentTestEnable</code> is considered to be <code>VK_FALSE</code>,
and the representative fragment test is disabled.</p>
</div>
<div class="paragraph">
<p>If the active fragment shader does not specify the <code>EarlyFragmentTests</code>
execution mode, the representative fragment shader test has no effect, even
if enabled.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPipelineRepresentativeFragmentTestStateCreateInfoNV-sType-sType" href="#VUID-VkPipelineRepresentativeFragmentTestStateCreateInfoNV-sType-sType"></a> <span class="vuid">VUID-VkPipelineRepresentativeFragmentTestStateCreateInfoNV-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_PIPELINE_REPRESENTATIVE_FRAGMENT_TEST_STATE_CREATE_INFO_NV</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the
<code>representativeFragmentTestEnable</code> state, call:</p>
</div>
<div id="vkCmdSetRepresentativeFragmentTestEnableNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_extended_dynamic_state3 with VK_NV_representative_fragment_test, VK_EXT_shader_object with VK_NV_representative_fragment_test
void vkCmdSetRepresentativeFragmentTestEnableNV(
    VkCommandBuffer                             commandBuffer,
    VkBool32                                    representativeFragmentTestEnable);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>representativeFragmentTestEnable</code> specifies the
<code>representativeFragmentTestEnable</code> state.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the <code>representativeFragmentTestEnable</code> state for
subsequent drawing commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_REPRESENTATIVE_FRAGMENT_TEST_ENABLE_NV</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="#VkPipelineRepresentativeFragmentTestStateCreateInfoNV">VkPipelineRepresentativeFragmentTestStateCreateInfoNV</a>::<code>representativeFragmentTestEnable</code>
value used to create the currently active pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetRepresentativeFragmentTestEnableNV-None-08522" href="#VUID-vkCmdSetRepresentativeFragmentTestEnableNV-None-08522"></a> <span class="vuid">VUID-vkCmdSetRepresentativeFragmentTestEnableNV-None-08522</span><br>

Either the
<a href="features.html#features-extendedDynamicState3RepresentativeFragmentTestEnable" class="xref page">    <code>extendedDynamicState3RepresentativeFragmentTestEnable</code></a> feature or
the <a href="features.html#features-shaderObject" class="xref page"><code>shaderObject</code></a> feature or both <strong>must</strong>
be enabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetRepresentativeFragmentTestEnableNV-commandBuffer-parameter" href="#VUID-vkCmdSetRepresentativeFragmentTestEnableNV-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetRepresentativeFragmentTestEnableNV-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetRepresentativeFragmentTestEnableNV-commandBuffer-recording" href="#VUID-vkCmdSetRepresentativeFragmentTestEnableNV-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetRepresentativeFragmentTestEnableNV-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetRepresentativeFragmentTestEnableNV-commandBuffer-cmdpool" href="#VUID-vkCmdSetRepresentativeFragmentTestEnableNV-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetRepresentativeFragmentTestEnableNV-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetRepresentativeFragmentTestEnableNV-videocoding" href="#VUID-vkCmdSetRepresentativeFragmentTestEnableNV-videocoding"></a> <span class="vuid">VUID-vkCmdSetRepresentativeFragmentTestEnableNV-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fragops-samplecount"><a class="anchor" href="#fragops-samplecount"></a>Sample Counting</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Occlusion queries use query pool entries to track the number of samples that
pass all the per-fragment tests.
The mechanism of collecting an occlusion query value is described in
<a href="queries.html#queries-occlusion" class="xref page">Occlusion Queries</a>.</p>
</div>
<div class="paragraph">
<p>The occlusion query sample counter increments by one for each sample with a
coverage value of 1 in each fragment that survives all the per-fragment
tests, including scissor,
exclusive scissor,
sample mask, alpha to coverage, stencil, and depth tests.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fragops-coverage-to-color"><a class="anchor" href="#fragops-coverage-to-color"></a>Fragment Coverage To Color</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPipelineCoverageToColorStateCreateInfoNV</code> structure is defined
as:</p>
</div>
<div id="VkPipelineCoverageToColorStateCreateInfoNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_NV_fragment_coverage_to_color
typedef struct VkPipelineCoverageToColorStateCreateInfoNV {
    VkStructureType                                sType;
    const void*                                    pNext;
    VkPipelineCoverageToColorStateCreateFlagsNV    flags;
    VkBool32                                       coverageToColorEnable;
    uint32_t                                       coverageToColorLocation;
} VkPipelineCoverageToColorStateCreateInfoNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>coverageToColorEnable</code> controls whether the fragment coverage value
replaces a fragment color output.</p>
</li>
<li>
<p><code>coverageToColorLocation</code> controls which fragment shader color
output value is replaced.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <code>pNext</code> chain of <a href="primsrast.html#VkPipelineMultisampleStateCreateInfo" class="xref page">VkPipelineMultisampleStateCreateInfo</a>
includes a <code>VkPipelineCoverageToColorStateCreateInfoNV</code> structure, then
that structure controls whether the fragment coverage is substituted for a
fragment color output and, if so, which output is replaced.</p>
</div>
<div class="paragraph">
<p>If <code>coverageToColorEnable</code> is <code>VK_TRUE</code>, the
<a href="primsrast.html#primsrast-multisampling-coverage-mask" class="xref page">coverage mask</a> replaces the first
component of the color value corresponding to the fragment shader output
location with <code>Location</code> equal to <code>coverageToColorLocation</code> and
<code>Index</code> equal to zero.
If the color attachment format has fewer bits than the coverage mask, the
low bits of the sample coverage mask are taken without any clamping.
If the color attachment format has more bits than the coverage mask, the
high bits of the sample coverage mask are filled with zeros.</p>
</div>
<div class="paragraph">
<p>If <code>coverageToColorEnable</code> is <code>VK_FALSE</code>, these operations are
skipped.
If this structure is not included in the <code>pNext</code> chain, it is as if
<code>coverageToColorEnable</code> is <code>VK_FALSE</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPipelineCoverageToColorStateCreateInfoNV-coverageToColorEnable-01404" href="#VUID-VkPipelineCoverageToColorStateCreateInfoNV-coverageToColorEnable-01404"></a> <span class="vuid">VUID-VkPipelineCoverageToColorStateCreateInfoNV-coverageToColorEnable-01404</span><br>

If <code>coverageToColorEnable</code> is <code>VK_TRUE</code>, then the render pass
subpass indicated by
<a href="pipelines.html#VkGraphicsPipelineCreateInfo" class="xref page">VkGraphicsPipelineCreateInfo</a>::<code>renderPass</code> and
<a href="pipelines.html#VkGraphicsPipelineCreateInfo" class="xref page">VkGraphicsPipelineCreateInfo</a>::<code>subpass</code> <strong>must</strong> have a color
attachment at the location selected by <code>coverageToColorLocation</code>,
with a <a href="formats.html#VkFormat" class="xref page">VkFormat</a> of <code>VK_FORMAT_R8_UINT</code>,
<code>VK_FORMAT_R8_SINT</code>, <code>VK_FORMAT_R16_UINT</code>,
<code>VK_FORMAT_R16_SINT</code>, <code>VK_FORMAT_R32_UINT</code>, or
<code>VK_FORMAT_R32_SINT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPipelineCoverageToColorStateCreateInfoNV-sType-sType" href="#VUID-VkPipelineCoverageToColorStateCreateInfoNV-sType-sType"></a> <span class="vuid">VUID-VkPipelineCoverageToColorStateCreateInfoNV-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_PIPELINE_COVERAGE_TO_COLOR_STATE_CREATE_INFO_NV</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineCoverageToColorStateCreateInfoNV-flags-zerobitmask" href="#VUID-VkPipelineCoverageToColorStateCreateInfoNV-flags-zerobitmask"></a> <span class="vuid">VUID-VkPipelineCoverageToColorStateCreateInfoNV-flags-zerobitmask</span><br>
 <code>flags</code> <strong>must</strong> be <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkPipelineCoverageToColorStateCreateFlagsNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_NV_fragment_coverage_to_color
typedef VkFlags VkPipelineCoverageToColorStateCreateFlagsNV;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkPipelineCoverageToColorStateCreateFlagsNV</code> is a bitmask type for
setting a mask, but is currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the
<code>coverageToColorEnable</code> state, call:</p>
</div>
<div id="vkCmdSetCoverageToColorEnableNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_extended_dynamic_state3 with VK_NV_fragment_coverage_to_color, VK_EXT_shader_object with VK_NV_fragment_coverage_to_color
void vkCmdSetCoverageToColorEnableNV(
    VkCommandBuffer                             commandBuffer,
    VkBool32                                    coverageToColorEnable);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>coverageToColorEnable</code> specifies the <code>coverageToColorEnable</code>
state.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the <code>coverageToColorEnable</code> state for subsequent
drawing commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_COVERAGE_TO_COLOR_ENABLE_NV</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="#VkPipelineCoverageToColorStateCreateInfoNV">VkPipelineCoverageToColorStateCreateInfoNV</a>::<code>coverageToColorEnable</code>
value used to create the currently active pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetCoverageToColorEnableNV-None-08524" href="#VUID-vkCmdSetCoverageToColorEnableNV-None-08524"></a> <span class="vuid">VUID-vkCmdSetCoverageToColorEnableNV-None-08524</span><br>

Either the <a href="features.html#features-extendedDynamicState3CoverageToColorEnable" class="xref page">    <code>extendedDynamicState3CoverageToColorEnable</code></a> feature or the
<a href="features.html#features-shaderObject" class="xref page"><code>shaderObject</code></a> feature or both <strong>must</strong> be
enabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetCoverageToColorEnableNV-commandBuffer-parameter" href="#VUID-vkCmdSetCoverageToColorEnableNV-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetCoverageToColorEnableNV-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageToColorEnableNV-commandBuffer-recording" href="#VUID-vkCmdSetCoverageToColorEnableNV-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetCoverageToColorEnableNV-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageToColorEnableNV-commandBuffer-cmdpool" href="#VUID-vkCmdSetCoverageToColorEnableNV-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetCoverageToColorEnableNV-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageToColorEnableNV-videocoding" href="#VUID-vkCmdSetCoverageToColorEnableNV-videocoding"></a> <span class="vuid">VUID-vkCmdSetCoverageToColorEnableNV-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the
<code>coverageToColorLocation</code> state, call:</p>
</div>
<div id="vkCmdSetCoverageToColorLocationNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_extended_dynamic_state3 with VK_NV_fragment_coverage_to_color, VK_EXT_shader_object with VK_NV_fragment_coverage_to_color
void vkCmdSetCoverageToColorLocationNV(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    coverageToColorLocation);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>coverageToColorLocation</code> specifies the
<code>coverageToColorLocation</code> state.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the <code>coverageToColorLocation</code> state for subsequent
drawing commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_COVERAGE_TO_COLOR_LOCATION_NV</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="#VkPipelineCoverageToColorStateCreateInfoNV">VkPipelineCoverageToColorStateCreateInfoNV</a>::<code>coverageToColorLocation</code>
value used to create the currently active pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetCoverageToColorLocationNV-None-08526" href="#VUID-vkCmdSetCoverageToColorLocationNV-None-08526"></a> <span class="vuid">VUID-vkCmdSetCoverageToColorLocationNV-None-08526</span><br>

Either the <a href="features.html#features-extendedDynamicState3CoverageToColorLocation" class="xref page">    <code>extendedDynamicState3CoverageToColorLocation</code></a> feature or the
<a href="features.html#features-shaderObject" class="xref page"><code>shaderObject</code></a> feature or both <strong>must</strong> be
enabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetCoverageToColorLocationNV-commandBuffer-parameter" href="#VUID-vkCmdSetCoverageToColorLocationNV-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetCoverageToColorLocationNV-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageToColorLocationNV-commandBuffer-recording" href="#VUID-vkCmdSetCoverageToColorLocationNV-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetCoverageToColorLocationNV-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageToColorLocationNV-commandBuffer-cmdpool" href="#VUID-vkCmdSetCoverageToColorLocationNV-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetCoverageToColorLocationNV-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageToColorLocationNV-videocoding" href="#VUID-vkCmdSetCoverageToColorLocationNV-videocoding"></a> <span class="vuid">VUID-vkCmdSetCoverageToColorLocationNV-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fragops-coverage-reduction"><a class="anchor" href="#fragops-coverage-reduction"></a>Coverage Reduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Coverage reduction takes the coverage information for a fragment and
converts that to a boolean coverage value for each color sample in each
pixel covered by the fragment.</p>
</div>
<div class="sect2">
<h3 id="_pixel_coverage"><a class="anchor" href="#_pixel_coverage"></a>Pixel Coverage</h3>
<div class="paragraph">
<p>Coverage for each pixel is first extracted from the total fragment coverage
mask.
This consists of <code>rasterizationSamples</code> unique coverage samples for each
pixel in the fragment area, each with a unique
<a href="primsrast.html#primsrast-multisampling-coverage-mask" class="xref page">sample index</a>.
If the fragment only contains a single pixel, coverage for the pixel is
equivalent to the fragment coverage.</p>
</div>
<div class="paragraph">
<p>If the render pass has a fragment density map attachment and the fragment
covers multiple pixels, pixel coverage is generated in an
implementation-dependent manner.
If all samples in the fragment are covered, all samples will be covered in
each pixel coverage.</p>
</div>
<div class="paragraph">
<p>If a <a href="primsrast.html#primsrast-shading-rate-image" class="xref page">shading rate image</a> is used, and the
fragment covers multiple pixels, each pixel&#8217;s coverage consists of the
coverage samples corresponding to that pixel, and each sample retains its
unique <a href="primsrast.html#primsrast-multisampling-coverage-mask" class="xref page">sample index <span class="eq">i</span></a>.</p>
</div>
<div class="paragraph">
<p>If the <a href="primsrast.html#primsrast-fragment-shading-rate" class="xref page">fragment shading rate</a> is set,
and the fragment covers multiple pixels, each pixel&#8217;s coverage consists of
the coverage samples with a <a href="primsrast.html#primsrast-multisampling-coverage-mask-vrfs" class="xref page">pixel index</a> matching that pixel, and each sample retains its unique
<a href="primsrast.html#primsrast-multisampling-coverage-mask" class="xref page">sample index <span class="eq">i</span></a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_color_sample_coverage"><a class="anchor" href="#_color_sample_coverage"></a>Color Sample Coverage</h3>
<div class="paragraph">
<p>Once pixel coverage is determined, coverage for each individual color sample
corresponding to that pixel is determined.</p>
</div>
<div class="paragraph">
<p>If the
number of <code>rasterizationSamples</code> is identical to the number of samples
in the color
attachments, a
color sample is covered if the pixel coverage sample with the same
<a href="primsrast.html#primsrast-multisampling-coverage-mask" class="xref page">sample index</a> <span class="eq">i</span> is covered.</p>
</div>
<div class="paragraph">
<p>Otherwise, the coverage for each color sample is computed from the pixel
coverage as follows.</p>
</div>
<div class="paragraph">
<p>If the <code><a href="../appendices/extensions.html#VK_AMD_mixed_attachment_samples" class="xref page">VK_AMD_mixed_attachment_samples</a></code> extension is enabled, for
color samples present in the color attachments, a color sample is covered if
the pixel coverage sample with the same
<a href="primsrast.html#primsrast-multisampling-coverage-mask" class="xref page">sample index</a> <span class="eq">i</span> is covered;
additional pixel coverage samples are discarded.</p>
</div>
<div class="paragraph">
<p>If the <code>pNext</code> chain of <a href="renderpass.html#VkSubpassDescription2" class="xref page">VkSubpassDescription2</a>
or <a href="renderpass.html#VkRenderingInfo" class="xref page">VkRenderingInfo</a>
includes a <a href="renderpass.html#VkMultisampledRenderToSingleSampledInfoEXT" class="xref page">VkMultisampledRenderToSingleSampledInfoEXT</a> structure with
the <code>multisampledRenderToSingleSampledEnable</code> field equal to
<code>VK_TRUE</code>, sample coverage is calculated as if the attachment has
<a href="renderpass.html#VkMultisampledRenderToSingleSampledInfoEXT" class="xref page">VkMultisampledRenderToSingleSampledInfoEXT</a>::<code>rasterizationSamples</code>
samples.</p>
</div>
<div class="paragraph">
<p>When the <code><a href="../appendices/extensions.html#VK_NV_coverage_reduction_mode" class="xref page">VK_NV_coverage_reduction_mode</a></code> extension is enabled, the
pipeline state controlling coverage reduction is specified through the
members of the <code>VkPipelineCoverageReductionStateCreateInfoNV</code> structure.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPipelineCoverageReductionStateCreateInfoNV</code> structure is defined
as:</p>
</div>
<div id="VkPipelineCoverageReductionStateCreateInfoNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_NV_coverage_reduction_mode
typedef struct VkPipelineCoverageReductionStateCreateInfoNV {
    VkStructureType                                  sType;
    const void*                                      pNext;
    VkPipelineCoverageReductionStateCreateFlagsNV    flags;
    VkCoverageReductionModeNV                        coverageReductionMode;
} VkPipelineCoverageReductionStateCreateInfoNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>coverageReductionMode</code> is a <a href="#VkCoverageReductionModeNV">VkCoverageReductionModeNV</a> value
controlling how color sample coverage is generated from pixel coverage.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If this structure is not included in the <code>pNext</code> chain, or if the
extension is not enabled, the default coverage reduction mode is inferred as
follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the <code><a href="../appendices/extensions.html#VK_NV_framebuffer_mixed_samples" class="xref page">VK_NV_framebuffer_mixed_samples</a></code> extension is enabled,
then it is as if the <code>coverageReductionMode</code> is
<code>VK_COVERAGE_REDUCTION_MODE_MERGE_NV</code>.</p>
</li>
<li>
<p>If the <code><a href="../appendices/extensions.html#VK_AMD_mixed_attachment_samples" class="xref page">VK_AMD_mixed_attachment_samples</a></code> extension is enabled,
then it is as if the <code>coverageReductionMode</code> is
<code>VK_COVERAGE_REDUCTION_MODE_TRUNCATE_NV</code>.</p>
</li>
<li>
<p>If both <code><a href="../appendices/extensions.html#VK_NV_framebuffer_mixed_samples" class="xref page">VK_NV_framebuffer_mixed_samples</a></code> and
<code><a href="../appendices/extensions.html#VK_AMD_mixed_attachment_samples" class="xref page">VK_AMD_mixed_attachment_samples</a></code> are enabled, then the default
coverage reduction mode is implementation-dependent.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPipelineCoverageReductionStateCreateInfoNV-sType-sType" href="#VUID-VkPipelineCoverageReductionStateCreateInfoNV-sType-sType"></a> <span class="vuid">VUID-VkPipelineCoverageReductionStateCreateInfoNV-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_PIPELINE_COVERAGE_REDUCTION_STATE_CREATE_INFO_NV</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineCoverageReductionStateCreateInfoNV-flags-zerobitmask" href="#VUID-VkPipelineCoverageReductionStateCreateInfoNV-flags-zerobitmask"></a> <span class="vuid">VUID-VkPipelineCoverageReductionStateCreateInfoNV-flags-zerobitmask</span><br>
 <code>flags</code> <strong>must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineCoverageReductionStateCreateInfoNV-coverageReductionMode-parameter" href="#VUID-VkPipelineCoverageReductionStateCreateInfoNV-coverageReductionMode-parameter"></a> <span class="vuid">VUID-VkPipelineCoverageReductionStateCreateInfoNV-coverageReductionMode-parameter</span><br>
 <code>coverageReductionMode</code> <strong>must</strong> be a valid <a href="#VkCoverageReductionModeNV">VkCoverageReductionModeNV</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkPipelineCoverageReductionStateCreateFlagsNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_NV_coverage_reduction_mode
typedef VkFlags VkPipelineCoverageReductionStateCreateFlagsNV;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkPipelineCoverageReductionStateCreateFlagsNV</code> is a bitmask type for
setting a mask, but is currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of
<a href="#VkPipelineCoverageReductionStateCreateInfoNV">VkPipelineCoverageReductionStateCreateInfoNV</a>::<code>coverageReductionMode</code>,
specifying how color sample coverage is generated from pixel coverage, are:</p>
</div>
<div id="VkCoverageReductionModeNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_NV_coverage_reduction_mode
typedef enum VkCoverageReductionModeNV {
    VK_COVERAGE_REDUCTION_MODE_MERGE_NV = 0,
    VK_COVERAGE_REDUCTION_MODE_TRUNCATE_NV = 1,
} VkCoverageReductionModeNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_COVERAGE_REDUCTION_MODE_MERGE_NV</code> specifies that each color
sample will be associated with an implementation-dependent subset of
samples in the pixel coverage.
If any of those associated samples are covered, the color sample is
covered.</p>
</li>
<li>
<p><code>VK_COVERAGE_REDUCTION_MODE_TRUNCATE_NV</code> specifies that for color
samples present in the color attachments, a color sample is covered if
the pixel coverage sample with the same
<a href="primsrast.html#primsrast-multisampling-coverage-mask" class="xref page">sample index</a> <span class="eq">i</span> is
covered; other pixel coverage samples are discarded.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the
<code>coverageReductionMode</code> state, call:</p>
</div>
<div id="vkCmdSetCoverageReductionModeNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_extended_dynamic_state3 with VK_NV_coverage_reduction_mode, VK_EXT_shader_object with VK_NV_coverage_reduction_mode
void vkCmdSetCoverageReductionModeNV(
    VkCommandBuffer                             commandBuffer,
    VkCoverageReductionModeNV                   coverageReductionMode);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>coverageReductionMode</code> specifies the <code>coverageReductionMode</code>
state.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the <code>coverageReductionMode</code> state for subsequent
drawing commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_COVERAGE_REDUCTION_MODE_NV</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="#VkPipelineCoverageReductionStateCreateInfoNV">VkPipelineCoverageReductionStateCreateInfoNV</a>::<code>coverageReductionMode</code>
value used to create the currently active pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetCoverageReductionModeNV-None-08528" href="#VUID-vkCmdSetCoverageReductionModeNV-None-08528"></a> <span class="vuid">VUID-vkCmdSetCoverageReductionModeNV-None-08528</span><br>

Either the <a href="features.html#features-extendedDynamicState3CoverageReductionMode" class="xref page">    <code>extendedDynamicState3CoverageReductionMode</code></a> feature or the
<a href="features.html#features-shaderObject" class="xref page"><code>shaderObject</code></a> feature or both <strong>must</strong> be
enabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetCoverageReductionModeNV-commandBuffer-parameter" href="#VUID-vkCmdSetCoverageReductionModeNV-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetCoverageReductionModeNV-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageReductionModeNV-coverageReductionMode-parameter" href="#VUID-vkCmdSetCoverageReductionModeNV-coverageReductionMode-parameter"></a> <span class="vuid">VUID-vkCmdSetCoverageReductionModeNV-coverageReductionMode-parameter</span><br>
 <code>coverageReductionMode</code> <strong>must</strong> be a valid <a href="#VkCoverageReductionModeNV">VkCoverageReductionModeNV</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageReductionModeNV-commandBuffer-recording" href="#VUID-vkCmdSetCoverageReductionModeNV-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetCoverageReductionModeNV-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageReductionModeNV-commandBuffer-cmdpool" href="#VUID-vkCmdSetCoverageReductionModeNV-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetCoverageReductionModeNV-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageReductionModeNV-videocoding" href="#VUID-vkCmdSetCoverageReductionModeNV-videocoding"></a> <span class="vuid">VUID-vkCmdSetCoverageReductionModeNV-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query the set of mixed sample combinations of coverage reduction mode,
rasterization samples and color, depth, stencil attachment sample counts
that are supported by a physical device, call:</p>
</div>
<div id="vkGetPhysicalDeviceSupportedFramebufferMixedSamplesCombinationsNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_NV_coverage_reduction_mode
VkResult vkGetPhysicalDeviceSupportedFramebufferMixedSamplesCombinationsNV(
    VkPhysicalDevice                            physicalDevice,
    uint32_t*                                   pCombinationCount,
    VkFramebufferMixedSamplesCombinationNV*     pCombinations);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>physicalDevice</code> is the physical device from which to query the set
of combinations.</p>
</li>
<li>
<p><code>pCombinationCount</code> is a pointer to an integer related to the number
of combinations available or queried, as described below.</p>
</li>
<li>
<p><code>pCombinations</code> is either <code>NULL</code> or a pointer to an array of
<a href="#VkFramebufferMixedSamplesCombinationNV">VkFramebufferMixedSamplesCombinationNV</a> values, indicating the
supported combinations of coverage reduction mode, rasterization
samples, and color, depth, stencil attachment sample counts.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>pCombinations</code> is <code>NULL</code>, then the number of supported combinations
for the given <code>physicalDevice</code> is returned in <code>pCombinationCount</code>.
Otherwise, <code>pCombinationCount</code> <strong>must</strong> point to a variable set by the user
to the number of elements in the <code>pCombinations</code> array, and on return
the variable is overwritten with the number of values actually written to
<code>pCombinations</code>.
If the value of <code>pCombinationCount</code> is less than the number of
combinations supported for the given <code>physicalDevice</code>, at most
<code>pCombinationCount</code> values will be written to <code>pCombinations</code>, and
<code>VK_INCOMPLETE</code> will be returned instead of <code>VK_SUCCESS</code>, to
indicate that not all the supported values were returned.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPhysicalDeviceSupportedFramebufferMixedSamplesCombinationsNV-physicalDevice-parameter" href="#VUID-vkGetPhysicalDeviceSupportedFramebufferMixedSamplesCombinationsNV-physicalDevice-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceSupportedFramebufferMixedSamplesCombinationsNV-physicalDevice-parameter</span><br>
 <code>physicalDevice</code> <strong>must</strong> be a valid <a href="devsandqueues.html#VkPhysicalDevice" class="xref page">VkPhysicalDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceSupportedFramebufferMixedSamplesCombinationsNV-pCombinationCount-parameter" href="#VUID-vkGetPhysicalDeviceSupportedFramebufferMixedSamplesCombinationsNV-pCombinationCount-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceSupportedFramebufferMixedSamplesCombinationsNV-pCombinationCount-parameter</span><br>
 <code>pCombinationCount</code> <strong>must</strong> be a valid pointer to a <code>uint32_t</code> value</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceSupportedFramebufferMixedSamplesCombinationsNV-pCombinations-parameter" href="#VUID-vkGetPhysicalDeviceSupportedFramebufferMixedSamplesCombinationsNV-pCombinations-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceSupportedFramebufferMixedSamplesCombinationsNV-pCombinations-parameter</span><br>
 If the value referenced by <code>pCombinationCount</code> is not <code>0</code>, and <code>pCombinations</code> is not <code>NULL</code>, <code>pCombinations</code> <strong>must</strong> be a valid pointer to an array of <code>pCombinationCount</code> <a href="#VkFramebufferMixedSamplesCombinationNV">VkFramebufferMixedSamplesCombinationNV</a> structures</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-successcodes" class="xref page">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_INCOMPLETE</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="fundamentals.html#fundamentals-errorcodes" class="xref page">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkFramebufferMixedSamplesCombinationNV</code> structure is defined as:</p>
</div>
<div id="VkFramebufferMixedSamplesCombinationNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_NV_coverage_reduction_mode
typedef struct VkFramebufferMixedSamplesCombinationNV {
    VkStructureType              sType;
    void*                        pNext;
    VkCoverageReductionModeNV    coverageReductionMode;
    VkSampleCountFlagBits        rasterizationSamples;
    VkSampleCountFlags           depthStencilSamples;
    VkSampleCountFlags           colorSamples;
} VkFramebufferMixedSamplesCombinationNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>coverageReductionMode</code> is a <a href="#VkCoverageReductionModeNV">VkCoverageReductionModeNV</a> value
specifying the coverage reduction mode.</p>
</li>
<li>
<p><code>rasterizationSamples</code> is a <a href="limits.html#VkSampleCountFlagBits" class="xref page">VkSampleCountFlagBits</a> specifying
the number of rasterization samples in the supported combination.</p>
</li>
<li>
<p><code>depthStencilSamples</code> specifies the number of samples in the depth
stencil attachment in the supported combination.
A value of 0 indicates the combination does not have a depth stencil
attachment.</p>
</li>
<li>
<p><code>colorSamples</code> specifies the number of color samples in a color
attachment in the supported combination.
A value of 0 indicates the combination does not have a color attachment.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkFramebufferMixedSamplesCombinationNV-sType-sType" href="#VUID-VkFramebufferMixedSamplesCombinationNV-sType-sType"></a> <span class="vuid">VUID-VkFramebufferMixedSamplesCombinationNV-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_FRAMEBUFFER_MIXED_SAMPLES_COMBINATION_NV</code></p>
</li>
<li>
<p><a id="VUID-VkFramebufferMixedSamplesCombinationNV-pNext-pNext" href="#VUID-VkFramebufferMixedSamplesCombinationNV-pNext-pNext"></a> <span class="vuid">VUID-VkFramebufferMixedSamplesCombinationNV-pNext-pNext</span><br>
 <code>pNext</code> <strong>must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="fragops-coverage-modulation"><a class="anchor" href="#fragops-coverage-modulation"></a>Coverage Modulation</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>As part of coverage reduction, fragment color values <strong>can</strong> also be modulated
(multiplied) by a value that is a function of fraction of covered
rasterization samples associated with that color sample.</p>
</div>
<div class="paragraph">
<p>Pipeline state controlling coverage modulation is specified through the
members of the <code>VkPipelineCoverageModulationStateCreateInfoNV</code>
structure.</p>
</div>
<div class="paragraph">
<p>The <code>VkPipelineCoverageModulationStateCreateInfoNV</code> structure is defined
as:</p>
</div>
<div id="VkPipelineCoverageModulationStateCreateInfoNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_NV_framebuffer_mixed_samples
typedef struct VkPipelineCoverageModulationStateCreateInfoNV {
    VkStructureType                                   sType;
    const void*                                       pNext;
    VkPipelineCoverageModulationStateCreateFlagsNV    flags;
    VkCoverageModulationModeNV                        coverageModulationMode;
    VkBool32                                          coverageModulationTableEnable;
    uint32_t                                          coverageModulationTableCount;
    const float*                                      pCoverageModulationTable;
} VkPipelineCoverageModulationStateCreateInfoNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="fundamentals.html#VkStructureType" class="xref page">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>coverageModulationMode</code> is a <a href="#VkCoverageModulationModeNV">VkCoverageModulationModeNV</a> value
controlling which color components are modulated.</p>
</li>
<li>
<p><code>coverageModulationTableEnable</code> controls whether the modulation
factor is looked up from a table in <code>pCoverageModulationTable</code>.</p>
</li>
<li>
<p><code>coverageModulationTableCount</code> is the number of elements in
<code>pCoverageModulationTable</code>.</p>
</li>
<li>
<p><code>pCoverageModulationTable</code> is a table of modulation factors
containing a value for each number of covered samples.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>coverageModulationTableEnable</code> is <code>VK_FALSE</code>, then for each
color sample the associated bits of the pixel coverage are counted and
divided by the number of associated bits to produce a modulation factor
<span class="eq">R</span> in the range <span class="eq">(0,1]</span> (a value of zero would have been killed due
to a color coverage of 0).
Specifically:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="eq">N</span> = value of <code>rasterizationSamples</code></p>
</li>
<li>
<p><span class="eq">M</span> = value of <a href="renderpass.html#VkAttachmentDescription" class="xref page">VkAttachmentDescription</a>::<code>samples</code> for any
color attachments</p>
</li>
<li>
<p><span class="eq">R = popcount(associated coverage bits) / (N / M)</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>coverageModulationTableEnable</code> is <code>VK_TRUE</code>, the value <span class="eq">R</span>
is computed using a programmable lookup table.
The lookup table has <span class="eq">N / M</span> elements, and the element of the table is
selected by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="eq">R = <code>pCoverageModulationTable</code>[popcount(associated coverage
bits)-1]</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that the table does not have an entry for <span class="eq">popcount(associated
coverage bits) = 0</span>, because such samples would have been killed.</p>
</div>
<div class="paragraph">
<p>The values of <code>pCoverageModulationTable</code> <strong>may</strong> be rounded to an
implementation-dependent precision, which is at least as fine as <span class="eq">1 /
N</span>, and clamped to <span class="eq">[0,1]</span>.</p>
</div>
<div class="paragraph">
<p>For each color attachment with a floating point or normalized color format,
each fragment output color value is replicated to <span class="eq">M</span> values which <strong>can</strong>
each be modulated (multiplied) by that color sample&#8217;s associated value of
<span class="eq">R</span>.
Which components are modulated is controlled by
<code>coverageModulationMode</code>.</p>
</div>
<div class="paragraph">
<p>If this structure is not included in the <code>pNext</code> chain, it is as if
<code>coverageModulationMode</code> is <code>VK_COVERAGE_MODULATION_MODE_NONE_NV</code>.</p>
</div>
<div class="paragraph">
<p>If the <a href="#fragops-coverage-reduction">coverage reduction mode</a> is
<code>VK_COVERAGE_REDUCTION_MODE_TRUNCATE_NV</code>, each color sample is
associated with only a single coverage sample.
In this case, it is as if <code>coverageModulationMode</code> is
<code>VK_COVERAGE_MODULATION_MODE_NONE_NV</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPipelineCoverageModulationStateCreateInfoNV-coverageModulationTableEnable-01405" href="#VUID-VkPipelineCoverageModulationStateCreateInfoNV-coverageModulationTableEnable-01405"></a> <span class="vuid">VUID-VkPipelineCoverageModulationStateCreateInfoNV-coverageModulationTableEnable-01405</span><br>

If <code>coverageModulationTableEnable</code> is <code>VK_TRUE</code>,
<code>coverageModulationTableCount</code> <strong>must</strong> be equal to the number of
rasterization samples divided by the number of color samples in the
subpass</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPipelineCoverageModulationStateCreateInfoNV-sType-sType" href="#VUID-VkPipelineCoverageModulationStateCreateInfoNV-sType-sType"></a> <span class="vuid">VUID-VkPipelineCoverageModulationStateCreateInfoNV-sType-sType</span><br>
 <code>sType</code> <strong>must</strong> be <code>VK_STRUCTURE_TYPE_PIPELINE_COVERAGE_MODULATION_STATE_CREATE_INFO_NV</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineCoverageModulationStateCreateInfoNV-flags-zerobitmask" href="#VUID-VkPipelineCoverageModulationStateCreateInfoNV-flags-zerobitmask"></a> <span class="vuid">VUID-VkPipelineCoverageModulationStateCreateInfoNV-flags-zerobitmask</span><br>
 <code>flags</code> <strong>must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineCoverageModulationStateCreateInfoNV-coverageModulationMode-parameter" href="#VUID-VkPipelineCoverageModulationStateCreateInfoNV-coverageModulationMode-parameter"></a> <span class="vuid">VUID-VkPipelineCoverageModulationStateCreateInfoNV-coverageModulationMode-parameter</span><br>
 <code>coverageModulationMode</code> <strong>must</strong> be a valid <a href="#VkCoverageModulationModeNV">VkCoverageModulationModeNV</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkPipelineCoverageModulationStateCreateFlagsNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_NV_framebuffer_mixed_samples
typedef VkFlags VkPipelineCoverageModulationStateCreateFlagsNV;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkPipelineCoverageModulationStateCreateFlagsNV</code> is a bitmask type for
setting a mask, but is currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of
<a href="#VkPipelineCoverageModulationStateCreateInfoNV">VkPipelineCoverageModulationStateCreateInfoNV</a>::<code>coverageModulationMode</code>,
specifying which color components are modulated, are:</p>
</div>
<div id="VkCoverageModulationModeNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_NV_framebuffer_mixed_samples
typedef enum VkCoverageModulationModeNV {
    VK_COVERAGE_MODULATION_MODE_NONE_NV = 0,
    VK_COVERAGE_MODULATION_MODE_RGB_NV = 1,
    VK_COVERAGE_MODULATION_MODE_ALPHA_NV = 2,
    VK_COVERAGE_MODULATION_MODE_RGBA_NV = 3,
} VkCoverageModulationModeNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_COVERAGE_MODULATION_MODE_NONE_NV</code> specifies that no components
are multiplied by the modulation factor.</p>
</li>
<li>
<p><code>VK_COVERAGE_MODULATION_MODE_RGB_NV</code> specifies that the red, green,
and blue components are multiplied by the modulation factor.</p>
</li>
<li>
<p><code>VK_COVERAGE_MODULATION_MODE_ALPHA_NV</code> specifies that the alpha
component is multiplied by the modulation factor.</p>
</li>
<li>
<p><code>VK_COVERAGE_MODULATION_MODE_RGBA_NV</code> specifies that all components
are multiplied by the modulation factor.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the
<code>coverageModulationMode</code> state, call:</p>
</div>
<div id="vkCmdSetCoverageModulationModeNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_extended_dynamic_state3 with VK_NV_framebuffer_mixed_samples, VK_EXT_shader_object with VK_NV_framebuffer_mixed_samples
void vkCmdSetCoverageModulationModeNV(
    VkCommandBuffer                             commandBuffer,
    VkCoverageModulationModeNV                  coverageModulationMode);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>coverageModulationMode</code> specifies the <code>coverageModulationMode</code>
state.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the <code>coverageModulationMode</code> state for subsequent
drawing commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_COVERAGE_MODULATION_MODE_NV</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="#VkPipelineCoverageModulationStateCreateInfoNV">VkPipelineCoverageModulationStateCreateInfoNV</a>::<code>coverageModulationMode</code>
value used to create the currently active pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetCoverageModulationModeNV-None-08530" href="#VUID-vkCmdSetCoverageModulationModeNV-None-08530"></a> <span class="vuid">VUID-vkCmdSetCoverageModulationModeNV-None-08530</span><br>

Either the <a href="features.html#features-extendedDynamicState3CoverageModulationMode" class="xref page">    <code>extendedDynamicState3CoverageModulationMode</code></a> feature or the
<a href="features.html#features-shaderObject" class="xref page"><code>shaderObject</code></a> feature or both <strong>must</strong> be
enabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetCoverageModulationModeNV-commandBuffer-parameter" href="#VUID-vkCmdSetCoverageModulationModeNV-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetCoverageModulationModeNV-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageModulationModeNV-coverageModulationMode-parameter" href="#VUID-vkCmdSetCoverageModulationModeNV-coverageModulationMode-parameter"></a> <span class="vuid">VUID-vkCmdSetCoverageModulationModeNV-coverageModulationMode-parameter</span><br>
 <code>coverageModulationMode</code> <strong>must</strong> be a valid <a href="#VkCoverageModulationModeNV">VkCoverageModulationModeNV</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageModulationModeNV-commandBuffer-recording" href="#VUID-vkCmdSetCoverageModulationModeNV-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetCoverageModulationModeNV-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageModulationModeNV-commandBuffer-cmdpool" href="#VUID-vkCmdSetCoverageModulationModeNV-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetCoverageModulationModeNV-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageModulationModeNV-videocoding" href="#VUID-vkCmdSetCoverageModulationModeNV-videocoding"></a> <span class="vuid">VUID-vkCmdSetCoverageModulationModeNV-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the
<code>coverageModulationTableEnable</code> state, call:</p>
</div>
<div id="vkCmdSetCoverageModulationTableEnableNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_extended_dynamic_state3 with VK_NV_framebuffer_mixed_samples, VK_EXT_shader_object with VK_NV_framebuffer_mixed_samples
void vkCmdSetCoverageModulationTableEnableNV(
    VkCommandBuffer                             commandBuffer,
    VkBool32                                    coverageModulationTableEnable);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>coverageModulationTableEnable</code> specifies the
<code>coverageModulationTableEnable</code> state.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the <code>coverageModulationTableEnable</code> state for
subsequent drawing commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_COVERAGE_MODULATION_TABLE_ENABLE_NV</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="#VkPipelineCoverageModulationStateCreateInfoNV">VkPipelineCoverageModulationStateCreateInfoNV</a>::<code>coverageModulationTableEnable</code>
value used to create the currently active pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetCoverageModulationTableEnableNV-None-08532" href="#VUID-vkCmdSetCoverageModulationTableEnableNV-None-08532"></a> <span class="vuid">VUID-vkCmdSetCoverageModulationTableEnableNV-None-08532</span><br>

Either the
<a href="features.html#features-extendedDynamicState3CoverageModulationTableEnable" class="xref page">    <code>extendedDynamicState3CoverageModulationTableEnable</code></a> feature or
the <a href="features.html#features-shaderObject" class="xref page"><code>shaderObject</code></a> feature or both <strong>must</strong>
be enabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetCoverageModulationTableEnableNV-commandBuffer-parameter" href="#VUID-vkCmdSetCoverageModulationTableEnableNV-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetCoverageModulationTableEnableNV-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageModulationTableEnableNV-commandBuffer-recording" href="#VUID-vkCmdSetCoverageModulationTableEnableNV-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetCoverageModulationTableEnableNV-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageModulationTableEnableNV-commandBuffer-cmdpool" href="#VUID-vkCmdSetCoverageModulationTableEnableNV-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetCoverageModulationTableEnableNV-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageModulationTableEnableNV-videocoding" href="#VUID-vkCmdSetCoverageModulationTableEnableNV-videocoding"></a> <span class="vuid">VUID-vkCmdSetCoverageModulationTableEnableNV-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To <a href="pipelines.html#pipelines-dynamic-state" class="xref page">dynamically set</a> the
<code>pCoverageModulationTable</code> state, call:</p>
</div>
<div id="vkCmdSetCoverageModulationTableNV" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c++ hljs" data-lang="c++">// Provided by VK_EXT_extended_dynamic_state3 with VK_NV_framebuffer_mixed_samples, VK_EXT_shader_object with VK_NV_framebuffer_mixed_samples
void vkCmdSetCoverageModulationTableNV(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    coverageModulationTableCount,
    const float*                                pCoverageModulationTable);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>coverageModulationTableCount</code> specifies the number of elements in
<code>pCoverageModulationTable</code>.</p>
</li>
<li>
<p><code>pCoverageModulationTable</code> specifies the table of modulation factors
containing a value for each number of covered samples.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the table of modulation factors for subsequent drawing
commands
when drawing using <a href="shaders.html#shaders-objects" class="xref page">shader objects</a>, or
when the graphics pipeline is created with
<code>VK_DYNAMIC_STATE_COVERAGE_MODULATION_TABLE_NV</code> set in
<a href="pipelines.html#VkPipelineDynamicStateCreateInfo" class="xref page">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code>.
Otherwise, this state is specified by the
<a href="#VkPipelineCoverageModulationStateCreateInfoNV">VkPipelineCoverageModulationStateCreateInfoNV</a>::<code>coverageModulationTableCount</code>,
and
<a href="#VkPipelineCoverageModulationStateCreateInfoNV">VkPipelineCoverageModulationStateCreateInfoNV</a>::<code>pCoverageModulationTable</code>
values used to create the currently active pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetCoverageModulationTableNV-None-08534" href="#VUID-vkCmdSetCoverageModulationTableNV-None-08534"></a> <span class="vuid">VUID-vkCmdSetCoverageModulationTableNV-None-08534</span><br>

Either the <a href="features.html#features-extendedDynamicState3CoverageModulationTable" class="xref page">    <code>extendedDynamicState3CoverageModulationTable</code></a> feature or the
<a href="features.html#features-shaderObject" class="xref page"><code>shaderObject</code></a> feature or both <strong>must</strong> be
enabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetCoverageModulationTableNV-commandBuffer-parameter" href="#VUID-vkCmdSetCoverageModulationTableNV-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetCoverageModulationTableNV-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong>must</strong> be a valid <a href="cmdbuffers.html#VkCommandBuffer" class="xref page">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageModulationTableNV-pCoverageModulationTable-parameter" href="#VUID-vkCmdSetCoverageModulationTableNV-pCoverageModulationTable-parameter"></a> <span class="vuid">VUID-vkCmdSetCoverageModulationTableNV-pCoverageModulationTable-parameter</span><br>
 <code>pCoverageModulationTable</code> <strong>must</strong> be a valid pointer to an array of <code>coverageModulationTableCount</code> <code>float</code> values</p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageModulationTableNV-commandBuffer-recording" href="#VUID-vkCmdSetCoverageModulationTableNV-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetCoverageModulationTableNV-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong>must</strong> be in the <a href="cmdbuffers.html#commandbuffers-lifecycle" class="xref page">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageModulationTableNV-commandBuffer-cmdpool" href="#VUID-vkCmdSetCoverageModulationTableNV-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetCoverageModulationTableNV-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageModulationTableNV-videocoding" href="#VUID-vkCmdSetCoverageModulationTableNV-videocoding"></a> <span class="vuid">VUID-vkCmdSetCoverageModulationTableNV-videocoding</span><br>
 This command <strong>must</strong> only be called outside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdSetCoverageModulationTableNV-coverageModulationTableCount-arraylength" href="#VUID-vkCmdSetCoverageModulationTableNV-coverageModulationTableCount-arraylength"></a> <span class="vuid">VUID-vkCmdSetCoverageModulationTableNV-coverageModulationTableCount-arraylength</span><br>
 <code>coverageModulationTableCount</code> <strong>must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong>must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong>must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="cmdbuffers.html#VkCommandBufferLevel" class="xref page">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="renderpass.html#vkCmdBeginRenderPass" class="xref page">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="video_extensions.html#vkCmdBeginVideoCodingKHR" class="xref page">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="devsandqueues.html#VkQueueFlagBits" class="xref page">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="fundamentals.html#fundamentals-queueoperation-command-types" class="xref page">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
    <!--
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
    -->
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>

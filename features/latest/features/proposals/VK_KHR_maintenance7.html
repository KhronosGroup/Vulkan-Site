<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VK_KHR_maintenance7 :: Vulkan Documentation Project</title>
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <link rel="apple-touch-icon" sizes="180x180" href="../../../../_/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../../_/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../../_/img/favicon-16x16.png">
    <link rel="manifest" href="../../../../_/static/site.webmanifest">
    <link rel="mask-icon" href="../../../../_/img/safari-pinned-tab.svg" color="#a41e22">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../.."><img class="navbar-item" alt="Vulkan White Label" src="../../../../_/Vulkan_Docs.svg" /></a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field has-filter">
          <label for="search-input"></label>
          <input id="search-input" type="text" placeholder="Search the docs">
          <label class="filter checkbox">
            <input type="checkbox" data-facet-filter="component:features" checked> In this component
          </label>
        </div>
      </div>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <!-- <a class="navbar-item" href="#">Home</a> -->
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Specs</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../../spec/latest/chapters/introduction.html">Vulkan 1.3</a>
            <a class="navbar-item" href="https://registry.khronos.org/OpenGL/specs/gl/GLSLangSpec.4.60.html">GLSL</a>
            <a class="navbar-item" href="../../../../guide/latest/hlsl.html">HLSL</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Education</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../../features/latest/features/index.html">Vulkan Feature Descriptions</a>
            <a class="navbar-item" href="../../../../guide/latest/index.html">Vulkan Guide</a>
            <a class="navbar-item" href="../../../../samples/latest/README.html">Vulkan Samples</a>
            <a class="navbar-item" href="../../../../tutorial/latest/index.html">Vulkan Tutorial</a>
            <a class="navbar-item" href="https://www.youtube.com/c/vulkan">YouTube</a>
            <a class="navbar-item" href="https://vulkan.org">More Info at Vulkan.org</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Feedback</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="https://github.com/KhronosGroup/Vulkan-Site/issues/new/choose" target="_blank">Report a Problem</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Community</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="https://discord.gg/vulkan">Vulkan Discord</a>
            <a class="navbar-item" href="https://reddit.com/r/vulkan">Reddit</a>
            <a class="navbar-item" href="https://stackoverflow.com/questions/tagged/vulkan">Stack Overflow</a>
            <a class="navbar-item" href="https://fosstodon.org/@vulkan">Mastodon</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="features" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">Vulkan Feature Descriptions</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Vulkan Roadmap and Feature Descriptions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Roadmap.html">Vulkan Roadmap</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Feature Descriptions</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_AMDX_shader_enqueue.html">VK_AMDX_shader_enqueue</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_AMD_anti_lag.html">VK_AMD_anti_lag</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_AMD_shader_early_and_late_fragment_tests.html">VK_AMD_shader_early_and_late_fragment_tests</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_ANDROID_external_format_resolve.html">VK_ANDROID_external_format_resolve</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_ARM_render_pass_striped.html">VK_ARM_render_pass_striped</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_attachment_feedback_loop_dynamic_state.html">VK_EXT_attachment_feedback_loop_dynamic_state</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_attachment_feedback_loop_layout.html">VK_EXT_attachment_feedback_loop_layout</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_calibrated_timestamps.html">VK_EXT_calibrated_timestamps</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_depth_bias_control.html">VK_EXT_depth_bias_control</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_depth_clamp_control.html">VK_EXT_depth_clamp_control</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_descriptor_buffer.html">VK_EXT_descriptor_buffer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_device_fault.html">VK_EXT_device_fault</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_device_generated_commands.html">VK_EXT_device_generated_commands</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_dynamic_rendering_unused_attachments.html">VK_EXT_dynamic_rendering_unused_attachments</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_extended_dynamic_state3.html">VK_EXT_extended_dynamic_state3</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_external_memory_acquire_unmodified.html">VK_EXT_external_memory_acquire_unmodified</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_frame_boundary.html">Proposal: <code>VK_EXT_frame_boundary</code></a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_graphics_pipeline_library.html">VK_EXT_graphics_pipeline_library</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_host_image_copy.html">VK_EXT_host_image_copy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_image_2d_array_of_3d.html">VK_EXT_image_2d_array_of_3d</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_image_compression_control.html">VK_EXT_image_compression_control</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_image_sliced_view_of_3d.html">VK_EXT_image_sliced_view_of_3d</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_layer_settings.html">VK_EXT_layer_settings</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_legacy_dithering.html">VK_EXT_legacy_dithering</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_legacy_vertex_attributes.html">VK_EXT_legacy_vertex_attributes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_map_memory_placed.html">VK_EXT_map_memory_placed</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_mesh_shader.html">VK_EXT_mesh_shader</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_metal_objects.html">VK_EXT_metal_objects</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_multisampled_render_to_single_sampled.html">VK_EXT_multisampled_render_to_single_sampled</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_mutable_descriptor_type.html">VK_EXT_mutable_descriptor_type</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_non_seamless_cube_map.html">VK_EXT_non_seamless_cube_map</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_opacity_micromap.html">VK_EXT_opacity_micromap</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_pipeline_library_group_handles.html">VK_EXT_pipeline_library_group_handles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_pipeline_protected_access.html">VK_EXT_pipeline_protected_access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_present_mode_fifo_latest_ready.html">VK_EXT_present_mode_fifo_latest_ready</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_primitives_generated_query.html">VK_EXT_primitives_generated_query</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_rasterization_order_attachment_access.html">VK_EXT_rasterization_order_attachment_access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_shader_module_identifier.html">VK_EXT_shader_module_identifier</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_shader_object.html">VK_EXT_shader_object</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_shader_replicated_composites.html">VK_EXT_shader_replicated_composites</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_shader_tile_image.html">VK_EXT_shader_tile_image</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_subpass_merge_feedback.html">VK_EXT_subpass_merge_feedback</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_surface_maintenance1.html">VK_EXT_surface_maintenance1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_swapchain_maintenance1.html">VK_EXT_swapchain_maintenance1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_GOOGLE_surfaceless_query.html">VK_GOOGLE_surfaceless_query</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_HUAWEI_cluster_culling_shader.html">VK_HUAWEI_cluster_culling_shader</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_HUAWEI_invocation_mask.html">VK_HUAWEI_invocation_mask</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_compute_shader_derivatives.html">VK_KHR_compute_shader_derivatives</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_cooperative_matrix.html">VK_KHR_cooperative_matrix</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_dynamic_rendering.html">VK_KHR_dynamic_rendering</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_dynamic_rendering_local_read.html">VK_KHR_dynamic_rendering_local_read</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_fragment_shader_barycentric.html">VK_KHR_fragment_shader_barycentric</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_fragment_shading_rate.html">VK_KHR_fragment_shading_rate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_load_store_op_none.html">VK_KHR_load_store_op_none</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_maintenance5.html">VK_KHR_maintenance5</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_maintenance6.html">VK_KHR_maintenance6</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="VK_KHR_maintenance7.html">VK_KHR_maintenance7</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_map_memory2.html">VK_KHR_map_memory2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_pipeline_binary.html">VK_KHR_pipeline_binary</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_ray_tracing_position_fetch.html">VK_KHR_ray_tracing_position_fetch</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_shader_expect_assume.html">VK_KHR_shader_expect_assume</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_shader_float_controls2.html">VK_KHR_shader_float_controls2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_shader_integer_dot_product.html">VK_KHR_shader_integer_dot_product</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_shader_maximal_reconvergence.html">VK_KHR_shader_maximal_reconvergence</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_shader_quad_control.html">VK_KHR_shader_quad_control</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_shader_relaxed_extended_instruction.html">VK_KHR_shader_relaxed_extended_instruction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_shader_subgroup_rotate.html">Subgroup rotation instruction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_vertex_attribute_divisor.html">VK_KHR_vertex_attribute_divisor</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_decode_av1.html">VK_KHR_video_decode_av1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_decode_h264.html">VK_KHR_video_decode_h264</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_decode_h265.html">VK_KHR_video_decode_h265</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_decode_queue.html">VK_KHR_video_decode_queue</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_encode_h264.html">VK_KHR_video_encode_h264</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_encode_h265.html">VK_KHR_video_encode_h265</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_encode_queue.html">VK_KHR_video_encode_queue</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_maintenance1.html">VK_KHR_video_maintenance1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_queue.html">VK_KHR_video_queue</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_LUNARG_direct_driver_loading.html">VK_LUNARG_direct_driver_loading</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_MSFT_layered_driver.html">VK_MSFT_layered_driver</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_NV_cooperative_matrix2.html">VK_NV_cooperative_matrix2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_NV_ray_tracing_validation.html">VK_NV_ray_tracing_validation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_QCOM_image_processing.html">VK_QCOM_image_processing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_QCOM_tile_properties.html">VK_QCOM_tile_properties</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Vulkan Feature Descriptions</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../../../../tutorial/latest/00_Introduction.html">Khronos Vulkan Tutorial</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../tutorial/latest/00_Introduction.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <div class="title"><a href="../index.html">Vulkan Feature Descriptions</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../../guide/latest/index.html">Vulkan Guide</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../guide/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../../samples/latest/README.html">Vulkan Samples</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../samples/latest/README.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../../spec/latest/index.html">Vulkan Specification</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../spec/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../spec/latest/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Vulkan Feature Descriptions</a></li>
    <li>Feature Descriptions</li>
    <li><a href="VK_KHR_maintenance7.html">VK_KHR_maintenance7</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">VK_KHR_maintenance7</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_problem_statement">1. Problem Statement</a>
<ul class="sectlevel2">
<li><a href="#_separate_depthstencil_access">1.1. Separate Depth/Stencil Access</a></li>
<li><a href="#_query_properties_of_underlying_layered_implementations">1.2. Query Properties of Underlying Layered Implementations</a></li>
<li><a href="#_mixed_inline_and_secondary_command_buffer_recording_in_render_passes">1.3. Mixed Inline and Secondary Command Buffer Recording in Render Passes</a></li>
<li><a href="#_relax_count_of_dynamic_uniformstorage_buffers">1.4. Relax Count of Dynamic Uniform/Storage Buffers</a></li>
<li><a href="#_fragment_shading_rate_attachment_size_mismatch">1.5. Fragment Shading Rate Attachment Size Mismatch</a></li>
</ul>
</li>
<li><a href="#_issue_details_and_solution_space">2. Issue Details and Solution Space</a>
<ul class="sectlevel2">
<li><a href="#_separate_depthstencil_access_2">2.1. Separate Depth/Stencil Access</a></li>
<li><a href="#_query_properties_of_underlying_layered_implementations_2">2.2. Query Properties of Underlying Layered Implementations</a></li>
<li><a href="#_mixed_inline_and_secondary_command_buffer_recording_in_render_passes_2">2.3. Mixed Inline and Secondary Command Buffer Recording in Render Passes</a></li>
<li><a href="#_relax_count_of_dynamic_uniformstorage_buffers_2">2.4. Relax Count of Dynamic Uniform/Storage Buffers</a></li>
<li><a href="#_fragment_shading_rate_attachment_size_mismatch_2">2.5. Fragment Shading Rate Attachment Size Mismatch</a></li>
<li><a href="#_determine_32_bit_query_overflow_behavior">2.6. Determine 32-Bit Query Overflow Behavior</a></li>
</ul>
</li>
<li><a href="#_proposal">3. Proposal</a>
<ul class="sectlevel2">
<li><a href="#_new_features">3.1. New features</a></li>
<li><a href="#_new_properties">3.2. New properties</a></li>
<li><a href="#_new_flags">3.3. New flags</a></li>
<li><a href="#_new_structs">3.4. New structs</a></li>
</ul>
</li>
<li><a href="#_issues">4. Issues</a>
<ul class="sectlevel2">
<li><a href="#_resolved_when_running_on_a_layered_implementation_how_should_the_properties_of_an_underlying_layered_vulkan_device_be_queries">4.1. RESOLVED: When running on a layered implementation, how should the properties of an underlying layered Vulkan device be queries?</a></li>
</ul>
</li>
<li><a href="#_further_functionality">5. Further Functionality</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This proposal details and addresses the issues solved by the <code>VK_KHR_maintenance7</code> extension.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_problem_statement"><a class="anchor" href="#_problem_statement"></a>1. Problem Statement</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Over time, a collection of minor features, none of which would warrant an
entire extension of their own, requires the creation of a maintenance
extension.</p>
</div>
<div class="paragraph">
<p>The following is a list of issues considered in this proposal:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Require no access overlap between depth and stencil aspects when
rendering</p>
</li>
<li>
<p>Add a way to query information regarding the underlying devices in
environments where the Vulkan implementation is provided through layered
implementations.</p>
</li>
<li>
<p>Promote <code>VK_RENDERING_CONTENTS_INLINE_BIT_EXT</code> and
<code>VK_SUBPASS_CONTENTS_INLINE_AND_SECONDARY_COMMAND_BUFFERS_EXT</code> to
KHR</p>
</li>
<li>
<p>Add a limit to report the maximum total count of dynamic uniform buffers
and dynamic storage buffers that can be included in a pipeline layout.</p>
</li>
<li>
<p>Add a method for determining whether an implementation wraps or saturates
on 32bit timestamp query overflow</p>
</li>
<li>
<p>Require that FSR attachment access is consistent with other image
accesses for robustness. Perhaps also make sure array access is robust -
not just width/height.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_separate_depthstencil_access"><a class="anchor" href="#_separate_depthstencil_access"></a>1.1. Separate Depth/Stencil Access</h3>
<div class="paragraph">
<p>Some implementations treat writes to a single aspect of mixed depth/stencil attachments as writes
to both aspects, while some implementations treat these writes as single-aspect writes in isolation.
It is important for applications to know which behavior is in use by an implementation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_query_properties_of_underlying_layered_implementations"><a class="anchor" href="#_query_properties_of_underlying_layered_implementations"></a>1.2. Query Properties of Underlying Layered Implementations</h3>
<div class="paragraph">
<p>When the Vulkan driver is provided by a layered implementation, it may be necessary to query the details of the underlying device.
For example, running on Mesa/Venus, driver ID is returned as <code>VK_DRIVER_ID_MESA_VENUS</code>, but it may be necessary to know what the real driver under the hood is.</p>
</div>
</div>
<div class="sect2">
<h3 id="_mixed_inline_and_secondary_command_buffer_recording_in_render_passes"><a class="anchor" href="#_mixed_inline_and_secondary_command_buffer_recording_in_render_passes"></a>1.3. Mixed Inline and Secondary Command Buffer Recording in Render Passes</h3>
<div class="paragraph">
<p>Vulkan 1.0 required that the contents of a render pass subpass are either entirely inlined or are provided in a single secondary command buffer.
In some situations, it may be beneficial to be able to mix inline and secondary command buffers inside the same render pass subpass, or executed multiple secondary command buffers.</p>
</div>
</div>
<div class="sect2">
<h3 id="_relax_count_of_dynamic_uniformstorage_buffers"><a class="anchor" href="#_relax_count_of_dynamic_uniformstorage_buffers"></a>1.4. Relax Count of Dynamic Uniform/Storage Buffers</h3>
<div class="paragraph">
<p>The maximum count of dynamic uniform buffers and dynamic storage buffers that can
be included in a pipeline layout are reported separately. While some implementations
treat dynamic offsets of uniform buffers and storage buffers the same way, reporting
the total count along with maximum count of dynamic uniform and storage buffers could
relax the limitation and expose device capabilities more accurately.</p>
</div>
</div>
<div class="sect2">
<h3 id="_fragment_shading_rate_attachment_size_mismatch"><a class="anchor" href="#_fragment_shading_rate_attachment_size_mismatch"></a>1.5. Fragment Shading Rate Attachment Size Mismatch</h3>
<div class="paragraph">
<p>The <a href="https://microsoft.github.io/DirectX-Specs/d3d/VariableRateShading.html">DirectX 12 Variable Shading Rate</a> feature allows applications to specify a shading rate image that is smaller than would be required to provide shading rates for all rendered texels.
When a fragment is rendered outside of the area covered by the shading rate image, default values are returned, in line with the usual out of bounds values for images that it guarantees.</p>
</div>
<div class="paragraph">
<p>In Vulkan however, this is currently outright banned, making it difficult to guarantee portability for apps relying on this or for emulation layers.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_issue_details_and_solution_space"><a class="anchor" href="#_issue_details_and_solution_space"></a>2. Issue Details and Solution Space</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_separate_depthstencil_access_2"><a class="anchor" href="#_separate_depthstencil_access_2"></a>2.1. Separate Depth/Stencil Access</h3>
<div class="paragraph">
<p>A property that indicates whether single-aspect writes to a depth/stencil attachment will
result in writes to both aspects.</p>
</div>
</div>
<div class="sect2">
<h3 id="_query_properties_of_underlying_layered_implementations_2"><a class="anchor" href="#_query_properties_of_underlying_layered_implementations_2"></a>2.2. Query Properties of Underlying Layered Implementations</h3>
<div class="paragraph">
<p>A new set of structures are included, accessible through <a href="https://registry.khronos.org/vulkan/specs/1.3-extensions/man/html/VkPhysicalDeviceLayeredApiPropertiesListKHR.html">VkPhysicalDeviceLayeredApiPropertiesListKHR</a> when chained to <a href="https://registry.khronos.org/vulkan/specs/1.3-extensions/man/html/VkPhysicalDeviceProperties2.html">VkPhysicalDeviceProperties2</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_mixed_inline_and_secondary_command_buffer_recording_in_render_passes_2"><a class="anchor" href="#_mixed_inline_and_secondary_command_buffer_recording_in_render_passes_2"></a>2.3. Mixed Inline and Secondary Command Buffer Recording in Render Passes</h3>
<div class="paragraph">
<p>Flags from the <code>VK_EXT_nested_command_buffer</code> extension provide this functionality, and are promoted to this extension.</p>
</div>
</div>
<div class="sect2">
<h3 id="_relax_count_of_dynamic_uniformstorage_buffers_2"><a class="anchor" href="#_relax_count_of_dynamic_uniformstorage_buffers_2"></a>2.4. Relax Count of Dynamic Uniform/Storage Buffers</h3>
<div class="paragraph">
<p>A limit that indicates the maximum total count of dynamic uniform buffers and
storage buffers that can be included in a pipeline layout is added.</p>
</div>
</div>
<div class="sect2">
<h3 id="_fragment_shading_rate_attachment_size_mismatch_2"><a class="anchor" href="#_fragment_shading_rate_attachment_size_mismatch_2"></a>2.5. Fragment Shading Rate Attachment Size Mismatch</h3>
<div class="paragraph">
<p>At the basic level, the first hurdle is allowing applications to specify fragment shading rate attachments that are too small for the render area, and giving it some sense of defined behavior.
The second challenge is ensuring that implementations all return the expected values.</p>
</div>
<div class="paragraph">
<p>This could be achieved by using new language to describe the specifics of these lookups, but notably image reads with robust access already have the desired behavior.
As such, this proposal retools fragment shading rate attachment reads as general image reads, and guarantees the values match DirectX 12&#8217;s guarantees when the <a href="https://registry.khronos.org/vulkan/specs/1.3-extensions/man/html/VkPhysicalDeviceRobustness2FeaturesEXT.html">VkPhysicalDeviceRobustness2FeaturesEXT::robustImageAccess2</a> feature is enabled.</p>
</div>
</div>
<div class="sect2">
<h3 id="_determine_32_bit_query_overflow_behavior"><a class="anchor" href="#_determine_32_bit_query_overflow_behavior"></a>2.6. Determine 32-Bit Query Overflow Behavior</h3>
<div class="paragraph">
<p>Previously when the 32-bit unsigned integer query result overflows, the implementation may either
wrap or saturate. However, MESA Virtio-GPU Venus layered implementation needs determined behavior
to implement <code>vkGetQueryPoolResults</code> based on <code>vkCmdCopyQueryPoolResults</code> in an efficient way.
This is solved by requiring that for an unsigned integer query, the 32-bit result value must be
equal to the 32 least significant bits of the equivalent 64-bit result value.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_proposal"><a class="anchor" href="#_proposal"></a>3. Proposal</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_new_features"><a class="anchor" href="#_new_features"></a>3.1. New features</h3>
<div class="paragraph">
<p>The following features are exposed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c hljs" data-lang="c">typedef struct VkPhysicalDeviceMaintenance7FeaturesKHR {
    VkStructureType    sType;
    void*              pNext;
    VkBool32           maintenance7;
} VkPhysicalDeviceMaintenance7FeaturesKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>maintenance7</code> feature indicates support for the <code>VK_KHR_maintenance7</code> extension.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_new_properties"><a class="anchor" href="#_new_properties"></a>3.2. New properties</h3>
<div class="paragraph">
<p>The following properties are added by this extension:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c hljs" data-lang="c">typedef struct VkPhysicalDeviceMaintenance7PropertiesKHR {
    VkStructureType                     sType;
    void*                               pNext;
    VkBool32                            robustFragmentShadingRateAttachmentAccess;
    VkBool32                            separateDepthStencilAttachmentAccess;
    uint32_t                            maxDescriptorSetTotalUniformBuffersDynamic;
    uint32_t                            maxDescriptorSetTotalStorageBuffersDynamic;
    uint32_t                            maxDescriptorSetTotalBuffersDynamic;
    uint32_t                            maxDescriptorSetUpdateAfterBindTotalUniformBuffersDynamic;
    uint32_t                            maxDescriptorSetUpdateAfterBindTotalStorageBuffersDynamic;
    uint32_t                            maxDescriptorSetUpdateAfterBindTotalBuffersDynamic;
} VkPhysicalDeviceMaintenance7PropertiesKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>robustFragmentShadingRateAttachmentAccess</code> indicates whether a
fragment shading rate attachment created with
<a href="https://registry.khronos.org/vulkan/specs/1.3-extensions/man/html/VkImageSubresourceRange.html">VkImageSubresourceRange</a>::`baseMipLevel`
equal to 0 can
have a size that is too small to cover a specified render area.</p>
</li>
<li>
<p><code>separateDepthStencilAttachmentAccess</code> indicates whether
read-modify-write operations to a depth/stencil attachment are considered a write to the sibling
stencil or depth attachment in an image which contains both depth and stencil aspects.</p>
</li>
<li>
<p><code>maxDescriptorSetTotalUniformBuffersDynamic</code> indicates the maximum total count of dynamic uniform buffers
that can be included in a pipeline layout.</p>
</li>
<li>
<p><code>maxDescriptorSetTotalStorageBuffersDynamic</code> indicates the maximum total count of dynamic storage buffers
that can be included in a pipeline layout.</p>
</li>
<li>
<p><code>maxDescriptorSetTotalBuffersDynamic</code> indicates the maximum total count of dynamic uniform buffers
and storage buffers that can be included in a pipeline layout.</p>
</li>
<li>
<p><code>maxDescriptorSetUpdateAfterBindTotalUniformBuffersDynamic</code> is similar to
<code>maxDescriptorSetUniformBuffersDynamic</code>
    but counts descriptors from descriptor sets created with or without the
    <code>VK_DESCRIPTOR_SET_LAYOUT_CREATE_UPDATE_AFTER_BIND_POOL_BIT</code> bit set.</p>
</li>
<li>
<p><code>maxDescriptorSetUpdateAfterBindTotalStorageBuffersDynamic</code> is similar to <code>maxDescriptorSetStorageBuffersDynamic</code>
but counts descriptors from descriptor sets created with or without the
<code>VK_DESCRIPTOR_SET_LAYOUT_CREATE_UPDATE_AFTER_BIND_POOL_BIT</code> bit set.</p>
</li>
<li>
<p><code>maxDescriptorSetUpdateAfterBindTotalBuffersDynamic</code> is similar to <code>maxDescriptorSetBuffersDynamic</code>
but counts descriptors from descriptor sets created with or without the
<code>VK_DESCRIPTOR_SET_LAYOUT_CREATE_UPDATE_AFTER_BIND_POOL_BIT</code> bit set.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_new_flags"><a class="anchor" href="#_new_flags"></a>3.3. New flags</h3>
<div class="paragraph">
<p>The <code>VK_RENDERING_CONTENTS_INLINE_BIT_KHR</code> flag promoted from
the <code>VK_EXT_nested_command_buffer</code> extension allows the render pass instance to be recorded
inline within the current command buffer.
Combined with the <code>VK_RENDERING_CONTENTS_SECONDARY_COMMAND_BUFFERS_BIT</code> bit,
the contents of the render pass instance can be recorded both inline and in
secondary command buffers executed with <code>vkCmdExecuteCommands</code>.</p>
</div>
<div class="paragraph">
<p>The <code>VK_SUBPASS_CONTENTS_INLINE_AND_SECONDARY_COMMAND_BUFFERS_KHR</code> flag
promoted from the <code>VK_EXT_nested_command_buffer</code> extension allows the contents
of a render pass subpass to be recorded both inline and in secondary command
buffers executed with <code>vkCmdExecuteCommands</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_new_structs"><a class="anchor" href="#_new_structs"></a>3.4. New structs</h3>
<div class="paragraph">
<p>To query information regarding layered implementations, chain the following to <code>vkGetPhysicalDeviceProperties2</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c hljs" data-lang="c">typedef struct VkPhysicalDeviceLayeredApiPropertiesListKHR {
    VkStructureType                            sType;
    void*                                      pNext;
    uint32_t                                   layeredApiCount;
    VkPhysicalDeviceLayeredApiPropertiesKHR*   pLayeredApis;
} VkPhysicalDeviceLayeredApiPropertiesListKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c hljs" data-lang="c">typedef struct VkPhysicalDeviceLayeredApiPropertiesKHR {
    VkStructureType                       sType;
    void*                                 pNext;
    uint32_t                              vendorID;
    uint32_t                              deviceID;
    VkPhysicalDeviceLayeredApiKHR         layeredAPI;
    char                                  deviceName[VK_MAX_PHYSICAL_DEVICE_NAME_SIZE];
} VkPhysicalDeviceLayeredApiPropertiesKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above, <code>vendorID</code>, <code>deviceID</code>, and <code>deviceName</code> are similar to members of the same name in <code>VkPhysicalDeviceProperties</code>.
<code>layeredAPI</code> is an enum that identifies the underlying API of the layered implementation, for example <code>VK_PHYSICAL_DEVICE_LAYERED_API_D3D12_KHR</code> if the layer implements the D3D12 API.</p>
</div>
<div class="paragraph">
<p>In the presence of multiple layers, the contents of <code>pLayeredApis[0]</code> corresponds to the bottom-most layer, with the following indices (if any) ordered by layer order.
This allows applications who are purely interested in the ultimate vendor ID or API that is executing the commands to avoid querying the layer count, always provide a <code>layeredApiCount</code> of 1, and inspect only <code>pLayeredApis[0]</code>.</p>
</div>
<div class="paragraph">
<p>To query API-specific details of the layered implementation, an API-specific struct can be chained to <code>VkPhysicalDeviceLayeredApiPropertiesKHR</code>.
For layered Vulkan implementations (i.e. <code>VK_PHYSICAL_DEVICE_LAYERED_API_VULKAN_KHR</code>) this extension introduces <code>VkPhysicalDeviceLayeredApiVulkanPropertiesKHR</code> to be chained, with structs for other APIs potentially added in future extensions.
The implementation will fill in the chained struct that corresponds to the layered API, and leave structs for other APIs untouched.
This allows the application to chain structs for multiple APIs and retrieve all necessary information in a single query.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c hljs" data-lang="c">typedef struct VkPhysicalDeviceLayeredApiVulkanPropertiesKHR {
    VkStructureType                       sType;
    void*                                 pNext;
    VkPhysicalDeviceProperties2           properties;
} VkPhysicalDeviceLayeredApiVulkanPropertiesKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above struct, the application may additionally chain <code>VkPhysicalDeviceDriverProperties</code> and <code>VkPhysicalDeviceIDProperties</code> to <code>properties</code> to extract further information from the underlying Vulkan device.
<code>properties.properties.limits</code> and <code>properties.properties.sparseProperties</code> will however be 0-initialized and will not contain meaningful values.</p>
</div>
<div class="paragraph">
<p>For example, an application running through Mesa&#8217;s Venus, atop Mesa&#8217;s Dozen, atop the Nvidia proprietary D3D12 implementation would receive:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c hljs" data-lang="c">layers-&gt;pLayeredApis[0].layeredAPI = VK_PHYSICAL_DEVICE_LAYERED_API_D3D12_KHR;
// other fields

layers-&gt;pLayeredApis[1].layeredAPI = VK_PHYSICAL_DEVICE_LAYERED_API_VULKAN_KHR;
// other fields

// If driverProperties is a VkPhysicalDeviceDriverProperties chained to
// VkPhysicalDeviceLayeredApiVulkanPropertiesKHR::properties that is in turn
// chained to layers-&gt;pLayeredApis[1].pNext:
driverProperties-&gt;driverID = VK_DRIVER_ID_MESA_DOZEN;
// other fields</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, the properties of the top layer (Mesa&#8217;s Venus) will be returned as usual in <code>VkPhysicalDeviceProperties2</code>.
Note: if there are layers underneath a non-Vulkan implementation, they may not be visible in this query.
For example, if the application is running through Mesa&#8217;s Dozen, atop VKD3D-proton and so on, the query may return layered implementations only up to Mesa&#8217;s Dozen as other APIs may lack such a query.</p>
</div>
<div class="paragraph">
<p>The <code>VkPhysicalDeviceLayeredApiKHR</code> enum is defined as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c hljs" data-lang="c">typedef enum VkPhysicalDeviceLayeredApiKHR {
    VK_PHYSICAL_DEVICE_LAYERED_API_VULKAN_KHR = 1,
    VK_PHYSICAL_DEVICE_LAYERED_API_D3D12_KHR = 2,
    VK_PHYSICAL_DEVICE_LAYERED_API_METAL_KHR = 3,
    VK_PHYSICAL_DEVICE_LAYERED_API_OPENGL_KHR = 4,
    VK_PHYSICAL_DEVICE_LAYERED_API_OPENGLES_KHR = 5,
} VkPhysicalDeviceLayeredApiKHR;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_issues"><a class="anchor" href="#_issues"></a>4. Issues</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_resolved_when_running_on_a_layered_implementation_how_should_the_properties_of_an_underlying_layered_vulkan_device_be_queries"><a class="anchor" href="#_resolved_when_running_on_a_layered_implementation_how_should_the_properties_of_an_underlying_layered_vulkan_device_be_queries"></a>4.1. RESOLVED: When running on a layered implementation, how should the properties of an underlying layered Vulkan device be queries?</h3>
<div class="paragraph">
<p>A dedicated struct <code>VkPhysicalDeviceLayeredApiVulkanPropertiesKHR</code> should be used, with a <code>VkPhysicalDeviceProperties2</code> member.
Additional information can be queried by chaining <code>VkPhysicalDeviceDriverProperties</code> and <code>VkPhysicalDeviceIDProperties</code> structs to that member.</p>
</div>
<div class="paragraph">
<p>Chaining <code>VkPhysicalDeviceProperties2</code>, <code>VkPhysicalDeviceDriverProperties</code> and <code>VkPhysicalDeviceIDProperties</code> directly to <code>VkPhysicalDeviceLayeredApiPropertiesKHR</code> can be confusing for a number of reasons.
In particular, <code>VkPhysicalDeviceProperties2</code> is a "root" structure which can accept <code>VkPhysicalDeviceDriverProperties</code> and <code>VkPhysicalDeviceIDProperties</code> in its chain; allowing those structs to be chained to <code>VkPhysicalDeviceLayeredApiPropertiesKHR</code> means that it would be valid for an application to create a chain such as <code>VkPhysicalDeviceLayeredApiPropertiesKHR</code> &#8594; <code>VkPhysicalDeviceDriverProperties</code> &#8594; <code>VkPhysicalDeviceProperties2</code> which can be confusing.</p>
</div>
<div class="paragraph">
<p>A future extension could also provide functionality to query properties of another layered API, such as D3D.
This extension allows the API-specific structs to be chained to <code>VkPhysicalDeviceLayeredApiPropertiesKHR</code> to facilitate querying all information at once, which means the <code>pNext</code> chain of <code>VkPhysicalDeviceLayeredApiPropertiesKHR</code> could include property structs for both Vulkan and D3D for example.
Allowing multiple structs per API, potentially interleaved would just add to the confusion.</p>
</div>
<div class="paragraph">
<p>By wrapping <code>VkPhysicalDeviceProperties2</code> in a <code>VkPhysicalDeviceLayeredApiVulkanPropertiesKHR</code> struct, the <code>pNext</code> chain of <code>VkPhysicalDeviceLayeredApiPropertiesKHR</code> would contain only one struct per API, and avoid confusion in drivers, applications and validation layers.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_further_functionality"><a class="anchor" href="#_further_functionality"></a>5. Further Functionality</h2>
<div class="sectionbody">
<div class="paragraph">
<p>None.</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css"></script>
<script async src="../../../../search-index.js"></script>
  </body>
</html>
